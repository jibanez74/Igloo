var ey=r=>{throw TypeError(r)};var ah=(r,e,t)=>e.has(r)||ey("Cannot "+t);var j=(r,e,t)=>(ah(r,e,"read from private field"),t?t.call(r):e.get(r)),Ee=(r,e,t)=>e.has(r)?ey("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ge=(r,e,t,s)=>(ah(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),Oe=(r,e,t)=>(ah(r,e,"access private method"),t);var Yl=(r,e,t,s)=>({set _(a){ge(r,e,a,t)},get _(){return j(r,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var oh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Db(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var a=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:function(){return r[s]}})}),t}var lh={exports:{}},go={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function Cb(){if(ty)return go;ty=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,a,o){var u=null;if(o!==void 0&&(u=""+o),a.key!==void 0&&(u=""+a.key),"key"in a){o={};for(var c in a)c!=="key"&&(o[c]=a[c])}else o=a;return a=o.ref,{$$typeof:r,type:s,key:u,ref:a!==void 0?a:null,props:o}}return go.Fragment=e,go.jsx=t,go.jsxs=t,go}var iy;function wb(){return iy||(iy=1,lh.exports=Cb()),lh.exports}var L=wb(),uh={exports:{}},we={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function Ob(){if(sy)return we;sy=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function v(O){return O===null||typeof O!="object"?null:(O=p&&O[p]||O["@@iterator"],typeof O=="function"?O:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function T(O,K,te){this.props=O,this.context=K,this.refs=E,this.updater=te||x}T.prototype.isReactComponent={},T.prototype.setState=function(O,K){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,K,"setState")},T.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function A(){}A.prototype=T.prototype;function w(O,K,te){this.props=O,this.context=K,this.refs=E,this.updater=te||x}var C=w.prototype=new A;C.constructor=w,S(C,T.prototype),C.isPureReactComponent=!0;var k=Array.isArray,_={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function B(O,K,te,ae,re,me){return te=me.ref,{$$typeof:r,type:O,key:K,ref:te!==void 0?te:null,props:me}}function M(O,K){return B(O.type,K,void 0,void 0,void 0,O.props)}function D(O){return typeof O=="object"&&O!==null&&O.$$typeof===r}function N(O){var K={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(te){return K[te]})}var P=/\/+/g;function G(O,K){return typeof O=="object"&&O!==null&&O.key!=null?N(""+O.key):K.toString(36)}function J(){}function z(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(J,J):(O.status="pending",O.then(function(K){O.status==="pending"&&(O.status="fulfilled",O.value=K)},function(K){O.status==="pending"&&(O.status="rejected",O.reason=K)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function Q(O,K,te,ae,re){var me=typeof O;(me==="undefined"||me==="boolean")&&(O=null);var de=!1;if(O===null)de=!0;else switch(me){case"bigint":case"string":case"number":de=!0;break;case"object":switch(O.$$typeof){case r:case e:de=!0;break;case m:return de=O._init,Q(de(O._payload),K,te,ae,re)}}if(de)return re=re(O),de=ae===""?"."+G(O,0):ae,k(re)?(te="",de!=null&&(te=de.replace(P,"$&/")+"/"),Q(re,K,te,"",function(Le){return Le})):re!=null&&(D(re)&&(re=M(re,te+(re.key==null||O&&O.key===re.key?"":(""+re.key).replace(P,"$&/")+"/")+de)),K.push(re)),1;de=0;var _e=ae===""?".":ae+":";if(k(O))for(var pe=0;pe<O.length;pe++)ae=O[pe],me=_e+G(ae,pe),de+=Q(ae,K,te,me,re);else if(pe=v(O),typeof pe=="function")for(O=pe.call(O),pe=0;!(ae=O.next()).done;)ae=ae.value,me=_e+G(ae,pe++),de+=Q(ae,K,te,me,re);else if(me==="object"){if(typeof O.then=="function")return Q(z(O),K,te,ae,re);throw K=String(O),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return de}function $(O,K,te){if(O==null)return O;var ae=[],re=0;return Q(O,ae,"","",function(me){return K.call(te,me,re++)}),ae}function oe(O){if(O._status===-1){var K=O._result;K=K(),K.then(function(te){(O._status===0||O._status===-1)&&(O._status=1,O._result=te)},function(te){(O._status===0||O._status===-1)&&(O._status=2,O._result=te)}),O._status===-1&&(O._status=0,O._result=K)}if(O._status===1)return O._result.default;throw O._result}var ue=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)};function Y(){}return we.Children={map:$,forEach:function(O,K,te){$(O,function(){K.apply(this,arguments)},te)},count:function(O){var K=0;return $(O,function(){K++}),K},toArray:function(O){return $(O,function(K){return K})||[]},only:function(O){if(!D(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},we.Component=T,we.Fragment=t,we.Profiler=a,we.PureComponent=w,we.StrictMode=s,we.Suspense=h,we.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_,we.act=function(){throw Error("act(...) is not supported in production builds of React.")},we.cache=function(O){return function(){return O.apply(null,arguments)}},we.cloneElement=function(O,K,te){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var ae=S({},O.props),re=O.key,me=void 0;if(K!=null)for(de in K.ref!==void 0&&(me=void 0),K.key!==void 0&&(re=""+K.key),K)!U.call(K,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&K.ref===void 0||(ae[de]=K[de]);var de=arguments.length-2;if(de===1)ae.children=te;else if(1<de){for(var _e=Array(de),pe=0;pe<de;pe++)_e[pe]=arguments[pe+2];ae.children=_e}return B(O.type,re,void 0,void 0,me,ae)},we.createContext=function(O){return O={$$typeof:u,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:o,_context:O},O},we.createElement=function(O,K,te){var ae,re={},me=null;if(K!=null)for(ae in K.key!==void 0&&(me=""+K.key),K)U.call(K,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(re[ae]=K[ae]);var de=arguments.length-2;if(de===1)re.children=te;else if(1<de){for(var _e=Array(de),pe=0;pe<de;pe++)_e[pe]=arguments[pe+2];re.children=_e}if(O&&O.defaultProps)for(ae in de=O.defaultProps,de)re[ae]===void 0&&(re[ae]=de[ae]);return B(O,me,void 0,void 0,null,re)},we.createRef=function(){return{current:null}},we.forwardRef=function(O){return{$$typeof:c,render:O}},we.isValidElement=D,we.lazy=function(O){return{$$typeof:m,_payload:{_status:-1,_result:O},_init:oe}},we.memo=function(O,K){return{$$typeof:d,type:O,compare:K===void 0?null:K}},we.startTransition=function(O){var K=_.T,te={};_.T=te;try{var ae=O(),re=_.S;re!==null&&re(te,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(Y,ue)}catch(me){ue(me)}finally{_.T=K}},we.unstable_useCacheRefresh=function(){return _.H.useCacheRefresh()},we.use=function(O){return _.H.use(O)},we.useActionState=function(O,K,te){return _.H.useActionState(O,K,te)},we.useCallback=function(O,K){return _.H.useCallback(O,K)},we.useContext=function(O){return _.H.useContext(O)},we.useDebugValue=function(){},we.useDeferredValue=function(O,K){return _.H.useDeferredValue(O,K)},we.useEffect=function(O,K){return _.H.useEffect(O,K)},we.useId=function(){return _.H.useId()},we.useImperativeHandle=function(O,K,te){return _.H.useImperativeHandle(O,K,te)},we.useInsertionEffect=function(O,K){return _.H.useInsertionEffect(O,K)},we.useLayoutEffect=function(O,K){return _.H.useLayoutEffect(O,K)},we.useMemo=function(O,K){return _.H.useMemo(O,K)},we.useOptimistic=function(O,K){return _.H.useOptimistic(O,K)},we.useReducer=function(O,K,te){return _.H.useReducer(O,K,te)},we.useRef=function(O){return _.H.useRef(O)},we.useState=function(O){return _.H.useState(O)},we.useSyncExternalStore=function(O,K,te){return _.H.useSyncExternalStore(O,K,te)},we.useTransition=function(){return _.H.useTransition()},we.version="19.0.0",we}var ny;function ws(){return ny||(ny=1,uh.exports=Ob()),uh.exports}var fe=ws();const Jn=lx(fe);var ch={exports:{}},po={},fh={exports:{}},hh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ry;function Ib(){return ry||(ry=1,function(r){function e($,oe){var ue=$.length;$.push(oe);e:for(;0<ue;){var Y=ue-1>>>1,O=$[Y];if(0<a(O,oe))$[Y]=oe,$[ue]=O,ue=Y;else break e}}function t($){return $.length===0?null:$[0]}function s($){if($.length===0)return null;var oe=$[0],ue=$.pop();if(ue!==oe){$[0]=ue;e:for(var Y=0,O=$.length,K=O>>>1;Y<K;){var te=2*(Y+1)-1,ae=$[te],re=te+1,me=$[re];if(0>a(ae,ue))re<O&&0>a(me,ae)?($[Y]=me,$[re]=ue,Y=re):($[Y]=ae,$[te]=ue,Y=te);else if(re<O&&0>a(me,ue))$[Y]=me,$[re]=ue,Y=re;else break e}}return oe}function a($,oe){var ue=$.sortIndex-oe.sortIndex;return ue!==0?ue:$.id-oe.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var h=[],d=[],m=1,p=null,v=3,x=!1,S=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function C($){for(var oe=t(d);oe!==null;){if(oe.callback===null)s(d);else if(oe.startTime<=$)s(d),oe.sortIndex=oe.expirationTime,e(h,oe);else break;oe=t(d)}}function k($){if(E=!1,C($),!S)if(t(h)!==null)S=!0,z();else{var oe=t(d);oe!==null&&Q(k,oe.startTime-$)}}var _=!1,U=-1,B=5,M=-1;function D(){return!(r.unstable_now()-M<B)}function N(){if(_){var $=r.unstable_now();M=$;var oe=!0;try{e:{S=!1,E&&(E=!1,A(U),U=-1),x=!0;var ue=v;try{t:{for(C($),p=t(h);p!==null&&!(p.expirationTime>$&&D());){var Y=p.callback;if(typeof Y=="function"){p.callback=null,v=p.priorityLevel;var O=Y(p.expirationTime<=$);if($=r.unstable_now(),typeof O=="function"){p.callback=O,C($),oe=!0;break t}p===t(h)&&s(h),C($)}else s(h);p=t(h)}if(p!==null)oe=!0;else{var K=t(d);K!==null&&Q(k,K.startTime-$),oe=!1}}break e}finally{p=null,v=ue,x=!1}oe=void 0}}finally{oe?P():_=!1}}}var P;if(typeof w=="function")P=function(){w(N)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,J=G.port2;G.port1.onmessage=N,P=function(){J.postMessage(null)}}else P=function(){T(N,0)};function z(){_||(_=!0,P())}function Q($,oe){U=T(function(){$(r.unstable_now())},oe)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function($){$.callback=null},r.unstable_continueExecution=function(){S||x||(S=!0,z())},r.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<$?Math.floor(1e3/$):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(h)},r.unstable_next=function($){switch(v){case 1:case 2:case 3:var oe=3;break;default:oe=v}var ue=v;v=oe;try{return $()}finally{v=ue}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function($,oe){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ue=v;v=$;try{return oe()}finally{v=ue}},r.unstable_scheduleCallback=function($,oe,ue){var Y=r.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Y+ue:Y):ue=Y,$){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ue+O,$={id:m++,callback:oe,priorityLevel:$,startTime:ue,expirationTime:O,sortIndex:-1},ue>Y?($.sortIndex=ue,e(d,$),t(h)===null&&$===t(d)&&(E?(A(U),U=-1):E=!0,Q(k,ue-Y))):($.sortIndex=O,e(h,$),S||x||(S=!0,z())),$},r.unstable_shouldYield=D,r.unstable_wrapCallback=function($){var oe=v;return function(){var ue=v;v=oe;try{return $.apply(this,arguments)}finally{v=ue}}}}(hh)),hh}var ay;function Mb(){return ay||(ay=1,fh.exports=Ib()),fh.exports}var dh={exports:{}},kt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function kb(){if(oy)return kt;oy=1;var r=ws();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:h,containerInfo:d,implementation:m}}var u=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return kt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,kt.createPortal=function(h,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,m)},kt.flushSync=function(h){var d=u.T,m=s.p;try{if(u.T=null,s.p=2,h)return h()}finally{u.T=d,s.p=m,s.d.f()}},kt.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,s.d.C(h,d))},kt.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},kt.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var m=d.as,p=c(m,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,x=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?s.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:x}):m==="script"&&s.d.X(h,{crossOrigin:p,integrity:v,fetchPriority:x,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},kt.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);s.d.M(h,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&s.d.M(h)},kt.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,p=c(m,d.crossOrigin);s.d.L(h,m,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},kt.preloadModule=function(h,d){if(typeof h=="string")if(d){var m=c(d.as,d.crossOrigin);s.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else s.d.m(h)},kt.requestFormReset=function(h){s.d.r(h)},kt.unstable_batchedUpdates=function(h,d){return h(d)},kt.useFormState=function(h,d,m){return u.H.useFormState(h,d,m)},kt.useFormStatus=function(){return u.H.useHostTransitionStatus()},kt.version="19.0.0",kt}var ly;function ux(){if(ly)return dh.exports;ly=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),dh.exports=kb(),dh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uy;function Nb(){if(uy)return po;uy=1;var r=Mb(),e=ws(),t=ux();function s(i){var n="https://react.dev/errors/"+i;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var o=Symbol.for("react.element"),u=Symbol.for("react.transitional.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),v=Symbol.for("react.consumer"),x=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),k=Symbol.for("react.memo_cache_sentinel"),_=Symbol.iterator;function U(i){return i===null||typeof i!="object"?null:(i=_&&i[_]||i["@@iterator"],typeof i=="function"?i:null)}var B=Symbol.for("react.client.reference");function M(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===B?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case h:return"Fragment";case c:return"Portal";case m:return"Profiler";case d:return"StrictMode";case E:return"Suspense";case T:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case x:return(i.displayName||"Context")+".Provider";case v:return(i._context.displayName||"Context")+".Consumer";case S:var n=i.render;return i=i.displayName,i||(i=n.displayName||n.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case A:return n=i.displayName||null,n!==null?n:M(i.type)||"Memo";case w:n=i._payload,i=i._init;try{return M(i(n))}catch{}}return null}var D=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N=Object.assign,P,G;function J(i){if(P===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);P=n&&n[1]||"",G=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+P+i+G}var z=!1;function Q(i,n){if(!i||z)return"";z=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(n){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(se){var ee=se}Reflect.construct(i,[],he)}else{try{he.call()}catch(se){ee=se}i.call(he.prototype)}}else{try{throw Error()}catch(se){ee=se}(he=i())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(se){if(se&&ee&&typeof se.stack=="string")return[se.stack,ee.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),b=y[0],I=y[1];if(b&&I){var F=b.split(`
`),V=I.split(`
`);for(g=f=0;f<F.length&&!F[f].includes("DetermineComponentFrameRoot");)f++;for(;g<V.length&&!V[g].includes("DetermineComponentFrameRoot");)g++;if(f===F.length||g===V.length)for(f=F.length-1,g=V.length-1;1<=f&&0<=g&&F[f]!==V[g];)g--;for(;1<=f&&0<=g;f--,g--)if(F[f]!==V[g]){if(f!==1||g!==1)do if(f--,g--,0>g||F[f]!==V[g]){var ne=`
`+F[f].replace(" at new "," at ");return i.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",i.displayName)),ne}while(1<=f&&0<=g);break}}}finally{z=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?J(l):""}function $(i){switch(i.tag){case 26:case 27:case 5:return J(i.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 15:return i=Q(i.type,!1),i;case 11:return i=Q(i.type.render,!1),i;case 1:return i=Q(i.type,!0),i;default:return""}}function oe(i){try{var n="";do n+=$(i),i=i.return;while(i);return n}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function ue(i){var n=i,l=i;if(i.alternate)for(;n.return;)n=n.return;else{i=n;do n=i,(n.flags&4098)!==0&&(l=n.return),i=n.return;while(i)}return n.tag===3?l:null}function Y(i){if(i.tag===13){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function O(i){if(ue(i)!==i)throw Error(s(188))}function K(i){var n=i.alternate;if(!n){if(n=ue(i),n===null)throw Error(s(188));return n!==i?null:i}for(var l=i,f=n;;){var g=l.return;if(g===null)break;var y=g.alternate;if(y===null){if(f=g.return,f!==null){l=f;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===l)return O(g),i;if(y===f)return O(g),n;y=y.sibling}throw Error(s(188))}if(l.return!==f.return)l=g,f=y;else{for(var b=!1,I=g.child;I;){if(I===l){b=!0,l=g,f=y;break}if(I===f){b=!0,f=g,l=y;break}I=I.sibling}if(!b){for(I=y.child;I;){if(I===l){b=!0,l=y,f=g;break}if(I===f){b=!0,f=y,l=g;break}I=I.sibling}if(!b)throw Error(s(189))}}if(l.alternate!==f)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?i:n}function te(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i;for(i=i.child;i!==null;){if(n=te(i),n!==null)return n;i=i.sibling}return null}var ae=Array.isArray,re=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},de=[],_e=-1;function pe(i){return{current:i}}function Le(i){0>_e||(i.current=de[_e],de[_e]=null,_e--)}function Ne(i,n){_e++,de[_e]=i.current,i.current=n}var ut=pe(null),si=pe(null),_t=pe(null),et=pe(null);function gt(i,n){switch(Ne(_t,n),Ne(si,i),Ne(ut,null),i=n.nodeType,i){case 9:case 11:n=(n=n.documentElement)&&(n=n.namespaceURI)?Cp(n):0;break;default:if(i=i===8?n.parentNode:n,n=i.tagName,i=i.namespaceURI)i=Cp(i),n=wp(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}Le(ut),Ne(ut,n)}function Je(){Le(ut),Le(si),Le(_t)}function Ai(i){i.memoizedState!==null&&Ne(et,i);var n=ut.current,l=wp(n,i.type);n!==l&&(Ne(si,i),Ne(ut,l))}function Fi(i){si.current===i&&(Le(ut),Le(si)),et.current===i&&(Le(et),uo._currentValue=me)}var Os=Object.prototype.hasOwnProperty,$e=r.unstable_scheduleCallback,tt=r.unstable_cancelCallback,is=r.unstable_shouldYield,No=r.unstable_requestPaint,ni=r.unstable_now,Ju=r.unstable_getCurrentPriorityLevel,v0=r.unstable_ImmediatePriority,x0=r.unstable_UserBlockingPriority,Po=r.unstable_NormalPriority,uE=r.unstable_LowPriority,S0=r.unstable_IdlePriority,cE=r.log,fE=r.unstable_setDisableYieldValue,va=null,Qt=null;function hE(i){if(Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(va,i,void 0,(i.current.flags&128)===128)}catch{}}function Is(i){if(typeof cE=="function"&&fE(i),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(va,i)}catch{}}var Wt=Math.clz32?Math.clz32:gE,dE=Math.log,mE=Math.LN2;function gE(i){return i>>>=0,i===0?32:31-(dE(i)/mE|0)|0}var Fo=128,Uo=4194304;function pn(i){var n=i&42;if(n!==0)return n;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Bo(i,n){var l=i.pendingLanes;if(l===0)return 0;var f=0,g=i.suspendedLanes,y=i.pingedLanes,b=i.warmLanes;i=i.finishedLanes!==0;var I=l&134217727;return I!==0?(l=I&~g,l!==0?f=pn(l):(y&=I,y!==0?f=pn(y):i||(b=I&~b,b!==0&&(f=pn(b))))):(I=l&~g,I!==0?f=pn(I):y!==0?f=pn(y):i||(b=l&~b,b!==0&&(f=pn(b)))),f===0?0:n!==0&&n!==f&&(n&g)===0&&(g=f&-f,b=n&-n,g>=b||g===32&&(b&4194176)!==0)?n:f}function xa(i,n){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&n)===0}function pE(i,n){switch(i){case 1:case 2:case 4:case 8:return n+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function E0(){var i=Fo;return Fo<<=1,(Fo&4194176)===0&&(Fo=128),i}function T0(){var i=Uo;return Uo<<=1,(Uo&62914560)===0&&(Uo=4194304),i}function ec(i){for(var n=[],l=0;31>l;l++)n.push(i);return n}function Sa(i,n){i.pendingLanes|=n,n!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function yE(i,n,l,f,g,y){var b=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var I=i.entanglements,F=i.expirationTimes,V=i.hiddenUpdates;for(l=b&~l;0<l;){var ne=31-Wt(l),he=1<<ne;I[ne]=0,F[ne]=-1;var ee=V[ne];if(ee!==null)for(V[ne]=null,ne=0;ne<ee.length;ne++){var se=ee[ne];se!==null&&(se.lane&=-536870913)}l&=~he}f!==0&&b0(i,f,0),y!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=y&~(b&~n))}function b0(i,n,l){i.pendingLanes|=n,i.suspendedLanes&=~n;var f=31-Wt(n);i.entangledLanes|=n,i.entanglements[f]=i.entanglements[f]|1073741824|l&4194218}function A0(i,n){var l=i.entangledLanes|=n;for(i=i.entanglements;l;){var f=31-Wt(l),g=1<<f;g&n|i[f]&n&&(i[f]|=n),l&=~g}}function R0(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function L0(){var i=re.p;return i!==0?i:(i=window.event,i===void 0?32:qp(i.type))}function vE(i,n){var l=re.p;try{return re.p=i,n()}finally{re.p=l}}var Ms=Math.random().toString(36).slice(2),It="__reactFiber$"+Ms,Ht="__reactProps$"+Ms,rr="__reactContainer$"+Ms,tc="__reactEvents$"+Ms,xE="__reactListeners$"+Ms,SE="__reactHandles$"+Ms,_0="__reactResources$"+Ms,Ea="__reactMarker$"+Ms;function ic(i){delete i[It],delete i[Ht],delete i[tc],delete i[xE],delete i[SE]}function yn(i){var n=i[It];if(n)return n;for(var l=i.parentNode;l;){if(n=l[rr]||l[It]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(i=Mp(i);i!==null;){if(l=i[It])return l;i=Mp(i)}return n}i=l,l=i.parentNode}return null}function ar(i){if(i=i[It]||i[rr]){var n=i.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return i}return null}function Ta(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i.stateNode;throw Error(s(33))}function or(i){var n=i[_0];return n||(n=i[_0]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function St(i){i[Ea]=!0}var D0=new Set,C0={};function vn(i,n){lr(i,n),lr(i+"Capture",n)}function lr(i,n){for(C0[i]=n,i=0;i<n.length;i++)D0.add(n[i])}var ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),EE=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),w0={},O0={};function TE(i){return Os.call(O0,i)?!0:Os.call(w0,i)?!1:EE.test(i)?O0[i]=!0:(w0[i]=!0,!1)}function jo(i,n,l){if(TE(n))if(l===null)i.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(n);return;case"boolean":var f=n.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(n);return}}i.setAttribute(n,""+l)}}function Go(i,n,l){if(l===null)i.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(n);return}i.setAttribute(n,""+l)}}function ns(i,n,l,f){if(f===null)i.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(n,l,""+f)}}function ri(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function I0(i){var n=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function bE(i){var n=I0(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,n),f=""+i[n];if(!i.hasOwnProperty(n)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,y=l.set;return Object.defineProperty(i,n,{configurable:!0,get:function(){return g.call(this)},set:function(b){f=""+b,y.call(this,b)}}),Object.defineProperty(i,n,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(b){f=""+b},stopTracking:function(){i._valueTracker=null,delete i[n]}}}}function Ho(i){i._valueTracker||(i._valueTracker=bE(i))}function M0(i){if(!i)return!1;var n=i._valueTracker;if(!n)return!0;var l=n.getValue(),f="";return i&&(f=I0(i)?i.checked?"true":"false":i.value),i=f,i!==l?(n.setValue(i),!0):!1}function $o(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var AE=/[\n"\\]/g;function ai(i){return i.replace(AE,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function sc(i,n,l,f,g,y,b,I){i.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?i.type=b:i.removeAttribute("type"),n!=null?b==="number"?(n===0&&i.value===""||i.value!=n)&&(i.value=""+ri(n)):i.value!==""+ri(n)&&(i.value=""+ri(n)):b!=="submit"&&b!=="reset"||i.removeAttribute("value"),n!=null?nc(i,b,ri(n)):l!=null?nc(i,b,ri(l)):f!=null&&i.removeAttribute("value"),g==null&&y!=null&&(i.defaultChecked=!!y),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.name=""+ri(I):i.removeAttribute("name")}function k0(i,n,l,f,g,y,b,I){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),n!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||n!=null))return;l=l!=null?""+ri(l):"",n=n!=null?""+ri(n):l,I||n===i.value||(i.value=n),i.defaultValue=n}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=I?i.checked:!!f,i.defaultChecked=!!f,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.name=b)}function nc(i,n,l){n==="number"&&$o(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function ur(i,n,l,f){if(i=i.options,n){n={};for(var g=0;g<l.length;g++)n["$"+l[g]]=!0;for(l=0;l<i.length;l++)g=n.hasOwnProperty("$"+i[l].value),i[l].selected!==g&&(i[l].selected=g),g&&f&&(i[l].defaultSelected=!0)}else{for(l=""+ri(l),n=null,g=0;g<i.length;g++){if(i[g].value===l){i[g].selected=!0,f&&(i[g].defaultSelected=!0);return}n!==null||i[g].disabled||(n=i[g])}n!==null&&(n.selected=!0)}}function N0(i,n,l){if(n!=null&&(n=""+ri(n),n!==i.value&&(i.value=n),l==null)){i.defaultValue!==n&&(i.defaultValue=n);return}i.defaultValue=l!=null?""+ri(l):""}function P0(i,n,l,f){if(n==null){if(f!=null){if(l!=null)throw Error(s(92));if(ae(f)){if(1<f.length)throw Error(s(93));f=f[0]}l=f}l==null&&(l=""),n=l}l=ri(n),i.defaultValue=l,f=i.textContent,f===l&&f!==""&&f!==null&&(i.value=f)}function cr(i,n){if(n){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=n;return}}i.textContent=n}var RE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function F0(i,n,l){var f=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?i.setProperty(n,""):n==="float"?i.cssFloat="":i[n]="":f?i.setProperty(n,l):typeof l!="number"||l===0||RE.has(n)?n==="float"?i.cssFloat=l:i[n]=(""+l).trim():i[n]=l+"px"}function U0(i,n,l){if(n!=null&&typeof n!="object")throw Error(s(62));if(i=i.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||n!=null&&n.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var g in n)f=n[g],n.hasOwnProperty(g)&&l[g]!==f&&F0(i,g,f)}else for(var y in n)n.hasOwnProperty(y)&&F0(i,y,n[y])}function rc(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var LE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_E=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vo(i){return _E.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var ac=null;function oc(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var fr=null,hr=null;function B0(i){var n=ar(i);if(n&&(i=n.stateNode)){var l=i[Ht]||null;e:switch(i=n.stateNode,n.type){case"input":if(sc(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+ai(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var f=l[n];if(f!==i&&f.form===i.form){var g=f[Ht]||null;if(!g)throw Error(s(90));sc(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(n=0;n<l.length;n++)f=l[n],f.form===i.form&&M0(f)}break e;case"textarea":N0(i,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&ur(i,!!l.multiple,n,!1)}}}var lc=!1;function j0(i,n,l){if(lc)return i(n,l);lc=!0;try{var f=i(n);return f}finally{if(lc=!1,(fr!==null||hr!==null)&&(_l(),fr&&(n=fr,i=hr,hr=fr=null,B0(n),i)))for(n=0;n<i.length;n++)B0(i[n])}}function ba(i,n){var l=i.stateNode;if(l===null)return null;var f=l[Ht]||null;if(f===null)return null;l=f[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(s(231,n,typeof l));return l}var uc=!1;if(ss)try{var Aa={};Object.defineProperty(Aa,"passive",{get:function(){uc=!0}}),window.addEventListener("test",Aa,Aa),window.removeEventListener("test",Aa,Aa)}catch{uc=!1}var ks=null,cc=null,Ko=null;function G0(){if(Ko)return Ko;var i,n=cc,l=n.length,f,g="value"in ks?ks.value:ks.textContent,y=g.length;for(i=0;i<l&&n[i]===g[i];i++);var b=l-i;for(f=1;f<=b&&n[l-f]===g[y-f];f++);return Ko=g.slice(i,1<f?1-f:void 0)}function zo(i){var n=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&n===13&&(i=13)):i=n,i===10&&(i=13),32<=i||i===13?i:0}function Yo(){return!0}function H0(){return!1}function $t(i){function n(l,f,g,y,b){this._reactName=l,this._targetInst=g,this.type=f,this.nativeEvent=y,this.target=b,this.currentTarget=null;for(var I in i)i.hasOwnProperty(I)&&(l=i[I],this[I]=l?l(y):y[I]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Yo:H0,this.isPropagationStopped=H0,this}return N(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Yo)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Yo)},persist:function(){},isPersistent:Yo}),n}var xn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qo=$t(xn),Ra=N({},xn,{view:0,detail:0}),DE=$t(Ra),fc,hc,La,Xo=N({},Ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mc,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==La&&(La&&i.type==="mousemove"?(fc=i.screenX-La.screenX,hc=i.screenY-La.screenY):hc=fc=0,La=i),fc)},movementY:function(i){return"movementY"in i?i.movementY:hc}}),$0=$t(Xo),CE=N({},Xo,{dataTransfer:0}),wE=$t(CE),OE=N({},Ra,{relatedTarget:0}),dc=$t(OE),IE=N({},xn,{animationName:0,elapsedTime:0,pseudoElement:0}),ME=$t(IE),kE=N({},xn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),NE=$t(kE),PE=N({},xn,{data:0}),V0=$t(PE),FE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jE(i){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(i):(i=BE[i])?!!n[i]:!1}function mc(){return jE}var GE=N({},Ra,{key:function(i){if(i.key){var n=FE[i.key]||i.key;if(n!=="Unidentified")return n}return i.type==="keypress"?(i=zo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?UE[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mc,charCode:function(i){return i.type==="keypress"?zo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?zo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),HE=$t(GE),$E=N({},Xo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),K0=$t($E),VE=N({},Ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mc}),KE=$t(VE),zE=N({},xn,{propertyName:0,elapsedTime:0,pseudoElement:0}),YE=$t(zE),qE=N({},Xo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),XE=$t(qE),QE=N({},xn,{newState:0,oldState:0}),WE=$t(QE),ZE=[9,13,27,32],gc=ss&&"CompositionEvent"in window,_a=null;ss&&"documentMode"in document&&(_a=document.documentMode);var JE=ss&&"TextEvent"in window&&!_a,z0=ss&&(!gc||_a&&8<_a&&11>=_a),Y0=" ",q0=!1;function X0(i,n){switch(i){case"keyup":return ZE.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Q0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var dr=!1;function eT(i,n){switch(i){case"compositionend":return Q0(n);case"keypress":return n.which!==32?null:(q0=!0,Y0);case"textInput":return i=n.data,i===Y0&&q0?null:i;default:return null}}function tT(i,n){if(dr)return i==="compositionend"||!gc&&X0(i,n)?(i=G0(),Ko=cc=ks=null,dr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return z0&&n.locale!=="ko"?null:n.data;default:return null}}var iT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function W0(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n==="input"?!!iT[i.type]:n==="textarea"}function Z0(i,n,l,f){fr?hr?hr.push(f):hr=[f]:fr=f,n=Il(n,"onChange"),0<n.length&&(l=new qo("onChange","change",null,l,f),i.push({event:l,listeners:n}))}var Da=null,Ca=null;function sT(i){Ap(i,0)}function Qo(i){var n=Ta(i);if(M0(n))return i}function J0(i,n){if(i==="change")return n}var em=!1;if(ss){var pc;if(ss){var yc="oninput"in document;if(!yc){var tm=document.createElement("div");tm.setAttribute("oninput","return;"),yc=typeof tm.oninput=="function"}pc=yc}else pc=!1;em=pc&&(!document.documentMode||9<document.documentMode)}function im(){Da&&(Da.detachEvent("onpropertychange",sm),Ca=Da=null)}function sm(i){if(i.propertyName==="value"&&Qo(Ca)){var n=[];Z0(n,Ca,i,oc(i)),j0(sT,n)}}function nT(i,n,l){i==="focusin"?(im(),Da=n,Ca=l,Da.attachEvent("onpropertychange",sm)):i==="focusout"&&im()}function rT(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Qo(Ca)}function aT(i,n){if(i==="click")return Qo(n)}function oT(i,n){if(i==="input"||i==="change")return Qo(n)}function lT(i,n){return i===n&&(i!==0||1/i===1/n)||i!==i&&n!==n}var Zt=typeof Object.is=="function"?Object.is:lT;function wa(i,n){if(Zt(i,n))return!0;if(typeof i!="object"||i===null||typeof n!="object"||n===null)return!1;var l=Object.keys(i),f=Object.keys(n);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var g=l[f];if(!Os.call(n,g)||!Zt(i[g],n[g]))return!1}return!0}function nm(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function rm(i,n){var l=nm(i);i=0;for(var f;l;){if(l.nodeType===3){if(f=i+l.textContent.length,i<=n&&f>=n)return{node:l,offset:n-i};i=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=nm(l)}}function am(i,n){return i&&n?i===n?!0:i&&i.nodeType===3?!1:n&&n.nodeType===3?am(i,n.parentNode):"contains"in i?i.contains(n):i.compareDocumentPosition?!!(i.compareDocumentPosition(n)&16):!1:!1}function om(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var n=$o(i.document);n instanceof i.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)i=n.contentWindow;else break;n=$o(i.document)}return n}function vc(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n&&(n==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||n==="textarea"||i.contentEditable==="true")}function uT(i,n){var l=om(n);n=i.focusedElem;var f=i.selectionRange;if(l!==n&&n&&n.ownerDocument&&am(n.ownerDocument.documentElement,n)){if(f!==null&&vc(n)){if(i=f.start,l=f.end,l===void 0&&(l=i),"selectionStart"in n)n.selectionStart=i,n.selectionEnd=Math.min(l,n.value.length);else if(l=(i=n.ownerDocument||document)&&i.defaultView||window,l.getSelection){l=l.getSelection();var g=n.textContent.length,y=Math.min(f.start,g);f=f.end===void 0?y:Math.min(f.end,g),!l.extend&&y>f&&(g=f,f=y,y=g),g=rm(n,y);var b=rm(n,f);g&&b&&(l.rangeCount!==1||l.anchorNode!==g.node||l.anchorOffset!==g.offset||l.focusNode!==b.node||l.focusOffset!==b.offset)&&(i=i.createRange(),i.setStart(g.node,g.offset),l.removeAllRanges(),y>f?(l.addRange(i),l.extend(b.node,b.offset)):(i.setEnd(b.node,b.offset),l.addRange(i)))}}for(i=[],l=n;l=l.parentNode;)l.nodeType===1&&i.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<i.length;n++)l=i[n],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var cT=ss&&"documentMode"in document&&11>=document.documentMode,mr=null,xc=null,Oa=null,Sc=!1;function lm(i,n,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Sc||mr==null||mr!==$o(f)||(f=mr,"selectionStart"in f&&vc(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Oa&&wa(Oa,f)||(Oa=f,f=Il(xc,"onSelect"),0<f.length&&(n=new qo("onSelect","select",null,n,l),i.push({event:n,listeners:f}),n.target=mr)))}function Sn(i,n){var l={};return l[i.toLowerCase()]=n.toLowerCase(),l["Webkit"+i]="webkit"+n,l["Moz"+i]="moz"+n,l}var gr={animationend:Sn("Animation","AnimationEnd"),animationiteration:Sn("Animation","AnimationIteration"),animationstart:Sn("Animation","AnimationStart"),transitionrun:Sn("Transition","TransitionRun"),transitionstart:Sn("Transition","TransitionStart"),transitioncancel:Sn("Transition","TransitionCancel"),transitionend:Sn("Transition","TransitionEnd")},Ec={},um={};ss&&(um=document.createElement("div").style,"AnimationEvent"in window||(delete gr.animationend.animation,delete gr.animationiteration.animation,delete gr.animationstart.animation),"TransitionEvent"in window||delete gr.transitionend.transition);function En(i){if(Ec[i])return Ec[i];if(!gr[i])return i;var n=gr[i],l;for(l in n)if(n.hasOwnProperty(l)&&l in um)return Ec[i]=n[l];return i}var cm=En("animationend"),fm=En("animationiteration"),hm=En("animationstart"),fT=En("transitionrun"),hT=En("transitionstart"),dT=En("transitioncancel"),dm=En("transitionend"),mm=new Map,gm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Ri(i,n){mm.set(i,n),vn(n,[i])}var oi=[],pr=0,Tc=0;function Wo(){for(var i=pr,n=Tc=pr=0;n<i;){var l=oi[n];oi[n++]=null;var f=oi[n];oi[n++]=null;var g=oi[n];oi[n++]=null;var y=oi[n];if(oi[n++]=null,f!==null&&g!==null){var b=f.pending;b===null?g.next=g:(g.next=b.next,b.next=g),f.pending=g}y!==0&&pm(l,g,y)}}function Zo(i,n,l,f){oi[pr++]=i,oi[pr++]=n,oi[pr++]=l,oi[pr++]=f,Tc|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function bc(i,n,l,f){return Zo(i,n,l,f),Jo(i)}function Ns(i,n){return Zo(i,null,null,n),Jo(i)}function pm(i,n,l){i.lanes|=l;var f=i.alternate;f!==null&&(f.lanes|=l);for(var g=!1,y=i.return;y!==null;)y.childLanes|=l,f=y.alternate,f!==null&&(f.childLanes|=l),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(g=!0)),i=y,y=y.return;g&&n!==null&&i.tag===3&&(y=i.stateNode,g=31-Wt(l),y=y.hiddenUpdates,i=y[g],i===null?y[g]=[n]:i.push(n),n.lane=l|536870912)}function Jo(i){if(50<io)throw io=0,wf=null,Error(s(185));for(var n=i.return;n!==null;)i=n,n=i.return;return i.tag===3?i.stateNode:null}var yr={},ym=new WeakMap;function li(i,n){if(typeof i=="object"&&i!==null){var l=ym.get(i);return l!==void 0?l:(n={value:i,source:n,stack:oe(n)},ym.set(i,n),n)}return{value:i,source:n,stack:oe(n)}}var vr=[],xr=0,el=null,tl=0,ui=[],ci=0,Tn=null,rs=1,as="";function bn(i,n){vr[xr++]=tl,vr[xr++]=el,el=i,tl=n}function vm(i,n,l){ui[ci++]=rs,ui[ci++]=as,ui[ci++]=Tn,Tn=i;var f=rs;i=as;var g=32-Wt(f)-1;f&=~(1<<g),l+=1;var y=32-Wt(n)+g;if(30<y){var b=g-g%5;y=(f&(1<<b)-1).toString(32),f>>=b,g-=b,rs=1<<32-Wt(n)+g|l<<g|f,as=y+i}else rs=1<<y|l<<g|f,as=i}function Ac(i){i.return!==null&&(bn(i,1),vm(i,1,0))}function Rc(i){for(;i===el;)el=vr[--xr],vr[xr]=null,tl=vr[--xr],vr[xr]=null;for(;i===Tn;)Tn=ui[--ci],ui[ci]=null,as=ui[--ci],ui[ci]=null,rs=ui[--ci],ui[ci]=null}var Ft=null,Dt=null,Ge=!1,Li=null,Ui=!1,Lc=Error(s(519));function An(i){var n=Error(s(418,""));throw ka(li(n,i)),Lc}function xm(i){var n=i.stateNode,l=i.type,f=i.memoizedProps;switch(n[It]=i,n[Ht]=f,l){case"dialog":Pe("cancel",n),Pe("close",n);break;case"iframe":case"object":case"embed":Pe("load",n);break;case"video":case"audio":for(l=0;l<no.length;l++)Pe(no[l],n);break;case"source":Pe("error",n);break;case"img":case"image":case"link":Pe("error",n),Pe("load",n);break;case"details":Pe("toggle",n);break;case"input":Pe("invalid",n),k0(n,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),Ho(n);break;case"select":Pe("invalid",n);break;case"textarea":Pe("invalid",n),P0(n,f.value,f.defaultValue,f.children),Ho(n)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||f.suppressHydrationWarning===!0||Dp(n.textContent,l)?(f.popover!=null&&(Pe("beforetoggle",n),Pe("toggle",n)),f.onScroll!=null&&Pe("scroll",n),f.onScrollEnd!=null&&Pe("scrollend",n),f.onClick!=null&&(n.onclick=Ml),n=!0):n=!1,n||An(i)}function Sm(i){for(Ft=i.return;Ft;)switch(Ft.tag){case 3:case 27:Ui=!0;return;case 5:case 13:Ui=!1;return;default:Ft=Ft.return}}function Ia(i){if(i!==Ft)return!1;if(!Ge)return Sm(i),Ge=!0,!1;var n=!1,l;if((l=i.tag!==3&&i.tag!==27)&&((l=i.tag===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||Yf(i.type,i.memoizedProps)),l=!l),l&&(n=!0),n&&Dt&&An(i),Sm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));e:{for(i=i.nextSibling,n=0;i;){if(i.nodeType===8)if(l=i.data,l==="/$"){if(n===0){Dt=Di(i.nextSibling);break e}n--}else l!=="$"&&l!=="$!"&&l!=="$?"||n++;i=i.nextSibling}Dt=null}}else Dt=Ft?Di(i.stateNode.nextSibling):null;return!0}function Ma(){Dt=Ft=null,Ge=!1}function ka(i){Li===null?Li=[i]:Li.push(i)}var Na=Error(s(460)),Em=Error(s(474)),_c={then:function(){}};function Tm(i){return i=i.status,i==="fulfilled"||i==="rejected"}function il(){}function bm(i,n,l){switch(l=i[l],l===void 0?i.push(n):l!==n&&(n.then(il,il),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,i===Na?Error(s(483)):i;default:if(typeof n.status=="string")n.then(il,il);else{if(i=Qe,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=n,i.status="pending",i.then(function(f){if(n.status==="pending"){var g=n;g.status="fulfilled",g.value=f}},function(f){if(n.status==="pending"){var g=n;g.status="rejected",g.reason=f}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,i===Na?Error(s(483)):i}throw Pa=n,Na}}var Pa=null;function Am(){if(Pa===null)throw Error(s(459));var i=Pa;return Pa=null,i}var Sr=null,Fa=0;function sl(i){var n=Fa;return Fa+=1,Sr===null&&(Sr=[]),bm(Sr,i,n)}function Ua(i,n){n=n.props.ref,i.ref=n!==void 0?n:null}function nl(i,n){throw n.$$typeof===o?Error(s(525)):(i=Object.prototype.toString.call(n),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":i)))}function Rm(i){var n=i._init;return n(i._payload)}function Lm(i){function n(q,H){if(i){var W=q.deletions;W===null?(q.deletions=[H],q.flags|=16):W.push(H)}}function l(q,H){if(!i)return null;for(;H!==null;)n(q,H),H=H.sibling;return null}function f(q){for(var H=new Map;q!==null;)q.key!==null?H.set(q.key,q):H.set(q.index,q),q=q.sibling;return H}function g(q,H){return q=Ys(q,H),q.index=0,q.sibling=null,q}function y(q,H,W){return q.index=W,i?(W=q.alternate,W!==null?(W=W.index,W<H?(q.flags|=33554434,H):W):(q.flags|=33554434,H)):(q.flags|=1048576,H)}function b(q){return i&&q.alternate===null&&(q.flags|=33554434),q}function I(q,H,W,le){return H===null||H.tag!==6?(H=Tf(W,q.mode,le),H.return=q,H):(H=g(H,W),H.return=q,H)}function F(q,H,W,le){var ve=W.type;return ve===h?ne(q,H,W.props.children,le,W.key):H!==null&&(H.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===w&&Rm(ve)===H.type)?(H=g(H,W.props),Ua(H,W),H.return=q,H):(H=Tl(W.type,W.key,W.props,null,q.mode,le),Ua(H,W),H.return=q,H)}function V(q,H,W,le){return H===null||H.tag!==4||H.stateNode.containerInfo!==W.containerInfo||H.stateNode.implementation!==W.implementation?(H=bf(W,q.mode,le),H.return=q,H):(H=g(H,W.children||[]),H.return=q,H)}function ne(q,H,W,le,ve){return H===null||H.tag!==7?(H=kn(W,q.mode,le,ve),H.return=q,H):(H=g(H,W),H.return=q,H)}function he(q,H,W){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Tf(""+H,q.mode,W),H.return=q,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case u:return W=Tl(H.type,H.key,H.props,null,q.mode,W),Ua(W,H),W.return=q,W;case c:return H=bf(H,q.mode,W),H.return=q,H;case w:var le=H._init;return H=le(H._payload),he(q,H,W)}if(ae(H)||U(H))return H=kn(H,q.mode,W,null),H.return=q,H;if(typeof H.then=="function")return he(q,sl(H),W);if(H.$$typeof===x)return he(q,xl(q,H),W);nl(q,H)}return null}function ee(q,H,W,le){var ve=H!==null?H.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return ve!==null?null:I(q,H,""+W,le);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case u:return W.key===ve?F(q,H,W,le):null;case c:return W.key===ve?V(q,H,W,le):null;case w:return ve=W._init,W=ve(W._payload),ee(q,H,W,le)}if(ae(W)||U(W))return ve!==null?null:ne(q,H,W,le,null);if(typeof W.then=="function")return ee(q,H,sl(W),le);if(W.$$typeof===x)return ee(q,H,xl(q,W),le);nl(q,W)}return null}function se(q,H,W,le,ve){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return q=q.get(W)||null,I(H,q,""+le,ve);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case u:return q=q.get(le.key===null?W:le.key)||null,F(H,q,le,ve);case c:return q=q.get(le.key===null?W:le.key)||null,V(H,q,le,ve);case w:var Me=le._init;return le=Me(le._payload),se(q,H,W,le,ve)}if(ae(le)||U(le))return q=q.get(W)||null,ne(H,q,le,ve,null);if(typeof le.then=="function")return se(q,H,W,sl(le),ve);if(le.$$typeof===x)return se(q,H,W,xl(H,le),ve);nl(H,le)}return null}function xe(q,H,W,le){for(var ve=null,Me=null,Se=H,Re=H=0,bt=null;Se!==null&&Re<W.length;Re++){Se.index>Re?(bt=Se,Se=null):bt=Se.sibling;var He=ee(q,Se,W[Re],le);if(He===null){Se===null&&(Se=bt);break}i&&Se&&He.alternate===null&&n(q,Se),H=y(He,H,Re),Me===null?ve=He:Me.sibling=He,Me=He,Se=bt}if(Re===W.length)return l(q,Se),Ge&&bn(q,Re),ve;if(Se===null){for(;Re<W.length;Re++)Se=he(q,W[Re],le),Se!==null&&(H=y(Se,H,Re),Me===null?ve=Se:Me.sibling=Se,Me=Se);return Ge&&bn(q,Re),ve}for(Se=f(Se);Re<W.length;Re++)bt=se(Se,q,Re,W[Re],le),bt!==null&&(i&&bt.alternate!==null&&Se.delete(bt.key===null?Re:bt.key),H=y(bt,H,Re),Me===null?ve=bt:Me.sibling=bt,Me=bt);return i&&Se.forEach(function(en){return n(q,en)}),Ge&&bn(q,Re),ve}function De(q,H,W,le){if(W==null)throw Error(s(151));for(var ve=null,Me=null,Se=H,Re=H=0,bt=null,He=W.next();Se!==null&&!He.done;Re++,He=W.next()){Se.index>Re?(bt=Se,Se=null):bt=Se.sibling;var en=ee(q,Se,He.value,le);if(en===null){Se===null&&(Se=bt);break}i&&Se&&en.alternate===null&&n(q,Se),H=y(en,H,Re),Me===null?ve=en:Me.sibling=en,Me=en,Se=bt}if(He.done)return l(q,Se),Ge&&bn(q,Re),ve;if(Se===null){for(;!He.done;Re++,He=W.next())He=he(q,He.value,le),He!==null&&(H=y(He,H,Re),Me===null?ve=He:Me.sibling=He,Me=He);return Ge&&bn(q,Re),ve}for(Se=f(Se);!He.done;Re++,He=W.next())He=se(Se,q,Re,He.value,le),He!==null&&(i&&He.alternate!==null&&Se.delete(He.key===null?Re:He.key),H=y(He,H,Re),Me===null?ve=He:Me.sibling=He,Me=He);return i&&Se.forEach(function(_b){return n(q,_b)}),Ge&&bn(q,Re),ve}function ot(q,H,W,le){if(typeof W=="object"&&W!==null&&W.type===h&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case u:e:{for(var ve=W.key;H!==null;){if(H.key===ve){if(ve=W.type,ve===h){if(H.tag===7){l(q,H.sibling),le=g(H,W.props.children),le.return=q,q=le;break e}}else if(H.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===w&&Rm(ve)===H.type){l(q,H.sibling),le=g(H,W.props),Ua(le,W),le.return=q,q=le;break e}l(q,H);break}else n(q,H);H=H.sibling}W.type===h?(le=kn(W.props.children,q.mode,le,W.key),le.return=q,q=le):(le=Tl(W.type,W.key,W.props,null,q.mode,le),Ua(le,W),le.return=q,q=le)}return b(q);case c:e:{for(ve=W.key;H!==null;){if(H.key===ve)if(H.tag===4&&H.stateNode.containerInfo===W.containerInfo&&H.stateNode.implementation===W.implementation){l(q,H.sibling),le=g(H,W.children||[]),le.return=q,q=le;break e}else{l(q,H);break}else n(q,H);H=H.sibling}le=bf(W,q.mode,le),le.return=q,q=le}return b(q);case w:return ve=W._init,W=ve(W._payload),ot(q,H,W,le)}if(ae(W))return xe(q,H,W,le);if(U(W)){if(ve=U(W),typeof ve!="function")throw Error(s(150));return W=ve.call(W),De(q,H,W,le)}if(typeof W.then=="function")return ot(q,H,sl(W),le);if(W.$$typeof===x)return ot(q,H,xl(q,W),le);nl(q,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,H!==null&&H.tag===6?(l(q,H.sibling),le=g(H,W),le.return=q,q=le):(l(q,H),le=Tf(W,q.mode,le),le.return=q,q=le),b(q)):l(q,H)}return function(q,H,W,le){try{Fa=0;var ve=ot(q,H,W,le);return Sr=null,ve}catch(Se){if(Se===Na)throw Se;var Me=mi(29,Se,null,q.mode);return Me.lanes=le,Me.return=q,Me}finally{}}}var Rn=Lm(!0),_m=Lm(!1),Er=pe(null),rl=pe(0);function Dm(i,n){i=ys,Ne(rl,i),Ne(Er,n),ys=i|n.baseLanes}function Dc(){Ne(rl,ys),Ne(Er,Er.current)}function Cc(){ys=rl.current,Le(Er),Le(rl)}var fi=pe(null),Bi=null;function Ps(i){var n=i.alternate;Ne(pt,pt.current&1),Ne(fi,i),Bi===null&&(n===null||Er.current!==null||n.memoizedState!==null)&&(Bi=i)}function Cm(i){if(i.tag===22){if(Ne(pt,pt.current),Ne(fi,i),Bi===null){var n=i.alternate;n!==null&&n.memoizedState!==null&&(Bi=i)}}else Fs()}function Fs(){Ne(pt,pt.current),Ne(fi,fi.current)}function os(i){Le(fi),Bi===i&&(Bi=null),Le(pt)}var pt=pe(0);function al(i){for(var n=i;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var mT=typeof AbortController<"u"?AbortController:function(){var i=[],n=this.signal={aborted:!1,addEventListener:function(l,f){i.push(f)}};this.abort=function(){n.aborted=!0,i.forEach(function(l){return l()})}},gT=r.unstable_scheduleCallback,pT=r.unstable_NormalPriority,yt={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wc(){return{controller:new mT,data:new Map,refCount:0}}function Ba(i){i.refCount--,i.refCount===0&&gT(pT,function(){i.controller.abort()})}var ja=null,Oc=0,Tr=0,br=null;function yT(i,n){if(ja===null){var l=ja=[];Oc=0,Tr=Uf(),br={status:"pending",value:void 0,then:function(f){l.push(f)}}}return Oc++,n.then(wm,wm),n}function wm(){if(--Oc===0&&ja!==null){br!==null&&(br.status="fulfilled");var i=ja;ja=null,Tr=0,br=null;for(var n=0;n<i.length;n++)(0,i[n])()}}function vT(i,n){var l=[],f={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return i.then(function(){f.status="fulfilled",f.value=n;for(var g=0;g<l.length;g++)(0,l[g])(n)},function(g){for(f.status="rejected",f.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),f}var Om=D.S;D.S=function(i,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&yT(i,n),Om!==null&&Om(i,n)};var Ln=pe(null);function Ic(){var i=Ln.current;return i!==null?i:Qe.pooledCache}function ol(i,n){n===null?Ne(Ln,Ln.current):Ne(Ln,n.pool)}function Im(){var i=Ic();return i===null?null:{parent:yt._currentValue,pool:i}}var Us=0,Ie=null,Ye=null,ft=null,ll=!1,Ar=!1,_n=!1,ul=0,Ga=0,Rr=null,xT=0;function ct(){throw Error(s(321))}function Mc(i,n){if(n===null)return!1;for(var l=0;l<n.length&&l<i.length;l++)if(!Zt(i[l],n[l]))return!1;return!0}function kc(i,n,l,f,g,y){return Us=y,Ie=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,D.H=i===null||i.memoizedState===null?Dn:Bs,_n=!1,y=l(f,g),_n=!1,Ar&&(y=km(n,l,f,g)),Mm(i),y}function Mm(i){D.H=ji;var n=Ye!==null&&Ye.next!==null;if(Us=0,ft=Ye=Ie=null,ll=!1,Ga=0,Rr=null,n)throw Error(s(300));i===null||Et||(i=i.dependencies,i!==null&&vl(i)&&(Et=!0))}function km(i,n,l,f){Ie=i;var g=0;do{if(Ar&&(Rr=null),Ga=0,Ar=!1,25<=g)throw Error(s(301));if(g+=1,ft=Ye=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}D.H=Cn,y=n(l,f)}while(Ar);return y}function ST(){var i=D.H,n=i.useState()[0];return n=typeof n.then=="function"?Ha(n):n,i=i.useState()[0],(Ye!==null?Ye.memoizedState:null)!==i&&(Ie.flags|=1024),n}function Nc(){var i=ul!==0;return ul=0,i}function Pc(i,n,l){n.updateQueue=i.updateQueue,n.flags&=-2053,i.lanes&=~l}function Fc(i){if(ll){for(i=i.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}ll=!1}Us=0,ft=Ye=Ie=null,Ar=!1,Ga=ul=0,Rr=null}function Vt(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?Ie.memoizedState=ft=i:ft=ft.next=i,ft}function ht(){if(Ye===null){var i=Ie.alternate;i=i!==null?i.memoizedState:null}else i=Ye.next;var n=ft===null?Ie.memoizedState:ft.next;if(n!==null)ft=n,Ye=i;else{if(i===null)throw Ie.alternate===null?Error(s(467)):Error(s(310));Ye=i,i={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},ft===null?Ie.memoizedState=ft=i:ft=ft.next=i}return ft}var cl;cl=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Ha(i){var n=Ga;return Ga+=1,Rr===null&&(Rr=[]),i=bm(Rr,i,n),n=Ie,(ft===null?n.memoizedState:ft.next)===null&&(n=n.alternate,D.H=n===null||n.memoizedState===null?Dn:Bs),i}function fl(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ha(i);if(i.$$typeof===x)return Mt(i)}throw Error(s(438,String(i)))}function Uc(i){var n=null,l=Ie.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var f=Ie.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(n={data:f.data.map(function(g){return g.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=cl(),Ie.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(i),f=0;f<i;f++)l[f]=k;return n.index++,l}function ls(i,n){return typeof n=="function"?n(i):n}function hl(i){var n=ht();return Bc(n,Ye,i)}function Bc(i,n,l){var f=i.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=l;var g=i.baseQueue,y=f.pending;if(y!==null){if(g!==null){var b=g.next;g.next=y.next,y.next=b}n.baseQueue=g=y,f.pending=null}if(y=i.baseState,g===null)i.memoizedState=y;else{n=g.next;var I=b=null,F=null,V=n,ne=!1;do{var he=V.lane&-536870913;if(he!==V.lane?(Ue&he)===he:(Us&he)===he){var ee=V.revertLane;if(ee===0)F!==null&&(F=F.next={lane:0,revertLane:0,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null}),he===Tr&&(ne=!0);else if((Us&ee)===ee){V=V.next,ee===Tr&&(ne=!0);continue}else he={lane:0,revertLane:V.revertLane,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},F===null?(I=F=he,b=y):F=F.next=he,Ie.lanes|=ee,qs|=ee;he=V.action,_n&&l(y,he),y=V.hasEagerState?V.eagerState:l(y,he)}else ee={lane:he,revertLane:V.revertLane,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},F===null?(I=F=ee,b=y):F=F.next=ee,Ie.lanes|=he,qs|=he;V=V.next}while(V!==null&&V!==n);if(F===null?b=y:F.next=I,!Zt(y,i.memoizedState)&&(Et=!0,ne&&(l=br,l!==null)))throw l;i.memoizedState=y,i.baseState=b,i.baseQueue=F,f.lastRenderedState=y}return g===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function jc(i){var n=ht(),l=n.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=i;var f=l.dispatch,g=l.pending,y=n.memoizedState;if(g!==null){l.pending=null;var b=g=g.next;do y=i(y,b.action),b=b.next;while(b!==g);Zt(y,n.memoizedState)||(Et=!0),n.memoizedState=y,n.baseQueue===null&&(n.baseState=y),l.lastRenderedState=y}return[y,f]}function Nm(i,n,l){var f=Ie,g=ht(),y=Ge;if(y){if(l===void 0)throw Error(s(407));l=l()}else l=n();var b=!Zt((Ye||g).memoizedState,l);if(b&&(g.memoizedState=l,Et=!0),g=g.queue,$c(Um.bind(null,f,g,i),[i]),g.getSnapshot!==n||b||ft!==null&&ft.memoizedState.tag&1){if(f.flags|=2048,Lr(9,Fm.bind(null,f,g,l,n),{destroy:void 0},null),Qe===null)throw Error(s(349));y||(Us&60)!==0||Pm(f,n,l)}return l}function Pm(i,n,l){i.flags|=16384,i={getSnapshot:n,value:l},n=Ie.updateQueue,n===null?(n=cl(),Ie.updateQueue=n,n.stores=[i]):(l=n.stores,l===null?n.stores=[i]:l.push(i))}function Fm(i,n,l,f){n.value=l,n.getSnapshot=f,Bm(n)&&jm(i)}function Um(i,n,l){return l(function(){Bm(n)&&jm(i)})}function Bm(i){var n=i.getSnapshot;i=i.value;try{var l=n();return!Zt(i,l)}catch{return!0}}function jm(i){var n=Ns(i,2);n!==null&&Ut(n,i,2)}function Gc(i){var n=Vt();if(typeof i=="function"){var l=i;if(i=l(),_n){Is(!0);try{l()}finally{Is(!1)}}}return n.memoizedState=n.baseState=i,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:i},n}function Gm(i,n,l,f){return i.baseState=l,Bc(i,Ye,typeof f=="function"?f:ls)}function ET(i,n,l,f,g){if(gl(i))throw Error(s(485));if(i=n.action,i!==null){var y={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){y.listeners.push(b)}};D.T!==null?l(!0):y.isTransition=!1,f(y),l=n.pending,l===null?(y.next=n.pending=y,Hm(n,y)):(y.next=l.next,n.pending=l.next=y)}}function Hm(i,n){var l=n.action,f=n.payload,g=i.state;if(n.isTransition){var y=D.T,b={};D.T=b;try{var I=l(g,f),F=D.S;F!==null&&F(b,I),$m(i,n,I)}catch(V){Hc(i,n,V)}finally{D.T=y}}else try{y=l(g,f),$m(i,n,y)}catch(V){Hc(i,n,V)}}function $m(i,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){Vm(i,n,f)},function(f){return Hc(i,n,f)}):Vm(i,n,l)}function Vm(i,n,l){n.status="fulfilled",n.value=l,Km(n),i.state=l,n=i.pending,n!==null&&(l=n.next,l===n?i.pending=null:(l=l.next,n.next=l,Hm(i,l)))}function Hc(i,n,l){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do n.status="rejected",n.reason=l,Km(n),n=n.next;while(n!==f)}i.action=null}function Km(i){i=i.listeners;for(var n=0;n<i.length;n++)(0,i[n])()}function zm(i,n){return n}function Ym(i,n){if(Ge){var l=Qe.formState;if(l!==null){e:{var f=Ie;if(Ge){if(Dt){t:{for(var g=Dt,y=Ui;g.nodeType!==8;){if(!y){g=null;break t}if(g=Di(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){Dt=Di(g.nextSibling),f=g.data==="F!";break e}}An(f)}f=!1}f&&(n=l[0])}}return l=Vt(),l.memoizedState=l.baseState=n,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zm,lastRenderedState:n},l.queue=f,l=fg.bind(null,Ie,f),f.dispatch=l,f=Gc(!1),y=qc.bind(null,Ie,!1,f.queue),f=Vt(),g={state:n,dispatch:null,action:i,pending:null},f.queue=g,l=ET.bind(null,Ie,g,y,l),g.dispatch=l,f.memoizedState=i,[n,l,!1]}function qm(i){var n=ht();return Xm(n,Ye,i)}function Xm(i,n,l){n=Bc(i,n,zm)[0],i=hl(ls)[0],n=typeof n=="object"&&n!==null&&typeof n.then=="function"?Ha(n):n;var f=ht(),g=f.queue,y=g.dispatch;return l!==f.memoizedState&&(Ie.flags|=2048,Lr(9,TT.bind(null,g,l),{destroy:void 0},null)),[n,y,i]}function TT(i,n){i.action=n}function Qm(i){var n=ht(),l=Ye;if(l!==null)return Xm(n,l,i);ht(),n=n.memoizedState,l=ht();var f=l.queue.dispatch;return l.memoizedState=i,[n,f,!1]}function Lr(i,n,l,f){return i={tag:i,create:n,inst:l,deps:f,next:null},n=Ie.updateQueue,n===null&&(n=cl(),Ie.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=i.next=i:(f=l.next,l.next=i,i.next=f,n.lastEffect=i),i}function Wm(){return ht().memoizedState}function dl(i,n,l,f){var g=Vt();Ie.flags|=i,g.memoizedState=Lr(1|n,l,{destroy:void 0},f===void 0?null:f)}function ml(i,n,l,f){var g=ht();f=f===void 0?null:f;var y=g.memoizedState.inst;Ye!==null&&f!==null&&Mc(f,Ye.memoizedState.deps)?g.memoizedState=Lr(n,l,y,f):(Ie.flags|=i,g.memoizedState=Lr(1|n,l,y,f))}function Zm(i,n){dl(8390656,8,i,n)}function $c(i,n){ml(2048,8,i,n)}function Jm(i,n){return ml(4,2,i,n)}function eg(i,n){return ml(4,4,i,n)}function tg(i,n){if(typeof n=="function"){i=i();var l=n(i);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return i=i(),n.current=i,function(){n.current=null}}function ig(i,n,l){l=l!=null?l.concat([i]):null,ml(4,4,tg.bind(null,n,i),l)}function Vc(){}function sg(i,n){var l=ht();n=n===void 0?null:n;var f=l.memoizedState;return n!==null&&Mc(n,f[1])?f[0]:(l.memoizedState=[i,n],i)}function ng(i,n){var l=ht();n=n===void 0?null:n;var f=l.memoizedState;if(n!==null&&Mc(n,f[1]))return f[0];if(f=i(),_n){Is(!0);try{i()}finally{Is(!1)}}return l.memoizedState=[f,n],f}function Kc(i,n,l){return l===void 0||(Us&1073741824)!==0?i.memoizedState=n:(i.memoizedState=l,i=ap(),Ie.lanes|=i,qs|=i,l)}function rg(i,n,l,f){return Zt(l,n)?l:Er.current!==null?(i=Kc(i,l,f),Zt(i,n)||(Et=!0),i):(Us&42)===0?(Et=!0,i.memoizedState=l):(i=ap(),Ie.lanes|=i,qs|=i,n)}function ag(i,n,l,f,g){var y=re.p;re.p=y!==0&&8>y?y:8;var b=D.T,I={};D.T=I,qc(i,!1,n,l);try{var F=g(),V=D.S;if(V!==null&&V(I,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var ne=vT(F,f);$a(i,n,ne,ii(i))}else $a(i,n,f,ii(i))}catch(he){$a(i,n,{then:function(){},status:"rejected",reason:he},ii())}finally{re.p=y,D.T=b}}function bT(){}function zc(i,n,l,f){if(i.tag!==5)throw Error(s(476));var g=og(i).queue;ag(i,g,n,me,l===null?bT:function(){return lg(i),l(f)})}function og(i){var n=i.memoizedState;if(n!==null)return n;n={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:me},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:l},next:null},i.memoizedState=n,i=i.alternate,i!==null&&(i.memoizedState=n),n}function lg(i){var n=og(i).next.queue;$a(i,n,{},ii())}function Yc(){return Mt(uo)}function ug(){return ht().memoizedState}function cg(){return ht().memoizedState}function AT(i){for(var n=i.return;n!==null;){switch(n.tag){case 24:case 3:var l=ii();i=Hs(l);var f=$s(n,i,l);f!==null&&(Ut(f,n,l),za(f,n,l)),n={cache:wc()},i.payload=n;return}n=n.return}}function RT(i,n,l){var f=ii();l={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},gl(i)?hg(n,l):(l=bc(i,n,l,f),l!==null&&(Ut(l,i,f),dg(l,n,f)))}function fg(i,n,l){var f=ii();$a(i,n,l,f)}function $a(i,n,l,f){var g={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(gl(i))hg(n,g);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=n.lastRenderedReducer,y!==null))try{var b=n.lastRenderedState,I=y(b,l);if(g.hasEagerState=!0,g.eagerState=I,Zt(I,b))return Zo(i,n,g,0),Qe===null&&Wo(),!1}catch{}finally{}if(l=bc(i,n,g,f),l!==null)return Ut(l,i,f),dg(l,n,f),!0}return!1}function qc(i,n,l,f){if(f={lane:2,revertLane:Uf(),action:f,hasEagerState:!1,eagerState:null,next:null},gl(i)){if(n)throw Error(s(479))}else n=bc(i,l,f,2),n!==null&&Ut(n,i,2)}function gl(i){var n=i.alternate;return i===Ie||n!==null&&n===Ie}function hg(i,n){Ar=ll=!0;var l=i.pending;l===null?n.next=n:(n.next=l.next,l.next=n),i.pending=n}function dg(i,n,l){if((l&4194176)!==0){var f=n.lanes;f&=i.pendingLanes,l|=f,n.lanes=l,A0(i,l)}}var ji={readContext:Mt,use:fl,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useLayoutEffect:ct,useInsertionEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useSyncExternalStore:ct,useId:ct};ji.useCacheRefresh=ct,ji.useMemoCache=ct,ji.useHostTransitionStatus=ct,ji.useFormState=ct,ji.useActionState=ct,ji.useOptimistic=ct;var Dn={readContext:Mt,use:fl,useCallback:function(i,n){return Vt().memoizedState=[i,n===void 0?null:n],i},useContext:Mt,useEffect:Zm,useImperativeHandle:function(i,n,l){l=l!=null?l.concat([i]):null,dl(4194308,4,tg.bind(null,n,i),l)},useLayoutEffect:function(i,n){return dl(4194308,4,i,n)},useInsertionEffect:function(i,n){dl(4,2,i,n)},useMemo:function(i,n){var l=Vt();n=n===void 0?null:n;var f=i();if(_n){Is(!0);try{i()}finally{Is(!1)}}return l.memoizedState=[f,n],f},useReducer:function(i,n,l){var f=Vt();if(l!==void 0){var g=l(n);if(_n){Is(!0);try{l(n)}finally{Is(!1)}}}else g=n;return f.memoizedState=f.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},f.queue=i,i=i.dispatch=RT.bind(null,Ie,i),[f.memoizedState,i]},useRef:function(i){var n=Vt();return i={current:i},n.memoizedState=i},useState:function(i){i=Gc(i);var n=i.queue,l=fg.bind(null,Ie,n);return n.dispatch=l,[i.memoizedState,l]},useDebugValue:Vc,useDeferredValue:function(i,n){var l=Vt();return Kc(l,i,n)},useTransition:function(){var i=Gc(!1);return i=ag.bind(null,Ie,i.queue,!0,!1),Vt().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,n,l){var f=Ie,g=Vt();if(Ge){if(l===void 0)throw Error(s(407));l=l()}else{if(l=n(),Qe===null)throw Error(s(349));(Ue&60)!==0||Pm(f,n,l)}g.memoizedState=l;var y={value:l,getSnapshot:n};return g.queue=y,Zm(Um.bind(null,f,y,i),[i]),f.flags|=2048,Lr(9,Fm.bind(null,f,y,l,n),{destroy:void 0},null),l},useId:function(){var i=Vt(),n=Qe.identifierPrefix;if(Ge){var l=as,f=rs;l=(f&~(1<<32-Wt(f)-1)).toString(32)+l,n=":"+n+"R"+l,l=ul++,0<l&&(n+="H"+l.toString(32)),n+=":"}else l=xT++,n=":"+n+"r"+l.toString(32)+":";return i.memoizedState=n},useCacheRefresh:function(){return Vt().memoizedState=AT.bind(null,Ie)}};Dn.useMemoCache=Uc,Dn.useHostTransitionStatus=Yc,Dn.useFormState=Ym,Dn.useActionState=Ym,Dn.useOptimistic=function(i){var n=Vt();n.memoizedState=n.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=qc.bind(null,Ie,!0,l),l.dispatch=n,[i,n]};var Bs={readContext:Mt,use:fl,useCallback:sg,useContext:Mt,useEffect:$c,useImperativeHandle:ig,useInsertionEffect:Jm,useLayoutEffect:eg,useMemo:ng,useReducer:hl,useRef:Wm,useState:function(){return hl(ls)},useDebugValue:Vc,useDeferredValue:function(i,n){var l=ht();return rg(l,Ye.memoizedState,i,n)},useTransition:function(){var i=hl(ls)[0],n=ht().memoizedState;return[typeof i=="boolean"?i:Ha(i),n]},useSyncExternalStore:Nm,useId:ug};Bs.useCacheRefresh=cg,Bs.useMemoCache=Uc,Bs.useHostTransitionStatus=Yc,Bs.useFormState=qm,Bs.useActionState=qm,Bs.useOptimistic=function(i,n){var l=ht();return Gm(l,Ye,i,n)};var Cn={readContext:Mt,use:fl,useCallback:sg,useContext:Mt,useEffect:$c,useImperativeHandle:ig,useInsertionEffect:Jm,useLayoutEffect:eg,useMemo:ng,useReducer:jc,useRef:Wm,useState:function(){return jc(ls)},useDebugValue:Vc,useDeferredValue:function(i,n){var l=ht();return Ye===null?Kc(l,i,n):rg(l,Ye.memoizedState,i,n)},useTransition:function(){var i=jc(ls)[0],n=ht().memoizedState;return[typeof i=="boolean"?i:Ha(i),n]},useSyncExternalStore:Nm,useId:ug};Cn.useCacheRefresh=cg,Cn.useMemoCache=Uc,Cn.useHostTransitionStatus=Yc,Cn.useFormState=Qm,Cn.useActionState=Qm,Cn.useOptimistic=function(i,n){var l=ht();return Ye!==null?Gm(l,Ye,i,n):(l.baseState=i,[i,l.queue.dispatch])};function Xc(i,n,l,f){n=i.memoizedState,l=l(f,n),l=l==null?n:N({},n,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Qc={isMounted:function(i){return(i=i._reactInternals)?ue(i)===i:!1},enqueueSetState:function(i,n,l){i=i._reactInternals;var f=ii(),g=Hs(f);g.payload=n,l!=null&&(g.callback=l),n=$s(i,g,f),n!==null&&(Ut(n,i,f),za(n,i,f))},enqueueReplaceState:function(i,n,l){i=i._reactInternals;var f=ii(),g=Hs(f);g.tag=1,g.payload=n,l!=null&&(g.callback=l),n=$s(i,g,f),n!==null&&(Ut(n,i,f),za(n,i,f))},enqueueForceUpdate:function(i,n){i=i._reactInternals;var l=ii(),f=Hs(l);f.tag=2,n!=null&&(f.callback=n),n=$s(i,f,l),n!==null&&(Ut(n,i,l),za(n,i,l))}};function mg(i,n,l,f,g,y,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,y,b):n.prototype&&n.prototype.isPureReactComponent?!wa(l,f)||!wa(g,y):!0}function gg(i,n,l,f){i=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,f),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,f),n.state!==i&&Qc.enqueueReplaceState(n,n.state,null)}function wn(i,n){var l=n;if("ref"in n){l={};for(var f in n)f!=="ref"&&(l[f]=n[f])}if(i=i.defaultProps){l===n&&(l=N({},l));for(var g in i)l[g]===void 0&&(l[g]=i[g])}return l}var pl=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function pg(i){pl(i)}function yg(i){console.error(i)}function vg(i){pl(i)}function yl(i,n){try{var l=i.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(f){setTimeout(function(){throw f})}}function xg(i,n,l){try{var f=i.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Wc(i,n,l){return l=Hs(l),l.tag=3,l.payload={element:null},l.callback=function(){yl(i,n)},l}function Sg(i){return i=Hs(i),i.tag=3,i}function Eg(i,n,l,f){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var y=f.value;i.payload=function(){return g(y)},i.callback=function(){xg(n,l,f)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(i.callback=function(){xg(n,l,f),typeof g!="function"&&(Xs===null?Xs=new Set([this]):Xs.add(this));var I=f.stack;this.componentDidCatch(f.value,{componentStack:I!==null?I:""})})}function LT(i,n,l,f,g){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(n=l.alternate,n!==null&&Ka(n,l,g,!0),l=fi.current,l!==null){switch(l.tag){case 13:return Bi===null?Mf():l.alternate===null&&at===0&&(at=3),l.flags&=-257,l.flags|=65536,l.lanes=g,f===_c?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([f]):n.add(f),Nf(i,f,g)),!1;case 22:return l.flags|=65536,f===_c?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([f]):l.add(f)),Nf(i,f,g)),!1}throw Error(s(435,l.tag))}return Nf(i,f,g),Mf(),!1}if(Ge)return n=fi.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=g,f!==Lc&&(i=Error(s(422),{cause:f}),ka(li(i,l)))):(f!==Lc&&(n=Error(s(423),{cause:f}),ka(li(n,l))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,f=li(f,l),g=Wc(i.stateNode,f,g),df(i,g),at!==4&&(at=2)),!1;var y=Error(s(520),{cause:f});if(y=li(y,l),eo===null?eo=[y]:eo.push(y),at!==4&&(at=2),n===null)return!0;f=li(f,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,i=g&-g,l.lanes|=i,i=Wc(l.stateNode,f,i),df(l,i),!1;case 1:if(n=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Xs===null||!Xs.has(y))))return l.flags|=65536,g&=-g,l.lanes|=g,g=Sg(g),Eg(g,i,l,f),df(l,g),!1}l=l.return}while(l!==null);return!1}var Tg=Error(s(461)),Et=!1;function Ct(i,n,l,f){n.child=i===null?_m(n,null,l,f):Rn(n,i.child,l,f)}function bg(i,n,l,f,g){l=l.render;var y=n.ref;if("ref"in f){var b={};for(var I in f)I!=="ref"&&(b[I]=f[I])}else b=f;return In(n),f=kc(i,n,l,b,y,g),I=Nc(),i!==null&&!Et?(Pc(i,n,g),us(i,n,g)):(Ge&&I&&Ac(n),n.flags|=1,Ct(i,n,f,g),n.child)}function Ag(i,n,l,f,g){if(i===null){var y=l.type;return typeof y=="function"&&!Ef(y)&&y.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=y,Rg(i,n,y,f,g)):(i=Tl(l.type,null,f,n,n.mode,g),i.ref=n.ref,i.return=n,n.child=i)}if(y=i.child,!of(i,g)){var b=y.memoizedProps;if(l=l.compare,l=l!==null?l:wa,l(b,f)&&i.ref===n.ref)return us(i,n,g)}return n.flags|=1,i=Ys(y,f),i.ref=n.ref,i.return=n,n.child=i}function Rg(i,n,l,f,g){if(i!==null){var y=i.memoizedProps;if(wa(y,f)&&i.ref===n.ref)if(Et=!1,n.pendingProps=f=y,of(i,g))(i.flags&131072)!==0&&(Et=!0);else return n.lanes=i.lanes,us(i,n,g)}return Zc(i,n,l,f,g)}function Lg(i,n,l){var f=n.pendingProps,g=f.children,y=(n.stateNode._pendingVisibility&2)!==0,b=i!==null?i.memoizedState:null;if(Va(i,n),f.mode==="hidden"||y){if((n.flags&128)!==0){if(f=b!==null?b.baseLanes|l:l,i!==null){for(g=n.child=i.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;n.childLanes=y&~f}else n.childLanes=0,n.child=null;return _g(i,n,f,l)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},i!==null&&ol(n,b!==null?b.cachePool:null),b!==null?Dm(n,b):Dc(),Cm(n);else return n.lanes=n.childLanes=536870912,_g(i,n,b!==null?b.baseLanes|l:l,l)}else b!==null?(ol(n,b.cachePool),Dm(n,b),Fs(),n.memoizedState=null):(i!==null&&ol(n,null),Dc(),Fs());return Ct(i,n,g,l),n.child}function _g(i,n,l,f){var g=Ic();return g=g===null?null:{parent:yt._currentValue,pool:g},n.memoizedState={baseLanes:l,cachePool:g},i!==null&&ol(n,null),Dc(),Cm(n),i!==null&&Ka(i,n,f,!0),null}function Va(i,n){var l=n.ref;if(l===null)i!==null&&i.ref!==null&&(n.flags|=2097664);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(i===null||i.ref!==l)&&(n.flags|=2097664)}}function Zc(i,n,l,f,g){return In(n),l=kc(i,n,l,f,void 0,g),f=Nc(),i!==null&&!Et?(Pc(i,n,g),us(i,n,g)):(Ge&&f&&Ac(n),n.flags|=1,Ct(i,n,l,g),n.child)}function Dg(i,n,l,f,g,y){return In(n),n.updateQueue=null,l=km(n,f,l,g),Mm(i),f=Nc(),i!==null&&!Et?(Pc(i,n,y),us(i,n,y)):(Ge&&f&&Ac(n),n.flags|=1,Ct(i,n,l,y),n.child)}function Cg(i,n,l,f,g){if(In(n),n.stateNode===null){var y=yr,b=l.contextType;typeof b=="object"&&b!==null&&(y=Mt(b)),y=new l(f,y),n.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Qc,n.stateNode=y,y._reactInternals=n,y=n.stateNode,y.props=f,y.state=n.memoizedState,y.refs={},ff(n),b=l.contextType,y.context=typeof b=="object"&&b!==null?Mt(b):yr,y.state=n.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(Xc(n,l,b,f),y.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(b=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),b!==y.state&&Qc.enqueueReplaceState(y,y.state,null),qa(n,f,y,g),Ya(),y.state=n.memoizedState),typeof y.componentDidMount=="function"&&(n.flags|=4194308),f=!0}else if(i===null){y=n.stateNode;var I=n.memoizedProps,F=wn(l,I);y.props=F;var V=y.context,ne=l.contextType;b=yr,typeof ne=="object"&&ne!==null&&(b=Mt(ne));var he=l.getDerivedStateFromProps;ne=typeof he=="function"||typeof y.getSnapshotBeforeUpdate=="function",I=n.pendingProps!==I,ne||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(I||V!==b)&&gg(n,y,f,b),Gs=!1;var ee=n.memoizedState;y.state=ee,qa(n,f,y,g),Ya(),V=n.memoizedState,I||ee!==V||Gs?(typeof he=="function"&&(Xc(n,l,he,f),V=n.memoizedState),(F=Gs||mg(n,l,F,f,ee,V,b))?(ne||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(n.flags|=4194308)):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=f,n.memoizedState=V),y.props=f,y.state=V,y.context=b,f=F):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),f=!1)}else{y=n.stateNode,hf(i,n),b=n.memoizedProps,ne=wn(l,b),y.props=ne,he=n.pendingProps,ee=y.context,V=l.contextType,F=yr,typeof V=="object"&&V!==null&&(F=Mt(V)),I=l.getDerivedStateFromProps,(V=typeof I=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(b!==he||ee!==F)&&gg(n,y,f,F),Gs=!1,ee=n.memoizedState,y.state=ee,qa(n,f,y,g),Ya();var se=n.memoizedState;b!==he||ee!==se||Gs||i!==null&&i.dependencies!==null&&vl(i.dependencies)?(typeof I=="function"&&(Xc(n,l,I,f),se=n.memoizedState),(ne=Gs||mg(n,l,ne,f,ee,se,F)||i!==null&&i.dependencies!==null&&vl(i.dependencies))?(V||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,se,F),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,se,F)),typeof y.componentDidUpdate=="function"&&(n.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof y.componentDidUpdate!="function"||b===i.memoizedProps&&ee===i.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&ee===i.memoizedState||(n.flags|=1024),n.memoizedProps=f,n.memoizedState=se),y.props=f,y.state=se,y.context=F,f=ne):(typeof y.componentDidUpdate!="function"||b===i.memoizedProps&&ee===i.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&ee===i.memoizedState||(n.flags|=1024),f=!1)}return y=f,Va(i,n),f=(n.flags&128)!==0,y||f?(y=n.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:y.render(),n.flags|=1,i!==null&&f?(n.child=Rn(n,i.child,null,g),n.child=Rn(n,null,l,g)):Ct(i,n,l,g),n.memoizedState=y.state,i=n.child):i=us(i,n,g),i}function wg(i,n,l,f){return Ma(),n.flags|=256,Ct(i,n,l,f),n.child}var Jc={dehydrated:null,treeContext:null,retryLane:0};function ef(i){return{baseLanes:i,cachePool:Im()}}function tf(i,n,l){return i=i!==null?i.childLanes&~l:0,n&&(i|=gi),i}function Og(i,n,l){var f=n.pendingProps,g=!1,y=(n.flags&128)!==0,b;if((b=y)||(b=i!==null&&i.memoizedState===null?!1:(pt.current&2)!==0),b&&(g=!0,n.flags&=-129),b=(n.flags&32)!==0,n.flags&=-33,i===null){if(Ge){if(g?Ps(n):Fs(),Ge){var I=Dt,F;if(F=I){e:{for(F=I,I=Ui;F.nodeType!==8;){if(!I){I=null;break e}if(F=Di(F.nextSibling),F===null){I=null;break e}}I=F}I!==null?(n.memoizedState={dehydrated:I,treeContext:Tn!==null?{id:rs,overflow:as}:null,retryLane:536870912},F=mi(18,null,null,0),F.stateNode=I,F.return=n,n.child=F,Ft=n,Dt=null,F=!0):F=!1}F||An(n)}if(I=n.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return I.data==="$!"?n.lanes=16:n.lanes=536870912,null;os(n)}return I=f.children,f=f.fallback,g?(Fs(),g=n.mode,I=nf({mode:"hidden",children:I},g),f=kn(f,g,l,null),I.return=n,f.return=n,I.sibling=f,n.child=I,g=n.child,g.memoizedState=ef(l),g.childLanes=tf(i,b,l),n.memoizedState=Jc,f):(Ps(n),sf(n,I))}if(F=i.memoizedState,F!==null&&(I=F.dehydrated,I!==null)){if(y)n.flags&256?(Ps(n),n.flags&=-257,n=rf(i,n,l)):n.memoizedState!==null?(Fs(),n.child=i.child,n.flags|=128,n=null):(Fs(),g=f.fallback,I=n.mode,f=nf({mode:"visible",children:f.children},I),g=kn(g,I,l,null),g.flags|=2,f.return=n,g.return=n,f.sibling=g,n.child=f,Rn(n,i.child,null,l),f=n.child,f.memoizedState=ef(l),f.childLanes=tf(i,b,l),n.memoizedState=Jc,n=g);else if(Ps(n),I.data==="$!"){if(b=I.nextSibling&&I.nextSibling.dataset,b)var V=b.dgst;b=V,f=Error(s(419)),f.stack="",f.digest=b,ka({value:f,source:null,stack:null}),n=rf(i,n,l)}else if(Et||Ka(i,n,l,!1),b=(l&i.childLanes)!==0,Et||b){if(b=Qe,b!==null){if(f=l&-l,(f&42)!==0)f=1;else switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=64;break;case 268435456:f=134217728;break;default:f=0}if(f=(f&(b.suspendedLanes|l))!==0?0:f,f!==0&&f!==F.retryLane)throw F.retryLane=f,Ns(i,f),Ut(b,i,f),Tg}I.data==="$?"||Mf(),n=rf(i,n,l)}else I.data==="$?"?(n.flags|=128,n.child=i.child,n=GT.bind(null,i),I._reactRetry=n,n=null):(i=F.treeContext,Dt=Di(I.nextSibling),Ft=n,Ge=!0,Li=null,Ui=!1,i!==null&&(ui[ci++]=rs,ui[ci++]=as,ui[ci++]=Tn,rs=i.id,as=i.overflow,Tn=n),n=sf(n,f.children),n.flags|=4096);return n}return g?(Fs(),g=f.fallback,I=n.mode,F=i.child,V=F.sibling,f=Ys(F,{mode:"hidden",children:f.children}),f.subtreeFlags=F.subtreeFlags&31457280,V!==null?g=Ys(V,g):(g=kn(g,I,l,null),g.flags|=2),g.return=n,f.return=n,f.sibling=g,n.child=f,f=g,g=n.child,I=i.child.memoizedState,I===null?I=ef(l):(F=I.cachePool,F!==null?(V=yt._currentValue,F=F.parent!==V?{parent:V,pool:V}:F):F=Im(),I={baseLanes:I.baseLanes|l,cachePool:F}),g.memoizedState=I,g.childLanes=tf(i,b,l),n.memoizedState=Jc,f):(Ps(n),l=i.child,i=l.sibling,l=Ys(l,{mode:"visible",children:f.children}),l.return=n,l.sibling=null,i!==null&&(b=n.deletions,b===null?(n.deletions=[i],n.flags|=16):b.push(i)),n.child=l,n.memoizedState=null,l)}function sf(i,n){return n=nf({mode:"visible",children:n},i.mode),n.return=i,i.child=n}function nf(i,n){return sp(i,n,0,null)}function rf(i,n,l){return Rn(n,i.child,null,l),i=sf(n,n.pendingProps.children),i.flags|=2,n.memoizedState=null,i}function Ig(i,n,l){i.lanes|=n;var f=i.alternate;f!==null&&(f.lanes|=n),uf(i.return,n,l)}function af(i,n,l,f,g){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:g}:(y.isBackwards=n,y.rendering=null,y.renderingStartTime=0,y.last=f,y.tail=l,y.tailMode=g)}function Mg(i,n,l){var f=n.pendingProps,g=f.revealOrder,y=f.tail;if(Ct(i,n,f.children,l),f=pt.current,(f&2)!==0)f=f&1|2,n.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=n.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ig(i,l,n);else if(i.tag===19)Ig(i,l,n);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}switch(Ne(pt,f),g){case"forwards":for(l=n.child,g=null;l!==null;)i=l.alternate,i!==null&&al(i)===null&&(g=l),l=l.sibling;l=g,l===null?(g=n.child,n.child=null):(g=l.sibling,l.sibling=null),af(n,!1,g,l,y);break;case"backwards":for(l=null,g=n.child,n.child=null;g!==null;){if(i=g.alternate,i!==null&&al(i)===null){n.child=g;break}i=g.sibling,g.sibling=l,l=g,g=i}af(n,!0,l,null,y);break;case"together":af(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function us(i,n,l){if(i!==null&&(n.dependencies=i.dependencies),qs|=n.lanes,(l&n.childLanes)===0)if(i!==null){if(Ka(i,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(i!==null&&n.child!==i.child)throw Error(s(153));if(n.child!==null){for(i=n.child,l=Ys(i,i.pendingProps),n.child=l,l.return=n;i.sibling!==null;)i=i.sibling,l=l.sibling=Ys(i,i.pendingProps),l.return=n;l.sibling=null}return n.child}function of(i,n){return(i.lanes&n)!==0?!0:(i=i.dependencies,!!(i!==null&&vl(i)))}function _T(i,n,l){switch(n.tag){case 3:gt(n,n.stateNode.containerInfo),js(n,yt,i.memoizedState.cache),Ma();break;case 27:case 5:Ai(n);break;case 4:gt(n,n.stateNode.containerInfo);break;case 10:js(n,n.type,n.memoizedProps.value);break;case 13:var f=n.memoizedState;if(f!==null)return f.dehydrated!==null?(Ps(n),n.flags|=128,null):(l&n.child.childLanes)!==0?Og(i,n,l):(Ps(n),i=us(i,n,l),i!==null?i.sibling:null);Ps(n);break;case 19:var g=(i.flags&128)!==0;if(f=(l&n.childLanes)!==0,f||(Ka(i,n,l,!1),f=(l&n.childLanes)!==0),g){if(f)return Mg(i,n,l);n.flags|=128}if(g=n.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Ne(pt,pt.current),f)break;return null;case 22:case 23:return n.lanes=0,Lg(i,n,l);case 24:js(n,yt,i.memoizedState.cache)}return us(i,n,l)}function kg(i,n,l){if(i!==null)if(i.memoizedProps!==n.pendingProps)Et=!0;else{if(!of(i,l)&&(n.flags&128)===0)return Et=!1,_T(i,n,l);Et=(i.flags&131072)!==0}else Et=!1,Ge&&(n.flags&1048576)!==0&&vm(n,tl,n.index);switch(n.lanes=0,n.tag){case 16:e:{i=n.pendingProps;var f=n.elementType,g=f._init;if(f=g(f._payload),n.type=f,typeof f=="function")Ef(f)?(i=wn(f,i),n.tag=1,n=Cg(null,n,f,i,l)):(n.tag=0,n=Zc(null,n,f,i,l));else{if(f!=null){if(g=f.$$typeof,g===S){n.tag=11,n=bg(null,n,f,i,l);break e}else if(g===A){n.tag=14,n=Ag(null,n,f,i,l);break e}}throw n=M(f)||f,Error(s(306,n,""))}}return n;case 0:return Zc(i,n,n.type,n.pendingProps,l);case 1:return f=n.type,g=wn(f,n.pendingProps),Cg(i,n,f,g,l);case 3:e:{if(gt(n,n.stateNode.containerInfo),i===null)throw Error(s(387));var y=n.pendingProps;g=n.memoizedState,f=g.element,hf(i,n),qa(n,y,null,l);var b=n.memoizedState;if(y=b.cache,js(n,yt,y),y!==g.cache&&cf(n,[yt],l,!0),Ya(),y=b.element,g.isDehydrated)if(g={element:y,isDehydrated:!1,cache:b.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=wg(i,n,y,l);break e}else if(y!==f){f=li(Error(s(424)),n),ka(f),n=wg(i,n,y,l);break e}else for(Dt=Di(n.stateNode.containerInfo.firstChild),Ft=n,Ge=!0,Li=null,Ui=!0,l=_m(n,null,y,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Ma(),y===f){n=us(i,n,l);break e}Ct(i,n,y,l)}n=n.child}return n;case 26:return Va(i,n),i===null?(l=Fp(n.type,null,n.pendingProps,null))?n.memoizedState=l:Ge||(l=n.type,i=n.pendingProps,f=kl(_t.current).createElement(l),f[It]=n,f[Ht]=i,wt(f,l,i),St(f),n.stateNode=f):n.memoizedState=Fp(n.type,i.memoizedProps,n.pendingProps,i.memoizedState),null;case 27:return Ai(n),i===null&&Ge&&(f=n.stateNode=kp(n.type,n.pendingProps,_t.current),Ft=n,Ui=!0,Dt=Di(f.firstChild)),f=n.pendingProps.children,i!==null||Ge?Ct(i,n,f,l):n.child=Rn(n,null,f,l),Va(i,n),n.child;case 5:return i===null&&Ge&&((g=f=Dt)&&(f=sb(f,n.type,n.pendingProps,Ui),f!==null?(n.stateNode=f,Ft=n,Dt=Di(f.firstChild),Ui=!1,g=!0):g=!1),g||An(n)),Ai(n),g=n.type,y=n.pendingProps,b=i!==null?i.memoizedProps:null,f=y.children,Yf(g,y)?f=null:b!==null&&Yf(g,b)&&(n.flags|=32),n.memoizedState!==null&&(g=kc(i,n,ST,null,null,l),uo._currentValue=g),Va(i,n),Ct(i,n,f,l),n.child;case 6:return i===null&&Ge&&((i=l=Dt)&&(l=nb(l,n.pendingProps,Ui),l!==null?(n.stateNode=l,Ft=n,Dt=null,i=!0):i=!1),i||An(n)),null;case 13:return Og(i,n,l);case 4:return gt(n,n.stateNode.containerInfo),f=n.pendingProps,i===null?n.child=Rn(n,null,f,l):Ct(i,n,f,l),n.child;case 11:return bg(i,n,n.type,n.pendingProps,l);case 7:return Ct(i,n,n.pendingProps,l),n.child;case 8:return Ct(i,n,n.pendingProps.children,l),n.child;case 12:return Ct(i,n,n.pendingProps.children,l),n.child;case 10:return f=n.pendingProps,js(n,n.type,f.value),Ct(i,n,f.children,l),n.child;case 9:return g=n.type._context,f=n.pendingProps.children,In(n),g=Mt(g),f=f(g),n.flags|=1,Ct(i,n,f,l),n.child;case 14:return Ag(i,n,n.type,n.pendingProps,l);case 15:return Rg(i,n,n.type,n.pendingProps,l);case 19:return Mg(i,n,l);case 22:return Lg(i,n,l);case 24:return In(n),f=Mt(yt),i===null?(g=Ic(),g===null&&(g=Qe,y=wc(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=l),g=y),n.memoizedState={parent:f,cache:g},ff(n),js(n,yt,g)):((i.lanes&l)!==0&&(hf(i,n),qa(n,null,null,l),Ya()),g=i.memoizedState,y=n.memoizedState,g.parent!==f?(g={parent:f,cache:f},n.memoizedState=g,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=g),js(n,yt,f)):(f=y.cache,js(n,yt,f),f!==g.cache&&cf(n,[yt],l,!0))),Ct(i,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}var lf=pe(null),On=null,cs=null;function js(i,n,l){Ne(lf,n._currentValue),n._currentValue=l}function fs(i){i._currentValue=lf.current,Le(lf)}function uf(i,n,l){for(;i!==null;){var f=i.alternate;if((i.childLanes&n)!==n?(i.childLanes|=n,f!==null&&(f.childLanes|=n)):f!==null&&(f.childLanes&n)!==n&&(f.childLanes|=n),i===l)break;i=i.return}}function cf(i,n,l,f){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var y=g.dependencies;if(y!==null){var b=g.child;y=y.firstContext;e:for(;y!==null;){var I=y;y=g;for(var F=0;F<n.length;F++)if(I.context===n[F]){y.lanes|=l,I=y.alternate,I!==null&&(I.lanes|=l),uf(y.return,l,i),f||(b=null);break e}y=I.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(s(341));b.lanes|=l,y=b.alternate,y!==null&&(y.lanes|=l),uf(b,l,i),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===i){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function Ka(i,n,l,f){i=null;for(var g=n,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(s(387));if(b=b.memoizedProps,b!==null){var I=g.type;Zt(g.pendingProps.value,b.value)||(i!==null?i.push(I):i=[I])}}else if(g===et.current){if(b=g.alternate,b===null)throw Error(s(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(uo):i=[uo])}g=g.return}i!==null&&cf(n,i,l,f),n.flags|=262144}function vl(i){for(i=i.firstContext;i!==null;){if(!Zt(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function In(i){On=i,cs=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Mt(i){return Ng(On,i)}function xl(i,n){return On===null&&In(i),Ng(i,n)}function Ng(i,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},cs===null){if(i===null)throw Error(s(308));cs=n,i.dependencies={lanes:0,firstContext:n},i.flags|=524288}else cs=cs.next=n;return l}var Gs=!1;function ff(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hf(i,n){i=i.updateQueue,n.updateQueue===i&&(n.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Hs(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function $s(i,n,l){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(st&2)!==0){var g=f.pending;return g===null?n.next=n:(n.next=g.next,g.next=n),f.pending=n,n=Jo(i),pm(i,null,l),n}return Zo(i,f,n,l),Jo(i)}function za(i,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194176)!==0)){var f=n.lanes;f&=i.pendingLanes,l|=f,n.lanes=l,A0(i,l)}}function df(i,n){var l=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var g=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?g=y=b:y=y.next=b,l=l.next}while(l!==null);y===null?g=y=n:y=y.next=n}else g=y=n;l={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=n:i.next=n,l.lastBaseUpdate=n}var mf=!1;function Ya(){if(mf){var i=br;if(i!==null)throw i}}function qa(i,n,l,f){mf=!1;var g=i.updateQueue;Gs=!1;var y=g.firstBaseUpdate,b=g.lastBaseUpdate,I=g.shared.pending;if(I!==null){g.shared.pending=null;var F=I,V=F.next;F.next=null,b===null?y=V:b.next=V,b=F;var ne=i.alternate;ne!==null&&(ne=ne.updateQueue,I=ne.lastBaseUpdate,I!==b&&(I===null?ne.firstBaseUpdate=V:I.next=V,ne.lastBaseUpdate=F))}if(y!==null){var he=g.baseState;b=0,ne=V=F=null,I=y;do{var ee=I.lane&-536870913,se=ee!==I.lane;if(se?(Ue&ee)===ee:(f&ee)===ee){ee!==0&&ee===Tr&&(mf=!0),ne!==null&&(ne=ne.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var xe=i,De=I;ee=n;var ot=l;switch(De.tag){case 1:if(xe=De.payload,typeof xe=="function"){he=xe.call(ot,he,ee);break e}he=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=De.payload,ee=typeof xe=="function"?xe.call(ot,he,ee):xe,ee==null)break e;he=N({},he,ee);break e;case 2:Gs=!0}}ee=I.callback,ee!==null&&(i.flags|=64,se&&(i.flags|=8192),se=g.callbacks,se===null?g.callbacks=[ee]:se.push(ee))}else se={lane:ee,tag:I.tag,payload:I.payload,callback:I.callback,next:null},ne===null?(V=ne=se,F=he):ne=ne.next=se,b|=ee;if(I=I.next,I===null){if(I=g.shared.pending,I===null)break;se=I,I=se.next,se.next=null,g.lastBaseUpdate=se,g.shared.pending=null}}while(!0);ne===null&&(F=he),g.baseState=F,g.firstBaseUpdate=V,g.lastBaseUpdate=ne,y===null&&(g.shared.lanes=0),qs|=b,i.lanes=b,i.memoizedState=he}}function Pg(i,n){if(typeof i!="function")throw Error(s(191,i));i.call(n)}function Fg(i,n){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)Pg(l[i],n)}function Xa(i,n){try{var l=n.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var g=f.next;l=g;do{if((l.tag&i)===i){f=void 0;var y=l.create,b=l.inst;f=y(),b.destroy=f}l=l.next}while(l!==g)}}catch(I){Xe(n,n.return,I)}}function Vs(i,n,l){try{var f=n.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var y=g.next;f=y;do{if((f.tag&i)===i){var b=f.inst,I=b.destroy;if(I!==void 0){b.destroy=void 0,g=n;var F=l;try{I()}catch(V){Xe(g,F,V)}}}f=f.next}while(f!==y)}}catch(V){Xe(n,n.return,V)}}function Ug(i){var n=i.updateQueue;if(n!==null){var l=i.stateNode;try{Fg(n,l)}catch(f){Xe(i,i.return,f)}}}function Bg(i,n,l){l.props=wn(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(f){Xe(i,n,f)}}function Mn(i,n){try{var l=i.ref;if(l!==null){var f=i.stateNode;switch(i.tag){case 26:case 27:case 5:var g=f;break;default:g=f}typeof l=="function"?i.refCleanup=l(g):l.current=g}}catch(y){Xe(i,n,y)}}function Jt(i,n){var l=i.ref,f=i.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(g){Xe(i,n,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Xe(i,n,g)}else l.current=null}function jg(i){var n=i.type,l=i.memoizedProps,f=i.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(g){Xe(i,i.return,g)}}function Gg(i,n,l){try{var f=i.stateNode;ZT(f,i.type,l,n),f[Ht]=n}catch(g){Xe(i,i.return,g)}}function Hg(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function gf(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Hg(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function pf(i,n,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,n?l.nodeType===8?l.parentNode.insertBefore(i,n):l.insertBefore(i,n):(l.nodeType===8?(n=l.parentNode,n.insertBefore(i,l)):(n=l,n.appendChild(i)),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=Ml));else if(f!==4&&f!==27&&(i=i.child,i!==null))for(pf(i,n,l),i=i.sibling;i!==null;)pf(i,n,l),i=i.sibling}function Sl(i,n,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,n?l.insertBefore(i,n):l.appendChild(i);else if(f!==4&&f!==27&&(i=i.child,i!==null))for(Sl(i,n,l),i=i.sibling;i!==null;)Sl(i,n,l),i=i.sibling}var hs=!1,rt=!1,yf=!1,$g=typeof WeakSet=="function"?WeakSet:Set,Tt=null,Vg=!1;function DT(i,n){if(i=i.containerInfo,Kf=jl,i=om(i),vc(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var g=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var b=0,I=-1,F=-1,V=0,ne=0,he=i,ee=null;t:for(;;){for(var se;he!==l||g!==0&&he.nodeType!==3||(I=b+g),he!==y||f!==0&&he.nodeType!==3||(F=b+f),he.nodeType===3&&(b+=he.nodeValue.length),(se=he.firstChild)!==null;)ee=he,he=se;for(;;){if(he===i)break t;if(ee===l&&++V===g&&(I=b),ee===y&&++ne===f&&(F=b),(se=he.nextSibling)!==null)break;he=ee,ee=he.parentNode}he=se}l=I===-1||F===-1?null:{start:I,end:F}}else l=null}l=l||{start:0,end:0}}else l=null;for(zf={focusedElem:i,selectionRange:l},jl=!1,Tt=n;Tt!==null;)if(n=Tt,i=n.child,(n.subtreeFlags&1028)!==0&&i!==null)i.return=n,Tt=i;else for(;Tt!==null;){switch(n=Tt,y=n.alternate,i=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,l=n,g=y.memoizedProps,y=y.memoizedState,f=l.stateNode;try{var xe=wn(l.type,g,l.elementType===l.type);i=f.getSnapshotBeforeUpdate(xe,y),f.__reactInternalSnapshotBeforeUpdate=i}catch(De){Xe(l,l.return,De)}}break;case 3:if((i&1024)!==0){if(i=n.stateNode.containerInfo,l=i.nodeType,l===9)Qf(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Qf(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=n.sibling,i!==null){i.return=n.return,Tt=i;break}Tt=n.return}return xe=Vg,Vg=!1,xe}function Kg(i,n,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:ms(i,l),f&4&&Xa(5,l);break;case 1:if(ms(i,l),f&4)if(i=l.stateNode,n===null)try{i.componentDidMount()}catch(I){Xe(l,l.return,I)}else{var g=wn(l.type,n.memoizedProps);n=n.memoizedState;try{i.componentDidUpdate(g,n,i.__reactInternalSnapshotBeforeUpdate)}catch(I){Xe(l,l.return,I)}}f&64&&Ug(l),f&512&&Mn(l,l.return);break;case 3:if(ms(i,l),f&64&&(f=l.updateQueue,f!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{Fg(f,i)}catch(I){Xe(l,l.return,I)}}break;case 26:ms(i,l),f&512&&Mn(l,l.return);break;case 27:case 5:ms(i,l),n===null&&f&4&&jg(l),f&512&&Mn(l,l.return);break;case 12:ms(i,l);break;case 13:ms(i,l),f&4&&qg(i,l);break;case 22:if(g=l.memoizedState!==null||hs,!g){n=n!==null&&n.memoizedState!==null||rt;var y=hs,b=rt;hs=g,(rt=n)&&!b?Ks(i,l,(l.subtreeFlags&8772)!==0):ms(i,l),hs=y,rt=b}f&512&&(l.memoizedProps.mode==="manual"?Mn(l,l.return):Jt(l,l.return));break;default:ms(i,l)}}function zg(i){var n=i.alternate;n!==null&&(i.alternate=null,zg(n)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(n=i.stateNode,n!==null&&ic(n)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var dt=null,ei=!1;function ds(i,n,l){for(l=l.child;l!==null;)Yg(i,n,l),l=l.sibling}function Yg(i,n,l){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(va,l)}catch{}switch(l.tag){case 26:rt||Jt(l,n),ds(i,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:rt||Jt(l,n);var f=dt,g=ei;for(dt=l.stateNode,ds(i,n,l),l=l.stateNode,n=l.attributes;n.length;)l.removeAttributeNode(n[0]);ic(l),dt=f,ei=g;break;case 5:rt||Jt(l,n);case 6:g=dt;var y=ei;if(dt=null,ds(i,n,l),dt=g,ei=y,dt!==null)if(ei)try{i=dt,f=l.stateNode,i.nodeType===8?i.parentNode.removeChild(f):i.removeChild(f)}catch(b){Xe(l,n,b)}else try{dt.removeChild(l.stateNode)}catch(b){Xe(l,n,b)}break;case 18:dt!==null&&(ei?(n=dt,l=l.stateNode,n.nodeType===8?Xf(n.parentNode,l):n.nodeType===1&&Xf(n,l),mo(n)):Xf(dt,l.stateNode));break;case 4:f=dt,g=ei,dt=l.stateNode.containerInfo,ei=!0,ds(i,n,l),dt=f,ei=g;break;case 0:case 11:case 14:case 15:rt||Vs(2,l,n),rt||Vs(4,l,n),ds(i,n,l);break;case 1:rt||(Jt(l,n),f=l.stateNode,typeof f.componentWillUnmount=="function"&&Bg(l,n,f)),ds(i,n,l);break;case 21:ds(i,n,l);break;case 22:rt||Jt(l,n),rt=(f=rt)||l.memoizedState!==null,ds(i,n,l),rt=f;break;default:ds(i,n,l)}}function qg(i,n){if(n.memoizedState===null&&(i=n.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{mo(i)}catch(l){Xe(n,n.return,l)}}function CT(i){switch(i.tag){case 13:case 19:var n=i.stateNode;return n===null&&(n=i.stateNode=new $g),n;case 22:return i=i.stateNode,n=i._retryCache,n===null&&(n=i._retryCache=new $g),n;default:throw Error(s(435,i.tag))}}function vf(i,n){var l=CT(i);n.forEach(function(f){var g=HT.bind(null,i,f);l.has(f)||(l.add(f),f.then(g,g))})}function hi(i,n){var l=n.deletions;if(l!==null)for(var f=0;f<l.length;f++){var g=l[f],y=i,b=n,I=b;e:for(;I!==null;){switch(I.tag){case 27:case 5:dt=I.stateNode,ei=!1;break e;case 3:dt=I.stateNode.containerInfo,ei=!0;break e;case 4:dt=I.stateNode.containerInfo,ei=!0;break e}I=I.return}if(dt===null)throw Error(s(160));Yg(y,b,g),dt=null,ei=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)Xg(n,i),n=n.sibling}var _i=null;function Xg(i,n){var l=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:hi(n,i),di(i),f&4&&(Vs(3,i,i.return),Xa(3,i),Vs(5,i,i.return));break;case 1:hi(n,i),di(i),f&512&&(rt||l===null||Jt(l,l.return)),f&64&&hs&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var g=_i;if(hi(n,i),di(i),f&512&&(rt||l===null||Jt(l,l.return)),f&4){var y=l!==null?l.memoizedState:null;if(f=i.memoizedState,l===null)if(f===null)if(i.stateNode===null){e:{f=i.type,l=i.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":y=g.getElementsByTagName("title")[0],(!y||y[Ea]||y[It]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(f),g.head.insertBefore(y,g.querySelector("head > title"))),wt(y,f,l),y[It]=i,St(y),f=y;break e;case"link":var b=jp("link","href",g).get(f+(l.href||""));if(b){for(var I=0;I<b.length;I++)if(y=b[I],y.getAttribute("href")===(l.href==null?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(I,1);break t}}y=g.createElement(f),wt(y,f,l),g.head.appendChild(y);break;case"meta":if(b=jp("meta","content",g).get(f+(l.content||""))){for(I=0;I<b.length;I++)if(y=b[I],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(I,1);break t}}y=g.createElement(f),wt(y,f,l),g.head.appendChild(y);break;default:throw Error(s(468,f))}y[It]=i,St(y),f=y}i.stateNode=f}else Gp(g,i.type,i.stateNode);else i.stateNode=Bp(g,f,i.memoizedProps);else y!==f?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,f===null?Gp(g,i.type,i.stateNode):Bp(g,f,i.memoizedProps)):f===null&&i.stateNode!==null&&Gg(i,i.memoizedProps,l.memoizedProps)}break;case 27:if(f&4&&i.alternate===null){g=i.stateNode,y=i.memoizedProps;try{for(var F=g.firstChild;F;){var V=F.nextSibling,ne=F.nodeName;F[Ea]||ne==="HEAD"||ne==="BODY"||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&F.rel.toLowerCase()==="stylesheet"||g.removeChild(F),F=V}for(var he=i.type,ee=g.attributes;ee.length;)g.removeAttributeNode(ee[0]);wt(g,he,y),g[It]=i,g[Ht]=y}catch(xe){Xe(i,i.return,xe)}}case 5:if(hi(n,i),di(i),f&512&&(rt||l===null||Jt(l,l.return)),i.flags&32){g=i.stateNode;try{cr(g,"")}catch(xe){Xe(i,i.return,xe)}}f&4&&i.stateNode!=null&&(g=i.memoizedProps,Gg(i,g,l!==null?l.memoizedProps:g)),f&1024&&(yf=!0);break;case 6:if(hi(n,i),di(i),f&4){if(i.stateNode===null)throw Error(s(162));f=i.memoizedProps,l=i.stateNode;try{l.nodeValue=f}catch(xe){Xe(i,i.return,xe)}}break;case 3:if(Fl=null,g=_i,_i=Nl(n.containerInfo),hi(n,i),_i=g,di(i),f&4&&l!==null&&l.memoizedState.isDehydrated)try{mo(n.containerInfo)}catch(xe){Xe(i,i.return,xe)}yf&&(yf=!1,Qg(i));break;case 4:f=_i,_i=Nl(i.stateNode.containerInfo),hi(n,i),di(i),_i=f;break;case 12:hi(n,i),di(i);break;case 13:hi(n,i),di(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(_f=ni()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,vf(i,f)));break;case 22:if(f&512&&(rt||l===null||Jt(l,l.return)),F=i.memoizedState!==null,V=l!==null&&l.memoizedState!==null,ne=hs,he=rt,hs=ne||F,rt=he||V,hi(n,i),rt=he,hs=ne,di(i),n=i.stateNode,n._current=i,n._visibility&=-3,n._visibility|=n._pendingVisibility&2,f&8192&&(n._visibility=F?n._visibility&-2:n._visibility|1,F&&(n=hs||rt,l===null||V||n||_r(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))e:for(l=null,n=i;;){if(n.tag===5||n.tag===26||n.tag===27){if(l===null){V=l=n;try{if(g=V.stateNode,F)y=g.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{b=V.stateNode,I=V.memoizedProps.style;var se=I!=null&&I.hasOwnProperty("display")?I.display:null;b.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(xe){Xe(V,V.return,xe)}}}else if(n.tag===6){if(l===null){V=n;try{V.stateNode.nodeValue=F?"":V.memoizedProps}catch(xe){Xe(V,V.return,xe)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===i)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}f&4&&(f=i.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,vf(i,l))));break;case 19:hi(n,i),di(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,vf(i,f)));break;case 21:break;default:hi(n,i),di(i)}}function di(i){var n=i.flags;if(n&2){try{if(i.tag!==27){e:{for(var l=i.return;l!==null;){if(Hg(l)){var f=l;break e}l=l.return}throw Error(s(160))}switch(f.tag){case 27:var g=f.stateNode,y=gf(i);Sl(i,y,g);break;case 5:var b=f.stateNode;f.flags&32&&(cr(b,""),f.flags&=-33);var I=gf(i);Sl(i,I,b);break;case 3:case 4:var F=f.stateNode.containerInfo,V=gf(i);pf(i,V,F);break;default:throw Error(s(161))}}}catch(ne){Xe(i,i.return,ne)}i.flags&=-3}n&4096&&(i.flags&=-4097)}function Qg(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var n=i;Qg(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),i=i.sibling}}function ms(i,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Kg(i,n.alternate,n),n=n.sibling}function _r(i){for(i=i.child;i!==null;){var n=i;switch(n.tag){case 0:case 11:case 14:case 15:Vs(4,n,n.return),_r(n);break;case 1:Jt(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&Bg(n,n.return,l),_r(n);break;case 26:case 27:case 5:Jt(n,n.return),_r(n);break;case 22:Jt(n,n.return),n.memoizedState===null&&_r(n);break;default:_r(n)}i=i.sibling}}function Ks(i,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var f=n.alternate,g=i,y=n,b=y.flags;switch(y.tag){case 0:case 11:case 15:Ks(g,y,l),Xa(4,y);break;case 1:if(Ks(g,y,l),f=y,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(V){Xe(f,f.return,V)}if(f=y,g=f.updateQueue,g!==null){var I=f.stateNode;try{var F=g.shared.hiddenCallbacks;if(F!==null)for(g.shared.hiddenCallbacks=null,g=0;g<F.length;g++)Pg(F[g],I)}catch(V){Xe(f,f.return,V)}}l&&b&64&&Ug(y),Mn(y,y.return);break;case 26:case 27:case 5:Ks(g,y,l),l&&f===null&&b&4&&jg(y),Mn(y,y.return);break;case 12:Ks(g,y,l);break;case 13:Ks(g,y,l),l&&b&4&&qg(g,y);break;case 22:y.memoizedState===null&&Ks(g,y,l),Mn(y,y.return);break;default:Ks(g,y,l)}n=n.sibling}}function xf(i,n){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Ba(l))}function Sf(i,n){i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&Ba(i))}function zs(i,n,l,f){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Wg(i,n,l,f),n=n.sibling}function Wg(i,n,l,f){var g=n.flags;switch(n.tag){case 0:case 11:case 15:zs(i,n,l,f),g&2048&&Xa(9,n);break;case 3:zs(i,n,l,f),g&2048&&(i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&Ba(i)));break;case 12:if(g&2048){zs(i,n,l,f),i=n.stateNode;try{var y=n.memoizedProps,b=y.id,I=y.onPostCommit;typeof I=="function"&&I(b,n.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(F){Xe(n,n.return,F)}}else zs(i,n,l,f);break;case 23:break;case 22:y=n.stateNode,n.memoizedState!==null?y._visibility&4?zs(i,n,l,f):Qa(i,n):y._visibility&4?zs(i,n,l,f):(y._visibility|=4,Dr(i,n,l,f,(n.subtreeFlags&10256)!==0)),g&2048&&xf(n.alternate,n);break;case 24:zs(i,n,l,f),g&2048&&Sf(n.alternate,n);break;default:zs(i,n,l,f)}}function Dr(i,n,l,f,g){for(g=g&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var y=i,b=n,I=l,F=f,V=b.flags;switch(b.tag){case 0:case 11:case 15:Dr(y,b,I,F,g),Xa(8,b);break;case 23:break;case 22:var ne=b.stateNode;b.memoizedState!==null?ne._visibility&4?Dr(y,b,I,F,g):Qa(y,b):(ne._visibility|=4,Dr(y,b,I,F,g)),g&&V&2048&&xf(b.alternate,b);break;case 24:Dr(y,b,I,F,g),g&&V&2048&&Sf(b.alternate,b);break;default:Dr(y,b,I,F,g)}n=n.sibling}}function Qa(i,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=i,f=n,g=f.flags;switch(f.tag){case 22:Qa(l,f),g&2048&&xf(f.alternate,f);break;case 24:Qa(l,f),g&2048&&Sf(f.alternate,f);break;default:Qa(l,f)}n=n.sibling}}var Wa=8192;function Cr(i){if(i.subtreeFlags&Wa)for(i=i.child;i!==null;)Zg(i),i=i.sibling}function Zg(i){switch(i.tag){case 26:Cr(i),i.flags&Wa&&i.memoizedState!==null&&yb(_i,i.memoizedState,i.memoizedProps);break;case 5:Cr(i);break;case 3:case 4:var n=_i;_i=Nl(i.stateNode.containerInfo),Cr(i),_i=n;break;case 22:i.memoizedState===null&&(n=i.alternate,n!==null&&n.memoizedState!==null?(n=Wa,Wa=16777216,Cr(i),Wa=n):Cr(i));break;default:Cr(i)}}function Jg(i){var n=i.alternate;if(n!==null&&(i=n.child,i!==null)){n.child=null;do n=i.sibling,i.sibling=null,i=n;while(i!==null)}}function Za(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var f=n[l];Tt=f,tp(f,i)}Jg(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)ep(i),i=i.sibling}function ep(i){switch(i.tag){case 0:case 11:case 15:Za(i),i.flags&2048&&Vs(9,i,i.return);break;case 3:Za(i);break;case 12:Za(i);break;case 22:var n=i.stateNode;i.memoizedState!==null&&n._visibility&4&&(i.return===null||i.return.tag!==13)?(n._visibility&=-5,El(i)):Za(i);break;default:Za(i)}}function El(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var f=n[l];Tt=f,tp(f,i)}Jg(i)}for(i=i.child;i!==null;){switch(n=i,n.tag){case 0:case 11:case 15:Vs(8,n,n.return),El(n);break;case 22:l=n.stateNode,l._visibility&4&&(l._visibility&=-5,El(n));break;default:El(n)}i=i.sibling}}function tp(i,n){for(;Tt!==null;){var l=Tt;switch(l.tag){case 0:case 11:case 15:Vs(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ba(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,Tt=f;else e:for(l=i;Tt!==null;){f=Tt;var g=f.sibling,y=f.return;if(zg(f),f===l){Tt=null;break e}if(g!==null){g.return=y,Tt=g;break e}Tt=y}}}function wT(i,n,l,f){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mi(i,n,l,f){return new wT(i,n,l,f)}function Ef(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ys(i,n){var l=i.alternate;return l===null?(l=mi(i.tag,n,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=n,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&31457280,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,n=i.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function ip(i,n){i.flags&=31457282;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,n=l.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),i}function Tl(i,n,l,f,g,y){var b=0;if(f=i,typeof i=="function")Ef(i)&&(b=1);else if(typeof i=="string")b=gb(i,l,ut.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case h:return kn(l.children,g,y,n);case d:b=8,g|=24;break;case m:return i=mi(12,l,n,g|2),i.elementType=m,i.lanes=y,i;case E:return i=mi(13,l,n,g),i.elementType=E,i.lanes=y,i;case T:return i=mi(19,l,n,g),i.elementType=T,i.lanes=y,i;case C:return sp(l,g,y,n);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case p:case x:b=10;break e;case v:b=9;break e;case S:b=11;break e;case A:b=14;break e;case w:b=16,f=null;break e}b=29,l=Error(s(130,i===null?"null":typeof i,"")),f=null}return n=mi(b,l,n,g),n.elementType=i,n.type=f,n.lanes=y,n}function kn(i,n,l,f){return i=mi(7,i,f,n),i.lanes=l,i}function sp(i,n,l,f){i=mi(22,i,f,n),i.elementType=C,i.lanes=l;var g={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var y=g._current;if(y===null)throw Error(s(456));if((g._pendingVisibility&2)===0){var b=Ns(y,2);b!==null&&(g._pendingVisibility|=2,Ut(b,y,2))}},attach:function(){var y=g._current;if(y===null)throw Error(s(456));if((g._pendingVisibility&2)!==0){var b=Ns(y,2);b!==null&&(g._pendingVisibility&=-3,Ut(b,y,2))}}};return i.stateNode=g,i}function Tf(i,n,l){return i=mi(6,i,null,n),i.lanes=l,i}function bf(i,n,l){return n=mi(4,i.children!==null?i.children:[],i.key,n),n.lanes=l,n.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},n}function gs(i){i.flags|=4}function np(i,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Hp(n)){if(n=fi.current,n!==null&&((Ue&4194176)===Ue?Bi!==null:(Ue&62914560)!==Ue&&(Ue&536870912)===0||n!==Bi))throw Pa=_c,Em;i.flags|=8192}}function bl(i,n){n!==null&&(i.flags|=4),i.flags&16384&&(n=i.tag!==22?T0():536870912,i.lanes|=n,Or|=n)}function Ja(i,n){if(!Ge)switch(i.tailMode){case"hidden":n=i.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?n||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function it(i){var n=i.alternate!==null&&i.alternate.child===i.child,l=0,f=0;if(n)for(var g=i.child;g!==null;)l|=g.lanes|g.childLanes,f|=g.subtreeFlags&31457280,f|=g.flags&31457280,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)l|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=f,i.childLanes=l,n}function OT(i,n,l){var f=n.pendingProps;switch(Rc(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return it(n),null;case 1:return it(n),null;case 3:return l=n.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),n.memoizedState.cache!==f&&(n.flags|=2048),fs(yt),Je(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Ia(n)?gs(n):i===null||i.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Li!==null&&(Of(Li),Li=null))),it(n),null;case 26:return l=n.memoizedState,i===null?(gs(n),l!==null?(it(n),np(n,l)):(it(n),n.flags&=-16777217)):l?l!==i.memoizedState?(gs(n),it(n),np(n,l)):(it(n),n.flags&=-16777217):(i.memoizedProps!==f&&gs(n),it(n),n.flags&=-16777217),null;case 27:Fi(n),l=_t.current;var g=n.type;if(i!==null&&n.stateNode!=null)i.memoizedProps!==f&&gs(n);else{if(!f){if(n.stateNode===null)throw Error(s(166));return it(n),null}i=ut.current,Ia(n)?xm(n):(i=kp(g,f,l),n.stateNode=i,gs(n))}return it(n),null;case 5:if(Fi(n),l=n.type,i!==null&&n.stateNode!=null)i.memoizedProps!==f&&gs(n);else{if(!f){if(n.stateNode===null)throw Error(s(166));return it(n),null}if(i=ut.current,Ia(n))xm(n);else{switch(g=kl(_t.current),i){case 1:i=g.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:i=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":i=g.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":i=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":i=g.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof f.is=="string"?g.createElement("select",{is:f.is}):g.createElement("select"),f.multiple?i.multiple=!0:f.size&&(i.size=f.size);break;default:i=typeof f.is=="string"?g.createElement(l,{is:f.is}):g.createElement(l)}}i[It]=n,i[Ht]=f;e:for(g=n.child;g!==null;){if(g.tag===5||g.tag===6)i.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===n)break e;for(;g.sibling===null;){if(g.return===null||g.return===n)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}n.stateNode=i;e:switch(wt(i,l,f),l){case"button":case"input":case"select":case"textarea":i=!!f.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&gs(n)}}return it(n),n.flags&=-16777217,null;case 6:if(i&&n.stateNode!=null)i.memoizedProps!==f&&gs(n);else{if(typeof f!="string"&&n.stateNode===null)throw Error(s(166));if(i=_t.current,Ia(n)){if(i=n.stateNode,l=n.memoizedProps,f=null,g=Ft,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}i[It]=n,i=!!(i.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||Dp(i.nodeValue,l)),i||An(n)}else i=kl(i).createTextNode(f),i[It]=n,n.stateNode=i}return it(n),null;case 13:if(f=n.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=Ia(n),f!==null&&f.dehydrated!==null){if(i===null){if(!g)throw Error(s(318));if(g=n.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[It]=n}else Ma(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;it(n),g=!1}else Li!==null&&(Of(Li),Li=null),g=!0;if(!g)return n.flags&256?(os(n),n):(os(n),null)}if(os(n),(n.flags&128)!==0)return n.lanes=l,n;if(l=f!==null,i=i!==null&&i.memoizedState!==null,l){f=n.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool);var y=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==g&&(f.flags|=2048)}return l!==i&&l&&(n.child.flags|=8192),bl(n,n.updateQueue),it(n),null;case 4:return Je(),i===null&&Hf(n.stateNode.containerInfo),it(n),null;case 10:return fs(n.type),it(n),null;case 19:if(Le(pt),g=n.memoizedState,g===null)return it(n),null;if(f=(n.flags&128)!==0,y=g.rendering,y===null)if(f)Ja(g,!1);else{if(at!==0||i!==null&&(i.flags&128)!==0)for(i=n.child;i!==null;){if(y=al(i),y!==null){for(n.flags|=128,Ja(g,!1),i=y.updateQueue,n.updateQueue=i,bl(n,i),n.subtreeFlags=0,i=l,l=n.child;l!==null;)ip(l,i),l=l.sibling;return Ne(pt,pt.current&1|2),n.child}i=i.sibling}g.tail!==null&&ni()>Al&&(n.flags|=128,f=!0,Ja(g,!1),n.lanes=4194304)}else{if(!f)if(i=al(y),i!==null){if(n.flags|=128,f=!0,i=i.updateQueue,n.updateQueue=i,bl(n,i),Ja(g,!0),g.tail===null&&g.tailMode==="hidden"&&!y.alternate&&!Ge)return it(n),null}else 2*ni()-g.renderingStartTime>Al&&l!==536870912&&(n.flags|=128,f=!0,Ja(g,!1),n.lanes=4194304);g.isBackwards?(y.sibling=n.child,n.child=y):(i=g.last,i!==null?i.sibling=y:n.child=y,g.last=y)}return g.tail!==null?(n=g.tail,g.rendering=n,g.tail=n.sibling,g.renderingStartTime=ni(),n.sibling=null,i=pt.current,Ne(pt,f?i&1|2:i&1),n):(it(n),null);case 22:case 23:return os(n),Cc(),f=n.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(n.flags|=8192):f&&(n.flags|=8192),f?(l&536870912)!==0&&(n.flags&128)===0&&(it(n),n.subtreeFlags&6&&(n.flags|=8192)):it(n),l=n.updateQueue,l!==null&&bl(n,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),f=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(f=n.memoizedState.cachePool.pool),f!==l&&(n.flags|=2048),i!==null&&Le(Ln),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),fs(yt),it(n),null;case 25:return null}throw Error(s(156,n.tag))}function IT(i,n){switch(Rc(n),n.tag){case 1:return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 3:return fs(yt),Je(),i=n.flags,(i&65536)!==0&&(i&128)===0?(n.flags=i&-65537|128,n):null;case 26:case 27:case 5:return Fi(n),null;case 13:if(os(n),i=n.memoizedState,i!==null&&i.dehydrated!==null){if(n.alternate===null)throw Error(s(340));Ma()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 19:return Le(pt),null;case 4:return Je(),null;case 10:return fs(n.type),null;case 22:case 23:return os(n),Cc(),i!==null&&Le(Ln),i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 24:return fs(yt),null;case 25:return null;default:return null}}function rp(i,n){switch(Rc(n),n.tag){case 3:fs(yt),Je();break;case 26:case 27:case 5:Fi(n);break;case 4:Je();break;case 13:os(n);break;case 19:Le(pt);break;case 10:fs(n.type);break;case 22:case 23:os(n),Cc(),i!==null&&Le(Ln);break;case 24:fs(yt)}}var MT={getCacheForType:function(i){var n=Mt(yt),l=n.data.get(i);return l===void 0&&(l=i(),n.data.set(i,l)),l}},kT=typeof WeakMap=="function"?WeakMap:Map,st=0,Qe=null,ke=null,Ue=0,We=0,ti=null,ps=!1,wr=!1,Af=!1,ys=0,at=0,qs=0,Nn=0,Rf=0,gi=0,Or=0,eo=null,Gi=null,Lf=!1,_f=0,Al=1/0,Rl=null,Xs=null,Ll=!1,Pn=null,to=0,Df=0,Cf=null,io=0,wf=null;function ii(){if((st&2)!==0&&Ue!==0)return Ue&-Ue;if(D.T!==null){var i=Tr;return i!==0?i:Uf()}return L0()}function ap(){gi===0&&(gi=(Ue&536870912)===0||Ge?E0():536870912);var i=fi.current;return i!==null&&(i.flags|=32),gi}function Ut(i,n,l){(i===Qe&&We===2||i.cancelPendingCommit!==null)&&(Ir(i,0),vs(i,Ue,gi,!1)),Sa(i,l),((st&2)===0||i!==Qe)&&(i===Qe&&((st&2)===0&&(Nn|=l),at===4&&vs(i,Ue,gi,!1)),Hi(i))}function op(i,n,l){if((st&6)!==0)throw Error(s(327));var f=!l&&(n&60)===0&&(n&i.expiredLanes)===0||xa(i,n),g=f?FT(i,n):kf(i,n,!0),y=f;do{if(g===0){wr&&!f&&vs(i,n,0,!1);break}else if(g===6)vs(i,n,0,!ps);else{if(l=i.current.alternate,y&&!NT(l)){g=kf(i,n,!1),y=!1;continue}if(g===2){if(y=n,i.errorRecoveryDisabledLanes&y)var b=0;else b=i.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){n=b;e:{var I=i;g=eo;var F=I.current.memoizedState.isDehydrated;if(F&&(Ir(I,b).flags|=256),b=kf(I,b,!1),b!==2){if(Af&&!F){I.errorRecoveryDisabledLanes|=y,Nn|=y,g=4;break e}y=Gi,Gi=g,y!==null&&Of(y)}g=b}if(y=!1,g!==2)continue}}if(g===1){Ir(i,0),vs(i,n,0,!0);break}e:{switch(f=i,g){case 0:case 1:throw Error(s(345));case 4:if((n&4194176)===n){vs(f,n,gi,!ps);break e}break;case 2:Gi=null;break;case 3:case 5:break;default:throw Error(s(329))}if(f.finishedWork=l,f.finishedLanes=n,(n&62914560)===n&&(y=_f+300-ni(),10<y)){if(vs(f,n,gi,!ps),Bo(f,0)!==0)break e;f.timeoutHandle=Op(lp.bind(null,f,l,Gi,Rl,Lf,n,gi,Nn,Or,ps,2,-0,0),y);break e}lp(f,l,Gi,Rl,Lf,n,gi,Nn,Or,ps,0,-0,0)}}break}while(!0);Hi(i)}function Of(i){Gi===null?Gi=i:Gi.push.apply(Gi,i)}function lp(i,n,l,f,g,y,b,I,F,V,ne,he,ee){var se=n.subtreeFlags;if((se&8192||(se&16785408)===16785408)&&(lo={stylesheets:null,count:0,unsuspend:pb},Zg(n),n=vb(),n!==null)){i.cancelPendingCommit=n(gp.bind(null,i,l,f,g,b,I,F,1,he,ee)),vs(i,y,b,!V);return}gp(i,l,f,g,b,I,F,ne,he,ee)}function NT(i){for(var n=i;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var g=l[f],y=g.getSnapshot;g=g.value;try{if(!Zt(y(),g))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function vs(i,n,l,f){n&=~Rf,n&=~Nn,i.suspendedLanes|=n,i.pingedLanes&=~n,f&&(i.warmLanes|=n),f=i.expirationTimes;for(var g=n;0<g;){var y=31-Wt(g),b=1<<y;f[y]=-1,g&=~b}l!==0&&b0(i,l,n)}function _l(){return(st&6)===0?(so(0),!1):!0}function If(){if(ke!==null){if(We===0)var i=ke.return;else i=ke,cs=On=null,Fc(i),Sr=null,Fa=0,i=ke;for(;i!==null;)rp(i.alternate,i),i=i.return;ke=null}}function Ir(i,n){i.finishedWork=null,i.finishedLanes=0;var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,eb(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),If(),Qe=i,ke=l=Ys(i.current,null),Ue=n,We=0,ti=null,ps=!1,wr=xa(i,n),Af=!1,Or=gi=Rf=Nn=qs=at=0,Gi=eo=null,Lf=!1,(n&8)!==0&&(n|=n&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=n;0<f;){var g=31-Wt(f),y=1<<g;n|=i[g],f&=~y}return ys=n,Wo(),l}function up(i,n){Ie=null,D.H=ji,n===Na?(n=Am(),We=3):n===Em?(n=Am(),We=4):We=n===Tg?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,ti=n,ke===null&&(at=1,yl(i,li(n,i.current)))}function cp(){var i=D.H;return D.H=ji,i===null?ji:i}function fp(){var i=D.A;return D.A=MT,i}function Mf(){at=4,ps||(Ue&4194176)!==Ue&&fi.current!==null||(wr=!0),(qs&134217727)===0&&(Nn&134217727)===0||Qe===null||vs(Qe,Ue,gi,!1)}function kf(i,n,l){var f=st;st|=2;var g=cp(),y=fp();(Qe!==i||Ue!==n)&&(Rl=null,Ir(i,n)),n=!1;var b=at;e:do try{if(We!==0&&ke!==null){var I=ke,F=ti;switch(We){case 8:If(),b=6;break e;case 3:case 2:case 6:fi.current===null&&(n=!0);var V=We;if(We=0,ti=null,Mr(i,I,F,V),l&&wr){b=0;break e}break;default:V=We,We=0,ti=null,Mr(i,I,F,V)}}PT(),b=at;break}catch(ne){up(i,ne)}while(!0);return n&&i.shellSuspendCounter++,cs=On=null,st=f,D.H=g,D.A=y,ke===null&&(Qe=null,Ue=0,Wo()),b}function PT(){for(;ke!==null;)hp(ke)}function FT(i,n){var l=st;st|=2;var f=cp(),g=fp();Qe!==i||Ue!==n?(Rl=null,Al=ni()+500,Ir(i,n)):wr=xa(i,n);e:do try{if(We!==0&&ke!==null){n=ke;var y=ti;t:switch(We){case 1:We=0,ti=null,Mr(i,n,y,1);break;case 2:if(Tm(y)){We=0,ti=null,dp(n);break}n=function(){We===2&&Qe===i&&(We=7),Hi(i)},y.then(n,n);break e;case 3:We=7;break e;case 4:We=5;break e;case 7:Tm(y)?(We=0,ti=null,dp(n)):(We=0,ti=null,Mr(i,n,y,7));break;case 5:var b=null;switch(ke.tag){case 26:b=ke.memoizedState;case 5:case 27:var I=ke;if(!b||Hp(b)){We=0,ti=null;var F=I.sibling;if(F!==null)ke=F;else{var V=I.return;V!==null?(ke=V,Dl(V)):ke=null}break t}}We=0,ti=null,Mr(i,n,y,5);break;case 6:We=0,ti=null,Mr(i,n,y,6);break;case 8:If(),at=6;break e;default:throw Error(s(462))}}UT();break}catch(ne){up(i,ne)}while(!0);return cs=On=null,D.H=f,D.A=g,st=l,ke!==null?0:(Qe=null,Ue=0,Wo(),at)}function UT(){for(;ke!==null&&!is();)hp(ke)}function hp(i){var n=kg(i.alternate,i,ys);i.memoizedProps=i.pendingProps,n===null?Dl(i):ke=n}function dp(i){var n=i,l=n.alternate;switch(n.tag){case 15:case 0:n=Dg(l,n,n.pendingProps,n.type,void 0,Ue);break;case 11:n=Dg(l,n,n.pendingProps,n.type.render,n.ref,Ue);break;case 5:Fc(n);default:rp(l,n),n=ke=ip(n,ys),n=kg(l,n,ys)}i.memoizedProps=i.pendingProps,n===null?Dl(i):ke=n}function Mr(i,n,l,f){cs=On=null,Fc(n),Sr=null,Fa=0;var g=n.return;try{if(LT(i,g,n,l,Ue)){at=1,yl(i,li(l,i.current)),ke=null;return}}catch(y){if(g!==null)throw ke=g,y;at=1,yl(i,li(l,i.current)),ke=null;return}n.flags&32768?(Ge||f===1?i=!0:wr||(Ue&536870912)!==0?i=!1:(ps=i=!0,(f===2||f===3||f===6)&&(f=fi.current,f!==null&&f.tag===13&&(f.flags|=16384))),mp(n,i)):Dl(n)}function Dl(i){var n=i;do{if((n.flags&32768)!==0){mp(n,ps);return}i=n.return;var l=OT(n.alternate,n,ys);if(l!==null){ke=l;return}if(n=n.sibling,n!==null){ke=n;return}ke=n=i}while(n!==null);at===0&&(at=5)}function mp(i,n){do{var l=IT(i.alternate,i);if(l!==null){l.flags&=32767,ke=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(i=i.sibling,i!==null)){ke=i;return}ke=i=l}while(i!==null);at=6,ke=null}function gp(i,n,l,f,g,y,b,I,F,V){var ne=D.T,he=re.p;try{re.p=2,D.T=null,BT(i,n,l,f,he,g,y,b,I,F,V)}finally{D.T=ne,re.p=he}}function BT(i,n,l,f,g,y,b,I){do kr();while(Pn!==null);if((st&6)!==0)throw Error(s(327));var F=i.finishedWork;if(f=i.finishedLanes,F===null)return null;if(i.finishedWork=null,i.finishedLanes=0,F===i.current)throw Error(s(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var V=F.lanes|F.childLanes;if(V|=Tc,yE(i,f,V,y,b,I),i===Qe&&(ke=Qe=null,Ue=0),(F.subtreeFlags&10256)===0&&(F.flags&10256)===0||Ll||(Ll=!0,Df=V,Cf=l,$T(Po,function(){return kr(),null})),l=(F.flags&15990)!==0,(F.subtreeFlags&15990)!==0||l?(l=D.T,D.T=null,y=re.p,re.p=2,b=st,st|=4,DT(i,F),Xg(F,i),uT(zf,i.containerInfo),jl=!!Kf,zf=Kf=null,i.current=F,Kg(i,F.alternate,F),No(),st=b,re.p=y,D.T=l):i.current=F,Ll?(Ll=!1,Pn=i,to=f):pp(i,V),V=i.pendingLanes,V===0&&(Xs=null),hE(F.stateNode),Hi(i),n!==null)for(g=i.onRecoverableError,F=0;F<n.length;F++)V=n[F],g(V.value,{componentStack:V.stack});return(to&3)!==0&&kr(),V=i.pendingLanes,(f&4194218)!==0&&(V&42)!==0?i===wf?io++:(io=0,wf=i):io=0,so(0),null}function pp(i,n){(i.pooledCacheLanes&=n)===0&&(n=i.pooledCache,n!=null&&(i.pooledCache=null,Ba(n)))}function kr(){if(Pn!==null){var i=Pn,n=Df;Df=0;var l=R0(to),f=D.T,g=re.p;try{if(re.p=32>l?32:l,D.T=null,Pn===null)var y=!1;else{l=Cf,Cf=null;var b=Pn,I=to;if(Pn=null,to=0,(st&6)!==0)throw Error(s(331));var F=st;if(st|=4,ep(b.current),Wg(b,b.current,I,l),st=F,so(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(va,b)}catch{}y=!0}return y}finally{re.p=g,D.T=f,pp(i,n)}}return!1}function yp(i,n,l){n=li(l,n),n=Wc(i.stateNode,n,2),i=$s(i,n,2),i!==null&&(Sa(i,2),Hi(i))}function Xe(i,n,l){if(i.tag===3)yp(i,i,l);else for(;n!==null;){if(n.tag===3){yp(n,i,l);break}else if(n.tag===1){var f=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Xs===null||!Xs.has(f))){i=li(l,i),l=Sg(2),f=$s(n,l,2),f!==null&&(Eg(l,f,n,i),Sa(f,2),Hi(f));break}}n=n.return}}function Nf(i,n,l){var f=i.pingCache;if(f===null){f=i.pingCache=new kT;var g=new Set;f.set(n,g)}else g=f.get(n),g===void 0&&(g=new Set,f.set(n,g));g.has(l)||(Af=!0,g.add(l),i=jT.bind(null,i,n,l),n.then(i,i))}function jT(i,n,l){var f=i.pingCache;f!==null&&f.delete(n),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,Qe===i&&(Ue&l)===l&&(at===4||at===3&&(Ue&62914560)===Ue&&300>ni()-_f?(st&2)===0&&Ir(i,0):Rf|=l,Or===Ue&&(Or=0)),Hi(i)}function vp(i,n){n===0&&(n=T0()),i=Ns(i,n),i!==null&&(Sa(i,n),Hi(i))}function GT(i){var n=i.memoizedState,l=0;n!==null&&(l=n.retryLane),vp(i,l)}function HT(i,n){var l=0;switch(i.tag){case 13:var f=i.stateNode,g=i.memoizedState;g!==null&&(l=g.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(s(314))}f!==null&&f.delete(n),vp(i,l)}function $T(i,n){return $e(i,n)}var Cl=null,Nr=null,Pf=!1,wl=!1,Ff=!1,Fn=0;function Hi(i){i!==Nr&&i.next===null&&(Nr===null?Cl=Nr=i:Nr=Nr.next=i),wl=!0,Pf||(Pf=!0,KT(VT))}function so(i,n){if(!Ff&&wl){Ff=!0;do for(var l=!1,f=Cl;f!==null;){if(i!==0){var g=f.pendingLanes;if(g===0)var y=0;else{var b=f.suspendedLanes,I=f.pingedLanes;y=(1<<31-Wt(42|i)+1)-1,y&=g&~(b&~I),y=y&201326677?y&201326677|1:y?y|2:0}y!==0&&(l=!0,Ep(f,y))}else y=Ue,y=Bo(f,f===Qe?y:0),(y&3)===0||xa(f,y)||(l=!0,Ep(f,y));f=f.next}while(l);Ff=!1}}function VT(){wl=Pf=!1;var i=0;Fn!==0&&(JT()&&(i=Fn),Fn=0);for(var n=ni(),l=null,f=Cl;f!==null;){var g=f.next,y=xp(f,n);y===0?(f.next=null,l===null?Cl=g:l.next=g,g===null&&(Nr=l)):(l=f,(i!==0||(y&3)!==0)&&(wl=!0)),f=g}so(i)}function xp(i,n){for(var l=i.suspendedLanes,f=i.pingedLanes,g=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var b=31-Wt(y),I=1<<b,F=g[b];F===-1?((I&l)===0||(I&f)!==0)&&(g[b]=pE(I,n)):F<=n&&(i.expiredLanes|=I),y&=~I}if(n=Qe,l=Ue,l=Bo(i,i===n?l:0),f=i.callbackNode,l===0||i===n&&We===2||i.cancelPendingCommit!==null)return f!==null&&f!==null&&tt(f),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||xa(i,l)){if(n=l&-l,n===i.callbackPriority)return n;switch(f!==null&&tt(f),R0(l)){case 2:case 8:l=x0;break;case 32:l=Po;break;case 268435456:l=S0;break;default:l=Po}return f=Sp.bind(null,i),l=$e(l,f),i.callbackPriority=n,i.callbackNode=l,n}return f!==null&&f!==null&&tt(f),i.callbackPriority=2,i.callbackNode=null,2}function Sp(i,n){var l=i.callbackNode;if(kr()&&i.callbackNode!==l)return null;var f=Ue;return f=Bo(i,i===Qe?f:0),f===0?null:(op(i,f,n),xp(i,ni()),i.callbackNode!=null&&i.callbackNode===l?Sp.bind(null,i):null)}function Ep(i,n){if(kr())return null;op(i,n,!0)}function KT(i){tb(function(){(st&6)!==0?$e(v0,i):i()})}function Uf(){return Fn===0&&(Fn=E0()),Fn}function Tp(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Vo(""+i)}function bp(i,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,i.id&&l.setAttribute("form",i.id),n.parentNode.insertBefore(l,n),i=new FormData(i),l.parentNode.removeChild(l),i}function zT(i,n,l,f,g){if(n==="submit"&&l&&l.stateNode===g){var y=Tp((g[Ht]||null).action),b=f.submitter;b&&(n=(n=b[Ht]||null)?Tp(n.formAction):b.getAttribute("formAction"),n!==null&&(y=n,b=null));var I=new qo("action","action",null,f,g);i.push({event:I,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Fn!==0){var F=b?bp(g,b):new FormData(g);zc(l,{pending:!0,data:F,method:g.method,action:y},null,F)}}else typeof y=="function"&&(I.preventDefault(),F=b?bp(g,b):new FormData(g),zc(l,{pending:!0,data:F,method:g.method,action:y},y,F))},currentTarget:g}]})}}for(var Bf=0;Bf<gm.length;Bf++){var jf=gm[Bf],YT=jf.toLowerCase(),qT=jf[0].toUpperCase()+jf.slice(1);Ri(YT,"on"+qT)}Ri(cm,"onAnimationEnd"),Ri(fm,"onAnimationIteration"),Ri(hm,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(fT,"onTransitionRun"),Ri(hT,"onTransitionStart"),Ri(dT,"onTransitionCancel"),Ri(dm,"onTransitionEnd"),lr("onMouseEnter",["mouseout","mouseover"]),lr("onMouseLeave",["mouseout","mouseover"]),lr("onPointerEnter",["pointerout","pointerover"]),lr("onPointerLeave",["pointerout","pointerover"]),vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vn("onBeforeInput",["compositionend","keypress","textInput","paste"]),vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var no="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(no));function Ap(i,n){n=(n&4)!==0;for(var l=0;l<i.length;l++){var f=i[l],g=f.event;f=f.listeners;e:{var y=void 0;if(n)for(var b=f.length-1;0<=b;b--){var I=f[b],F=I.instance,V=I.currentTarget;if(I=I.listener,F!==y&&g.isPropagationStopped())break e;y=I,g.currentTarget=V;try{y(g)}catch(ne){pl(ne)}g.currentTarget=null,y=F}else for(b=0;b<f.length;b++){if(I=f[b],F=I.instance,V=I.currentTarget,I=I.listener,F!==y&&g.isPropagationStopped())break e;y=I,g.currentTarget=V;try{y(g)}catch(ne){pl(ne)}g.currentTarget=null,y=F}}}}function Pe(i,n){var l=n[tc];l===void 0&&(l=n[tc]=new Set);var f=i+"__bubble";l.has(f)||(Rp(n,i,2,!1),l.add(f))}function Gf(i,n,l){var f=0;n&&(f|=4),Rp(l,i,f,n)}var Ol="_reactListening"+Math.random().toString(36).slice(2);function Hf(i){if(!i[Ol]){i[Ol]=!0,D0.forEach(function(l){l!=="selectionchange"&&(XT.has(l)||Gf(l,!1,i),Gf(l,!0,i))});var n=i.nodeType===9?i:i.ownerDocument;n===null||n[Ol]||(n[Ol]=!0,Gf("selectionchange",!1,n))}}function Rp(i,n,l,f){switch(qp(n)){case 2:var g=Eb;break;case 8:g=Tb;break;default:g=th}l=g.bind(null,n,l,i),g=void 0,!uc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(g=!0),f?g!==void 0?i.addEventListener(n,l,{capture:!0,passive:g}):i.addEventListener(n,l,!0):g!==void 0?i.addEventListener(n,l,{passive:g}):i.addEventListener(n,l,!1)}function $f(i,n,l,f,g){var y=f;if((n&1)===0&&(n&2)===0&&f!==null)e:for(;;){if(f===null)return;var b=f.tag;if(b===3||b===4){var I=f.stateNode.containerInfo;if(I===g||I.nodeType===8&&I.parentNode===g)break;if(b===4)for(b=f.return;b!==null;){var F=b.tag;if((F===3||F===4)&&(F=b.stateNode.containerInfo,F===g||F.nodeType===8&&F.parentNode===g))return;b=b.return}for(;I!==null;){if(b=yn(I),b===null)return;if(F=b.tag,F===5||F===6||F===26||F===27){f=y=b;continue e}I=I.parentNode}}f=f.return}j0(function(){var V=y,ne=oc(l),he=[];e:{var ee=mm.get(i);if(ee!==void 0){var se=qo,xe=i;switch(i){case"keypress":if(zo(l)===0)break e;case"keydown":case"keyup":se=HE;break;case"focusin":xe="focus",se=dc;break;case"focusout":xe="blur",se=dc;break;case"beforeblur":case"afterblur":se=dc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=$0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=wE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=KE;break;case cm:case fm:case hm:se=ME;break;case dm:se=YE;break;case"scroll":case"scrollend":se=DE;break;case"wheel":se=XE;break;case"copy":case"cut":case"paste":se=NE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=K0;break;case"toggle":case"beforetoggle":se=WE}var De=(n&4)!==0,ot=!De&&(i==="scroll"||i==="scrollend"),q=De?ee!==null?ee+"Capture":null:ee;De=[];for(var H=V,W;H!==null;){var le=H;if(W=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||W===null||q===null||(le=ba(H,q),le!=null&&De.push(ro(H,le,W))),ot)break;H=H.return}0<De.length&&(ee=new se(ee,xe,null,l,ne),he.push({event:ee,listeners:De}))}}if((n&7)===0){e:{if(ee=i==="mouseover"||i==="pointerover",se=i==="mouseout"||i==="pointerout",ee&&l!==ac&&(xe=l.relatedTarget||l.fromElement)&&(yn(xe)||xe[rr]))break e;if((se||ee)&&(ee=ne.window===ne?ne:(ee=ne.ownerDocument)?ee.defaultView||ee.parentWindow:window,se?(xe=l.relatedTarget||l.toElement,se=V,xe=xe?yn(xe):null,xe!==null&&(ot=ue(xe),De=xe.tag,xe!==ot||De!==5&&De!==27&&De!==6)&&(xe=null)):(se=null,xe=V),se!==xe)){if(De=$0,le="onMouseLeave",q="onMouseEnter",H="mouse",(i==="pointerout"||i==="pointerover")&&(De=K0,le="onPointerLeave",q="onPointerEnter",H="pointer"),ot=se==null?ee:Ta(se),W=xe==null?ee:Ta(xe),ee=new De(le,H+"leave",se,l,ne),ee.target=ot,ee.relatedTarget=W,le=null,yn(ne)===V&&(De=new De(q,H+"enter",xe,l,ne),De.target=W,De.relatedTarget=ot,le=De),ot=le,se&&xe)t:{for(De=se,q=xe,H=0,W=De;W;W=Pr(W))H++;for(W=0,le=q;le;le=Pr(le))W++;for(;0<H-W;)De=Pr(De),H--;for(;0<W-H;)q=Pr(q),W--;for(;H--;){if(De===q||q!==null&&De===q.alternate)break t;De=Pr(De),q=Pr(q)}De=null}else De=null;se!==null&&Lp(he,ee,se,De,!1),xe!==null&&ot!==null&&Lp(he,ot,xe,De,!0)}}e:{if(ee=V?Ta(V):window,se=ee.nodeName&&ee.nodeName.toLowerCase(),se==="select"||se==="input"&&ee.type==="file")var ve=J0;else if(W0(ee))if(em)ve=oT;else{ve=rT;var Me=nT}else se=ee.nodeName,!se||se.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?V&&rc(V.elementType)&&(ve=J0):ve=aT;if(ve&&(ve=ve(i,V))){Z0(he,ve,l,ne);break e}Me&&Me(i,ee,V),i==="focusout"&&V&&ee.type==="number"&&V.memoizedProps.value!=null&&nc(ee,"number",ee.value)}switch(Me=V?Ta(V):window,i){case"focusin":(W0(Me)||Me.contentEditable==="true")&&(mr=Me,xc=V,Oa=null);break;case"focusout":Oa=xc=mr=null;break;case"mousedown":Sc=!0;break;case"contextmenu":case"mouseup":case"dragend":Sc=!1,lm(he,l,ne);break;case"selectionchange":if(cT)break;case"keydown":case"keyup":lm(he,l,ne)}var Se;if(gc)e:{switch(i){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else dr?X0(i,l)&&(Re="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Re="onCompositionStart");Re&&(z0&&l.locale!=="ko"&&(dr||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&dr&&(Se=G0()):(ks=ne,cc="value"in ks?ks.value:ks.textContent,dr=!0)),Me=Il(V,Re),0<Me.length&&(Re=new V0(Re,i,null,l,ne),he.push({event:Re,listeners:Me}),Se?Re.data=Se:(Se=Q0(l),Se!==null&&(Re.data=Se)))),(Se=JE?eT(i,l):tT(i,l))&&(Re=Il(V,"onBeforeInput"),0<Re.length&&(Me=new V0("onBeforeInput","beforeinput",null,l,ne),he.push({event:Me,listeners:Re}),Me.data=Se)),zT(he,i,V,l,ne)}Ap(he,n)})}function ro(i,n,l){return{instance:i,listener:n,currentTarget:l}}function Il(i,n){for(var l=n+"Capture",f=[];i!==null;){var g=i,y=g.stateNode;g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=ba(i,l),g!=null&&f.unshift(ro(i,g,y)),g=ba(i,n),g!=null&&f.push(ro(i,g,y))),i=i.return}return f}function Pr(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Lp(i,n,l,f,g){for(var y=n._reactName,b=[];l!==null&&l!==f;){var I=l,F=I.alternate,V=I.stateNode;if(I=I.tag,F!==null&&F===f)break;I!==5&&I!==26&&I!==27||V===null||(F=V,g?(V=ba(l,y),V!=null&&b.unshift(ro(l,V,F))):g||(V=ba(l,y),V!=null&&b.push(ro(l,V,F)))),l=l.return}b.length!==0&&i.push({event:n,listeners:b})}var QT=/\r\n?/g,WT=/\u0000|\uFFFD/g;function _p(i){return(typeof i=="string"?i:""+i).replace(QT,`
`).replace(WT,"")}function Dp(i,n){return n=_p(n),_p(i)===n}function Ml(){}function qe(i,n,l,f,g,y){switch(l){case"children":typeof f=="string"?n==="body"||n==="textarea"&&f===""||cr(i,f):(typeof f=="number"||typeof f=="bigint")&&n!=="body"&&cr(i,""+f);break;case"className":Go(i,"class",f);break;case"tabIndex":Go(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Go(i,l,f);break;case"style":U0(i,f,y);break;case"data":if(n!=="object"){Go(i,"data",f);break}case"src":case"href":if(f===""&&(n!=="a"||l!=="href")){i.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(l);break}f=Vo(""+f),i.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(n!=="input"&&qe(i,n,"name",g.name,g,null),qe(i,n,"formEncType",g.formEncType,g,null),qe(i,n,"formMethod",g.formMethod,g,null),qe(i,n,"formTarget",g.formTarget,g,null)):(qe(i,n,"encType",g.encType,g,null),qe(i,n,"method",g.method,g,null),qe(i,n,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(l);break}f=Vo(""+f),i.setAttribute(l,f);break;case"onClick":f!=null&&(i.onclick=Ml);break;case"onScroll":f!=null&&Pe("scroll",i);break;case"onScrollEnd":f!=null&&Pe("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(l=f.__html,l!=null){if(g.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}l=Vo(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(l,""+f):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":f===!0?i.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(l,f):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(l,f):i.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(l):i.setAttribute(l,f);break;case"popover":Pe("beforetoggle",i),Pe("toggle",i),jo(i,"popover",f);break;case"xlinkActuate":ns(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":ns(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":ns(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":ns(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":ns(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":ns(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":ns(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":ns(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":ns(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":jo(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=LE.get(l)||l,jo(i,l,f))}}function Vf(i,n,l,f,g,y){switch(l){case"style":U0(i,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(l=f.__html,l!=null){if(g.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"children":typeof f=="string"?cr(i,f):(typeof f=="number"||typeof f=="bigint")&&cr(i,""+f);break;case"onScroll":f!=null&&Pe("scroll",i);break;case"onScrollEnd":f!=null&&Pe("scrollend",i);break;case"onClick":f!=null&&(i.onclick=Ml);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!C0.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),n=l.slice(2,g?l.length-7:void 0),y=i[Ht]||null,y=y!=null?y[l]:null,typeof y=="function"&&i.removeEventListener(n,y,g),typeof f=="function")){typeof y!="function"&&y!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(n,f,g);break e}l in i?i[l]=f:f===!0?i.setAttribute(l,""):jo(i,l,f)}}}function wt(i,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pe("error",i),Pe("load",i);var f=!1,g=!1,y;for(y in l)if(l.hasOwnProperty(y)){var b=l[y];if(b!=null)switch(y){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:qe(i,n,y,b,l,null)}}g&&qe(i,n,"srcSet",l.srcSet,l,null),f&&qe(i,n,"src",l.src,l,null);return;case"input":Pe("invalid",i);var I=y=b=g=null,F=null,V=null;for(f in l)if(l.hasOwnProperty(f)){var ne=l[f];if(ne!=null)switch(f){case"name":g=ne;break;case"type":b=ne;break;case"checked":F=ne;break;case"defaultChecked":V=ne;break;case"value":y=ne;break;case"defaultValue":I=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(s(137,n));break;default:qe(i,n,f,ne,l,null)}}k0(i,y,I,F,V,b,g,!1),Ho(i);return;case"select":Pe("invalid",i),f=b=y=null;for(g in l)if(l.hasOwnProperty(g)&&(I=l[g],I!=null))switch(g){case"value":y=I;break;case"defaultValue":b=I;break;case"multiple":f=I;default:qe(i,n,g,I,l,null)}n=y,l=b,i.multiple=!!f,n!=null?ur(i,!!f,n,!1):l!=null&&ur(i,!!f,l,!0);return;case"textarea":Pe("invalid",i),y=g=f=null;for(b in l)if(l.hasOwnProperty(b)&&(I=l[b],I!=null))switch(b){case"value":f=I;break;case"defaultValue":g=I;break;case"children":y=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(s(91));break;default:qe(i,n,b,I,l,null)}P0(i,f,g,y),Ho(i);return;case"option":for(F in l)if(l.hasOwnProperty(F)&&(f=l[F],f!=null))switch(F){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:qe(i,n,F,f,l,null)}return;case"dialog":Pe("cancel",i),Pe("close",i);break;case"iframe":case"object":Pe("load",i);break;case"video":case"audio":for(f=0;f<no.length;f++)Pe(no[f],i);break;case"image":Pe("error",i),Pe("load",i);break;case"details":Pe("toggle",i);break;case"embed":case"source":case"link":Pe("error",i),Pe("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(V in l)if(l.hasOwnProperty(V)&&(f=l[V],f!=null))switch(V){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:qe(i,n,V,f,l,null)}return;default:if(rc(n)){for(ne in l)l.hasOwnProperty(ne)&&(f=l[ne],f!==void 0&&Vf(i,n,ne,f,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(f=l[I],f!=null&&qe(i,n,I,f,l,null))}function ZT(i,n,l,f){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,b=null,I=null,F=null,V=null,ne=null;for(se in l){var he=l[se];if(l.hasOwnProperty(se)&&he!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":F=he;default:f.hasOwnProperty(se)||qe(i,n,se,null,f,he)}}for(var ee in f){var se=f[ee];if(he=l[ee],f.hasOwnProperty(ee)&&(se!=null||he!=null))switch(ee){case"type":y=se;break;case"name":g=se;break;case"checked":V=se;break;case"defaultChecked":ne=se;break;case"value":b=se;break;case"defaultValue":I=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,n));break;default:se!==he&&qe(i,n,ee,se,f,he)}}sc(i,b,I,F,V,ne,y,g);return;case"select":se=b=I=ee=null;for(y in l)if(F=l[y],l.hasOwnProperty(y)&&F!=null)switch(y){case"value":break;case"multiple":se=F;default:f.hasOwnProperty(y)||qe(i,n,y,null,f,F)}for(g in f)if(y=f[g],F=l[g],f.hasOwnProperty(g)&&(y!=null||F!=null))switch(g){case"value":ee=y;break;case"defaultValue":I=y;break;case"multiple":b=y;default:y!==F&&qe(i,n,g,y,f,F)}n=I,l=b,f=se,ee!=null?ur(i,!!l,ee,!1):!!f!=!!l&&(n!=null?ur(i,!!l,n,!0):ur(i,!!l,l?[]:"",!1));return;case"textarea":se=ee=null;for(I in l)if(g=l[I],l.hasOwnProperty(I)&&g!=null&&!f.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:qe(i,n,I,null,f,g)}for(b in f)if(g=f[b],y=l[b],f.hasOwnProperty(b)&&(g!=null||y!=null))switch(b){case"value":ee=g;break;case"defaultValue":se=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==y&&qe(i,n,b,g,f,y)}N0(i,ee,se);return;case"option":for(var xe in l)if(ee=l[xe],l.hasOwnProperty(xe)&&ee!=null&&!f.hasOwnProperty(xe))switch(xe){case"selected":i.selected=!1;break;default:qe(i,n,xe,null,f,ee)}for(F in f)if(ee=f[F],se=l[F],f.hasOwnProperty(F)&&ee!==se&&(ee!=null||se!=null))switch(F){case"selected":i.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:qe(i,n,F,ee,f,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var De in l)ee=l[De],l.hasOwnProperty(De)&&ee!=null&&!f.hasOwnProperty(De)&&qe(i,n,De,null,f,ee);for(V in f)if(ee=f[V],se=l[V],f.hasOwnProperty(V)&&ee!==se&&(ee!=null||se!=null))switch(V){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(s(137,n));break;default:qe(i,n,V,ee,f,se)}return;default:if(rc(n)){for(var ot in l)ee=l[ot],l.hasOwnProperty(ot)&&ee!==void 0&&!f.hasOwnProperty(ot)&&Vf(i,n,ot,void 0,f,ee);for(ne in f)ee=f[ne],se=l[ne],!f.hasOwnProperty(ne)||ee===se||ee===void 0&&se===void 0||Vf(i,n,ne,ee,f,se);return}}for(var q in l)ee=l[q],l.hasOwnProperty(q)&&ee!=null&&!f.hasOwnProperty(q)&&qe(i,n,q,null,f,ee);for(he in f)ee=f[he],se=l[he],!f.hasOwnProperty(he)||ee===se||ee==null&&se==null||qe(i,n,he,ee,f,se)}var Kf=null,zf=null;function kl(i){return i.nodeType===9?i:i.ownerDocument}function Cp(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wp(i,n){if(i===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&n==="foreignObject"?0:i}function Yf(i,n){return i==="textarea"||i==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var qf=null;function JT(){var i=window.event;return i&&i.type==="popstate"?i===qf?!1:(qf=i,!0):(qf=null,!1)}var Op=typeof setTimeout=="function"?setTimeout:void 0,eb=typeof clearTimeout=="function"?clearTimeout:void 0,Ip=typeof Promise=="function"?Promise:void 0,tb=typeof queueMicrotask=="function"?queueMicrotask:typeof Ip<"u"?function(i){return Ip.resolve(null).then(i).catch(ib)}:Op;function ib(i){setTimeout(function(){throw i})}function Xf(i,n){var l=n,f=0;do{var g=l.nextSibling;if(i.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(f===0){i.removeChild(g),mo(n);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=g}while(l);mo(n)}function Qf(i){var n=i.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Qf(l),ic(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function sb(i,n,l,f){for(;i.nodeType===1;){var g=l;if(i.nodeName.toLowerCase()!==n.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[Ea])switch(n){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==g.rel||i.getAttribute("href")!==(g.href==null?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(n==="input"&&i.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=Di(i.nextSibling),i===null)break}return null}function nb(i,n,l){if(n==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=Di(i.nextSibling),i===null))return null;return i}function Di(i){for(;i!=null;i=i.nextSibling){var n=i.nodeType;if(n===1||n===3)break;if(n===8){if(n=i.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return i}function Mp(i){i=i.previousSibling;for(var n=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(n===0)return i;n--}else l==="/$"&&n++}i=i.previousSibling}return null}function kp(i,n,l){switch(n=kl(l),i){case"html":if(i=n.documentElement,!i)throw Error(s(452));return i;case"head":if(i=n.head,!i)throw Error(s(453));return i;case"body":if(i=n.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}var pi=new Map,Np=new Set;function Nl(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var xs=re.d;re.d={f:rb,r:ab,D:ob,C:lb,L:ub,m:cb,X:hb,S:fb,M:db};function rb(){var i=xs.f(),n=_l();return i||n}function ab(i){var n=ar(i);n!==null&&n.tag===5&&n.type==="form"?lg(n):xs.r(i)}var Fr=typeof document>"u"?null:document;function Pp(i,n,l){var f=Fr;if(f&&typeof n=="string"&&n){var g=ai(n);g='link[rel="'+i+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Np.has(g)||(Np.add(g),i={rel:i,crossOrigin:l,href:n},f.querySelector(g)===null&&(n=f.createElement("link"),wt(n,"link",i),St(n),f.head.appendChild(n)))}}function ob(i){xs.D(i),Pp("dns-prefetch",i,null)}function lb(i,n){xs.C(i,n),Pp("preconnect",i,n)}function ub(i,n,l){xs.L(i,n,l);var f=Fr;if(f&&i&&n){var g='link[rel="preload"][as="'+ai(n)+'"]';n==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+ai(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+ai(l.imageSizes)+'"]')):g+='[href="'+ai(i)+'"]';var y=g;switch(n){case"style":y=Ur(i);break;case"script":y=Br(i)}pi.has(y)||(i=N({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:i,as:n},l),pi.set(y,i),f.querySelector(g)!==null||n==="style"&&f.querySelector(ao(y))||n==="script"&&f.querySelector(oo(y))||(n=f.createElement("link"),wt(n,"link",i),St(n),f.head.appendChild(n)))}}function cb(i,n){xs.m(i,n);var l=Fr;if(l&&i){var f=n&&typeof n.as=="string"?n.as:"script",g='link[rel="modulepreload"][as="'+ai(f)+'"][href="'+ai(i)+'"]',y=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Br(i)}if(!pi.has(y)&&(i=N({rel:"modulepreload",href:i},n),pi.set(y,i),l.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(oo(y)))return}f=l.createElement("link"),wt(f,"link",i),St(f),l.head.appendChild(f)}}}function fb(i,n,l){xs.S(i,n,l);var f=Fr;if(f&&i){var g=or(f).hoistableStyles,y=Ur(i);n=n||"default";var b=g.get(y);if(!b){var I={loading:0,preload:null};if(b=f.querySelector(ao(y)))I.loading=5;else{i=N({rel:"stylesheet",href:i,"data-precedence":n},l),(l=pi.get(y))&&Wf(i,l);var F=b=f.createElement("link");St(F),wt(F,"link",i),F._p=new Promise(function(V,ne){F.onload=V,F.onerror=ne}),F.addEventListener("load",function(){I.loading|=1}),F.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Pl(b,n,f)}b={type:"stylesheet",instance:b,count:1,state:I},g.set(y,b)}}}function hb(i,n){xs.X(i,n);var l=Fr;if(l&&i){var f=or(l).hoistableScripts,g=Br(i),y=f.get(g);y||(y=l.querySelector(oo(g)),y||(i=N({src:i,async:!0},n),(n=pi.get(g))&&Zf(i,n),y=l.createElement("script"),St(y),wt(y,"link",i),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(g,y))}}function db(i,n){xs.M(i,n);var l=Fr;if(l&&i){var f=or(l).hoistableScripts,g=Br(i),y=f.get(g);y||(y=l.querySelector(oo(g)),y||(i=N({src:i,async:!0,type:"module"},n),(n=pi.get(g))&&Zf(i,n),y=l.createElement("script"),St(y),wt(y,"link",i),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(g,y))}}function Fp(i,n,l,f){var g=(g=_t.current)?Nl(g):null;if(!g)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=Ur(l.href),l=or(g).hoistableStyles,f=l.get(n),f||(f={type:"style",instance:null,count:0,state:null},l.set(n,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=Ur(l.href);var y=or(g).hoistableStyles,b=y.get(i);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,b),(y=g.querySelector(ao(i)))&&!y._p&&(b.instance=y,b.state.loading=5),pi.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},pi.set(i,l),y||mb(g,i,l,b.state))),n&&f===null)throw Error(s(528,""));return b}if(n&&f!==null)throw Error(s(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Br(l),l=or(g).hoistableScripts,f=l.get(n),f||(f={type:"script",instance:null,count:0,state:null},l.set(n,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function Ur(i){return'href="'+ai(i)+'"'}function ao(i){return'link[rel="stylesheet"]['+i+"]"}function Up(i){return N({},i,{"data-precedence":i.precedence,precedence:null})}function mb(i,n,l,f){i.querySelector('link[rel="preload"][as="style"]['+n+"]")?f.loading=1:(n=i.createElement("link"),f.preload=n,n.addEventListener("load",function(){return f.loading|=1}),n.addEventListener("error",function(){return f.loading|=2}),wt(n,"link",l),St(n),i.head.appendChild(n))}function Br(i){return'[src="'+ai(i)+'"]'}function oo(i){return"script[async]"+i}function Bp(i,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var f=i.querySelector('style[data-href~="'+ai(l.href)+'"]');if(f)return n.instance=f,St(f),f;var g=N({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),St(f),wt(f,"style",g),Pl(f,l.precedence,i),n.instance=f;case"stylesheet":g=Ur(l.href);var y=i.querySelector(ao(g));if(y)return n.state.loading|=4,n.instance=y,St(y),y;f=Up(l),(g=pi.get(g))&&Wf(f,g),y=(i.ownerDocument||i).createElement("link"),St(y);var b=y;return b._p=new Promise(function(I,F){b.onload=I,b.onerror=F}),wt(y,"link",f),n.state.loading|=4,Pl(y,l.precedence,i),n.instance=y;case"script":return y=Br(l.src),(g=i.querySelector(oo(y)))?(n.instance=g,St(g),g):(f=l,(g=pi.get(y))&&(f=N({},l),Zf(f,g)),i=i.ownerDocument||i,g=i.createElement("script"),St(g),wt(g,"link",f),i.head.appendChild(g),n.instance=g);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(f=n.instance,n.state.loading|=4,Pl(f,l.precedence,i));return n.instance}function Pl(i,n,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,y=g,b=0;b<f.length;b++){var I=f[b];if(I.dataset.precedence===n)y=I;else if(y!==g)break}y?y.parentNode.insertBefore(i,y.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(i,n.firstChild))}function Wf(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.title==null&&(i.title=n.title)}function Zf(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.integrity==null&&(i.integrity=n.integrity)}var Fl=null;function jp(i,n,l){if(Fl===null){var f=new Map,g=Fl=new Map;g.set(l,f)}else g=Fl,f=g.get(l),f||(f=new Map,g.set(l,f));if(f.has(i))return f;for(f.set(i,null),l=l.getElementsByTagName(i),g=0;g<l.length;g++){var y=l[g];if(!(y[Ea]||y[It]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var b=y.getAttribute(n)||"";b=i+b;var I=f.get(b);I?I.push(y):f.set(b,[y])}}return f}function Gp(i,n,l){i=i.ownerDocument||i,i.head.insertBefore(l,n==="title"?i.querySelector("head > title"):null)}function gb(i,n,l){if(l===1||n.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return i=n.disabled,typeof n.precedence=="string"&&i==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Hp(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var lo=null;function pb(){}function yb(i,n,l){if(lo===null)throw Error(s(475));var f=lo;if(n.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var g=Ur(l.href),y=i.querySelector(ao(g));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(f.count++,f=Ul.bind(f),i.then(f,f)),n.state.loading|=4,n.instance=y,St(y);return}y=i.ownerDocument||i,l=Up(l),(g=pi.get(g))&&Wf(l,g),y=y.createElement("link"),St(y);var b=y;b._p=new Promise(function(I,F){b.onload=I,b.onerror=F}),wt(y,"link",l),n.instance=y}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(n,i),(i=n.state.preload)&&(n.state.loading&3)===0&&(f.count++,n=Ul.bind(f),i.addEventListener("load",n),i.addEventListener("error",n))}}function vb(){if(lo===null)throw Error(s(475));var i=lo;return i.stylesheets&&i.count===0&&Jf(i,i.stylesheets),0<i.count?function(n){var l=setTimeout(function(){if(i.stylesheets&&Jf(i,i.stylesheets),i.unsuspend){var f=i.unsuspend;i.unsuspend=null,f()}},6e4);return i.unsuspend=n,function(){i.unsuspend=null,clearTimeout(l)}}:null}function Ul(){if(this.count--,this.count===0){if(this.stylesheets)Jf(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Bl=null;function Jf(i,n){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Bl=new Map,n.forEach(xb,i),Bl=null,Ul.call(i))}function xb(i,n){if(!(n.state.loading&4)){var l=Bl.get(i);if(l)var f=l.get(null);else{l=new Map,Bl.set(i,l);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var b=g[y];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),f=b)}f&&l.set(null,f)}g=n.instance,b=g.getAttribute("data-precedence"),y=l.get(b)||f,y===f&&l.set(null,g),l.set(b,g),this.count++,f=Ul.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),y?y.parentNode.insertBefore(g,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),n.state.loading|=4}}var uo={$$typeof:x,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function Sb(i,n,l,f,g,y,b,I){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ec(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ec(0),this.hiddenUpdates=ec(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function $p(i,n,l,f,g,y,b,I,F,V,ne,he){return i=new Sb(i,n,l,b,I,F,V,he),n=1,y===!0&&(n|=24),y=mi(3,null,null,n),i.current=y,y.stateNode=i,n=wc(),n.refCount++,i.pooledCache=n,n.refCount++,y.memoizedState={element:f,isDehydrated:l,cache:n},ff(y),i}function Vp(i){return i?(i=yr,i):yr}function Kp(i,n,l,f,g,y){g=Vp(g),f.context===null?f.context=g:f.pendingContext=g,f=Hs(n),f.payload={element:l},y=y===void 0?null:y,y!==null&&(f.callback=y),l=$s(i,f,n),l!==null&&(Ut(l,i,n),za(l,i,n))}function zp(i,n){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<n?l:n}}function eh(i,n){zp(i,n),(i=i.alternate)&&zp(i,n)}function Yp(i){if(i.tag===13){var n=Ns(i,67108864);n!==null&&Ut(n,i,67108864),eh(i,67108864)}}var jl=!0;function Eb(i,n,l,f){var g=D.T;D.T=null;var y=re.p;try{re.p=2,th(i,n,l,f)}finally{re.p=y,D.T=g}}function Tb(i,n,l,f){var g=D.T;D.T=null;var y=re.p;try{re.p=8,th(i,n,l,f)}finally{re.p=y,D.T=g}}function th(i,n,l,f){if(jl){var g=ih(f);if(g===null)$f(i,n,f,Gl,l),Xp(i,f);else if(Ab(g,i,n,l,f))f.stopPropagation();else if(Xp(i,f),n&4&&-1<bb.indexOf(i)){for(;g!==null;){var y=ar(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var b=pn(y.pendingLanes);if(b!==0){var I=y;for(I.pendingLanes|=2,I.entangledLanes|=2;b;){var F=1<<31-Wt(b);I.entanglements[1]|=F,b&=~F}Hi(y),(st&6)===0&&(Al=ni()+500,so(0))}}break;case 13:I=Ns(y,2),I!==null&&Ut(I,y,2),_l(),eh(y,2)}if(y=ih(f),y===null&&$f(i,n,f,Gl,l),y===g)break;g=y}g!==null&&f.stopPropagation()}else $f(i,n,f,null,l)}}function ih(i){return i=oc(i),sh(i)}var Gl=null;function sh(i){if(Gl=null,i=yn(i),i!==null){var n=ue(i);if(n===null)i=null;else{var l=n.tag;if(l===13){if(i=Y(n),i!==null)return i;i=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;i=null}else n!==i&&(i=null)}}return Gl=i,null}function qp(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ju()){case v0:return 2;case x0:return 8;case Po:case uE:return 32;case S0:return 268435456;default:return 32}default:return 32}}var nh=!1,Qs=null,Ws=null,Zs=null,co=new Map,fo=new Map,Js=[],bb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Xp(i,n){switch(i){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":co.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":fo.delete(n.pointerId)}}function ho(i,n,l,f,g,y){return i===null||i.nativeEvent!==y?(i={blockedOn:n,domEventName:l,eventSystemFlags:f,nativeEvent:y,targetContainers:[g]},n!==null&&(n=ar(n),n!==null&&Yp(n)),i):(i.eventSystemFlags|=f,n=i.targetContainers,g!==null&&n.indexOf(g)===-1&&n.push(g),i)}function Ab(i,n,l,f,g){switch(n){case"focusin":return Qs=ho(Qs,i,n,l,f,g),!0;case"dragenter":return Ws=ho(Ws,i,n,l,f,g),!0;case"mouseover":return Zs=ho(Zs,i,n,l,f,g),!0;case"pointerover":var y=g.pointerId;return co.set(y,ho(co.get(y)||null,i,n,l,f,g)),!0;case"gotpointercapture":return y=g.pointerId,fo.set(y,ho(fo.get(y)||null,i,n,l,f,g)),!0}return!1}function Qp(i){var n=yn(i.target);if(n!==null){var l=ue(n);if(l!==null){if(n=l.tag,n===13){if(n=Y(l),n!==null){i.blockedOn=n,vE(i.priority,function(){if(l.tag===13){var f=ii(),g=Ns(l,f);g!==null&&Ut(g,l,f),eh(l,f)}});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Hl(i){if(i.blockedOn!==null)return!1;for(var n=i.targetContainers;0<n.length;){var l=ih(i.nativeEvent);if(l===null){l=i.nativeEvent;var f=new l.constructor(l.type,l);ac=f,l.target.dispatchEvent(f),ac=null}else return n=ar(l),n!==null&&Yp(n),i.blockedOn=l,!1;n.shift()}return!0}function Wp(i,n,l){Hl(i)&&l.delete(n)}function Rb(){nh=!1,Qs!==null&&Hl(Qs)&&(Qs=null),Ws!==null&&Hl(Ws)&&(Ws=null),Zs!==null&&Hl(Zs)&&(Zs=null),co.forEach(Wp),fo.forEach(Wp)}function $l(i,n){i.blockedOn===n&&(i.blockedOn=null,nh||(nh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Rb)))}var Vl=null;function Zp(i){Vl!==i&&(Vl=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Vl===i&&(Vl=null);for(var n=0;n<i.length;n+=3){var l=i[n],f=i[n+1],g=i[n+2];if(typeof f!="function"){if(sh(f||l)===null)continue;break}var y=ar(l);y!==null&&(i.splice(n,3),n-=3,zc(y,{pending:!0,data:g,method:l.method,action:f},f,g))}}))}function mo(i){function n(F){return $l(F,i)}Qs!==null&&$l(Qs,i),Ws!==null&&$l(Ws,i),Zs!==null&&$l(Zs,i),co.forEach(n),fo.forEach(n);for(var l=0;l<Js.length;l++){var f=Js[l];f.blockedOn===i&&(f.blockedOn=null)}for(;0<Js.length&&(l=Js[0],l.blockedOn===null);)Qp(l),l.blockedOn===null&&Js.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var g=l[f],y=l[f+1],b=g[Ht]||null;if(typeof y=="function")b||Zp(l);else if(b){var I=null;if(y&&y.hasAttribute("formAction")){if(g=y,b=y[Ht]||null)I=b.formAction;else if(sh(g)!==null)continue}else I=b.action;typeof I=="function"?l[f+1]=I:(l.splice(f,3),f-=3),Zp(l)}}}function rh(i){this._internalRoot=i}Kl.prototype.render=rh.prototype.render=function(i){var n=this._internalRoot;if(n===null)throw Error(s(409));var l=n.current,f=ii();Kp(l,f,i,n,null,null)},Kl.prototype.unmount=rh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var n=i.containerInfo;i.tag===0&&kr(),Kp(i.current,2,null,i,null,null),_l(),n[rr]=null}};function Kl(i){this._internalRoot=i}Kl.prototype.unstable_scheduleHydration=function(i){if(i){var n=L0();i={blockedOn:null,target:i,priority:n};for(var l=0;l<Js.length&&n!==0&&n<Js[l].priority;l++);Js.splice(l,0,i),l===0&&Qp(i)}};var Jp=e.version;if(Jp!=="19.0.0")throw Error(s(527,Jp,"19.0.0"));re.findDOMNode=function(i){var n=i._reactInternals;if(n===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=K(n),i=i!==null?te(i):null,i=i===null?null:i.stateNode,i};var Lb={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:D,findFiberByHostInstance:yn,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zl.isDisabled&&zl.supportsFiber)try{va=zl.inject(Lb),Qt=zl}catch{}}return po.createRoot=function(i,n){if(!a(i))throw Error(s(299));var l=!1,f="",g=pg,y=yg,b=vg,I=null;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(f=n.identifierPrefix),n.onUncaughtError!==void 0&&(g=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(b=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(I=n.unstable_transitionCallbacks)),n=$p(i,1,!1,null,null,l,f,g,y,b,I,null),i[rr]=n.current,Hf(i.nodeType===8?i.parentNode:i),new rh(n)},po.hydrateRoot=function(i,n,l){if(!a(i))throw Error(s(299));var f=!1,g="",y=pg,b=yg,I=vg,F=null,V=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(F=l.unstable_transitionCallbacks),l.formState!==void 0&&(V=l.formState)),n=$p(i,1,!0,n,l??null,f,g,y,b,I,F,V),n.context=Vp(null),l=n.current,f=ii(),g=Hs(f),g.callback=null,$s(l,g,f),n.current.lanes=f,Sa(n,f),Hi(n),i[rr]=n.current,Hf(i),new Kl(n)},po.version="19.0.0",po}var cy;function Pb(){if(cy)return ch.exports;cy=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),ch.exports=Nb(),ch.exports}var Fb=Pb(),Ub="Invariant failed";function Ni(r,e){if(!r)throw new Error(Ub)}function qr(r){const e=r.resolvedLocation,t=r.location,s=(e==null?void 0:e.pathname)!==t.pathname,a=(e==null?void 0:e.href)!==t.href,o=(e==null?void 0:e.hash)!==t.hash;return{fromLocation:e,toLocation:t,pathChanged:s,hrefChanged:a,hashChanged:o}}const Bb="Error preloading route! ☝️";function Eo(r){return r[r.length-1]}function jb(r){return typeof r=="function"}function Hn(r,e){return jb(r)?r(e):r}function ld(r,e){return e.reduce((t,s)=>(t[s]=r[s],t),{})}function vi(r,e){if(r===e)return r;const t=e,s=hy(r)&&hy(t);if(s||bu(r)&&bu(t)){const a=s?r:Object.keys(r),o=a.length,u=s?t:Object.keys(t),c=u.length,h=s?[]:{};let d=0;for(let m=0;m<c;m++){const p=s?m:u[m];(!s&&a.includes(p)||s)&&r[p]===void 0&&t[p]===void 0?(h[p]=void 0,d++):(h[p]=vi(r[p],t[p]),h[p]===r[p]&&r[p]!==void 0&&d++)}return o===c&&d===o?r:h}return t}function bu(r){if(!fy(r))return!1;const e=r.constructor;if(typeof e>"u")return!0;const t=e.prototype;return!(!fy(t)||!t.hasOwnProperty("isPrototypeOf"))}function fy(r){return Object.prototype.toString.call(r)==="[object Object]"}function hy(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function dy(r,e){let t=Object.keys(r);return e&&(t=t.filter(s=>r[s]!==void 0)),t}function Xr(r,e,t){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(bu(r)&&bu(e)){const s=(t==null?void 0:t.ignoreUndefined)??!0,a=dy(r,s),o=dy(e,s);return!(t!=null&&t.partial)&&a.length!==o.length?!1:o.every(u=>Xr(r[u],e[u],t))}return Array.isArray(r)&&Array.isArray(e)?r.length!==e.length?!1:!r.some((s,a)=>!Xr(s,e[a],t)):!1}function Vr(r){let e,t;const s=new Promise((a,o)=>{e=a,t=o});return s.status="pending",s.resolve=a=>{s.status="resolved",s.value=a,e(a),r==null||r(a)},s.reject=a=>{s.status="rejected",t(a)},s}function Gb(r){return/%[0-9A-Fa-f]{2}/.test(r)}function _s(r){return zu(r.filter(e=>e!==void 0).join("/"))}function zu(r){return r.replace(/\/{2,}/g,"/")}function Vd(r){return r==="/"?r:r.replace(/^\/{1,}/,"")}function $n(r){return r==="/"?r:r.replace(/\/{1,}$/,"")}function Hb(r){return $n(Vd(r))}function Au(r,e){return r!=null&&r.endsWith("/")&&r!=="/"&&r!==`${e}/`?r.slice(0,-1):r}function $b(r,e,t){return Au(r,t)===Au(e,t)}function Vb({basepath:r,base:e,to:t,trailingSlash:s="never",caseSensitive:a}){var o,u;e=Ru(r,e,a),t=Ru(r,t,a);let c=da(e);const h=da(t);c.length>1&&((o=Eo(c))==null?void 0:o.value)==="/"&&c.pop(),h.forEach((m,p)=>{m.value==="/"?p?p===h.length-1&&c.push(m):c=[m]:m.value===".."?c.pop():m.value==="."||c.push(m)}),c.length>1&&(((u=Eo(c))==null?void 0:u.value)==="/"?s==="never"&&c.pop():s==="always"&&c.push({type:"pathname",value:"/"}));const d=_s([r,...c.map(m=>m.value)]);return zu(d)}function da(r){if(!r)return[];r=zu(r);const e=[];if(r.slice(0,1)==="/"&&(r=r.substring(1),e.push({type:"pathname",value:"/"})),!r)return e;const t=r.split("/").filter(Boolean);return e.push(...t.map(s=>s==="$"||s==="*"?{type:"wildcard",value:s}:s.charAt(0)==="$"?{type:"param",value:s}:{type:"pathname",value:s.includes("%25")?s.split("%25").map(a=>decodeURI(a)).join("%25"):decodeURI(s)})),r.slice(-1)==="/"&&(r=r.substring(1),e.push({type:"pathname",value:"/"})),e}function ql({path:r,params:e,leaveWildcards:t,leaveParams:s,decodeCharMap:a}){const o=da(r);function u(d){const m=e[d],p=typeof m=="string";return["*","_splat"].includes(d)?p?encodeURI(m):m:p?Kb(m,a):m}const c={},h=_s(o.map(d=>{if(d.type==="wildcard"){c._splat=e._splat;const m=u("_splat");return t?`${d.value}${m??""}`:m}if(d.type==="param"){const m=d.value.substring(1);if(c[m]=e[m],s){const p=u(d.value);return`${d.value}${p??""}`}return u(m)??"undefined"}return d.value}));return{usedParams:c,interpolatedPath:h}}function Kb(r,e){let t=encodeURIComponent(r);if(e)for(const[s,a]of e)t=t.replaceAll(s,a);return t}function Xl(r,e,t){const s=zb(r,e,t);if(!(t.to&&!s))return s??{}}function Ru(r,e,t=!1){const s=t?r:r.toLowerCase(),a=t?e:e.toLowerCase();switch(!0){case s==="/":return e;case a===s:return"";case e.length<r.length:return e;case a[s.length]!=="/":return e;case a.startsWith(s):return e.slice(r.length);default:return e}}function zb(r,e,t){if(r!=="/"&&!e.startsWith(r))return;e=Ru(r,e,t.caseSensitive);const s=Ru(r,`${t.to??"$"}`,t.caseSensitive),a=da(e),o=da(s);e.startsWith("/")||a.unshift({type:"pathname",value:"/"}),s.startsWith("/")||o.unshift({type:"pathname",value:"/"});const u={};return(()=>{for(let h=0;h<Math.max(a.length,o.length);h++){const d=a[h],m=o[h],p=h>=a.length-1,v=h>=o.length-1;if(m){if(m.type==="wildcard"){const x=decodeURI(_s(a.slice(h).map(S=>S.value)));return u["*"]=x,u._splat=x,!0}if(m.type==="pathname"){if(m.value==="/"&&!(d!=null&&d.value))return!0;if(d){if(t.caseSensitive){if(m.value!==d.value)return!1}else if(m.value.toLowerCase()!==d.value.toLowerCase())return!1}}if(!d)return!1;if(m.type==="param"){if(d.value==="/")return!1;d.value.charAt(0)!=="$"&&(u[m.value.substring(1)]=decodeURIComponent(d.value))}}if(!p&&v)return u["**"]=_s(a.slice(h+1).map(x=>x.value)),!!t.fuzzy&&(m==null?void 0:m.value)!=="/"}return!0})()?u:void 0}function Yb(r,e){let t,s,a,o="";for(t in r)if((a=r[t])!==void 0)if(Array.isArray(a))for(s=0;s<a.length;s++)o&&(o+="&"),o+=encodeURIComponent(t)+"="+encodeURIComponent(a[s]);else o&&(o+="&"),o+=encodeURIComponent(t)+"="+encodeURIComponent(a);return""+o}function my(r){if(!r)return"";const e=Gb(r)?decodeURIComponent(r):decodeURIComponent(encodeURIComponent(r));return e==="false"?!1:e==="true"?!0:+e*0===0&&+e+""===e?+e:e}function qb(r,e){let t,s;const a={},o=r.split("&");for(;t=o.shift();){const u=t.indexOf("=");if(u!==-1){s=t.slice(0,u),s=decodeURIComponent(s);const c=t.slice(u+1);a[s]!==void 0?a[s]=[].concat(a[s],my(c)):a[s]=my(c)}else s=t,s=decodeURIComponent(s),a[s]=""}return a}const qt="__root__",Xb=Wb(JSON.parse),Qb=Zb(JSON.stringify,JSON.parse);function Wb(r){return e=>{e.substring(0,1)==="?"&&(e=e.substring(1));const t=qb(e);for(const s in t){const a=t[s];if(typeof a=="string")try{t[s]=r(a)}catch{}}return t}}function Zb(r,e){function t(s){if(typeof s=="object"&&s!==null)try{return r(s)}catch{}else if(typeof s=="string"&&typeof e=="function")try{return e(s),r(s)}catch{}return s}return s=>{s={...s},Object.keys(s).forEach(o=>{const u=s[o];typeof u>"u"||u===void 0?delete s[o]:s[o]=t(u)});const a=Yb(s).toString();return a?`?${a}`:""}}const gn="__TSR_index",gy="popstate",py="beforeunload";function cx(r){let e=r.getLocation();const t=new Set,s=u=>{e=r.getLocation(),t.forEach(c=>c({location:e,action:u}))},a=u=>{r.notifyOnIndexChange??!0?s(u):e=r.getLocation()},o=async({task:u,navigateOpts:c,...h})=>{var d,m;if((c==null?void 0:c.ignoreBlocker)??!1){u();return}const v=((d=r.getBlockers)==null?void 0:d.call(r))??[],x=h.type==="PUSH"||h.type==="REPLACE";if(typeof document<"u"&&v.length&&x)for(const S of v){const E=Ao(h.path,h.state);if(await S.blockerFn({currentLocation:e,nextLocation:E,action:h.type})){(m=r.onBlocked)==null||m.call(r);return}}u()};return{get location(){return e},get length(){return r.getLength()},subscribers:t,subscribe:u=>(t.add(u),()=>{t.delete(u)}),push:(u,c,h)=>{const d=e.state[gn];c=ud(d+1,c),o({task:()=>{r.pushState(u,c),s({type:"PUSH"})},navigateOpts:h,type:"PUSH",path:u,state:c})},replace:(u,c,h)=>{const d=e.state[gn];c=ud(d,c),o({task:()=>{r.replaceState(u,c),s({type:"REPLACE"})},navigateOpts:h,type:"REPLACE",path:u,state:c})},go:(u,c)=>{o({task:()=>{r.go(u),a({type:"GO",index:u})},navigateOpts:c,type:"GO"})},back:u=>{o({task:()=>{r.back((u==null?void 0:u.ignoreBlocker)??!1),a({type:"BACK"})},navigateOpts:u,type:"BACK"})},forward:u=>{o({task:()=>{r.forward((u==null?void 0:u.ignoreBlocker)??!1),a({type:"FORWARD"})},navigateOpts:u,type:"FORWARD"})},canGoBack:()=>e.state[gn]!==0,createHref:u=>r.createHref(u),block:u=>{var c;if(!r.setBlockers)return()=>{};const h=((c=r.getBlockers)==null?void 0:c.call(r))??[];return r.setBlockers([...h,u]),()=>{var d,m;const p=((d=r.getBlockers)==null?void 0:d.call(r))??[];(m=r.setBlockers)==null||m.call(r,p.filter(v=>v!==u))}},flush:()=>{var u;return(u=r.flush)==null?void 0:u.call(r)},destroy:()=>{var u;return(u=r.destroy)==null?void 0:u.call(r)},notify:s}}function ud(r,e){return e||(e={}),{...e,key:Kd(),[gn]:r}}function Jb(r){var e;const t=typeof document<"u"?window:void 0,s=t.history.pushState,a=t.history.replaceState;let o=[];const u=()=>o,c=D=>o=D,h=D=>D,d=()=>Ao(`${t.location.pathname}${t.location.search}${t.location.hash}`,t.history.state);(e=t.history.state)!=null&&e.key||t.history.replaceState({[gn]:0,key:Kd()},"");let m=d(),p,v=!1,x=!1,S=!1,E=!1;const T=()=>m;let A,w;const C=()=>{A&&(M._ignoreSubscribers=!0,(A.isPush?t.history.pushState:t.history.replaceState)(A.state,"",A.href),M._ignoreSubscribers=!1,A=void 0,w=void 0,p=void 0)},k=(D,N,P)=>{const G=h(N);w||(p=m),m=Ao(N,P),A={href:G,state:P,isPush:(A==null?void 0:A.isPush)||D==="push"},w||(w=Promise.resolve().then(()=>C()))},_=D=>{m=d(),M.notify({type:D})},U=async()=>{if(x){x=!1;return}const D=d(),N=D.state[gn]-m.state[gn],P=N===1,G=N===-1,J=!P&&!G||v;v=!1;const z=J?"GO":G?"BACK":"FORWARD",Q=J?{type:"GO",index:N}:{type:G?"BACK":"FORWARD"};if(S)S=!1;else{const $=u();if(typeof document<"u"&&$.length){for(const oe of $)if(await oe.blockerFn({currentLocation:m,nextLocation:D,action:z})){x=!0,t.history.go(1),M.notify(Q);return}}}m=d(),M.notify(Q)},B=D=>{if(E){E=!1;return}let N=!1;const P=u();if(typeof document<"u"&&P.length)for(const G of P){const J=G.enableBeforeUnload??!0;if(J===!0){N=!0;break}if(typeof J=="function"&&J()===!0){N=!0;break}}if(N)return D.preventDefault(),D.returnValue=""},M=cx({getLocation:T,getLength:()=>t.history.length,pushState:(D,N)=>k("push",D,N),replaceState:(D,N)=>k("replace",D,N),back:D=>(D&&(S=!0),E=!0,t.history.back()),forward:D=>{D&&(S=!0),E=!0,t.history.forward()},go:D=>{v=!0,t.history.go(D)},createHref:D=>h(D),flush:C,destroy:()=>{t.history.pushState=s,t.history.replaceState=a,t.removeEventListener(py,B,{capture:!0}),t.removeEventListener(gy,U)},onBlocked:()=>{p&&m!==p&&(m=p)},getBlockers:u,setBlockers:c,notifyOnIndexChange:!1});return t.addEventListener(py,B,{capture:!0}),t.addEventListener(gy,U),t.history.pushState=function(...D){const N=s.apply(t.history,D);return M._ignoreSubscribers||_("PUSH"),N},t.history.replaceState=function(...D){const N=a.apply(t.history,D);return M._ignoreSubscribers||_("REPLACE"),N},M}function e1(r={initialEntries:["/"]}){const e=r.initialEntries;let t=r.initialIndex?Math.min(Math.max(r.initialIndex,0),e.length-1):e.length-1;const s=e.map((o,u)=>ud(u,void 0));return cx({getLocation:()=>Ao(e[t],s[t]),getLength:()=>e.length,pushState:(o,u)=>{t<e.length-1&&(e.splice(t+1),s.splice(t+1)),s.push(u),e.push(o),t=Math.max(e.length-1,0)},replaceState:(o,u)=>{s[t]=u,e[t]=o},back:()=>{t=Math.max(t-1,0)},forward:()=>{t=Math.min(t+1,e.length-1)},go:o=>{t=Math.min(Math.max(t+o,0),e.length-1)},createHref:o=>o})}function Ao(r,e){const t=r.indexOf("#"),s=r.indexOf("?");return{href:r,pathname:r.substring(0,t>0?s>0?Math.min(t,s):t:s>0?s:r.length),hash:t>-1?r.substring(t):"",search:s>-1?r.slice(s,t===-1?void 0:t):"",state:e||{[gn]:0,key:Kd()}}}function Kd(){return(Math.random()+1).toString(36).substring(7)}function zd(r){const e=r.errorComponent??Yu;return L.jsx(t1,{getResetKey:r.getResetKey,onCatch:r.onCatch,children:({error:t,reset:s})=>t?fe.createElement(e,{error:t,reset:s}):r.children})}class t1 extends fe.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(e){return{resetKey:e.getResetKey()}}static getDerivedStateFromError(e){return{error:e}}reset(){this.setState({error:null})}componentDidUpdate(e,t){t.error&&t.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(e,t){this.props.onCatch&&this.props.onCatch(e,t)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function Yu({error:r}){const[e,t]=fe.useState(!1);return L.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[L.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[L.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),L.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>t(s=>!s),children:e?"Hide Error":"Show Error"})]}),L.jsx("div",{style:{height:".25rem"}}),e?L.jsx("div",{children:L.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:r.message?L.jsx("code",{children:r.message}):null})}):null]})}var mh={exports:{}},gh={},ph={exports:{}},yh={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function i1(){if(yy)return yh;yy=1;var r=ws();function e(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var t=typeof Object.is=="function"?Object.is:e,s=r.useState,a=r.useEffect,o=r.useLayoutEffect,u=r.useDebugValue;function c(p,v){var x=v(),S=s({inst:{value:x,getSnapshot:v}}),E=S[0].inst,T=S[1];return o(function(){E.value=x,E.getSnapshot=v,h(E)&&T({inst:E})},[p,x,v]),a(function(){return h(E)&&T({inst:E}),p(function(){h(E)&&T({inst:E})})},[p]),u(x),x}function h(p){var v=p.getSnapshot;p=p.value;try{var x=v();return!t(p,x)}catch{return!0}}function d(p,v){return v()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:c;return yh.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:m,yh}var vy;function s1(){return vy||(vy=1,ph.exports=i1()),ph.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xy;function n1(){if(xy)return gh;xy=1;var r=ws(),e=s1();function t(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var s=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,o=r.useRef,u=r.useEffect,c=r.useMemo,h=r.useDebugValue;return gh.useSyncExternalStoreWithSelector=function(d,m,p,v,x){var S=o(null);if(S.current===null){var E={hasValue:!1,value:null};S.current=E}else E=S.current;S=c(function(){function A(U){if(!w){if(w=!0,C=U,U=v(U),x!==void 0&&E.hasValue){var B=E.value;if(x(B,U))return k=B}return k=U}if(B=k,s(C,U))return B;var M=v(U);return x!==void 0&&x(B,M)?(C=U,B):(C=U,k=M)}var w=!1,C,k,_=p===void 0?null:p;return[function(){return A(m())},_===null?void 0:function(){return A(_())}]},[m,p,v,x]);var T=a(d,S[0],S[1]);return u(function(){E.hasValue=!0,E.value=T},[T]),h(T),T},gh}var Sy;function r1(){return Sy||(Sy=1,mh.exports=n1()),mh.exports}var a1=r1();const Qr=new WeakMap,fu=new WeakMap,Lu={current:[]};let vh=!1,To=0;const vo=new Set,Ql=new Map;function fx(r){const e=Array.from(r).sort((t,s)=>t instanceof Wr&&t.options.deps.includes(s)?1:s instanceof Wr&&s.options.deps.includes(t)?-1:0);for(const t of e){if(Lu.current.includes(t))continue;Lu.current.push(t),t.recompute();const s=fu.get(t);if(s)for(const a of s){const o=Qr.get(a);o&&fx(o)}}}function o1(r){r.listeners.forEach(e=>e({prevVal:r.prevState,currentVal:r.state}))}function l1(r){r.listeners.forEach(e=>e({prevVal:r.prevState,currentVal:r.state}))}function hx(r){if(To>0&&!Ql.has(r)&&Ql.set(r,r.prevState),vo.add(r),!(To>0)&&!vh)try{for(vh=!0;vo.size>0;){const e=Array.from(vo);vo.clear();for(const t of e){const s=Ql.get(t)??t.prevState;t.prevState=s,o1(t)}for(const t of e){const s=Qr.get(t);s&&(Lu.current.push(t),fx(s))}for(const t of e){const s=Qr.get(t);if(s)for(const a of s)l1(a)}}}finally{vh=!1,Lu.current=[],Ql.clear()}}function xh(r){To++;try{r()}finally{if(To--,To===0){const e=Array.from(vo)[0];e&&hx(e)}}}class cd{constructor(e,t){this.listeners=new Set,this.subscribe=s=>{var a,o;this.listeners.add(s);const u=(o=(a=this.options)==null?void 0:a.onSubscribe)==null?void 0:o.call(a,s,this);return()=>{this.listeners.delete(s),u==null||u()}},this.setState=s=>{var a,o,u;this.prevState=this.state,this.state=(a=this.options)!=null&&a.updateFn?this.options.updateFn(this.prevState)(s):s(this.prevState),(u=(o=this.options)==null?void 0:o.onUpdate)==null||u.call(o),hx(this)},this.prevState=e,this.state=e,this.options=t}}class Wr{constructor(e){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const t=[],s=[];for(const a of this.options.deps)t.push(a.prevState),s.push(a.state);return this.lastSeenDepValues=s,{prevDepVals:t,currDepVals:s,prevVal:this.prevState??void 0}},this.recompute=()=>{var t,s;this.prevState=this.state;const{prevDepVals:a,currDepVals:o,prevVal:u}=this.getDepVals();this.state=this.options.fn({prevDepVals:a,currDepVals:o,prevVal:u}),(s=(t=this.options).onUpdate)==null||s.call(t)},this.checkIfRecalculationNeededDeeply=()=>{for(const o of this.options.deps)o instanceof Wr&&o.checkIfRecalculationNeededDeeply();let t=!1;const s=this.lastSeenDepValues,{currDepVals:a}=this.getDepVals();for(let o=0;o<a.length;o++)if(a[o]!==s[o]){t=!0;break}t&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const t of this._subscriptions)t()}),this.subscribe=t=>{var s,a;this.listeners.add(t);const o=(a=(s=this.options).onSubscribe)==null?void 0:a.call(s,t,this);return()=>{this.listeners.delete(t),o==null||o()}},this.options=e,this.state=e.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(e=this.options.deps){for(const t of e)if(t instanceof Wr)t.registerOnGraph(),this.registerOnGraph(t.options.deps);else if(t instanceof cd){let s=Qr.get(t);s||(s=new Set,Qr.set(t,s)),s.add(this);let a=fu.get(this);a||(a=new Set,fu.set(this,a)),a.add(t)}}unregisterFromGraph(e=this.options.deps){for(const t of e)if(t instanceof Wr)this.unregisterFromGraph(t.options.deps);else if(t instanceof cd){const s=Qr.get(t);s&&s.delete(this);const a=fu.get(this);a&&a.delete(t)}}}function u1(r,e=t=>t){return a1.useSyncExternalStoreWithSelector(r.subscribe,()=>r.state,()=>r.state,e,c1)}function c1(r,e){if(Object.is(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(r instanceof Map&&e instanceof Map){if(r.size!==e.size)return!1;for(const[s,a]of r)if(!e.has(s)||!Object.is(a,e.get(s)))return!1;return!0}if(r instanceof Set&&e instanceof Set){if(r.size!==e.size)return!1;for(const s of r)if(!e.has(s))return!1;return!0}const t=Object.keys(r);if(t.length!==Object.keys(e).length)return!1;for(let s=0;s<t.length;s++)if(!Object.prototype.hasOwnProperty.call(e,t[s])||!Object.is(r[t[s]],e[t[s]]))return!1;return!0}const Sh=fe.createContext(null);function dx(){return typeof document>"u"?Sh:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=Sh,Sh)}function es(r){const e=fe.useContext(dx());return r==null||r.warn,e}function Gt(r){const e=es({warn:(r==null?void 0:r.router)===void 0}),t=(r==null?void 0:r.router)||e,s=fe.useRef(void 0);return u1(t.__store,a=>{if(r!=null&&r.select){if(r.structuralSharing??t.options.defaultStructuralSharing){const o=vi(s.current,r.select(a));return s.current=o,o}return r.select(a)}return a})}const qu=fe.createContext(void 0),f1=fe.createContext(void 0);function Cs(r){const e=fe.useContext(r.from?f1:qu);return Gt({select:s=>{const a=s.matches.find(o=>r.from?r.from===o.routeId:o.id===e);if(Ni(!((r.shouldThrow??!0)&&!a),`Could not find ${r.from?`an active match from "${r.from}"`:"a nearest match!"}`),a!==void 0)return r.select?r.select(a):a},structuralSharing:r.structuralSharing})}function mx(r){return Cs({from:r.from,strict:r.strict,structuralSharing:r.structuralSharing,select:e=>r.select?r.select(e.loaderData):e.loaderData})}function gx(r){const{select:e,...t}=r;return Cs({...t,select:s=>e?e(s.loaderDeps):s.loaderDeps})}function px(r){return Cs({from:r.from,strict:r.strict,shouldThrow:r.shouldThrow,structuralSharing:r.structuralSharing,select:e=>r.select?r.select(e.params):e.params})}function yx(r){return Cs({from:r.from,strict:r.strict,shouldThrow:r.shouldThrow,structuralSharing:r.structuralSharing,select:e=>r.select?r.select(e.search):e.search})}function Si(r){return!!(r!=null&&r.isNotFound)}function h1(r){const e=Gt({select:t=>`not-found-${t.location.pathname}-${t.status}`});return L.jsx(zd,{getResetKey:()=>e,onCatch:(t,s)=>{var a;if(Si(t))(a=r.onCatch)==null||a.call(r,t,s);else throw t},errorComponent:({error:t})=>{var s;if(Si(t))return(s=r.fallback)==null?void 0:s.call(r,t);throw t},children:r.children})}function d1(){return L.jsx("p",{children:"Not Found"})}function Yd(r){const{navigate:e}=es();return fe.useCallback(t=>e({...t}),[e])}let vx=class{constructor(e){this.init=t=>{var s,a;this.originalIndex=t.originalIndex;const o=this.options,u=!(o!=null&&o.path)&&!(o!=null&&o.id);this.parentRoute=(a=(s=this.options).getParentRoute)==null?void 0:a.call(s),u?this._path=qt:Ni(this.parentRoute);let c=u?qt:o.path;c&&c!=="/"&&(c=Vd(c));const h=(o==null?void 0:o.id)||c;let d=u?qt:_s([this.parentRoute.id===qt?"":this.parentRoute.id,h]);c===qt&&(c="/"),d!==qt&&(d=_s(["/",d]));const m=d===qt?"/":_s([this.parentRoute.fullPath,c]);this._path=c,this._id=d,this._fullPath=m,this._to=m,this._ssr=(o==null?void 0:o.ssr)??t.defaultSsr??!0},this.updateLoader=t=>(Object.assign(this.options,t),this),this.update=t=>(Object.assign(this.options,t),this),this.lazy=t=>(this.lazyFn=t,this),this.useMatch=t=>Cs({select:t==null?void 0:t.select,from:this.id,structuralSharing:t==null?void 0:t.structuralSharing}),this.useRouteContext=t=>Cs({...t,from:this.id,select:s=>t!=null&&t.select?t.select(s.context):s.context}),this.useSearch=t=>yx({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.id}),this.useParams=t=>px({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.id}),this.useLoaderDeps=t=>gx({...t,from:this.id}),this.useLoaderData=t=>mx({...t,from:this.id}),this.useNavigate=()=>Yd({from:this.id}),this.options=e||{},this.isRoot=!(e!=null&&e.getParentRoute),Ni(!(e!=null&&e.id&&(e!=null&&e.path))),this.$$typeof=Symbol.for("react.memo")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}get ssr(){return this._ssr}addChildren(e){return this._addFileChildren(e)}_addFileChildren(e){return Array.isArray(e)&&(this.children=e),typeof e=="object"&&e!==null&&(this.children=Object.values(e)),this}};function m1(r){return new vx(r)}class g1 extends vx{constructor(e){super(e)}addChildren(e){return super.addChildren(e),this}_addFileChildren(e){return super._addFileChildren(e),this}_addFileTypes(){return this}}function p1(r){return new g1(r)}function ts(r){return new y1(r,{silent:!0}).createRoute}class y1{constructor(e,t){this.path=e,this.createRoute=s=>{this.silent;const a=m1(s);return a.isRoot=!1,a},this.silent=t==null?void 0:t.silent}}class v1{constructor(e){this.useMatch=t=>Cs({select:t==null?void 0:t.select,from:this.options.id,structuralSharing:t==null?void 0:t.structuralSharing}),this.useRouteContext=t=>Cs({from:this.options.id,select:s=>t!=null&&t.select?t.select(s.context):s.context}),this.useSearch=t=>yx({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.options.id}),this.useParams=t=>px({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.options.id}),this.useLoaderDeps=t=>gx({...t,from:this.options.id}),this.useLoaderData=t=>mx({...t,from:this.options.id}),this.useNavigate=()=>Yd({from:this.options.id}),this.options=e,this.$$typeof=Symbol.for("react.memo")}}function Mw(r){return e=>new v1({id:r,...e})}function Ey(r){if(r.isRedirect=!0,r.statusCode=r.statusCode||r.code||307,r.headers=r.headers||{},!r.reloadDocument){r.reloadDocument=!1;try{new URL(`${r.href}`),r.reloadDocument=!0}catch{}}if(r.throw)throw r;return r}function Bn(r){return!!(r!=null&&r.isRedirect)}function Eh(r){return!!(r!=null&&r.isRedirect)&&r.href}function hu(r){return L.jsx(L.Fragment,{children:r.children})}function xx(r,e,t){return e.options.notFoundComponent?L.jsx(e.options.notFoundComponent,{data:t}):r.options.defaultNotFoundComponent?L.jsx(r.options.defaultNotFoundComponent,{data:t}):L.jsx(d1,{})}var Th,Ty;function x1(){if(Ty)return Th;Ty=1;const r={},e=r.hasOwnProperty,t=(M,D)=>{for(const N in M)e.call(M,N)&&D(N,M[N])},s=(M,D)=>(D&&t(D,(N,P)=>{M[N]=P}),M),a=(M,D)=>{const N=M.length;let P=-1;for(;++P<N;)D(M[P])},o=M=>"\\u"+("0000"+M).slice(-4),u=(M,D)=>{let N=M.toString(16);return D?N:N.toUpperCase()},c=r.toString,h=Array.isArray,d=M=>typeof Buffer=="function"&&Buffer.isBuffer(M),m=M=>c.call(M)=="[object Object]",p=M=>typeof M=="string"||c.call(M)=="[object String]",v=M=>typeof M=="number"||c.call(M)=="[object Number]",x=M=>typeof M=="bigint",S=M=>typeof M=="function",E=M=>c.call(M)=="[object Map]",T=M=>c.call(M)=="[object Set]",A={"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},w=/[\\\b\f\n\r\t]/,C=/[0-9]/,k=/[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,_=/([\uD800-\uDBFF][\uDC00-\uDFFF])|([\uD800-\uDFFF])|(['"`])|[^]/g,U=/([\uD800-\uDBFF][\uDC00-\uDFFF])|([\uD800-\uDFFF])|(['"`])|[^ !#-&\(-\[\]-_a-~]/g,B=(M,D)=>{const N=()=>{oe=$,++D.indentLevel,$=D.indent.repeat(D.indentLevel)},P={escapeEverything:!1,minimal:!1,isScriptContext:!1,quotes:"single",wrap:!1,es6:!1,json:!1,compact:!0,lowercaseHex:!1,numbers:"decimal",indent:"	",indentLevel:0,__inline1__:!1,__inline2__:!1},G=D&&D.json;G&&(P.quotes="double",P.wrap=!0),D=s(P,D),D.quotes!="single"&&D.quotes!="double"&&D.quotes!="backtick"&&(D.quotes="single");const J=D.quotes=="double"?'"':D.quotes=="backtick"?"`":"'",z=D.compact,Q=D.lowercaseHex;let $=D.indent.repeat(D.indentLevel),oe="";const ue=D.__inline1__,Y=D.__inline2__,O=z?"":`
`;let K,te=!0;const ae=D.numbers=="binary",re=D.numbers=="octal",me=D.numbers=="decimal",de=D.numbers=="hexadecimal";if(G&&M&&S(M.toJSON)&&(M=M.toJSON()),!p(M)){if(E(M))return M.size==0?"new Map()":(z||(D.__inline1__=!0,D.__inline2__=!1),"new Map("+B(Array.from(M),D)+")");if(T(M))return M.size==0?"new Set()":"new Set("+B(Array.from(M),D)+")";if(d(M))return M.length==0?"Buffer.from([])":"Buffer.from("+B(Array.from(M),D)+")";if(h(M))return K=[],D.wrap=!0,ue&&(D.__inline1__=!1,D.__inline2__=!0),Y||N(),a(M,pe=>{te=!1,Y&&(D.__inline2__=!1),K.push((z||Y?"":$)+B(pe,D))}),te?"[]":Y?"["+K.join(", ")+"]":"["+O+K.join(","+O)+O+(z?"":oe)+"]";if(v(M)||x(M)){if(G)return JSON.stringify(Number(M));let pe;if(me)pe=String(M);else if(de){let Le=M.toString(16);Q||(Le=Le.toUpperCase()),pe="0x"+Le}else ae?pe="0b"+M.toString(2):re&&(pe="0o"+M.toString(8));return x(M)?pe+"n":pe}else return x(M)?G?JSON.stringify(Number(M)):M+"n":m(M)?(K=[],D.wrap=!0,N(),t(M,(pe,Le)=>{te=!1,K.push((z?"":$)+B(pe,D)+":"+(z?"":" ")+B(Le,D))}),te?"{}":"{"+O+K.join(","+O)+O+(z?"":oe)+"}"):G?JSON.stringify(M)||"null":String(M)}const _e=D.escapeEverything?_:U;return K=M.replace(_e,(pe,Le,Ne,ut,si,_t)=>{if(Le){if(D.minimal)return Le;const gt=Le.charCodeAt(0),Je=Le.charCodeAt(1);if(D.es6){const Ai=(gt-55296)*1024+Je-56320+65536;return"\\u{"+u(Ai,Q)+"}"}return o(u(gt,Q))+o(u(Je,Q))}if(Ne)return o(u(Ne.charCodeAt(0),Q));if(pe=="\0"&&!G&&!C.test(_t.charAt(si+1)))return"\\0";if(ut)return ut==J||D.escapeEverything?"\\"+ut:ut;if(w.test(pe))return A[pe];if(D.minimal&&!k.test(pe))return pe;const et=u(pe.charCodeAt(0),Q);return G||et.length>2?o(et):"\\x"+("00"+et).slice(-2)}),J=="`"&&(K=K.replace(/\$\{/g,"\\${")),D.isScriptContext&&(K=K.replace(/<\/(script|style)/gi,"<\\/$1").replace(/<!--/g,G?"\\u003C!--":"\\x3C!--")),D.wrap&&(K=J+K+J),K};return B.version="3.0.2",Th=B,Th}x1();function S1({children:r,log:e}){return typeof document<"u"?null:L.jsx("script",{className:"tsr-once",dangerouslySetInnerHTML:{__html:[r,"",'if (typeof __TSR_SSR__ !== "undefined") __TSR_SSR__.cleanScripts()'].filter(Boolean).join(`
`)}})}const _u="tsr-scroll-restoration-v1_3",E1=typeof window<"u"&&window.sessionStorage,T1=(r,e)=>{let t;return(...s)=>{t||(t=setTimeout(()=>{r(...s),t=null},e))}},Kr=E1?{state:JSON.parse(window.sessionStorage.getItem(_u)||"null")||{},set:e=>(Kr.state=Hn(e,Kr.state)||Kr.state,window.sessionStorage.setItem(_u,JSON.stringify(Kr.state)))}:void 0,fd=r=>r.state.key||r.href;function b1(r){const e=[];let t;for(;t=r.parentNode;)e.unshift(`${r.tagName}:nth-child(${[].indexOf.call(t.children,r)+1})`),r=t;return`${e.join(" > ")}`.toLowerCase()}let Du=!1;function Sx(r,e,t,s,a){var o;let u;try{u=JSON.parse(sessionStorage.getItem(r)||"{}")}catch(d){console.error(d);return}const c=e||((o=window.history.state)==null?void 0:o.key),h=u[c];Du=!0,(()=>{if(s&&h){for(const m in h){const p=h[m];if(m==="window")window.scrollTo({top:p.scrollY,left:p.scrollX,behavior:t});else if(m){const v=document.querySelector(m);v&&(v.scrollLeft=p.scrollX,v.scrollTop=p.scrollY)}}return}const d=window.location.hash.split("#")[1];if(d){const m=(window.history.state||{}).__hashScrollIntoViewOptions??!0;if(m){const p=document.getElementById(d);p&&p.scrollIntoView(m)}return}["window",...(a==null?void 0:a.filter(m=>m!=="window"))??[]].forEach(m=>{const p=m==="window"?window:document.querySelector(m);p&&p.scrollTo({top:0,left:0,behavior:t})})})(),Du=!1}function A1(r,e){if((r.options.scrollRestoration??!1)&&(r.isScrollRestoring=!0),typeof document>"u"||r.isScrollRestorationSetup)return;r.isScrollRestorationSetup=!0,Du=!1;const s=r.options.getScrollRestorationKey||fd;window.history.scrollRestoration="manual";const a=o=>{if(Du||!r.isScrollRestoring)return;let u="";if(o.target===document||o.target===window)u="window";else{const h=o.target.getAttribute("data-scroll-restoration-id");h?u=`[data-scroll-restoration-id="${h}"]`:u=b1(o.target)}const c=s(r.state.location);Kr.set(h=>{const d=h[c]=h[c]||{},m=d[u]=d[u]||{};if(u==="window")m.scrollX=window.scrollX||0,m.scrollY=window.scrollY||0;else if(u){const p=document.querySelector(u);p&&(m.scrollX=p.scrollLeft||0,m.scrollY=p.scrollTop||0)}return h})};typeof document<"u"&&document.addEventListener("scroll",T1(a,100),!0),r.subscribe("onRendered",o=>{const u=s(o.toLocation);if(!r.resetNextScroll){r.resetNextScroll=!0;return}Sx(_u,u,r.options.scrollRestorationBehavior,r.isScrollRestoring,r.options.scrollToTopSelectors),r.isScrollRestoring&&Kr.set(c=>(c[u]=c[u]||{},c))})}function R1(){const r=es(),t=(r.options.getScrollRestorationKey||fd)(r.latestLocation),s=t!==fd(r.latestLocation)?t:null;return!r.isScrollRestoring||!r.isServer?null:L.jsx(S1,{children:`(${Sx.toString()})(${JSON.stringify(_u)},${JSON.stringify(s)}, undefined, true)`,log:!1})}const Ex=fe.memo(function({matchId:e}){var t,s;const a=es(),o=Gt({select:A=>{var w;return(w=A.matches.find(C=>C.id===e))==null?void 0:w.routeId}});Ni(o);const u=a.routesById[o],c=u.options.pendingComponent??a.options.defaultPendingComponent,h=c?L.jsx(c,{}):null,d=u.options.errorComponent??a.options.defaultErrorComponent,m=u.options.onCatch??a.options.defaultOnCatch,p=u.isRoot?u.options.notFoundComponent??((t=a.options.notFoundRoute)==null?void 0:t.options.component):u.options.notFoundComponent,v=(!u.isRoot||u.options.wrapInSuspense)&&(u.options.wrapInSuspense??c??((s=u.options.errorComponent)==null?void 0:s.preload))?fe.Suspense:hu,x=d?zd:hu,S=p?h1:hu,E=Gt({select:A=>A.loadedAt}),T=Gt({select:A=>{var w;const C=A.matches.findIndex(k=>k.id===e);return(w=A.matches[C-1])==null?void 0:w.routeId}});return L.jsxs(L.Fragment,{children:[L.jsx(qu.Provider,{value:e,children:L.jsx(v,{fallback:h,children:L.jsx(x,{getResetKey:()=>E,errorComponent:d||Yu,onCatch:(A,w)=>{if(Si(A))throw A;m==null||m(A,w)},children:L.jsx(S,{fallback:A=>{if(!p||A.routeId&&A.routeId!==o||!A.routeId&&!u.isRoot)throw A;return fe.createElement(p,A)},children:L.jsx(_1,{matchId:e})})})})}),T===qt&&a.options.scrollRestoration?L.jsxs(L.Fragment,{children:[L.jsx(L1,{}),L.jsx(R1,{})]}):null]})});function L1(){var r;const e=es(),t=fe.useRef(void 0);return L.jsx("script",{suppressHydrationWarning:!0,ref:s=>{s?e.emit({type:"onRendered",...qr(e.state)}):t.current=e.state.resolvedLocation}},(r=e.state.resolvedLocation)==null?void 0:r.state.key)}const _1=fe.memo(function({matchId:e}){var t,s,a;const o=es(),{match:u,key:c,routeId:h}=Gt({select:v=>{const x=v.matches.findIndex(C=>C.id===e),S=v.matches[x],E=S.routeId,T=o.routesById[E].options.remountDeps??o.options.defaultRemountDeps,A=T==null?void 0:T({routeId:E,loaderDeps:S.loaderDeps,params:S._strictParams,search:S._strictSearch});return{key:A?JSON.stringify(A):void 0,routeId:E,match:ld(S,["id","status","error"])}},structuralSharing:!0}),d=o.routesById[h],m=fe.useMemo(()=>{const v=d.options.component??o.options.defaultComponent;return v?L.jsx(v,{},c):L.jsx(Tx,{})},[c,d.options.component,o.options.defaultComponent]),p=(d.options.errorComponent??o.options.defaultErrorComponent)||Yu;if(u.status==="notFound")return Ni(Si(u.error)),xx(o,d,u.error);if(u.status==="redirected")throw Ni(Bn(u.error)),(t=o.getMatch(u.id))==null?void 0:t.loadPromise;if(u.status==="error"){if(o.isServer)return L.jsx(p,{error:u.error,reset:void 0,info:{componentStack:""}});throw u.error}if(u.status==="pending"){const v=d.options.pendingMinMs??o.options.defaultPendingMinMs;if(v&&!((s=o.getMatch(u.id))!=null&&s.minPendingPromise)&&!o.isServer){const x=Vr();Promise.resolve().then(()=>{o.updateMatch(u.id,S=>({...S,minPendingPromise:x}))}),setTimeout(()=>{x.resolve(),o.updateMatch(u.id,S=>({...S,minPendingPromise:void 0}))},v)}throw(a=o.getMatch(u.id))==null?void 0:a.loadPromise}return m}),Tx=fe.memo(function(){const e=es(),t=fe.useContext(qu),s=Gt({select:d=>{var m;return(m=d.matches.find(p=>p.id===t))==null?void 0:m.routeId}}),a=e.routesById[s],o=Gt({select:d=>{const p=d.matches.find(v=>v.id===t);return Ni(p),p.globalNotFound}}),u=Gt({select:d=>{var m;const p=d.matches,v=p.findIndex(x=>x.id===t);return(m=p[v+1])==null?void 0:m.id}});if(o)return xx(e,a,void 0);if(!u)return null;const c=L.jsx(Ex,{matchId:u}),h=e.options.defaultPendingComponent?L.jsx(e.options.defaultPendingComponent,{}):null;return t===qt?L.jsx(fe.Suspense,{fallback:h,children:c}):c});var D1=ux();const xo=typeof window<"u"?fe.useLayoutEffect:fe.useEffect;function bh(r){const e=fe.useRef({value:r,prev:null}),t=e.current.value;return r!==t&&(e.current={value:r,prev:t}),e.current.prev}function C1(r,e,t={},s={}){const a=fe.useRef(typeof IntersectionObserver=="function"),o=fe.useRef(null);return fe.useEffect(()=>{if(!(!r.current||!a.current||s.disabled))return o.current=new IntersectionObserver(([u])=>{e(u)},t),o.current.observe(r.current),()=>{var u;(u=o.current)==null||u.disconnect()}},[e,t,s.disabled,r]),o.current}function w1(r){const e=fe.useRef(null);return fe.useImperativeHandle(r,()=>e.current,[]),e}function O1(r,e){const t=es(),[s,a]=fe.useState(!1),o=fe.useRef(!1),u=w1(e),{activeProps:c=()=>({className:"active"}),inactiveProps:h=()=>({}),activeOptions:d,to:m,preload:p,preloadDelay:v,hashScrollIntoView:x,replace:S,startTransition:E,resetScroll:T,viewTransition:A,children:w,target:C,disabled:k,style:_,className:U,onClick:B,onFocus:M,onMouseEnter:D,onMouseLeave:N,onTouchStart:P,ignoreBlocker:G,...J}=r,{params:z,search:Q,hash:$,state:oe,mask:ue,reloadDocument:Y,...O}=J,K=fe.useMemo(()=>{try{return new URL(`${m}`),"external"}catch{}return"internal"},[m]),te=Gt({select:$e=>$e.location.search,structuralSharing:!0});r={from:Cs({strict:!1,select:$e=>$e.pathname}),...r};const re=fe.useMemo(()=>t.buildLocation(r),[t,r,te]),me=fe.useMemo(()=>r.reloadDocument?!1:p??t.options.defaultPreload,[t.options.defaultPreload,p,r.reloadDocument]),de=v??t.options.defaultPreloadDelay??0,_e=Gt({select:$e=>{if(d!=null&&d.exact){if(!$b($e.location.pathname,re.pathname,t.basepath))return!1}else{const tt=Au($e.location.pathname,t.basepath).split("/");if(!Au(re.pathname,t.basepath).split("/").every((ni,Ju)=>ni===tt[Ju]))return!1}return((d==null?void 0:d.includeSearch)??!0)&&!Xr($e.location.search,re.search,{partial:!(d!=null&&d.exact),ignoreUndefined:!(d!=null&&d.explicitUndefined)})?!1:d!=null&&d.includeHash?$e.location.hash===re.hash:!0}}),pe=fe.useCallback(()=>{t.preloadRoute(r).catch($e=>{console.warn($e),console.warn(Bb)})},[r,t]),Le=fe.useCallback($e=>{$e!=null&&$e.isIntersecting&&pe()},[pe]);if(C1(u,Le,{rootMargin:"100px"},{disabled:!!k||me!=="viewport"}),xo(()=>{o.current||!k&&me==="render"&&(pe(),o.current=!0)},[k,pe,me]),K==="external")return{...O,ref:u,type:K,href:m,...w&&{children:w},...C&&{target:C},...k&&{disabled:k},..._&&{style:_},...U&&{className:U},...B&&{onClick:B},...M&&{onFocus:M},...D&&{onMouseEnter:D},...N&&{onMouseLeave:N},...P&&{onTouchStart:P}};const Ne=$e=>{if(!k&&!I1($e)&&!$e.defaultPrevented&&(!C||C==="_self")&&$e.button===0){$e.preventDefault(),D1.flushSync(()=>{a(!0)});const tt=t.subscribe("onResolved",()=>{tt(),a(!1)});return t.navigate({...r,replace:S,resetScroll:T,hashScrollIntoView:x,startTransition:E,viewTransition:A,ignoreBlocker:G})}},ut=$e=>{k||me&&pe()},si=ut,_t=$e=>{if(k)return;const tt=$e.target||{};if(me){if(tt.preloadTimeout)return;tt.preloadTimeout=setTimeout(()=>{tt.preloadTimeout=null,pe()},de)}},et=$e=>{if(k)return;const tt=$e.target||{};tt.preloadTimeout&&(clearTimeout(tt.preloadTimeout),tt.preloadTimeout=null)},gt=$e=>tt=>{var is;(is=tt.persist)==null||is.call(tt),$e.filter(Boolean).forEach(No=>{tt.defaultPrevented||No(tt)})},Je=_e?Hn(c,{})??{}:{},Ai=_e?{}:Hn(h,{}),Fi=[U,Je.className,Ai.className].filter(Boolean).join(" "),Os={..._,...Je.style,...Ai.style};return{...O,...Je,...Ai,href:k?void 0:re.maskedLocation?t.history.createHref(re.maskedLocation.href):t.history.createHref(re.href),ref:u,onClick:gt([B,Ne]),onFocus:gt([M,ut]),onMouseEnter:gt([D,_t]),onMouseLeave:gt([N,et]),onTouchStart:gt([P,si]),disabled:!!k,target:C,...Object.keys(Os).length&&{style:Os},...Fi&&{className:Fi},...k&&{role:"link","aria-disabled":!0},..._e&&{"data-status":"active","aria-current":"page"},...s&&{"data-transitioning":"transitioning"}}}const zr=fe.forwardRef((r,e)=>{const{_asChild:t,...s}=r,{type:a,ref:o,...u}=O1(s,e),c=typeof s.children=="function"?s.children({isActive:u["data-status"]==="active"}):s.children;return typeof t>"u"&&delete u.disabled,fe.createElement(t||"a",{...u,ref:o},c)});function I1(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function M1(){const r=es(),e=fe.useRef({router:r,mounted:!1}),t=Gt({select:({isLoading:p})=>p}),[s,a]=fe.useState(!1),o=Gt({select:p=>p.matches.some(v=>v.status==="pending"),structuralSharing:!0}),u=bh(t),c=t||s||o,h=bh(c),d=t||o,m=bh(d);return r.isServer||(r.startReactTransition=p=>{a(!0),fe.startTransition(()=>{p(),a(!1)})}),fe.useEffect(()=>{const p=r.history.subscribe(r.load),v=r.buildLocation({to:r.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return $n(r.latestLocation.href)!==$n(v.href)&&r.commitLocation({...v,replace:!0}),()=>{p()}},[r,r.history]),xo(()=>{if(typeof window<"u"&&r.clientSsr||e.current.router===r&&e.current.mounted)return;e.current={router:r,mounted:!0},(async()=>{try{await r.load()}catch(v){console.error(v)}})()},[r]),xo(()=>{u&&!t&&r.emit({type:"onLoad",...qr(r.state)})},[u,r,t]),xo(()=>{m&&!d&&r.emit({type:"onBeforeRouteMount",...qr(r.state)})},[d,m,r]),xo(()=>{h&&!c&&(r.emit({type:"onResolved",...qr(r.state)}),r.__store.setState(p=>({...p,status:"idle",resolvedLocation:p.location})))},[c,h,r]),null}function k1(){const r=es(),e=r.options.defaultPendingComponent?L.jsx(r.options.defaultPendingComponent,{}):null,t=r.isServer||typeof document<"u"&&r.clientSsr?hu:fe.Suspense,s=L.jsxs(t,{fallback:e,children:[L.jsx(M1,{}),L.jsx(N1,{})]});return r.options.InnerWrap?L.jsx(r.options.InnerWrap,{children:s}):s}function N1(){const r=Gt({select:t=>{var s;return(s=t.matches[0])==null?void 0:s.id}}),e=Gt({select:t=>t.loadedAt});return L.jsx(qu.Provider,{value:r,children:L.jsx(zd,{getResetKey:()=>e,errorComponent:Yu,onCatch:t=>{t.message||t.toString()},children:r?L.jsx(Ex,{matchId:r}):null})})}const bx=["component","errorComponent","pendingComponent","notFoundComponent"];function P1(r){var e;for(const t of bx)if((e=r.options[t])!=null&&e.preload)return!0;return!1}function Ah(r,e){if(r==null)return{};if("~standard"in r){const t=r["~standard"].validate(e);if(t instanceof Promise)throw new Cu("Async validation not supported");if(t.issues)throw new Cu(JSON.stringify(t.issues,void 0,2),{cause:t});return t.value}return"parse"in r?r.parse(e):typeof r=="function"?r(e):{}}function F1(r){return new U1(r)}class U1{constructor(e){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startReactTransition=t=>t(),this.update=t=>{var s;t.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const a=this.options;this.options={...this.options,...t},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(o=>[encodeURIComponent(o),o])):void 0,(!this.basepath||t.basepath&&t.basepath!==a.basepath)&&(t.basepath===void 0||t.basepath===""||t.basepath==="/"?this.basepath="/":this.basepath=`/${Hb(t.basepath)}`),(!this.history||this.options.history&&this.options.history!==this.history)&&(this.history=this.options.history??(this.isServer?e1({initialEntries:[this.basepath||"/"]}):Jb()),this.latestLocation=this.parseLocation()),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),this.__store||(this.__store=new cd(j1(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(o=>!["redirected"].includes(o.status))}}}),A1(this)),typeof window<"u"&&"CSS"in window&&typeof((s=window.CSS)==null?void 0:s.supports)=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.buildRouteTree=()=>{this.routesById={},this.routesByPath={};const t=this.options.notFoundRoute;t&&(t.init({originalIndex:99999999999,defaultSsr:this.options.defaultSsr}),this.routesById[t.id]=t);const s=u=>{u.forEach((c,h)=>{c.init({originalIndex:h,defaultSsr:this.options.defaultSsr});const d=this.routesById[c.id];if(Ni(!d,`Duplicate routes found with id: ${String(c.id)}`),this.routesById[c.id]=c,!c.isRoot&&c.path){const p=$n(c.fullPath);(!this.routesByPath[p]||c.fullPath.endsWith("/"))&&(this.routesByPath[p]=c)}const m=c.children;m!=null&&m.length&&s(m)})};s([this.routeTree]);const a=[];Object.values(this.routesById).forEach((u,c)=>{var h;if(u.isRoot||!u.path)return;const d=Vd(u.fullPath),m=da(d);for(;m.length>1&&((h=m[0])==null?void 0:h.value)==="/";)m.shift();const p=m.map(v=>v.value==="/"?.75:v.type==="param"?.5:v.type==="wildcard"?.25:1);a.push({child:u,trimmed:d,parsed:m,index:c,scores:p})}),this.flatRoutes=a.sort((u,c)=>{const h=Math.min(u.scores.length,c.scores.length);for(let d=0;d<h;d++)if(u.scores[d]!==c.scores[d])return c.scores[d]-u.scores[d];if(u.scores.length!==c.scores.length)return c.scores.length-u.scores.length;for(let d=0;d<h;d++)if(u.parsed[d].value!==c.parsed[d].value)return u.parsed[d].value>c.parsed[d].value?1:-1;return u.index-c.index}).map((u,c)=>(u.child.rank=c,u.child))},this.subscribe=(t,s)=>{const a={eventType:t,fn:s};return this.subscribers.add(a),()=>{this.subscribers.delete(a)}},this.emit=t=>{this.subscribers.forEach(s=>{s.eventType===t.type&&s.fn(t)})},this.parseLocation=(t,s)=>{const a=({pathname:h,search:d,hash:m,state:p})=>{const v=this.options.parseSearch(d),x=this.options.stringifySearch(v);return{pathname:h,searchStr:x,search:vi(t==null?void 0:t.search,v),hash:m.split("#").reverse()[0]??"",href:`${h}${x}${m}`,state:vi(t==null?void 0:t.state,p)}},o=a(s??this.history.location),{__tempLocation:u,__tempKey:c}=o.state;if(u&&(!c||c===this.tempLocationKey)){const h=a(u);return h.state.key=o.state.key,delete h.state.__tempLocation,{...h,maskedLocation:o}}return o},this.resolvePathWithBase=(t,s)=>Vb({basepath:this.basepath,base:t,to:zu(s),trailingSlash:this.options.trailingSlash,caseSensitive:this.options.caseSensitive}),this.getMatchedRoutes=(t,s)=>{let a={};const o=$n(t.pathname),u=m=>Xl(this.basepath,o,{to:m.fullPath,caseSensitive:m.options.caseSensitive??this.options.caseSensitive,fuzzy:!0});let c=(s==null?void 0:s.to)!==void 0?this.routesByPath[s.to]:void 0;c?a=u(c):c=this.flatRoutes.find(m=>{const p=u(m);return p?(a=p,!0):!1});let h=c||this.routesById[qt];const d=[h];for(;h.parentRoute;)h=h.parentRoute,d.unshift(h);return{matchedRoutes:d,routeParams:a,foundRoute:c}},this.cancelMatch=t=>{const s=this.getMatch(t);s&&(s.abortController.abort(),clearTimeout(s.pendingTimeout))},this.cancelMatches=()=>{var t;(t=this.state.pendingMatches)==null||t.forEach(s=>{this.cancelMatch(s.id)})},this.buildLocation=t=>{const s=(o={},u)=>{var c,h,d,m,p,v;const x=o._fromLocation?this.matchRoutes(o._fromLocation,{_buildLocation:!0}):this.state.matches,S=o.from!=null?x.find(P=>Xl(this.basepath,$n(P.pathname),{to:o.from,caseSensitive:!1,fuzzy:!1})):void 0,E=(S==null?void 0:S.pathname)||this.latestLocation.pathname;Ni(o.from==null||S!=null,"Could not find match for from: "+o.from);const T=(c=this.state.pendingMatches)!=null&&c.length?(h=Eo(this.state.pendingMatches))==null?void 0:h.search:((d=Eo(x))==null?void 0:d.search)||this.latestLocation.search,A=u==null?void 0:u.matchedRoutes.filter(P=>x.find(G=>G.routeId===P.id));let w;if(o.to){const P=(S==null?void 0:S.fullPath)||this.latestLocation.pathname;w=this.resolvePathWithBase(P,`${o.to}`)}else{const P=this.routesById[(m=A==null?void 0:A.find(G=>{const J=ql({path:G.fullPath,params:(u==null?void 0:u.routeParams)??{},decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath;return _s([this.basepath,J])===E}))==null?void 0:m.id];w=this.resolvePathWithBase(E,(P==null?void 0:P.to)??E)}const C={...(p=Eo(x))==null?void 0:p.params};let k=(o.params??!0)===!0?C:{...C,...Hn(o.params,C)};Object.keys(k).length>0&&(u==null||u.matchedRoutes.map(P=>{var G;return((G=P.options.params)==null?void 0:G.stringify)??P.options.stringifyParams}).filter(Boolean).forEach(P=>{k={...k,...P(k)}})),w=ql({path:w,params:k??{},leaveWildcards:!1,leaveParams:t.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath;let _=T;if(t._includeValidateSearch&&((v=this.options.search)!=null&&v.strict)){let P={};u==null||u.matchedRoutes.forEach(G=>{try{G.options.validateSearch&&(P={...P,...Ah(G.options.validateSearch,{...P,..._})??{}})}catch{}}),_=P}_=(P=>{const G=(u==null?void 0:u.matchedRoutes.reduce((Q,$)=>{var oe;const ue=[];if("search"in $.options)(oe=$.options.search)!=null&&oe.middlewares&&ue.push(...$.options.search.middlewares);else if($.options.preSearchFilters||$.options.postSearchFilters){const Y=({search:O,next:K})=>{let te=O;"preSearchFilters"in $.options&&$.options.preSearchFilters&&(te=$.options.preSearchFilters.reduce((re,me)=>me(re),O));const ae=K(te);return"postSearchFilters"in $.options&&$.options.postSearchFilters?$.options.postSearchFilters.reduce((re,me)=>me(re),ae):ae};ue.push(Y)}if(t._includeValidateSearch&&$.options.validateSearch){const Y=({search:O,next:K})=>{const te=K(O);try{return{...te,...Ah($.options.validateSearch,te)??{}}}catch{return te}};ue.push(Y)}return Q.concat(ue)},[]))??[],J=({search:Q})=>o.search?o.search===!0?Q:Hn(o.search,Q):{};G.push(J);const z=(Q,$)=>{if(Q>=G.length)return $;const oe=G[Q];return oe({search:$,next:Y=>z(Q+1,Y)})};return z(0,P)})(_),_=vi(T,_);const B=this.options.stringifySearch(_),M=o.hash===!0?this.latestLocation.hash:o.hash?Hn(o.hash,this.latestLocation.hash):void 0,D=M?`#${M}`:"";let N=o.state===!0?this.latestLocation.state:o.state?Hn(o.state,this.latestLocation.state):{};return N=vi(this.latestLocation.state,N),{pathname:w,search:_,searchStr:B,state:N,hash:M??"",href:`${w}${B}${D}`,unmaskOnReload:o.unmaskOnReload}},a=(o={},u)=>{var c;const h=s(o);let d=u?s(u):void 0;if(!d){let v={};const x=(c=this.options.routeMasks)==null?void 0:c.find(S=>{const E=Xl(this.basepath,h.pathname,{to:S.from,caseSensitive:!1,fuzzy:!1});return E?(v=E,!0):!1});if(x){const{from:S,...E}=x;u={...ld(t,["from"]),...E,params:v},d=s(u)}}const m=this.getMatchedRoutes(h,o),p=s(o,m);if(d){const v=this.getMatchedRoutes(d,u),x=s(u,v);p.maskedLocation=x}return p};return t.mask?a(t,{...ld(t,["from"]),...t.mask}):a(t)},this.commitLocation=({viewTransition:t,ignoreBlocker:s,...a})=>{const o=()=>{const h=["key","__TSR_index","__hashScrollIntoViewOptions"];h.forEach(m=>{a.state[m]=this.latestLocation.state[m]});const d=Xr(a.state,this.latestLocation.state);return h.forEach(m=>{delete a.state[m]}),d},u=this.latestLocation.href===a.href,c=this.commitLocationPromise;if(this.commitLocationPromise=Vr(()=>{c==null||c.resolve()}),u&&o())this.load();else{let{maskedLocation:h,hashScrollIntoView:d,...m}=a;h&&(m={...h,state:{...h.state,__tempKey:void 0,__tempLocation:{...m,search:m.searchStr,state:{...m.state,__tempKey:void 0,__tempLocation:void 0,key:void 0}}}},(m.unmaskOnReload??this.options.unmaskOnReload??!1)&&(m.state.__tempKey=this.tempLocationKey)),m.state.__hashScrollIntoViewOptions=d??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=t,this.history[a.replace?"replace":"push"](m.href,m.state,{ignoreBlocker:s})}return this.resetNextScroll=a.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:t,resetScroll:s,hashScrollIntoView:a,viewTransition:o,ignoreBlocker:u,href:c,...h}={})=>{if(c){const m=this.history.location.state.__TSR_index,p=Ao(c,{__TSR_index:t?m:m+1});h.to=p.pathname,h.search=this.options.parseSearch(p.search),h.hash=p.hash.slice(1)}const d=this.buildLocation({...h,_includeValidateSearch:!0});return this.commitLocation({...d,viewTransition:o,replace:t,resetScroll:s,hashScrollIntoView:a,ignoreBlocker:u})},this.navigate=({to:t,reloadDocument:s,href:a,...o})=>{if(s){if(!a){const u=this.buildLocation({to:t,...o});a=this.history.createHref(u.href)}o.replace?window.location.replace(a):window.location.href=a;return}return this.buildAndCommitLocation({...o,href:a,to:t})},this.load=async t=>{this.latestLocation=this.parseLocation(this.latestLocation);let s,a,o;for(o=new Promise(u=>{this.startReactTransition(async()=>{var c;try{const h=this.latestLocation,d=this.state.resolvedLocation;this.cancelMatches();let m;xh(()=>{m=this.matchRoutes(h),this.__store.setState(p=>({...p,status:"pending",isLoading:!0,location:h,pendingMatches:m,cachedMatches:p.cachedMatches.filter(v=>!m.find(x=>x.id===v.id))}))}),this.state.redirect||this.emit({type:"onBeforeNavigate",...qr({resolvedLocation:d,location:h})}),this.emit({type:"onBeforeLoad",...qr({resolvedLocation:d,location:h})}),await this.loadMatches({sync:t==null?void 0:t.sync,matches:m,location:h,onReady:async()=>{this.startViewTransition(async()=>{let p,v,x;xh(()=>{this.__store.setState(S=>{const E=S.matches,T=S.pendingMatches||S.matches;return p=E.filter(A=>!T.find(w=>w.id===A.id)),v=T.filter(A=>!E.find(w=>w.id===A.id)),x=E.filter(A=>T.find(w=>w.id===A.id)),{...S,isLoading:!1,loadedAt:Date.now(),matches:T,pendingMatches:void 0,cachedMatches:[...S.cachedMatches,...p.filter(A=>A.status!=="error")]}}),this.clearExpiredCache()}),[[p,"onLeave"],[v,"onEnter"],[x,"onStay"]].forEach(([S,E])=>{S.forEach(T=>{var A,w;(w=(A=this.looseRoutesById[T.routeId].options)[E])==null||w.call(A,T)})})})}})}catch(h){Eh(h)?(s=h,this.isServer||this.navigate({...s,replace:!0,ignoreBlocker:!0})):Si(h)&&(a=h),this.__store.setState(d=>({...d,statusCode:s?s.statusCode:a?404:d.matches.some(m=>m.status==="error")?500:200,redirect:s}))}this.latestLoadPromise===o&&((c=this.commitLocationPromise)==null||c.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),u()})}),this.latestLoadPromise=o,await o;this.latestLoadPromise&&o!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(u=>({...u,statusCode:404}))},this.startViewTransition=t=>{const s=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,s&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let a;typeof s=="object"&&this.isViewTransitionTypesSupported?a={update:t,types:s.types}:a=t,document.startViewTransition(a)}else t()},this.updateMatch=(t,s)=>{var a;let o;const u=(a=this.state.pendingMatches)==null?void 0:a.find(m=>m.id===t),c=this.state.matches.find(m=>m.id===t),h=this.state.cachedMatches.find(m=>m.id===t),d=u?"pendingMatches":c?"matches":h?"cachedMatches":"";return d&&this.__store.setState(m=>{var p;return{...m,[d]:(p=m[d])==null?void 0:p.map(v=>v.id===t?o=s(v):v)}}),o},this.getMatch=t=>[...this.state.cachedMatches,...this.state.pendingMatches??[],...this.state.matches].find(s=>s.id===t),this.loadMatches=async({location:t,matches:s,preload:a,onReady:o,updateMatch:u=this.updateMatch,sync:c})=>{let h,d=!1;const m=async()=>{d||(d=!0,await(o==null?void 0:o()))},p=x=>!!(a&&!this.state.matches.find(S=>S.id===x));!this.isServer&&!this.state.matches.length&&m();const v=(x,S)=>{var E,T,A,w;if(Eh(S)&&!S.reloadDocument)throw S;if(Bn(S)||Si(S)){if(u(x.id,C=>({...C,status:Bn(S)?"redirected":Si(S)?"notFound":"error",isFetching:!1,error:S,beforeLoadPromise:void 0,loaderPromise:void 0})),S.routeId||(S.routeId=x.routeId),(E=x.beforeLoadPromise)==null||E.resolve(),(T=x.loaderPromise)==null||T.resolve(),(A=x.loadPromise)==null||A.resolve(),Bn(S))throw d=!0,S=this.resolveRedirect({...S,_fromLocation:t}),S;if(Si(S))throw this._handleNotFound(s,S,{updateMatch:u}),(w=this.serverSsr)==null||w.onMatchSettled({router:this,match:this.getMatch(x.id)}),S}};try{await new Promise((x,S)=>{(async()=>{var E,T,A;try{const w=(_,U,B)=>{var M,D;const{id:N,routeId:P}=s[_],G=this.looseRoutesById[P];if(U instanceof Promise)throw U;U.routerCode=B,h=h??_,v(this.getMatch(N),U);try{(D=(M=G.options).onError)==null||D.call(M,U)}catch(J){U=J,v(this.getMatch(N),U)}u(N,J=>{var z,Q;return(z=J.beforeLoadPromise)==null||z.resolve(),(Q=J.loadPromise)==null||Q.resolve(),{...J,error:U,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController,beforeLoadPromise:void 0}})};for(const[_,{id:U,routeId:B}]of s.entries()){const M=this.getMatch(U),D=(E=s[_-1])==null?void 0:E.id,N=this.looseRoutesById[B],P=N.options.pendingMs??this.options.defaultPendingMs,G=!!(o&&!this.isServer&&!p(U)&&(N.options.loader||N.options.beforeLoad)&&typeof P=="number"&&P!==1/0&&(N.options.pendingComponent??this.options.defaultPendingComponent));let J=!0;if((M.beforeLoadPromise||M.loaderPromise)&&(G&&setTimeout(()=>{try{m()}catch{}},P),await M.beforeLoadPromise,J=this.getMatch(U).status!=="success"),J){try{u(U,de=>({...de,loadPromise:Vr(()=>{var _e;(_e=de.loadPromise)==null||_e.resolve()}),beforeLoadPromise:Vr()}));const z=new AbortController;let Q;G&&(Q=setTimeout(()=>{try{m()}catch{}},P));const{paramsError:$,searchError:oe}=this.getMatch(U);$&&w(_,$,"PARSE_PARAMS"),oe&&w(_,oe,"VALIDATE_SEARCH");const ue=()=>D?this.getMatch(D).context:this.options.context??{};u(U,de=>({...de,isFetching:"beforeLoad",fetchCount:de.fetchCount+1,abortController:z,pendingTimeout:Q,context:{...ue(),...de.__routeContext}}));const{search:Y,params:O,context:K,cause:te}=this.getMatch(U),ae=p(U),re={search:Y,abortController:z,params:O,preload:ae,context:K,location:t,navigate:de=>this.navigate({...de,_fromLocation:t}),buildLocation:this.buildLocation,cause:ae?"preload":te,matches:s},me=await((A=(T=N.options).beforeLoad)==null?void 0:A.call(T,re))??{};(Bn(me)||Si(me))&&w(_,me,"BEFORE_LOAD"),u(U,de=>({...de,__beforeLoadContext:me,context:{...ue(),...de.__routeContext,...me},abortController:z}))}catch(z){w(_,z,"BEFORE_LOAD")}u(U,z=>{var Q;return(Q=z.beforeLoadPromise)==null||Q.resolve(),{...z,beforeLoadPromise:void 0,isFetching:!1}})}}const C=s.slice(0,h),k=[];C.forEach(({id:_,routeId:U},B)=>{k.push((async()=>{const{loaderPromise:M}=this.getMatch(_);let D=!1,N=!1;if(M){await M;const P=this.getMatch(_);P.error&&v(P,P.error)}else{const P=k[B-1],G=this.looseRoutesById[U],J=()=>{const{params:te,loaderDeps:ae,abortController:re,context:me,cause:de}=this.getMatch(_),_e=p(_);return{params:te,deps:ae,preload:!!_e,parentMatchPromise:P,abortController:re,context:me,location:t,navigate:pe=>this.navigate({...pe,_fromLocation:t}),cause:_e?"preload":de,route:G}},z=Date.now()-this.getMatch(_).updatedAt,Q=p(_),$=Q?G.options.preloadStaleTime??this.options.defaultPreloadStaleTime??3e4:G.options.staleTime??this.options.defaultStaleTime??0,oe=G.options.shouldReload,ue=typeof oe=="function"?oe(J()):oe;u(_,te=>({...te,loaderPromise:Vr(),preload:!!Q&&!this.state.matches.find(ae=>ae.id===_)}));const Y=async()=>{var te,ae,re,me,de,_e,pe,Le,Ne,ut,si;try{const _t=async()=>{const et=this.getMatch(_);et.minPendingPromise&&await et.minPendingPromise};try{this.loadRouteChunk(G),u(_,is=>({...is,isFetching:"loader"}));const et=await((ae=(te=G.options).loader)==null?void 0:ae.call(te,J()));v(this.getMatch(_),et),await G._lazyPromise,await _t();const gt={matches:s,match:this.getMatch(_),params:this.getMatch(_).params,loaderData:et},Je=(me=(re=G.options).head)==null?void 0:me.call(re,gt),Ai=Je==null?void 0:Je.meta,Fi=Je==null?void 0:Je.links,Os=Je==null?void 0:Je.scripts,$e=(_e=(de=G.options).scripts)==null?void 0:_e.call(de,gt),tt=(Le=(pe=G.options).headers)==null?void 0:Le.call(pe,{loaderData:et});u(_,is=>({...is,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),loaderData:et,meta:Ai,links:Fi,headScripts:Os,headers:tt,scripts:$e}))}catch(et){let gt=et;await _t(),v(this.getMatch(_),et);try{(ut=(Ne=G.options).onError)==null||ut.call(Ne,et)}catch(Je){gt=Je,v(this.getMatch(_),Je)}u(_,Je=>({...Je,error:gt,status:"error",isFetching:!1}))}(si=this.serverSsr)==null||si.onMatchSettled({router:this,match:this.getMatch(_)}),await G._componentsPromise}catch(_t){u(_,et=>({...et,loaderPromise:void 0})),v(this.getMatch(_),_t)}},{status:O,invalid:K}=this.getMatch(_);D=O==="success"&&(K||(ue??z>$)),Q&&G.options.preload===!1||(D&&!c?(N=!0,(async()=>{try{await Y();const{loaderPromise:te,loadPromise:ae}=this.getMatch(_);te==null||te.resolve(),ae==null||ae.resolve(),u(_,re=>({...re,loaderPromise:void 0}))}catch(te){Eh(te)&&await this.navigate(te)}})()):(O!=="success"||D&&c)&&await Y())}if(!N){const{loaderPromise:P,loadPromise:G}=this.getMatch(_);P==null||P.resolve(),G==null||G.resolve()}return u(_,P=>({...P,isFetching:N?P.isFetching:!1,loaderPromise:N?P.loaderPromise:void 0,invalid:!1})),this.getMatch(_)})())}),await Promise.all(k),x()}catch(w){S(w)}})()}),await m()}catch(x){if(Bn(x)||Si(x))throw Si(x)&&!a&&await m(),x}return s},this.invalidate=t=>{const s=a=>{var o;return((o=t==null?void 0:t.filter)==null?void 0:o.call(t,a))??!0?{...a,invalid:!0,...a.status==="error"?{status:"pending",error:void 0}:{}}:a};return this.__store.setState(a=>{var o;return{...a,matches:a.matches.map(s),cachedMatches:a.cachedMatches.map(s),pendingMatches:(o=a.pendingMatches)==null?void 0:o.map(s)}}),this.load({sync:t==null?void 0:t.sync})},this.resolveRedirect=t=>{const s=t;return s.href||(s.href=this.buildLocation(s).href),s},this.clearCache=t=>{const s=t==null?void 0:t.filter;s!==void 0?this.__store.setState(a=>({...a,cachedMatches:a.cachedMatches.filter(o=>!s(o))})):this.__store.setState(a=>({...a,cachedMatches:[]}))},this.clearExpiredCache=()=>{const t=s=>{const a=this.looseRoutesById[s.routeId];if(!a.options.loader)return!0;const o=(s.preload?a.options.preloadGcTime??this.options.defaultPreloadGcTime:a.options.gcTime??this.options.defaultGcTime)??5*60*1e3;return!(s.status!=="error"&&Date.now()-s.updatedAt<o)};this.clearCache({filter:t})},this.loadRouteChunk=t=>(t._lazyPromise===void 0&&(t.lazyFn?t._lazyPromise=t.lazyFn().then(s=>{const{id:a,...o}=s.options;Object.assign(t.options,o)}):t._lazyPromise=Promise.resolve()),t._componentsPromise===void 0&&(t._componentsPromise=t._lazyPromise.then(()=>Promise.all(bx.map(async s=>{const a=t.options[s];a!=null&&a.preload&&await a.preload()})))),t._componentsPromise),this.preloadRoute=async t=>{const s=this.buildLocation(t);let a=this.matchRoutes(s,{throwOnError:!0,preload:!0,dest:t});const o=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(c=>c.id)),u=new Set([...o,...this.state.cachedMatches.map(c=>c.id)]);xh(()=>{a.forEach(c=>{u.has(c.id)||this.__store.setState(h=>({...h,cachedMatches:[...h.cachedMatches,c]}))})});try{return a=await this.loadMatches({matches:a,location:s,preload:!0,updateMatch:(c,h)=>{o.has(c)?a=a.map(d=>d.id===c?h(d):d):this.updateMatch(c,h)}}),a}catch(c){if(Bn(c))return c.reloadDocument?void 0:await this.preloadRoute({...c,_fromLocation:s});Si(c)||console.error(c);return}},this.matchRoute=(t,s)=>{const a={...t,to:t.to?this.resolvePathWithBase(t.from||"",t.to):void 0,params:t.params||{},leaveParams:!0},o=this.buildLocation(a);if(s!=null&&s.pending&&this.state.status!=="pending")return!1;const c=((s==null?void 0:s.pending)===void 0?!this.state.isLoading:s.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,h=Xl(this.basepath,c.pathname,{...s,to:o.pathname});return!h||t.params&&!Xr(h,t.params,{partial:!0})?!1:h&&((s==null?void 0:s.includeSearch)??!0)?Xr(c.search,o.search,{partial:!0})?h:!1:h},this._handleNotFound=(t,s,{updateMatch:a=this.updateMatch}={})=>{const o=Object.fromEntries(t.map(h=>[h.routeId,h]));let u=(s.global?this.looseRoutesById[qt]:this.looseRoutesById[s.routeId])||this.looseRoutesById[qt];for(;!u.options.notFoundComponent&&!this.options.defaultNotFoundComponent&&u.id!==qt;)u=u.parentRoute,Ni(u);const c=o[u.id];Ni(c,"Could not find match for route: "+u.id),a(c.id,h=>({...h,status:"notFound",error:s,isFetching:!1})),s.routerCode==="BEFORE_LOAD"&&u.parentRoute&&(s.routeId=u.parentRoute.id,this._handleNotFound(t,s,{updateMatch:a}))},this.hasNotFoundMatch=()=>this.__store.state.matches.some(t=>t.status==="notFound"||t.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...e,caseSensitive:e.caseSensitive??!1,notFoundMode:e.notFoundMode??"fuzzy",stringifySearch:e.stringifySearch??Qb,parseSearch:e.parseSearch??Xb}),typeof document<"u"&&(window.__TSR_ROUTER__=this)}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutes(e,t,s){return typeof e=="string"?this.matchRoutesInternal({pathname:e,search:t},s):this.matchRoutesInternal(e,t)}matchRoutesInternal(e,t){const{foundRoute:s,matchedRoutes:a,routeParams:o}=this.getMatchedRoutes(e,t==null?void 0:t.dest);let u=!1;(s?s.path!=="/"&&o["**"]:$n(e.pathname))&&(this.options.notFoundRoute?a.push(this.options.notFoundRoute):u=!0);const c=(()=>{if(u){if(this.options.notFoundMode!=="root")for(let p=a.length-1;p>=0;p--){const v=a[p];if(v.children)return v.id}return qt}})(),h=a.map(p=>{var v;let x;const S=((v=p.options.params)==null?void 0:v.parse)??p.options.parseParams;if(S)try{const E=S(o);Object.assign(o,E)}catch(E){if(x=new B1(E.message,{cause:E}),t!=null&&t.throwOnError)throw x;return x}}),d=[],m=p=>(p==null?void 0:p.id)?p.context??this.options.context??{}:this.options.context??{};return a.forEach((p,v)=>{var x,S;const E=d[v-1],[T,A,w]=(()=>{const J=(E==null?void 0:E.search)??e.search,z=(E==null?void 0:E._strictSearch)??{};try{const Q=Ah(p.options.validateSearch,{...J})??{};return[{...J,...Q},{...z,...Q},void 0]}catch(Q){let $=Q;if(Q instanceof Cu||($=new Cu(Q.message,{cause:Q})),t!=null&&t.throwOnError)throw $;return[J,{},$]}})(),C=((S=(x=p.options).loaderDeps)==null?void 0:S.call(x,{search:T}))??"",k=C?JSON.stringify(C):"",{usedParams:_,interpolatedPath:U}=ql({path:p.fullPath,params:o,decodeCharMap:this.pathParamsDecodeCharMap}),B=ql({path:p.id,params:o,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath+k,M=this.getMatch(B),D=this.state.matches.find(J=>J.routeId===p.id),N=D?"stay":"enter";let P;if(M)P={...M,cause:N,params:D?vi(D.params,o):o,_strictParams:_,search:vi(D?D.search:M.search,T),_strictSearch:A};else{const J=p.options.loader||p.options.beforeLoad||p.lazyFn||P1(p)?"pending":"success";P={id:B,index:v,routeId:p.id,params:D?vi(D.params,o):o,_strictParams:_,pathname:_s([this.basepath,U]),updatedAt:Date.now(),search:D?vi(D.search,T):T,_strictSearch:A,searchError:void 0,status:J,isFetching:!1,error:void 0,paramsError:h[v],__routeContext:{},__beforeLoadContext:{},context:{},abortController:new AbortController,fetchCount:0,cause:N,loaderDeps:D?vi(D.loaderDeps,C):C,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:p.options.staticData||{},loadPromise:Vr(),fullPath:p.fullPath}}t!=null&&t.preload||(P.globalNotFound=c===p.id),P.searchError=w;const G=m(E);P.context={...G,...P.__routeContext,...P.__beforeLoadContext},d.push(P)}),d.forEach((p,v)=>{var x,S,E,T,A,w,C,k;const _=this.looseRoutesById[p.routeId];if(!this.getMatch(p.id)&&(t==null?void 0:t._buildLocation)!==!0){const B=d[v-1],M=m(B),D={deps:p.loaderDeps,params:p.params,context:M,location:e,navigate:N=>this.navigate({...N,_fromLocation:e}),buildLocation:this.buildLocation,cause:p.cause,abortController:p.abortController,preload:!!p.preload,matches:d};p.__routeContext=((S=(x=_.options).context)==null?void 0:S.call(x,D))??{},p.context={...M,...p.__routeContext,...p.__beforeLoadContext}}if(p.status==="success"){p.headers=(T=(E=_.options).headers)==null?void 0:T.call(E,{loaderData:p.loaderData});const B={matches:d,match:p,params:p.params,loaderData:p.loaderData},M=(w=(A=_.options).head)==null?void 0:w.call(A,B);p.links=M==null?void 0:M.links,p.headScripts=M==null?void 0:M.scripts,p.meta=M==null?void 0:M.meta,p.scripts=(k=(C=_.options).scripts)==null?void 0:k.call(C,B)}}),d}}class Cu extends Error{}class B1 extends Error{}function j1(r){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:r,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function G1({router:r,children:e,...t}){r.update({...r.options,...t,context:{...r.options.context,...t.context}});const s=dx(),a=L.jsx(s.Provider,{value:r,children:e});return r.options.Wrap?L.jsx(r.options.Wrap,{children:a}):a}function H1({router:r,...e}){return L.jsx(G1,{router:r,...e,children:L.jsx(k1,{})})}const $1="modulepreload",V1=function(r){return"/"+r},by={},Xu=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));a=Promise.allSettled(t.map(h=>{if(h=V1(h),h in by)return;by[h]=!0;const d=h.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":$1,d||(p.as="script"),p.crossOrigin="",p.href=h,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((v,x)=>{p.addEventListener("load",v),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return a.then(u=>{for(const c of u||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};var ya=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ir=typeof window>"u"||"Deno"in globalThis;function Ei(){}function K1(r,e){return typeof r=="function"?r(e):r}function hd(r){return typeof r=="number"&&r>=0&&r!==1/0}function Ax(r,e){return Math.max(r+(e||0)-Date.now(),0)}function Zr(r,e){return typeof r=="function"?r(e):r}function Mi(r,e){return typeof r=="function"?r(e):r}function Ay(r,e){const{type:t="all",exact:s,fetchStatus:a,predicate:o,queryKey:u,stale:c}=r;if(u){if(s){if(e.queryHash!==qd(u,e.options))return!1}else if(!Ro(e.queryKey,u))return!1}if(t!=="all"){const h=e.isActive();if(t==="active"&&!h||t==="inactive"&&h)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||a&&a!==e.state.fetchStatus||o&&!o(e))}function Ry(r,e){const{exact:t,status:s,predicate:a,mutationKey:o}=r;if(o){if(!e.options.mutationKey)return!1;if(t){if(sr(e.options.mutationKey)!==sr(o))return!1}else if(!Ro(e.options.mutationKey,o))return!1}return!(s&&e.state.status!==s||a&&!a(e))}function qd(r,e){return((e==null?void 0:e.queryKeyHashFn)||sr)(r)}function sr(r){return JSON.stringify(r,(e,t)=>dd(t)?Object.keys(t).sort().reduce((s,a)=>(s[a]=t[a],s),{}):t)}function Ro(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!Ro(r[t],e[t])):!1}function Rx(r,e){if(r===e)return r;const t=Ly(r)&&Ly(e);if(t||dd(r)&&dd(e)){const s=t?r:Object.keys(r),a=s.length,o=t?e:Object.keys(e),u=o.length,c=t?[]:{};let h=0;for(let d=0;d<u;d++){const m=t?d:o[d];(!t&&s.includes(m)||t)&&r[m]===void 0&&e[m]===void 0?(c[m]=void 0,h++):(c[m]=Rx(r[m],e[m]),c[m]===r[m]&&r[m]!==void 0&&h++)}return a===u&&h===a?r:c}return e}function wu(r,e){if(!e||Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}function Ly(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function dd(r){if(!_y(r))return!1;const e=r.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!_y(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function _y(r){return Object.prototype.toString.call(r)==="[object Object]"}function z1(r){return new Promise(e=>{setTimeout(e,r)})}function md(r,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?Rx(r,e):e}function Y1(r,e,t=0){const s=[...r,e];return t&&s.length>t?s.slice(1):s}function q1(r,e,t=0){const s=[e,...r];return t&&s.length>t?s.slice(0,-1):s}var Xd=Symbol();function Lx(r,e){return!r.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!r.queryFn||r.queryFn===Xd?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}var Kn,rn,ea,Zv,X1=(Zv=class extends ya{constructor(){super();Ee(this,Kn);Ee(this,rn);Ee(this,ea);ge(this,ea,e=>{if(!ir&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){j(this,rn)||this.setEventListener(j(this,ea))}onUnsubscribe(){var e;this.hasListeners()||((e=j(this,rn))==null||e.call(this),ge(this,rn,void 0))}setEventListener(e){var t;ge(this,ea,e),(t=j(this,rn))==null||t.call(this),ge(this,rn,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){j(this,Kn)!==e&&(ge(this,Kn,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof j(this,Kn)=="boolean"?j(this,Kn):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Kn=new WeakMap,rn=new WeakMap,ea=new WeakMap,Zv),Qd=new X1,ta,an,ia,Jv,Q1=(Jv=class extends ya{constructor(){super();Ee(this,ta,!0);Ee(this,an);Ee(this,ia);ge(this,ia,e=>{if(!ir&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}})}onSubscribe(){j(this,an)||this.setEventListener(j(this,ia))}onUnsubscribe(){var e;this.hasListeners()||((e=j(this,an))==null||e.call(this),ge(this,an,void 0))}setEventListener(e){var t;ge(this,ia,e),(t=j(this,an))==null||t.call(this),ge(this,an,e(this.setOnline.bind(this)))}setOnline(e){j(this,ta)!==e&&(ge(this,ta,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return j(this,ta)}},ta=new WeakMap,an=new WeakMap,ia=new WeakMap,Jv),Ou=new Q1;function gd(){let r,e;const t=new Promise((a,o)=>{r=a,e=o});t.status="pending",t.catch(()=>{});function s(a){Object.assign(t,a),delete t.resolve,delete t.reject}return t.resolve=a=>{s({status:"fulfilled",value:a}),r(a)},t.reject=a=>{s({status:"rejected",reason:a}),e(a)},t}function W1(r){return Math.min(1e3*2**r,3e4)}function _x(r){return(r??"online")==="online"?Ou.isOnline():!0}var Dx=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function Rh(r){return r instanceof Dx}function Cx(r){let e=!1,t=0,s=!1,a;const o=gd(),u=E=>{var T;s||(v(new Dx(E)),(T=r.abort)==null||T.call(r))},c=()=>{e=!0},h=()=>{e=!1},d=()=>Qd.isFocused()&&(r.networkMode==="always"||Ou.isOnline())&&r.canRun(),m=()=>_x(r.networkMode)&&r.canRun(),p=E=>{var T;s||(s=!0,(T=r.onSuccess)==null||T.call(r,E),a==null||a(),o.resolve(E))},v=E=>{var T;s||(s=!0,(T=r.onError)==null||T.call(r,E),a==null||a(),o.reject(E))},x=()=>new Promise(E=>{var T;a=A=>{(s||d())&&E(A)},(T=r.onPause)==null||T.call(r)}).then(()=>{var E;a=void 0,s||(E=r.onContinue)==null||E.call(r)}),S=()=>{if(s)return;let E;const T=t===0?r.initialPromise:void 0;try{E=T??r.fn()}catch(A){E=Promise.reject(A)}Promise.resolve(E).then(p).catch(A=>{var U;if(s)return;const w=r.retry??(ir?0:3),C=r.retryDelay??W1,k=typeof C=="function"?C(t,A):C,_=w===!0||typeof w=="number"&&t<w||typeof w=="function"&&w(t,A);if(e||!_){v(A);return}t++,(U=r.onFail)==null||U.call(r,t,A),z1(k).then(()=>d()?void 0:x()).then(()=>{e?v(A):S()})})};return{promise:o,cancel:u,continue:()=>(a==null||a(),o),cancelRetry:c,continueRetry:h,canStart:m,start:()=>(m()?S():x().then(S),o)}}function Z1(){let r=[],e=0,t=c=>{c()},s=c=>{c()},a=c=>setTimeout(c,0);const o=c=>{e?r.push(c):a(()=>{t(c)})},u=()=>{const c=r;r=[],c.length&&a(()=>{s(()=>{c.forEach(h=>{t(h)})})})};return{batch:c=>{let h;e++;try{h=c()}finally{e--,e||u()}return h},batchCalls:c=>(...h)=>{o(()=>{c(...h)})},schedule:o,setNotifyFunction:c=>{t=c},setBatchNotifyFunction:c=>{s=c},setScheduler:c=>{a=c}}}var xt=Z1(),zn,ex,wx=(ex=class{constructor(){Ee(this,zn)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),hd(this.gcTime)&&ge(this,zn,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(ir?1/0:5*60*1e3))}clearGcTimeout(){j(this,zn)&&(clearTimeout(j(this,zn)),ge(this,zn,void 0))}},zn=new WeakMap,ex),sa,na,xi,Yn,Pt,Oo,qn,Oi,Ts,tx,J1=(tx=class extends wx{constructor(e){super();Ee(this,Oi);Ee(this,sa);Ee(this,na);Ee(this,xi);Ee(this,Yn);Ee(this,Pt);Ee(this,Oo);Ee(this,qn);ge(this,qn,!1),ge(this,Oo,e.defaultOptions),this.setOptions(e.options),this.observers=[],ge(this,Yn,e.client),ge(this,xi,j(this,Yn).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,ge(this,sa,eA(this.options)),this.state=e.state??j(this,sa),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=j(this,Pt))==null?void 0:e.promise}setOptions(e){this.options={...j(this,Oo),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&j(this,xi).remove(this)}setData(e,t){const s=md(this.state.data,e,this.options);return Oe(this,Oi,Ts).call(this,{data:s,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),s}setState(e,t){Oe(this,Oi,Ts).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var s,a;const t=(s=j(this,Pt))==null?void 0:s.promise;return(a=j(this,Pt))==null||a.cancel(e),t?t.then(Ei).catch(Ei):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(j(this,sa))}isActive(){return this.observers.some(e=>Mi(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xd||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!Ax(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=j(this,Pt))==null||t.continue()}onOnline(){var t;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=j(this,Pt))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),j(this,xi).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(j(this,Pt)&&(j(this,qn)?j(this,Pt).cancel({revert:!0}):j(this,Pt).cancelRetry()),this.scheduleGc()),j(this,xi).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Oe(this,Oi,Ts).call(this,{type:"invalidate"})}fetch(e,t){var h,d,m;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(j(this,Pt))return j(this,Pt).continueRetry(),j(this,Pt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const p=this.observers.find(v=>v.options.queryFn);p&&this.setOptions(p.options)}const s=new AbortController,a=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(ge(this,qn,!0),s.signal)})},o=()=>{const p=Lx(this.options,t),v={client:j(this,Yn),queryKey:this.queryKey,meta:this.meta};return a(v),ge(this,qn,!1),this.options.persister?this.options.persister(p,v,this):p(v)},u={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:j(this,Yn),state:this.state,fetchFn:o};a(u),(h=this.options.behavior)==null||h.onFetch(u,this),ge(this,na,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=u.fetchOptions)==null?void 0:d.meta))&&Oe(this,Oi,Ts).call(this,{type:"fetch",meta:(m=u.fetchOptions)==null?void 0:m.meta});const c=p=>{var v,x,S,E;Rh(p)&&p.silent||Oe(this,Oi,Ts).call(this,{type:"error",error:p}),Rh(p)||((x=(v=j(this,xi).config).onError)==null||x.call(v,p,this),(E=(S=j(this,xi).config).onSettled)==null||E.call(S,this.state.data,p,this)),this.scheduleGc()};return ge(this,Pt,Cx({initialPromise:t==null?void 0:t.initialPromise,fn:u.fetchFn,abort:s.abort.bind(s),onSuccess:p=>{var v,x,S,E;if(p===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(T){c(T);return}(x=(v=j(this,xi).config).onSuccess)==null||x.call(v,p,this),(E=(S=j(this,xi).config).onSettled)==null||E.call(S,p,this.state.error,this),this.scheduleGc()},onError:c,onFail:(p,v)=>{Oe(this,Oi,Ts).call(this,{type:"failed",failureCount:p,error:v})},onPause:()=>{Oe(this,Oi,Ts).call(this,{type:"pause"})},onContinue:()=>{Oe(this,Oi,Ts).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0})),j(this,Pt).start()}},sa=new WeakMap,na=new WeakMap,xi=new WeakMap,Yn=new WeakMap,Pt=new WeakMap,Oo=new WeakMap,qn=new WeakMap,Oi=new WeakSet,Ts=function(e){const t=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...Ox(s.data,this.options),fetchMeta:e.meta??null};case"success":return{...s,data:e.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return Rh(a)&&a.revert&&j(this,na)?{...j(this,na),fetchStatus:"idle"}:{...s,error:a,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=t(this.state),xt.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),j(this,xi).notify({query:this,type:"updated",action:e})})},tx);function Ox(r,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_x(e.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function eA(r){const e=typeof r.initialData=="function"?r.initialData():r.initialData,t=e!==void 0,s=t?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var Ki,ix,tA=(ix=class extends ya{constructor(e={}){super();Ee(this,Ki);this.config=e,ge(this,Ki,new Map)}build(e,t,s){const a=t.queryKey,o=t.queryHash??qd(a,t);let u=this.get(o);return u||(u=new J1({client:e,queryKey:a,queryHash:o,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(a)}),this.add(u)),u}add(e){j(this,Ki).has(e.queryHash)||(j(this,Ki).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=j(this,Ki).get(e.queryHash);t&&(e.destroy(),t===e&&j(this,Ki).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){xt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return j(this,Ki).get(e)}getAll(){return[...j(this,Ki).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(s=>Ay(t,s))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(s=>Ay(e,s)):t}notify(e){xt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){xt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){xt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ki=new WeakMap,ix),zi,Bt,Xn,Yi,sn,sx,iA=(sx=class extends wx{constructor(e){super();Ee(this,Yi);Ee(this,zi);Ee(this,Bt);Ee(this,Xn);this.mutationId=e.mutationId,ge(this,Bt,e.mutationCache),ge(this,zi,[]),this.state=e.state||Ix(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){j(this,zi).includes(e)||(j(this,zi).push(e),this.clearGcTimeout(),j(this,Bt).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){ge(this,zi,j(this,zi).filter(t=>t!==e)),this.scheduleGc(),j(this,Bt).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){j(this,zi).length||(this.state.status==="pending"?this.scheduleGc():j(this,Bt).remove(this))}continue(){var e;return((e=j(this,Xn))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,o,u,c,h,d,m,p,v,x,S,E,T,A,w,C,k,_,U,B;ge(this,Xn,Cx({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(M,D)=>{Oe(this,Yi,sn).call(this,{type:"failed",failureCount:M,error:D})},onPause:()=>{Oe(this,Yi,sn).call(this,{type:"pause"})},onContinue:()=>{Oe(this,Yi,sn).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>j(this,Bt).canRun(this)}));const t=this.state.status==="pending",s=!j(this,Xn).canStart();try{if(!t){Oe(this,Yi,sn).call(this,{type:"pending",variables:e,isPaused:s}),await((o=(a=j(this,Bt).config).onMutate)==null?void 0:o.call(a,e,this));const D=await((c=(u=this.options).onMutate)==null?void 0:c.call(u,e));D!==this.state.context&&Oe(this,Yi,sn).call(this,{type:"pending",context:D,variables:e,isPaused:s})}const M=await j(this,Xn).start();return await((d=(h=j(this,Bt).config).onSuccess)==null?void 0:d.call(h,M,e,this.state.context,this)),await((p=(m=this.options).onSuccess)==null?void 0:p.call(m,M,e,this.state.context)),await((x=(v=j(this,Bt).config).onSettled)==null?void 0:x.call(v,M,null,this.state.variables,this.state.context,this)),await((E=(S=this.options).onSettled)==null?void 0:E.call(S,M,null,e,this.state.context)),Oe(this,Yi,sn).call(this,{type:"success",data:M}),M}catch(M){try{throw await((A=(T=j(this,Bt).config).onError)==null?void 0:A.call(T,M,e,this.state.context,this)),await((C=(w=this.options).onError)==null?void 0:C.call(w,M,e,this.state.context)),await((_=(k=j(this,Bt).config).onSettled)==null?void 0:_.call(k,void 0,M,this.state.variables,this.state.context,this)),await((B=(U=this.options).onSettled)==null?void 0:B.call(U,void 0,M,e,this.state.context)),M}finally{Oe(this,Yi,sn).call(this,{type:"error",error:M})}}finally{j(this,Bt).runNext(this)}}},zi=new WeakMap,Bt=new WeakMap,Xn=new WeakMap,Yi=new WeakSet,sn=function(e){const t=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),xt.batch(()=>{j(this,zi).forEach(s=>{s.onMutationUpdate(e)}),j(this,Bt).notify({mutation:this,type:"updated",action:e})})},sx);function Ix(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Rs,Ii,Io,nx,sA=(nx=class extends ya{constructor(e={}){super();Ee(this,Rs);Ee(this,Ii);Ee(this,Io);this.config=e,ge(this,Rs,new Set),ge(this,Ii,new Map),ge(this,Io,0)}build(e,t,s){const a=new iA({mutationCache:this,mutationId:++Yl(this,Io)._,options:e.defaultMutationOptions(t),state:s});return this.add(a),a}add(e){j(this,Rs).add(e);const t=Wl(e);if(typeof t=="string"){const s=j(this,Ii).get(t);s?s.push(e):j(this,Ii).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(j(this,Rs).delete(e)){const t=Wl(e);if(typeof t=="string"){const s=j(this,Ii).get(t);if(s)if(s.length>1){const a=s.indexOf(e);a!==-1&&s.splice(a,1)}else s[0]===e&&j(this,Ii).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Wl(e);if(typeof t=="string"){const s=j(this,Ii).get(t),a=s==null?void 0:s.find(o=>o.state.status==="pending");return!a||a===e}else return!0}runNext(e){var s;const t=Wl(e);if(typeof t=="string"){const a=(s=j(this,Ii).get(t))==null?void 0:s.find(o=>o!==e&&o.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){xt.batch(()=>{j(this,Rs).forEach(e=>{this.notify({type:"removed",mutation:e})}),j(this,Rs).clear(),j(this,Ii).clear()})}getAll(){return Array.from(j(this,Rs))}find(e){const t={exact:!0,...e};return this.getAll().find(s=>Ry(t,s))}findAll(e={}){return this.getAll().filter(t=>Ry(e,t))}notify(e){xt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return xt.batch(()=>Promise.all(e.map(t=>t.continue().catch(Ei))))}},Rs=new WeakMap,Ii=new WeakMap,Io=new WeakMap,nx);function Wl(r){var e;return(e=r.options.scope)==null?void 0:e.id}function Dy(r){return{onFetch:(e,t)=>{var m,p,v,x,S;const s=e.options,a=(v=(p=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:p.fetchMore)==null?void 0:v.direction,o=((x=e.state.data)==null?void 0:x.pages)||[],u=((S=e.state.data)==null?void 0:S.pageParams)||[];let c={pages:[],pageParams:[]},h=0;const d=async()=>{let E=!1;const T=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(e.signal.aborted?E=!0:e.signal.addEventListener("abort",()=>{E=!0}),e.signal)})},A=Lx(e.options,e.fetchOptions),w=async(C,k,_)=>{if(E)return Promise.reject();if(k==null&&C.pages.length)return Promise.resolve(C);const U={client:e.client,queryKey:e.queryKey,pageParam:k,direction:_?"backward":"forward",meta:e.options.meta};T(U);const B=await A(U),{maxPages:M}=e.options,D=_?q1:Y1;return{pages:D(C.pages,B,M),pageParams:D(C.pageParams,k,M)}};if(a&&o.length){const C=a==="backward",k=C?nA:Cy,_={pages:o,pageParams:u},U=k(s,_);c=await w(_,U,C)}else{const C=r??o.length;do{const k=h===0?u[0]??s.initialPageParam:Cy(s,c);if(h>0&&k==null)break;c=await w(c,k),h++}while(h<C)}return c};e.options.persister?e.fetchFn=()=>{var E,T;return(T=(E=e.options).persister)==null?void 0:T.call(E,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=d}}}function Cy(r,{pages:e,pageParams:t}){const s=e.length-1;return e.length>0?r.getNextPageParam(e[s],e,t[s],t):void 0}function nA(r,{pages:e,pageParams:t}){var s;return e.length>0?(s=r.getPreviousPageParam)==null?void 0:s.call(r,e[0],e,t[0],t):void 0}var lt,on,ln,ra,aa,un,oa,la,rx,rA=(rx=class{constructor(r={}){Ee(this,lt);Ee(this,on);Ee(this,ln);Ee(this,ra);Ee(this,aa);Ee(this,un);Ee(this,oa);Ee(this,la);ge(this,lt,r.queryCache||new tA),ge(this,on,r.mutationCache||new sA),ge(this,ln,r.defaultOptions||{}),ge(this,ra,new Map),ge(this,aa,new Map),ge(this,un,0)}mount(){Yl(this,un)._++,j(this,un)===1&&(ge(this,oa,Qd.subscribe(async r=>{r&&(await this.resumePausedMutations(),j(this,lt).onFocus())})),ge(this,la,Ou.subscribe(async r=>{r&&(await this.resumePausedMutations(),j(this,lt).onOnline())})))}unmount(){var r,e;Yl(this,un)._--,j(this,un)===0&&((r=j(this,oa))==null||r.call(this),ge(this,oa,void 0),(e=j(this,la))==null||e.call(this),ge(this,la,void 0))}isFetching(r){return j(this,lt).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return j(this,on).findAll({...r,status:"pending"}).length}getQueryData(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=j(this,lt).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(r){const e=this.defaultQueryOptions(r),t=j(this,lt).build(this,e),s=t.state.data;return s===void 0?this.fetchQuery(r):(r.revalidateIfStale&&t.isStaleByTime(Zr(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(r){return j(this,lt).findAll(r).map(({queryKey:e,state:t})=>{const s=t.data;return[e,s]})}setQueryData(r,e,t){const s=this.defaultQueryOptions({queryKey:r}),a=j(this,lt).get(s.queryHash),o=a==null?void 0:a.state.data,u=K1(e,o);if(u!==void 0)return j(this,lt).build(this,s).setData(u,{...t,manual:!0})}setQueriesData(r,e,t){return xt.batch(()=>j(this,lt).findAll(r).map(({queryKey:s})=>[s,this.setQueryData(s,e,t)]))}getQueryState(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=j(this,lt).get(e.queryHash))==null?void 0:t.state}removeQueries(r){const e=j(this,lt);xt.batch(()=>{e.findAll(r).forEach(t=>{e.remove(t)})})}resetQueries(r,e){const t=j(this,lt),s={type:"active",...r};return xt.batch(()=>(t.findAll(r).forEach(a=>{a.reset()}),this.refetchQueries(s,e)))}cancelQueries(r,e={}){const t={revert:!0,...e},s=xt.batch(()=>j(this,lt).findAll(r).map(a=>a.cancel(t)));return Promise.all(s).then(Ei).catch(Ei)}invalidateQueries(r,e={}){return xt.batch(()=>{if(j(this,lt).findAll(r).forEach(s=>{s.invalidate()}),(r==null?void 0:r.refetchType)==="none")return Promise.resolve();const t={...r,type:(r==null?void 0:r.refetchType)??(r==null?void 0:r.type)??"active"};return this.refetchQueries(t,e)})}refetchQueries(r,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},s=xt.batch(()=>j(this,lt).findAll(r).filter(a=>!a.isDisabled()).map(a=>{let o=a.fetch(void 0,t);return t.throwOnError||(o=o.catch(Ei)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(s).then(Ei)}fetchQuery(r){const e=this.defaultQueryOptions(r);e.retry===void 0&&(e.retry=!1);const t=j(this,lt).build(this,e);return t.isStaleByTime(Zr(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Ei).catch(Ei)}fetchInfiniteQuery(r){return r.behavior=Dy(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Ei).catch(Ei)}ensureInfiniteQueryData(r){return r.behavior=Dy(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Ou.isOnline()?j(this,on).resumePausedMutations():Promise.resolve()}getQueryCache(){return j(this,lt)}getMutationCache(){return j(this,on)}getDefaultOptions(){return j(this,ln)}setDefaultOptions(r){ge(this,ln,r)}setQueryDefaults(r,e){j(this,ra).set(sr(r),{queryKey:r,defaultOptions:e})}getQueryDefaults(r){const e=[...j(this,ra).values()],t={};return e.forEach(s=>{Ro(r,s.queryKey)&&Object.assign(t,s.defaultOptions)}),t}setMutationDefaults(r,e){j(this,aa).set(sr(r),{mutationKey:r,defaultOptions:e})}getMutationDefaults(r){const e=[...j(this,aa).values()];let t={};return e.forEach(s=>{Ro(r,s.mutationKey)&&(t={...t,...s.defaultOptions})}),t}defaultQueryOptions(r){if(r._defaulted)return r;const e={...j(this,ln).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return e.queryHash||(e.queryHash=qd(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Xd&&(e.enabled=!1),e}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...j(this,ln).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){j(this,lt).clear(),j(this,on).clear()}},lt=new WeakMap,on=new WeakMap,ln=new WeakMap,ra=new WeakMap,aa=new WeakMap,un=new WeakMap,oa=new WeakMap,la=new WeakMap,rx),zt,Fe,Mo,jt,Qn,ua,cn,qi,ko,ca,fa,Wn,Zn,fn,ha,Ke,So,pd,yd,vd,xd,Sd,Ed,Td,Mx,ax,aA=(ax=class extends ya{constructor(e,t){super();Ee(this,Ke);Ee(this,zt);Ee(this,Fe);Ee(this,Mo);Ee(this,jt);Ee(this,Qn);Ee(this,ua);Ee(this,cn);Ee(this,qi);Ee(this,ko);Ee(this,ca);Ee(this,fa);Ee(this,Wn);Ee(this,Zn);Ee(this,fn);Ee(this,ha,new Set);this.options=t,ge(this,zt,e),ge(this,qi,null),ge(this,cn,gd()),this.options.experimental_prefetchInRender||j(this,cn).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(j(this,Fe).addObserver(this),wy(j(this,Fe),this.options)?Oe(this,Ke,So).call(this):this.updateResult(),Oe(this,Ke,xd).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return bd(j(this,Fe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return bd(j(this,Fe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Oe(this,Ke,Sd).call(this),Oe(this,Ke,Ed).call(this),j(this,Fe).removeObserver(this)}setOptions(e,t){const s=this.options,a=j(this,Fe);if(this.options=j(this,zt).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Mi(this.options.enabled,j(this,Fe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Oe(this,Ke,Td).call(this),j(this,Fe).setOptions(this.options),s._defaulted&&!wu(this.options,s)&&j(this,zt).getQueryCache().notify({type:"observerOptionsUpdated",query:j(this,Fe),observer:this});const o=this.hasListeners();o&&Oy(j(this,Fe),a,this.options,s)&&Oe(this,Ke,So).call(this),this.updateResult(t),o&&(j(this,Fe)!==a||Mi(this.options.enabled,j(this,Fe))!==Mi(s.enabled,j(this,Fe))||Zr(this.options.staleTime,j(this,Fe))!==Zr(s.staleTime,j(this,Fe)))&&Oe(this,Ke,pd).call(this);const u=Oe(this,Ke,yd).call(this);o&&(j(this,Fe)!==a||Mi(this.options.enabled,j(this,Fe))!==Mi(s.enabled,j(this,Fe))||u!==j(this,fn))&&Oe(this,Ke,vd).call(this,u)}getOptimisticResult(e){const t=j(this,zt).getQueryCache().build(j(this,zt),e),s=this.createResult(t,e);return lA(this,s)&&(ge(this,jt,s),ge(this,ua,this.options),ge(this,Qn,j(this,Fe).state)),s}getCurrentResult(){return j(this,jt)}trackResult(e,t){const s={};return Object.keys(e).forEach(a=>{Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),t==null||t(a),e[a])})}),s}trackProp(e){j(this,ha).add(e)}getCurrentQuery(){return j(this,Fe)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=j(this,zt).defaultQueryOptions(e),s=j(this,zt).getQueryCache().build(j(this,zt),t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return Oe(this,Ke,So).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),j(this,jt)))}createResult(e,t){var M;const s=j(this,Fe),a=this.options,o=j(this,jt),u=j(this,Qn),c=j(this,ua),d=e!==s?e.state:j(this,Mo),{state:m}=e;let p={...m},v=!1,x;if(t._optimisticResults){const D=this.hasListeners(),N=!D&&wy(e,t),P=D&&Oy(e,s,t,a);(N||P)&&(p={...p,...Ox(m.data,e.options)}),t._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:S,errorUpdatedAt:E,status:T}=p;if(t.select&&p.data!==void 0)if(o&&p.data===(u==null?void 0:u.data)&&t.select===j(this,ko))x=j(this,ca);else try{ge(this,ko,t.select),x=t.select(p.data),x=md(o==null?void 0:o.data,x,t),ge(this,ca,x),ge(this,qi,null)}catch(D){ge(this,qi,D)}else x=p.data;if(t.placeholderData!==void 0&&x===void 0&&T==="pending"){let D;if(o!=null&&o.isPlaceholderData&&t.placeholderData===(c==null?void 0:c.placeholderData))D=o.data;else if(D=typeof t.placeholderData=="function"?t.placeholderData((M=j(this,fa))==null?void 0:M.state.data,j(this,fa)):t.placeholderData,t.select&&D!==void 0)try{D=t.select(D),ge(this,qi,null)}catch(N){ge(this,qi,N)}D!==void 0&&(T="success",x=md(o==null?void 0:o.data,D,t),v=!0)}j(this,qi)&&(S=j(this,qi),x=j(this,ca),E=Date.now(),T="error");const A=p.fetchStatus==="fetching",w=T==="pending",C=T==="error",k=w&&A,_=x!==void 0,B={status:T,fetchStatus:p.fetchStatus,isPending:w,isSuccess:T==="success",isError:C,isInitialLoading:k,isLoading:k,data:x,dataUpdatedAt:p.dataUpdatedAt,error:S,errorUpdatedAt:E,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:A,isRefetching:A&&!w,isLoadingError:C&&!_,isPaused:p.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:C&&_,isStale:Wd(e,t),refetch:this.refetch,promise:j(this,cn)};if(this.options.experimental_prefetchInRender){const D=G=>{B.status==="error"?G.reject(B.error):B.data!==void 0&&G.resolve(B.data)},N=()=>{const G=ge(this,cn,B.promise=gd());D(G)},P=j(this,cn);switch(P.status){case"pending":e.queryHash===s.queryHash&&D(P);break;case"fulfilled":(B.status==="error"||B.data!==P.value)&&N();break;case"rejected":(B.status!=="error"||B.error!==P.reason)&&N();break}}return B}updateResult(e){const t=j(this,jt),s=this.createResult(j(this,Fe),this.options);if(ge(this,Qn,j(this,Fe).state),ge(this,ua,this.options),j(this,Qn).data!==void 0&&ge(this,fa,j(this,Fe)),wu(s,t))return;ge(this,jt,s);const a={},o=()=>{if(!t)return!0;const{notifyOnChangeProps:u}=this.options,c=typeof u=="function"?u():u;if(c==="all"||!c&&!j(this,ha).size)return!0;const h=new Set(c??j(this,ha));return this.options.throwOnError&&h.add("error"),Object.keys(j(this,jt)).some(d=>{const m=d;return j(this,jt)[m]!==t[m]&&h.has(m)})};(e==null?void 0:e.listeners)!==!1&&o()&&(a.listeners=!0),Oe(this,Ke,Mx).call(this,{...a,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Oe(this,Ke,xd).call(this)}},zt=new WeakMap,Fe=new WeakMap,Mo=new WeakMap,jt=new WeakMap,Qn=new WeakMap,ua=new WeakMap,cn=new WeakMap,qi=new WeakMap,ko=new WeakMap,ca=new WeakMap,fa=new WeakMap,Wn=new WeakMap,Zn=new WeakMap,fn=new WeakMap,ha=new WeakMap,Ke=new WeakSet,So=function(e){Oe(this,Ke,Td).call(this);let t=j(this,Fe).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(Ei)),t},pd=function(){Oe(this,Ke,Sd).call(this);const e=Zr(this.options.staleTime,j(this,Fe));if(ir||j(this,jt).isStale||!hd(e))return;const s=Ax(j(this,jt).dataUpdatedAt,e)+1;ge(this,Wn,setTimeout(()=>{j(this,jt).isStale||this.updateResult()},s))},yd=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(j(this,Fe)):this.options.refetchInterval)??!1},vd=function(e){Oe(this,Ke,Ed).call(this),ge(this,fn,e),!(ir||Mi(this.options.enabled,j(this,Fe))===!1||!hd(j(this,fn))||j(this,fn)===0)&&ge(this,Zn,setInterval(()=>{(this.options.refetchIntervalInBackground||Qd.isFocused())&&Oe(this,Ke,So).call(this)},j(this,fn)))},xd=function(){Oe(this,Ke,pd).call(this),Oe(this,Ke,vd).call(this,Oe(this,Ke,yd).call(this))},Sd=function(){j(this,Wn)&&(clearTimeout(j(this,Wn)),ge(this,Wn,void 0))},Ed=function(){j(this,Zn)&&(clearInterval(j(this,Zn)),ge(this,Zn,void 0))},Td=function(){const e=j(this,zt).getQueryCache().build(j(this,zt),this.options);if(e===j(this,Fe))return;const t=j(this,Fe);ge(this,Fe,e),ge(this,Mo,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},Mx=function(e){xt.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(j(this,jt))}),j(this,zt).getQueryCache().notify({query:j(this,Fe),type:"observerResultsUpdated"})})},ax);function oA(r,e){return Mi(e.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&e.retryOnMount===!1)}function wy(r,e){return oA(r,e)||r.state.data!==void 0&&bd(r,e,e.refetchOnMount)}function bd(r,e,t){if(Mi(e.enabled,r)!==!1){const s=typeof t=="function"?t(r):t;return s==="always"||s!==!1&&Wd(r,e)}return!1}function Oy(r,e,t,s){return(r!==e||Mi(s.enabled,r)===!1)&&(!t.suspense||r.state.status!=="error")&&Wd(r,t)}function Wd(r,e){return Mi(e.enabled,r)!==!1&&r.isStaleByTime(Zr(e.staleTime,r))}function lA(r,e){return!wu(r.getCurrentResult(),e)}var hn,dn,Yt,Ls,Ds,du,Ad,ox,uA=(ox=class extends ya{constructor(t,s){super();Ee(this,Ds);Ee(this,hn);Ee(this,dn);Ee(this,Yt);Ee(this,Ls);ge(this,hn,t),this.setOptions(s),this.bindMethods(),Oe(this,Ds,du).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var a;const s=this.options;this.options=j(this,hn).defaultMutationOptions(t),wu(this.options,s)||j(this,hn).getMutationCache().notify({type:"observerOptionsUpdated",mutation:j(this,Yt),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&sr(s.mutationKey)!==sr(this.options.mutationKey)?this.reset():((a=j(this,Yt))==null?void 0:a.state.status)==="pending"&&j(this,Yt).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=j(this,Yt))==null||t.removeObserver(this)}onMutationUpdate(t){Oe(this,Ds,du).call(this),Oe(this,Ds,Ad).call(this,t)}getCurrentResult(){return j(this,dn)}reset(){var t;(t=j(this,Yt))==null||t.removeObserver(this),ge(this,Yt,void 0),Oe(this,Ds,du).call(this),Oe(this,Ds,Ad).call(this)}mutate(t,s){var a;return ge(this,Ls,s),(a=j(this,Yt))==null||a.removeObserver(this),ge(this,Yt,j(this,hn).getMutationCache().build(j(this,hn),this.options)),j(this,Yt).addObserver(this),j(this,Yt).execute(t)}},hn=new WeakMap,dn=new WeakMap,Yt=new WeakMap,Ls=new WeakMap,Ds=new WeakSet,du=function(){var s;const t=((s=j(this,Yt))==null?void 0:s.state)??Ix();ge(this,dn,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Ad=function(t){xt.batch(()=>{var s,a,o,u,c,h,d,m;if(j(this,Ls)&&this.hasListeners()){const p=j(this,dn).variables,v=j(this,dn).context;(t==null?void 0:t.type)==="success"?((a=(s=j(this,Ls)).onSuccess)==null||a.call(s,t.data,p,v),(u=(o=j(this,Ls)).onSettled)==null||u.call(o,t.data,null,p,v)):(t==null?void 0:t.type)==="error"&&((h=(c=j(this,Ls)).onError)==null||h.call(c,t.error,p,v),(m=(d=j(this,Ls)).onSettled)==null||m.call(d,void 0,t.error,p,v))}this.listeners.forEach(p=>{p(j(this,dn))})})},ox),kx=fe.createContext(void 0),Nx=r=>{const e=fe.useContext(kx);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},cA=({client:r,children:e})=>(fe.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),L.jsx(kx.Provider,{value:r,children:e})),Px=fe.createContext(!1),fA=()=>fe.useContext(Px);Px.Provider;function hA(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var dA=fe.createContext(hA()),mA=()=>fe.useContext(dA);function Fx(r,e){return typeof r=="function"?r(...e):!!r}function Rd(){}var gA=(r,e)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(e.isReset()||(r.retryOnMount=!1))},pA=r=>{fe.useEffect(()=>{r.clearReset()},[r])},yA=({result:r,errorResetBoundary:e,throwOnError:t,query:s,suspense:a})=>r.isError&&!e.isReset()&&!r.isFetching&&s&&(a&&r.data===void 0||Fx(t,[r.error,s])),vA=r=>{const e=r.staleTime;r.suspense&&(r.staleTime=typeof e=="function"?(...t)=>Math.max(e(...t),1e3):Math.max(e??1e3,1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},xA=(r,e)=>r.isLoading&&r.isFetching&&!e,SA=(r,e)=>(r==null?void 0:r.suspense)&&e.isPending,Iy=(r,e,t)=>e.fetchOptimistic(r).catch(()=>{t.clearReset()});function EA(r,e,t){var p,v,x,S,E;const s=Nx(),a=fA(),o=mA(),u=s.defaultQueryOptions(r);(v=(p=s.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||v.call(p,u),u._optimisticResults=a?"isRestoring":"optimistic",vA(u),gA(u,o),pA(o);const c=!s.getQueryCache().get(u.queryHash),[h]=fe.useState(()=>new e(s,u)),d=h.getOptimisticResult(u),m=!a&&r.subscribed!==!1;if(fe.useSyncExternalStore(fe.useCallback(T=>{const A=m?h.subscribe(xt.batchCalls(T)):Rd;return h.updateResult(),A},[h,m]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),fe.useEffect(()=>{h.setOptions(u,{listeners:!1})},[u,h]),SA(u,d))throw Iy(u,h,o);if(yA({result:d,errorResetBoundary:o,throwOnError:u.throwOnError,query:s.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw d.error;if((S=(x=s.getDefaultOptions().queries)==null?void 0:x._experimental_afterQuery)==null||S.call(x,u,d),u.experimental_prefetchInRender&&!ir&&xA(d,a)){const T=c?Iy(u,h,o):(E=s.getQueryCache().get(u.queryHash))==null?void 0:E.promise;T==null||T.catch(Rd).finally(()=>{h.updateResult()})}return u.notifyOnChangeProps?d:h.trackResult(d)}function TA(r,e){return EA(r,aA)}function bA(r,e){const t=Nx(),[s]=fe.useState(()=>new uA(t,r));fe.useEffect(()=>{s.setOptions(r)},[s,r]);const a=fe.useSyncExternalStore(fe.useCallback(u=>s.subscribe(xt.batchCalls(u)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),o=fe.useCallback((u,c)=>{s.mutate(u,c).catch(Rd)},[s]);if(a.error&&Fx(s.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}const AA=new rA;var Ux={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},My=Jn.createContext&&Jn.createContext(Ux),RA=["attr","size","title"];function LA(r,e){if(r==null)return{};var t=_A(r,e),s,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(a=0;a<o.length;a++)s=o[a],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(r,s)&&(t[s]=r[s])}return t}function _A(r,e){if(r==null)return{};var t={};for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s)){if(e.indexOf(s)>=0)continue;t[s]=r[s]}return t}function Iu(){return Iu=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},Iu.apply(this,arguments)}function ky(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,s)}return t}function Mu(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ky(Object(t),!0).forEach(function(s){DA(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ky(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}function DA(r,e,t){return e=CA(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function CA(r){var e=wA(r,"string");return typeof e=="symbol"?e:e+""}function wA(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Bx(r){return r&&r.map((e,t)=>Jn.createElement(e.tag,Mu({key:t},e.attr),Bx(e.child)))}function je(r){return e=>Jn.createElement(OA,Iu({attr:Mu({},r.attr)},e),Bx(r.child))}function OA(r){var e=t=>{var{attr:s,size:a,title:o}=r,u=LA(r,RA),c=a||t.size||"1em",h;return t.className&&(h=t.className),r.className&&(h=(h?h+" ":"")+r.className),Jn.createElement("svg",Iu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,u,{className:h,style:Mu(Mu({color:r.color||t.color},t.style),r.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),o&&Jn.createElement("title",null,o),r.children)};return My!==void 0?Jn.createElement(My.Consumer,null,t=>e(t)):e(Ux)}function IA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(r)}function MA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(r)}function kA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(r)}function jx(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(r)}function Gx(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(r)}function NA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(r)}function PA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(r)}function Hx(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(r)}function FA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(r)}function Ny(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(r)}function Zd(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"},child:[]},{tag:"line",attr:{x1:"7",y1:"2",x2:"7",y2:"22"},child:[]},{tag:"line",attr:{x1:"17",y1:"2",x2:"17",y2:"22"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"2",y1:"7",x2:"7",y2:"7"},child:[]},{tag:"line",attr:{x1:"2",y1:"17",x2:"7",y2:"17"},child:[]},{tag:"line",attr:{x1:"17",y1:"17",x2:"22",y2:"17"},child:[]},{tag:"line",attr:{x1:"17",y1:"7",x2:"22",y2:"7"},child:[]}]})(r)}function UA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"},child:[]}]})(r)}function BA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},child:[]}]})(r)}function jA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(r)}function Nw(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(r)}function GA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(r)}function $x(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"},child:[]},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"},child:[]}]})(r)}function Pw(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(r)}function HA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(r)}function $A(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(r)}function VA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(r)}function KA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"19",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"5",cy:"12",r:"1"},child:[]}]})(r)}function zA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 18V5l12-2v13"},child:[]},{tag:"circle",attr:{cx:"6",cy:"18",r:"3"},child:[]},{tag:"circle",attr:{cx:"18",cy:"16",r:"3"},child:[]}]})(r)}function ku(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"},child:[]}]})(r)}function YA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(r)}function qA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(r)}function XA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(r)}function QA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"15",rx:"2",ry:"2"},child:[]},{tag:"polyline",attr:{points:"17 2 12 7 7 2"},child:[]}]})(r)}function WA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"},child:[]},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"},child:[]}]})(r)}function Fw(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(r)}function Uw(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(r)}function Jd(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(r)}function ZA(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"},child:[]},{tag:"polygon",attr:{points:"9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"},child:[]}]})(r)}function JA({text:r="Loading..."}){return L.jsx("main",{className:"fixed inset-0 bg-gradient-to-br from-sky-950 via-blue-900 to-indigo-950 flex flex-col items-center justify-center",children:L.jsxs("div",{className:"flex flex-col items-center gap-6 p-8 bg-white/10 backdrop-blur-sm rounded-lg",children:[L.jsx($x,{className:"w-12 h-12 text-blue-200 animate-spin","aria-hidden":"true"}),L.jsx("h1",{className:"text-2xl font-medium text-white",children:r}),L.jsx("div",{className:"w-48 h-1 bg-blue-950/50 rounded overflow-hidden",children:L.jsx("div",{className:"h-full bg-blue-400/50 animate-progress rounded"})})]})})}const Vx=fe.createContext(null);function eR({children:r}){const[e,t]=fe.useState(null),[s,a]=fe.useState(!0);fe.useEffect(()=>{(async()=>{try{if(localStorage.getItem("hasSession")==="true"){const h=await fetch("/api/v1/auth/me",{credentials:"include"});if(h.ok){const d=await h.json();t(d.user)}else localStorage.removeItem("hasSession")}}catch(c){console.error("Auth check failed:",c),localStorage.removeItem("hasSession")}finally{a(!1)}})()},[]),fe.useEffect(()=>{e?localStorage.setItem("hasSession","true"):localStorage.removeItem("hasSession")},[e]);const o={user:e,setUser:t};return L.jsx(Vx.Provider,{value:o,children:s?L.jsx(JA,{}):r})}const tR="/assets/logo-alt-Y1ljnyPE.png";function iR(){const r=fe.useContext(Vx);if(!r)throw new Error("useAuth must be used within an AuthProvider");return{user:r.user,isAuthenticated:!!r.user,setUser:r.setUser}}const Py=[{to:"/",icon:jA,label:"Home"},{to:"/movies",icon:Zd,label:"Movies"},{to:"/tvshows",icon:QA,label:"TV Shows"},{to:"/music",icon:zA,label:"Music"},{to:"/others",icon:UA,label:"Others"}];function sR(){const[r,e]=fe.useState(!1),t=fe.useRef(null),s=fe.useRef(null),{user:a,setUser:o}=iR(),u=Yd();fe.useEffect(()=>{const d=m=>{r&&t.current&&!t.current.contains(m.target)&&s.current&&!s.current.contains(m.target)&&e(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[r]);const c=()=>e(!r),h=async()=>{try{(await fetch("/api/v1/auth/logout",{method:"POST"})).ok&&(o(null),u({to:"/login",replace:!0}))}catch(d){console.error("Logout failed:",d)}};return L.jsxs(L.Fragment,{children:[L.jsx("div",{className:`fixed inset-0 bg-gradient-to-b from-slate-950/80 to-blue-950/80 backdrop-blur-sm transition-all duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>e(!1),"aria-hidden":"true"}),L.jsxs("nav",{className:"fixed top-0 left-0 right-0 bg-slate-900/95 shadow-lg shadow-blue-900/20 backdrop-blur-sm z-50",children:[L.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:L.jsxs("div",{className:"flex items-center justify-between h-16",children:[L.jsxs("div",{className:"flex items-center gap-8",children:[L.jsxs(zr,{to:"/",className:"flex items-center gap-2 text-white hover:text-blue-300 transition-colors",preload:"intent",children:[L.jsx("img",{src:tR,alt:"Igloo",className:"h-8 w-auto"}),L.jsx("span",{className:"text-xl font-semibold bg-gradient-to-r from-blue-200 to-blue-100 text-transparent bg-clip-text",children:"Igloo"})]}),a&&L.jsx("div",{className:"hidden md:flex items-center gap-1",children:Py.map(({to:d,icon:m,label:p})=>L.jsxs(zr,{to:d,preload:"intent",className:"px-3 py-2 rounded-md text-sm font-medium text-blue-200 hover:text-white hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out flex items-center gap-2 relative group",children:[L.jsx(m,{className:"w-4 h-4","aria-hidden":"true"}),p,L.jsx("span",{className:"absolute inset-x-0 -bottom-px h-px bg-gradient-to-r from-transparent via-blue-500 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"})]},d))})]}),L.jsx("div",{className:"flex items-center gap-2",children:a&&L.jsxs(L.Fragment,{children:[L.jsxs(zr,{to:"/settings",className:"text-blue-200 hover:text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out flex items-center gap-2",children:[L.jsx(YA,{})," Settings"]}),L.jsxs("button",{onClick:h,className:"text-blue-200 hover:text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out flex items-center gap-2",children:[L.jsx(HA,{})," Sign Out"]}),L.jsx("button",{ref:s,type:"button",className:"md:hidden p-2 rounded-md text-blue-200 hover:text-white hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out",onClick:c,"aria-expanded":r,"aria-label":"Toggle mobile menu",children:r?L.jsx(Jd,{className:"w-6 h-6","aria-hidden":"true"}):L.jsx(VA,{className:"w-6 h-6","aria-hidden":"true"})})]})})]})}),a&&L.jsx("div",{ref:t,className:`md:hidden transition-all duration-300 ease-in-out ${r?"max-h-96 opacity-100":"max-h-0 opacity-0 pointer-events-none"}`,children:L.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-slate-900/95 backdrop-blur-sm border-t border-blue-900/20",children:Py.map(({to:d,icon:m,label:p})=>L.jsxs(zr,{to:d,preload:"intent",className:"px-3 py-2 rounded-md text-base font-medium text-blue-200 hover:text-white hover:bg-blue-500/10 transition-colors flex items-center gap-3",onClick:()=>e(!1),children:[L.jsx(m,{className:"w-5 h-5","aria-hidden":"true"}),p]},d))})})]})]})}const Pi=p1({component:()=>L.jsx(cA,{client:AA,children:L.jsxs(eR,{children:[L.jsx(sR,{}),L.jsx(Tx,{})]})}),beforeLoad:({location:r})=>{const e=["/login"].includes(r.pathname),t=localStorage.getItem("hasSession")==="true";if(!t&&!e)throw Ey({to:"/login",search:{redirect:r.pathname}});if(t&&e)throw Ey({to:"/"})}});function Lo(r){return r?r.startsWith("http")?r:`/api/v1${r}`:""}function Kx({movie:r,showPlayButton:e=!0,imgLoading:t}){const s=Lo(r.thumb);return L.jsx(zr,{to:"/movies/$movieID",params:{movieID:r.id.toString()},children:L.jsxs("div",{className:"group relative bg-slate-900/50 backdrop-blur-sm rounded-xl overflow-hidden shadow-lg shadow-blue-900/20 transition-all duration-300 hover:shadow-blue-500/20 hover:scale-[1.02]",children:[L.jsx("img",{src:s,alt:`${r.title}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",loading:t}),L.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent opacity-50"}),L.jsxs("div",{className:"p-4 space-y-4",children:[L.jsxs("div",{children:[L.jsxs("h3",{className:"text-lg font-semibold text-white line-clamp-1 group/title relative",title:r.title,children:[L.jsx("span",{className:"absolute invisible group-hover/title:visible opacity-0 group-hover/title:opacity-100 bottom-full mb-2 left-1/2 -translate-x-1/2 px-2 py-1 bg-slate-800 rounded text-sm whitespace-nowrap transition-all duration-200 z-10 shadow-lg shadow-black/20",children:r.title}),r.title]}),L.jsx("p",{className:"text-sm text-blue-200",children:r.year})]}),e&&L.jsxs("button",{className:"w-full flex items-center justify-center gap-2 py-2 px-4 bg-blue-600/20 hover:bg-blue-600 text-blue-200 hover:text-white rounded-lg transition-colors duration-300",type:"button",children:[L.jsx(ku,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{children:"Play Movie"})]})]})]})})}function nR({error:r,isVisible:e}){return L.jsx("div",{className:"h-10 flex items-center justify-center",role:"alert","aria-live":"polite",children:L.jsxs("div",{className:`flex items-center gap-2 text-red-500 text-sm font-medium bg-red-500/10 px-3 py-2 rounded-md transition-all duration-300 ${e?"opacity-100 transform scale-100":"opacity-0 transform scale-95"} ${r?"":"hidden"}`,children:[L.jsx(IA,{className:"h-4 w-4 flex-shrink-0","aria-hidden":"true"}),L.jsx("span",{children:r})]})})}function rR({size:r="md",className:e=""}){const t={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return L.jsx($x,{className:`text-blue-400 animate-spin ${t[r]} ${e}`,"aria-hidden":"true"})}function aR(){const{data:r,error:e,isError:t,isPending:s}=TA({queryKey:["latest-movies"],queryFn:async()=>{try{const a=await fetch("/api/v1/movies/latest",{credentials:"include"}),o=await a.json();if(!a.ok)throw new Error(`${a.status} - ${o.error?o.error:a.statusText}`);return o.movies}catch(a){throw console.error(a),new Error("a network occured while fetching movies")}}});return L.jsx("section",{className:"py-8",children:L.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[L.jsxs("div",{className:"flex items-center justify-between h-10 mb-6",children:[L.jsx("h2",{className:"text-2xl font-bold text-white",children:"Latest Movies"}),L.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:s&&L.jsx(rR,{})})]}),L.jsx("div",{className:"h-10",children:L.jsx(nR,{error:(e==null?void 0:e.message)||"",isVisible:t})}),L.jsxs("div",{className:"min-h-[200px]",children:[!s&&(r==null?void 0:r.length)===0&&L.jsx("div",{className:"h-full flex items-center justify-center",children:L.jsx("p",{className:"text-blue-200",children:"No movies available"})}),L.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 sm:gap-6",children:s?Array.from({length:12}).map((a,o)=>L.jsx("div",{className:"aspect-[2/3] rounded-xl bg-slate-800/50 animate-pulse"},`placeholder-${o}`)):r==null?void 0:r.map(a=>L.jsx(Kx,{movie:a,imgLoading:"eager"},a.id))})]})]})})}const oR=ts("/")({component:lR});function lR(){return L.jsxs("main",{className:"min-h-screen",children:[L.jsxs("section",{className:"relative h-[60vh] flex items-center justify-center overflow-hidden",children:[L.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900/90 via-slate-900/80 to-slate-900"}),L.jsx("div",{className:"relative z-10 text-center px-4 sm:px-6 lg:px-8",children:L.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[L.jsx(Zd,{className:"w-16 h-16 mx-auto text-blue-400","aria-hidden":"true"}),L.jsx("h1",{className:"text-4xl sm:text-5xl font-bold text-white",children:"Welcome to Igloo"}),L.jsx("p",{className:"text-xl text-blue-200",children:"Your personal media server for movies, TV shows, and more"}),L.jsx("div",{className:"flex justify-center gap-4",children:L.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:[L.jsx(ku,{className:"w-5 h-5","aria-hidden":"true"}),L.jsx("span",{children:"Start Watching"})]})})]})})]}),L.jsx("div",{className:"bg-slate-900",children:L.jsx(aR,{})})]})}const uR=ts("/tvshows/")({component:cR});function cR(){return L.jsx("div",{children:'Hello "/tvshows/"!'})}const fR=ts("/music/")({component:hR});function hR(){return L.jsx("div",{children:'Hello "/music/"!'})}function zx({currentPage:r,totalPages:e,onPageChange:t}){const s=()=>{const a=[];let u=Math.max(1,r-Math.floor(2.5));const c=Math.min(e,u+5-1);c-u+1<5&&(u=Math.max(1,c-5+1));for(let h=u;h<=c;h++)a.push(h);return a};return L.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[L.jsx("button",{onClick:()=>t(r-1),disabled:r===1,className:"p-2 text-sky-200 hover:text-white hover:bg-sky-500/10 rounded-lg disabled:opacity-50 disabled:hover:bg-transparent disabled:cursor-not-allowed transition-colors","aria-label":"Previous page",children:L.jsx(NA,{className:"w-5 h-5"})}),s()[0]>1&&L.jsxs(L.Fragment,{children:[L.jsx("button",{onClick:()=>t(1),className:`px-3 py-1 rounded-lg transition-colors ${r===1?"bg-sky-500 text-white":"text-sky-200 hover:text-white hover:bg-sky-500/10"}`,children:"1"}),s()[0]>2&&L.jsx("span",{className:"text-sky-200",children:"..."})]}),s().map(a=>L.jsx("button",{onClick:()=>t(a),className:`px-3 py-1 rounded-lg transition-colors ${r===a?"bg-sky-500 text-white":"text-sky-200 hover:text-white hover:bg-sky-500/10"}`,children:a},a)),s()[s().length-1]<e&&L.jsxs(L.Fragment,{children:[s()[s().length-1]<e-1&&L.jsx("span",{className:"text-sky-200",children:"..."}),L.jsx("button",{onClick:()=>t(e),className:`px-3 py-1 rounded-lg transition-colors ${r===e?"bg-sky-500 text-white":"text-sky-200 hover:text-white hover:bg-sky-500/10"}`,children:e})]}),L.jsx("button",{onClick:()=>t(r+1),disabled:r===e,className:"p-2 text-sky-200 hover:text-white hover:bg-sky-500/10 rounded-lg disabled:opacity-50 disabled:hover:bg-transparent disabled:cursor-not-allowed transition-colors","aria-label":"Next page",children:L.jsx(PA,{className:"w-5 h-5"})})]})}const Ld=ts("/movies/")({validateSearch:r=>({page:Number((r==null?void 0:r.page)??1),limit:Number((r==null?void 0:r.limit)??24)}),loaderDeps:({search:r})=>r,loader:async({deps:r})=>{const e=await fetch(`/api/v1/movies?page=${r.page}&limit=${r.limit}`,{credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch movies: ${e.statusText}`);return e.json()},component:dR});function dR(){const{movies:r,total_movies:e,current_page:t,total_pages:s}=Ld.useLoaderData(),a=Ld.useNavigate();return L.jsx("main",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900","aria-label":"Movie gallery page",children:L.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[L.jsxs("header",{className:"mb-8",children:[L.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Movies"}),L.jsxs("p",{className:"text-sky-200",role:"status","aria-live":"polite",children:[e," ",e===1?"movie":"movies"," available"]})]}),L.jsx("section",{className:"min-h-[200px]","aria-label":"Movie gallery",children:r.length===0?L.jsx("p",{className:"flex items-center justify-center h-64 text-sky-200",role:"status",children:"No movies available"}):L.jsx("ul",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 sm:gap-6",role:"list",children:r.map(o=>L.jsx("li",{children:L.jsx(Kx,{movie:o,imgLoading:"lazy"})},o.id))})}),s>1&&L.jsx("nav",{className:"mt-8","aria-label":"Movie gallery pagination",children:L.jsx(zx,{currentPage:t,totalPages:s,onPageChange:o=>{window.scrollTo({top:0,behavior:"smooth"}),a({search:u=>({...u,page:o})})}})})]})})}function mR({users:r}){return L.jsxs("table",{className:"w-full",role:"grid",children:[L.jsx("caption",{className:"sr-only",children:"List of system users with their details"}),L.jsx("thead",{children:L.jsxs("tr",{className:"text-left border-b border-sky-200/10",children:[L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Name"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Username"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Email"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Status"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Role"})]})}),L.jsx("tbody",{className:"divide-y divide-sky-200/10",children:r.map(e=>L.jsxs("tr",{className:"hover:bg-sky-500/5 transition-colors",children:[L.jsx("th",{scope:"row",className:"py-4 text-white font-normal",children:e.name}),L.jsx("td",{className:"py-4 text-sky-200",children:e.username}),L.jsx("td",{className:"py-4 text-sky-200",children:L.jsxs("div",{className:"flex items-center gap-2",children:[L.jsx($A,{className:"w-4 h-4","aria-hidden":"true"}),e.email]})}),L.jsx("td",{className:"py-4",children:e.is_active?L.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400",children:[L.jsx(jx,{className:"w-3 h-3","aria-hidden":"true"})," Active"]}):L.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-rose-500/10 text-rose-400",children:[L.jsx(Jd,{className:"w-3 h-3","aria-hidden":"true"})," Inactive"]})}),L.jsx("td",{className:"py-4",children:e.is_admin?L.jsxs("span",{className:"inline-flex items-center gap-1 text-amber-300",children:[L.jsx(qA,{className:"w-4 h-4","aria-hidden":"true"})," Admin"]}):L.jsx("span",{className:"text-sky-200",children:"User"})})]},e.id))})]})}const mu=ts("/settings/users/")({component:gR,validateSearch:r=>({page:Number((r==null?void 0:r.page)??1),limit:Number((r==null?void 0:r.limit)??10)}),loaderDeps:({search:r})=>r,loader:async({deps:r})=>{try{const e=await fetch(`/api/v1/users?page=${r.page}&limit=${r.limit}`,{credentials:"include"}),t=await e.json();if(!e.ok)throw new Error(`${e.status} - ${t.error?t.error:e.statusText}`);return t}catch(e){throw console.error(e),new Error("Failed to fetch users")}}});function gR(){const{users:r,total_pages:e,total_users:t}=mu.useLoaderData(),{page:s,limit:a}=mu.useSearch(),o=mu.useNavigate(),u=c=>{o({search:{page:c,limit:a}})};return L.jsx("main",{className:"container mx-auto px-4 py-8",children:L.jsxs("section",{className:"min-h-[400px] bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 shadow-lg","aria-label":"Users list",children:[L.jsxs("header",{className:"mb-6 flex items-center justify-between",children:[L.jsxs("div",{className:"flex items-center gap-4",children:[L.jsx("h2",{className:"text-2xl font-bold text-white",children:"Users"}),L.jsxs(zr,{to:"/settings/users/create",search:{page:1,limit:10},className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-sky-500/10 rounded-lg hover:bg-sky-500/20 transition-colors",children:[L.jsx(WA,{className:"w-4 h-4","aria-hidden":"true"}),"New User"]})]}),L.jsxs("p",{className:"text-sm text-sky-200",children:["Total users:"," ",L.jsx("span",{className:"text-white font-medium",children:t})]})]}),r.length===0?L.jsx("p",{className:"h-40 flex items-center justify-center text-sky-200",role:"status",children:"No users found"}):L.jsxs(L.Fragment,{children:[L.jsx("div",{className:"overflow-x-auto mb-6",children:L.jsx(mR,{users:r})}),L.jsx(zx,{currentPage:s,totalPages:e,onPageChange:u})]})]})})}function pR(r){const e=["January","February","March","April","May","June","July","August","September","October","November","December"],t=new Date(r).getDate(),s=new Date(r).getFullYear();return`${e[new Date(r).getMonth()]} ${t}, ${s}`}function yR(r){const e=Math.floor(r/60),t=r%60;return`${e}h ${t}m`}function Fy(r){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}function vR({cast:r}){const[e,t]=fe.useState(!1),s=e?r:r.slice(0,6);return L.jsxs("div",{className:"mb-12",children:[L.jsx("h3",{className:"text-lg font-medium text-sky-200 mb-4",children:"Cast"}),L.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:s.map(a=>L.jsxs("div",{className:"text-center",children:[L.jsx("div",{className:"aspect-[2/3] mb-2 rounded-lg bg-slate-800/50 overflow-hidden",children:a.thumb?L.jsx("img",{src:Lo(a.thumb),alt:a.name,className:"w-full h-full object-cover",loading:"lazy"}):L.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-800/50",children:L.jsx("span",{className:"text-sky-200/50",children:"No Image"})})}),L.jsx("div",{className:"text-sm font-medium text-white",children:a.name}),L.jsx("div",{className:"text-xs text-sky-200",children:a.character})]},a.id))}),r.length>6&&L.jsx("div",{className:"flex justify-center mt-6",children:L.jsx("button",{type:"button",onClick:()=>t(!e),className:`inline-flex items-center gap-2 px-4 py-2 bg-slate-800/50 hover:bg-slate-800 
                     text-sky-200 hover:text-sky-100 rounded-lg transition-colors text-sm font-medium`,children:e?L.jsxs(L.Fragment,{children:["Show Less ",L.jsx(Hx,{className:"w-4 h-4","aria-hidden":"true"})]}):L.jsxs(L.Fragment,{children:["Show All Cast (",r.length,")"," ",L.jsx(Gx,{className:"w-4 h-4","aria-hidden":"true"})]})})})]})}function xR({crew:r}){const[e,t]=fe.useState(!1),s=e?r:r.slice(0,6);return L.jsxs("div",{children:[L.jsx("h3",{className:"text-lg font-medium text-sky-200 mb-4",children:"Crew"}),L.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:s.map(a=>L.jsxs("div",{className:"text-center",children:[L.jsx("div",{className:"aspect-[2/3] mb-2 rounded-lg bg-slate-800/50 overflow-hidden",children:a.thumb?L.jsx("img",{src:Lo(a.thumb),alt:a.name,className:"w-full h-full object-cover",loading:"lazy"}):L.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-800/50",children:L.jsx("span",{className:"text-sky-200/50",children:"No Image"})})}),L.jsx("div",{className:"text-sm font-medium text-white",children:a.name}),L.jsx("div",{className:"text-xs text-sky-200",children:a.job})]},a.id))}),r.length>6&&L.jsx("div",{className:"flex justify-center mt-6",children:L.jsx("button",{type:"button",onClick:()=>t(!e),className:`inline-flex items-center gap-2 px-4 py-2 bg-slate-800/50 hover:bg-slate-800 
                     text-sky-200 hover:text-sky-100 rounded-lg transition-colors text-sm font-medium`,children:e?L.jsxs(L.Fragment,{children:["Show Less ",L.jsx(Hx,{className:"w-4 h-4","aria-hidden":"true"})]}):L.jsxs(L.Fragment,{children:["Show All Crew (",r.length,")"," ",L.jsx(Gx,{className:"w-4 h-4","aria-hidden":"true"})]})})})]})}function SR({genres:r}){return L.jsx("div",{className:"flex flex-wrap gap-4 text-sm text-sky-200 mb-6 drop-shadow-lg bg-slate-900/20 backdrop-blur-sm rounded-lg px-4 py-2",children:r.map(e=>L.jsx("span",{className:"px-2 py-0.5 bg-sky-500/10 rounded",children:e.tag},e.id))})}var Lh,Uy;function Yx(){if(Uy)return Lh;Uy=1;var r=function(w){return e(w)&&!t(w)};function e(A){return!!A&&typeof A=="object"}function t(A){var w=Object.prototype.toString.call(A);return w==="[object RegExp]"||w==="[object Date]"||o(A)}var s=typeof Symbol=="function"&&Symbol.for,a=s?Symbol.for("react.element"):60103;function o(A){return A.$$typeof===a}function u(A){return Array.isArray(A)?[]:{}}function c(A,w){return w.clone!==!1&&w.isMergeableObject(A)?E(u(A),A,w):A}function h(A,w,C){return A.concat(w).map(function(k){return c(k,C)})}function d(A,w){if(!w.customMerge)return E;var C=w.customMerge(A);return typeof C=="function"?C:E}function m(A){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(A).filter(function(w){return Object.propertyIsEnumerable.call(A,w)}):[]}function p(A){return Object.keys(A).concat(m(A))}function v(A,w){try{return w in A}catch{return!1}}function x(A,w){return v(A,w)&&!(Object.hasOwnProperty.call(A,w)&&Object.propertyIsEnumerable.call(A,w))}function S(A,w,C){var k={};return C.isMergeableObject(A)&&p(A).forEach(function(_){k[_]=c(A[_],C)}),p(w).forEach(function(_){x(A,_)||(v(A,_)&&C.isMergeableObject(w[_])?k[_]=d(_,C)(A[_],w[_],C):k[_]=c(w[_],C))}),k}function E(A,w,C){C=C||{},C.arrayMerge=C.arrayMerge||h,C.isMergeableObject=C.isMergeableObject||r,C.cloneUnlessOtherwiseSpecified=c;var k=Array.isArray(w),_=Array.isArray(A),U=k===_;return U?k?C.arrayMerge(A,w,C):S(A,w,C):c(w,C)}E.all=function(w,C){if(!Array.isArray(w))throw new Error("first argument should be an array");return w.reduce(function(k,_){return E(k,_,C)},{})};var T=E;return Lh=T,Lh}var By=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function ER(r,e){return!!(r===e||By(r)&&By(e))}function TR(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!ER(r[t],e[t]))return!1;return!0}function bR(r,e){e===void 0&&(e=TR);var t,s=[],a,o=!1;function u(){for(var c=[],h=0;h<arguments.length;h++)c[h]=arguments[h];return o&&t===this&&e(c,s)||(a=r.apply(this,c),o=!0,t=this,s=c),a}return u}const AR=Object.freeze(Object.defineProperty({__proto__:null,default:bR},Symbol.toStringTag,{value:"Module"})),RR=Db(AR);var _h,jy;function qx(){if(jy)return _h;jy=1;var r=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",s=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function a(o,u){if(o===u)return!0;if(o&&u&&typeof o=="object"&&typeof u=="object"){if(o.constructor!==u.constructor)return!1;var c,h,d;if(Array.isArray(o)){if(c=o.length,c!=u.length)return!1;for(h=c;h--!==0;)if(!a(o[h],u[h]))return!1;return!0}var m;if(e&&o instanceof Map&&u instanceof Map){if(o.size!==u.size)return!1;for(m=o.entries();!(h=m.next()).done;)if(!u.has(h.value[0]))return!1;for(m=o.entries();!(h=m.next()).done;)if(!a(h.value[1],u.get(h.value[0])))return!1;return!0}if(t&&o instanceof Set&&u instanceof Set){if(o.size!==u.size)return!1;for(m=o.entries();!(h=m.next()).done;)if(!u.has(h.value[0]))return!1;return!0}if(s&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(u)){if(c=o.length,c!=u.length)return!1;for(h=c;h--!==0;)if(o[h]!==u[h])return!1;return!0}if(o.constructor===RegExp)return o.source===u.source&&o.flags===u.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof u.valueOf=="function")return o.valueOf()===u.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof u.toString=="function")return o.toString()===u.toString();if(d=Object.keys(o),c=d.length,c!==Object.keys(u).length)return!1;for(h=c;h--!==0;)if(!Object.prototype.hasOwnProperty.call(u,d[h]))return!1;if(r&&o instanceof Element)return!1;for(h=c;h--!==0;)if(!((d[h]==="_owner"||d[h]==="__v"||d[h]==="__o")&&o.$$typeof)&&!a(o[d[h]],u[d[h]]))return!1;return!0}return o!==o&&u!==u}return _h=function(u,c){try{return a(u,c)}catch(h){if((h.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw h}},_h}var Dh={exports:{}},Ch,Gy;function LR(){if(Gy)return Ch;Gy=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ch=r,Ch}var wh,Hy;function _R(){if(Hy)return wh;Hy=1;var r=LR();function e(){}function t(){}return t.resetWarningCache=e,wh=function(){function s(u,c,h,d,m,p){if(p!==r){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}s.isRequired=s;function a(){return s}var o={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:a,element:s,elementType:s,instanceOf:a,node:s,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},wh}var $y;function DR(){return $y||($y=1,Dh.exports=_R()()),Dh.exports}var Oh,Vy;function Xx(){if(Vy)return Oh;Vy=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,u=(M,D)=>{for(var N in D)e(M,N,{get:D[N],enumerable:!0})},c=(M,D,N,P)=>{if(D&&typeof D=="object"||typeof D=="function")for(let G of s(D))!o.call(M,G)&&G!==N&&e(M,G,{get:()=>D[G],enumerable:!(P=t(D,G))||P.enumerable});return M},h=(M,D,N)=>(N=M!=null?r(a(M)):{},c(!M||!M.__esModule?e(N,"default",{value:M,enumerable:!0}):N,M)),d=M=>c(e({},"__esModule",{value:!0}),M),m={};u(m,{defaultProps:()=>B,propTypes:()=>_}),Oh=d(m);var p=h(DR());const{string:v,bool:x,number:S,array:E,oneOfType:T,shape:A,object:w,func:C,node:k}=p.default,_={url:T([v,E,w]),playing:x,loop:x,controls:x,volume:S,muted:x,playbackRate:S,width:T([v,S]),height:T([v,S]),style:w,progressInterval:S,playsinline:x,pip:x,stopOnUnmount:x,light:T([x,v,w]),playIcon:k,previewTabIndex:S,previewAriaLabel:v,fallback:k,oEmbedUrl:v,wrapper:T([v,C,A({render:C.isRequired})]),config:A({soundcloud:A({options:w}),youtube:A({playerVars:w,embedOptions:w,onUnstarted:C}),facebook:A({appId:v,version:v,playerId:v,attributes:w}),dailymotion:A({params:w}),vimeo:A({playerOptions:w,title:v}),mux:A({attributes:w,version:v}),file:A({attributes:w,tracks:E,forceVideo:x,forceAudio:x,forceHLS:x,forceSafariHLS:x,forceDisableHls:x,forceDASH:x,forceFLV:x,hlsOptions:w,hlsVersion:v,dashVersion:v,flvVersion:v}),wistia:A({options:w,playerId:v,customControls:E}),mixcloud:A({options:w}),twitch:A({options:w,playerId:v}),vidyard:A({options:w})}),onReady:C,onStart:C,onPlay:C,onPause:C,onBuffer:C,onBufferEnd:C,onEnded:C,onError:C,onDuration:C,onSeek:C,onPlaybackRateChange:C,onPlaybackQualityChange:C,onProgress:C,onClickPreview:C,onEnablePIP:C,onDisablePIP:C},U=()=>{},B={playing:!1,loop:!1,controls:!1,volume:null,muted:!1,playbackRate:1,width:"640px",height:"360px",style:{},progressInterval:1e3,playsinline:!1,pip:!1,stopOnUnmount:!0,light:!1,fallback:null,wrapper:"div",previewTabIndex:0,previewAriaLabel:"",oEmbedUrl:"https://noembed.com/embed?url={url}",config:{soundcloud:{options:{visual:!0,buying:!1,liking:!1,download:!1,sharing:!1,show_comments:!1,show_playcount:!1}},youtube:{playerVars:{playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1},embedOptions:{},onUnstarted:U},facebook:{appId:"1309697205772819",version:"v3.3",playerId:null,attributes:{}},dailymotion:{params:{api:1,"endscreen-enable":!1}},vimeo:{playerOptions:{autopause:!1,byline:!1,portrait:!1,title:!1},title:null},mux:{attributes:{},version:"2"},file:{attributes:{},tracks:[],forceVideo:!1,forceAudio:!1,forceHLS:!1,forceDASH:!1,forceFLV:!1,hlsOptions:{},hlsVersion:"1.1.4",dashVersion:"3.1.3",flvVersion:"1.5.0",forceDisableHls:!1},wistia:{options:{},playerId:null,customControls:null},mixcloud:{options:{hide_cover:1}},twitch:{options:{},playerId:null},vidyard:{options:{}}},onReady:U,onStart:U,onPlay:U,onPause:U,onBuffer:U,onBufferEnd:U,onEnded:U,onError:U,onDuration:U,onSeek:U,onPlaybackRateChange:U,onPlaybackQualityChange:U,onProgress:U,onClickPreview:U,onEnablePIP:U,onDisablePIP:U};return Oh}var Ih,Ky;function CR(){if(Ky)return Ih;Ky=1,Ih=function(a,o,u){var c=document.head||document.getElementsByTagName("head")[0],h=document.createElement("script");typeof o=="function"&&(u=o,o={}),o=o||{},u=u||function(){},h.type=o.type||"text/javascript",h.charset=o.charset||"utf8",h.async="async"in o?!!o.async:!0,h.src=a,o.attrs&&r(h,o.attrs),o.text&&(h.text=""+o.text);var d="onload"in h?e:t;d(h,u),h.onload||e(h,u),c.appendChild(h)};function r(s,a){for(var o in a)s.setAttribute(o,a[o])}function e(s,a){s.onload=function(){this.onerror=this.onload=null,a(null,s)},s.onerror=function(){this.onerror=this.onload=null,a(new Error("Failed to load "+this.src),s)}}function t(s,a){s.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,a(null,s))}}return Ih}var Mh,zy;function Qu(){if(zy)return Mh;zy=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,u=(Y,O)=>{for(var K in O)e(Y,K,{get:O[K],enumerable:!0})},c=(Y,O,K,te)=>{if(O&&typeof O=="object"||typeof O=="function")for(let ae of s(O))!o.call(Y,ae)&&ae!==K&&e(Y,ae,{get:()=>O[ae],enumerable:!(te=t(O,ae))||te.enumerable});return Y},h=(Y,O,K)=>(K=Y!=null?r(a(Y)):{},c(!Y||!Y.__esModule?e(K,"default",{value:Y,enumerable:!0}):K,Y)),d=Y=>c(e({},"__esModule",{value:!0}),Y),m={};u(m,{callPlayer:()=>z,getConfig:()=>G,getSDK:()=>P,isBlobUrl:()=>$,isMediaStream:()=>Q,lazy:()=>S,omit:()=>J,parseEndTime:()=>U,parseStartTime:()=>_,queryString:()=>M,randomString:()=>B,supportsWebKitPresentationMode:()=>oe}),Mh=d(m);var p=h(ws()),v=h(CR()),x=h(Yx());const S=Y=>p.default.lazy(async()=>{const O=await Y();return typeof O.default=="function"?O:O.default}),E=/[?&#](?:start|t)=([0-9hms]+)/,T=/[?&#]end=([0-9hms]+)/,A=/(\d+)(h|m|s)/g,w=/^\d+$/;function C(Y,O){if(Y instanceof Array)return;const K=Y.match(O);if(K){const te=K[1];if(te.match(A))return k(te);if(w.test(te))return parseInt(te)}}function k(Y){let O=0,K=A.exec(Y);for(;K!==null;){const[,te,ae]=K;ae==="h"&&(O+=parseInt(te,10)*60*60),ae==="m"&&(O+=parseInt(te,10)*60),ae==="s"&&(O+=parseInt(te,10)),K=A.exec(Y)}return O}function _(Y){return C(Y,E)}function U(Y){return C(Y,T)}function B(){return Math.random().toString(36).substr(2,5)}function M(Y){return Object.keys(Y).map(O=>`${O}=${Y[O]}`).join("&")}function D(Y){return window[Y]?window[Y]:window.exports&&window.exports[Y]?window.exports[Y]:window.module&&window.module.exports&&window.module.exports[Y]?window.module.exports[Y]:null}const N={},P=function(O,K,te=null,ae=()=>!0,re=v.default){const me=D(K);return me&&ae(me)?Promise.resolve(me):new Promise((de,_e)=>{if(N[O]){N[O].push({resolve:de,reject:_e});return}N[O]=[{resolve:de,reject:_e}];const pe=Le=>{N[O].forEach(Ne=>Ne.resolve(Le))};if(te){const Le=window[te];window[te]=function(){Le&&Le(),pe(D(K))}}re(O,Le=>{Le?(N[O].forEach(Ne=>Ne.reject(Le)),N[O]=null):te||pe(D(K))})})};function G(Y,O){return(0,x.default)(O.config,Y.config)}function J(Y,...O){const K=[].concat(...O),te={},ae=Object.keys(Y);for(const re of ae)K.indexOf(re)===-1&&(te[re]=Y[re]);return te}function z(Y,...O){if(!this.player||!this.player[Y]){let K=`ReactPlayer: ${this.constructor.displayName} player could not call %c${Y}%c – `;return this.player?this.player[Y]||(K+="The method was not available"):K+="The player was not available",console.warn(K,"font-weight: bold",""),null}return this.player[Y](...O)}function Q(Y){return typeof window<"u"&&typeof window.MediaStream<"u"&&Y instanceof window.MediaStream}function $(Y){return/^blob:/.test(Y)}function oe(Y=document.createElement("video")){const O=/iPhone|iPod/.test(navigator.userAgent)===!1;return Y.webkitSupportsPresentationMode&&typeof Y.webkitSetPresentationMode=="function"&&O}function ue(Y){return Y}return Mh}var kh,Yy;function wR(){if(Yy)return kh;Yy=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,u=(C,k,_)=>k in C?e(C,k,{enumerable:!0,configurable:!0,writable:!0,value:_}):C[k]=_,c=(C,k)=>{for(var _ in k)e(C,_,{get:k[_],enumerable:!0})},h=(C,k,_,U)=>{if(k&&typeof k=="object"||typeof k=="function")for(let B of s(k))!o.call(C,B)&&B!==_&&e(C,B,{get:()=>k[B],enumerable:!(U=t(k,B))||U.enumerable});return C},d=(C,k,_)=>(_=C!=null?r(a(C)):{},h(!C||!C.__esModule?e(_,"default",{value:C,enumerable:!0}):_,C)),m=C=>h(e({},"__esModule",{value:!0}),C),p=(C,k,_)=>(u(C,typeof k!="symbol"?k+"":k,_),_),v={};c(v,{default:()=>w}),kh=m(v);var x=d(ws()),S=d(qx()),E=Xx(),T=Qu();const A=5e3;class w extends x.Component{constructor(){super(...arguments),p(this,"mounted",!1),p(this,"isReady",!1),p(this,"isPlaying",!1),p(this,"isLoading",!0),p(this,"loadOnReady",null),p(this,"startOnPlay",!0),p(this,"seekOnPlay",null),p(this,"onDurationCalled",!1),p(this,"handlePlayerMount",k=>{if(this.player){this.progress();return}this.player=k,this.player.load(this.props.url),this.progress()}),p(this,"getInternalPlayer",k=>this.player?this.player[k]:null),p(this,"progress",()=>{if(this.props.url&&this.player&&this.isReady){const k=this.getCurrentTime()||0,_=this.getSecondsLoaded(),U=this.getDuration();if(U){const B={playedSeconds:k,played:k/U};_!==null&&(B.loadedSeconds=_,B.loaded=_/U),(B.playedSeconds!==this.prevPlayed||B.loadedSeconds!==this.prevLoaded)&&this.props.onProgress(B),this.prevPlayed=B.playedSeconds,this.prevLoaded=B.loadedSeconds}}this.progressTimeout=setTimeout(this.progress,this.props.progressFrequency||this.props.progressInterval)}),p(this,"handleReady",()=>{if(!this.mounted)return;this.isReady=!0,this.isLoading=!1;const{onReady:k,playing:_,volume:U,muted:B}=this.props;k(),!B&&U!==null&&this.player.setVolume(U),this.loadOnReady?(this.player.load(this.loadOnReady,!0),this.loadOnReady=null):_&&this.player.play(),this.handleDurationCheck()}),p(this,"handlePlay",()=>{this.isPlaying=!0,this.isLoading=!1;const{onStart:k,onPlay:_,playbackRate:U}=this.props;this.startOnPlay&&(this.player.setPlaybackRate&&U!==1&&this.player.setPlaybackRate(U),k(),this.startOnPlay=!1),_(),this.seekOnPlay&&(this.seekTo(this.seekOnPlay),this.seekOnPlay=null),this.handleDurationCheck()}),p(this,"handlePause",k=>{this.isPlaying=!1,this.isLoading||this.props.onPause(k)}),p(this,"handleEnded",()=>{const{activePlayer:k,loop:_,onEnded:U}=this.props;k.loopOnEnded&&_&&this.seekTo(0),_||(this.isPlaying=!1,U())}),p(this,"handleError",(...k)=>{this.isLoading=!1,this.props.onError(...k)}),p(this,"handleDurationCheck",()=>{clearTimeout(this.durationCheckTimeout);const k=this.getDuration();k?this.onDurationCalled||(this.props.onDuration(k),this.onDurationCalled=!0):this.durationCheckTimeout=setTimeout(this.handleDurationCheck,100)}),p(this,"handleLoaded",()=>{this.isLoading=!1})}componentDidMount(){this.mounted=!0}componentWillUnmount(){clearTimeout(this.progressTimeout),clearTimeout(this.durationCheckTimeout),this.isReady&&this.props.stopOnUnmount&&(this.player.stop(),this.player.disablePIP&&this.player.disablePIP()),this.mounted=!1}componentDidUpdate(k){if(!this.player)return;const{url:_,playing:U,volume:B,muted:M,playbackRate:D,pip:N,loop:P,activePlayer:G,disableDeferredLoading:J}=this.props;if(!(0,S.default)(k.url,_)){if(this.isLoading&&!G.forceLoad&&!J&&!(0,T.isMediaStream)(_)){console.warn(`ReactPlayer: the attempt to load ${_} is being deferred until the player has loaded`),this.loadOnReady=_;return}this.isLoading=!0,this.startOnPlay=!0,this.onDurationCalled=!1,this.player.load(_,this.isReady)}!k.playing&&U&&!this.isPlaying&&this.player.play(),k.playing&&!U&&this.isPlaying&&this.player.pause(),!k.pip&&N&&this.player.enablePIP&&this.player.enablePIP(),k.pip&&!N&&this.player.disablePIP&&this.player.disablePIP(),k.volume!==B&&B!==null&&this.player.setVolume(B),k.muted!==M&&(M?this.player.mute():(this.player.unmute(),B!==null&&setTimeout(()=>this.player.setVolume(B)))),k.playbackRate!==D&&this.player.setPlaybackRate&&this.player.setPlaybackRate(D),k.loop!==P&&this.player.setLoop&&this.player.setLoop(P)}getDuration(){return this.isReady?this.player.getDuration():null}getCurrentTime(){return this.isReady?this.player.getCurrentTime():null}getSecondsLoaded(){return this.isReady?this.player.getSecondsLoaded():null}seekTo(k,_,U){if(!this.isReady){k!==0&&(this.seekOnPlay=k,setTimeout(()=>{this.seekOnPlay=null},A));return}if(_?_==="fraction":k>0&&k<1){const M=this.player.getDuration();if(!M){console.warn("ReactPlayer: could not seek using fraction – duration not yet available");return}this.player.seekTo(M*k,U);return}this.player.seekTo(k,U)}render(){const k=this.props.activePlayer;return k?x.default.createElement(k,{...this.props,onMount:this.handlePlayerMount,onReady:this.handleReady,onPlay:this.handlePlay,onPause:this.handlePause,onEnded:this.handleEnded,onLoaded:this.handleLoaded,onError:this.handleError}):null}}return p(w,"displayName","Player"),p(w,"propTypes",E.propTypes),p(w,"defaultProps",E.defaultProps),kh}var Nh,qy;function OR(){if(qy)return Nh;qy=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,u=(P,G,J)=>G in P?e(P,G,{enumerable:!0,configurable:!0,writable:!0,value:J}):P[G]=J,c=(P,G)=>{for(var J in G)e(P,J,{get:G[J],enumerable:!0})},h=(P,G,J,z)=>{if(G&&typeof G=="object"||typeof G=="function")for(let Q of s(G))!o.call(P,Q)&&Q!==J&&e(P,Q,{get:()=>G[Q],enumerable:!(z=t(G,Q))||z.enumerable});return P},d=(P,G,J)=>(J=P!=null?r(a(P)):{},h(!P||!P.__esModule?e(J,"default",{value:P,enumerable:!0}):J,P)),m=P=>h(e({},"__esModule",{value:!0}),P),p=(P,G,J)=>(u(P,typeof G!="symbol"?G+"":G,J),J),v={};c(v,{createReactPlayer:()=>N}),Nh=m(v);var x=d(ws()),S=d(Yx()),E=d(RR),T=d(qx()),A=Xx(),w=Qu(),C=d(wR());const k=(0,w.lazy)(()=>Xu(()=>import("./Preview-CAWjgQUz.js").then(P=>P.P),[])),_=typeof window<"u"&&window.document&&typeof document<"u",U=typeof oh<"u"&&oh.window&&oh.window.document,B=Object.keys(A.propTypes),M=_||U?x.Suspense:()=>null,D=[],N=(P,G)=>{var J;return J=class extends x.Component{constructor(){super(...arguments),p(this,"state",{showPreview:!!this.props.light}),p(this,"references",{wrapper:z=>{this.wrapper=z},player:z=>{this.player=z}}),p(this,"handleClickPreview",z=>{this.setState({showPreview:!1}),this.props.onClickPreview(z)}),p(this,"showPreview",()=>{this.setState({showPreview:!0})}),p(this,"getDuration",()=>this.player?this.player.getDuration():null),p(this,"getCurrentTime",()=>this.player?this.player.getCurrentTime():null),p(this,"getSecondsLoaded",()=>this.player?this.player.getSecondsLoaded():null),p(this,"getInternalPlayer",(z="player")=>this.player?this.player.getInternalPlayer(z):null),p(this,"seekTo",(z,Q,$)=>{if(!this.player)return null;this.player.seekTo(z,Q,$)}),p(this,"handleReady",()=>{this.props.onReady(this)}),p(this,"getActivePlayer",(0,E.default)(z=>{for(const Q of[...D,...P])if(Q.canPlay(z))return Q;return G||null})),p(this,"getConfig",(0,E.default)((z,Q)=>{const{config:$}=this.props;return S.default.all([A.defaultProps.config,A.defaultProps.config[Q]||{},$,$[Q]||{}])})),p(this,"getAttributes",(0,E.default)(z=>(0,w.omit)(this.props,B))),p(this,"renderActivePlayer",z=>{if(!z)return null;const Q=this.getActivePlayer(z);if(!Q)return null;const $=this.getConfig(z,Q.key);return x.default.createElement(C.default,{...this.props,key:Q.key,ref:this.references.player,config:$,activePlayer:Q.lazyPlayer||Q,onReady:this.handleReady})})}shouldComponentUpdate(z,Q){return!(0,T.default)(this.props,z)||!(0,T.default)(this.state,Q)}componentDidUpdate(z){const{light:Q}=this.props;!z.light&&Q&&this.setState({showPreview:!0}),z.light&&!Q&&this.setState({showPreview:!1})}renderPreview(z){if(!z)return null;const{light:Q,playIcon:$,previewTabIndex:oe,oEmbedUrl:ue,previewAriaLabel:Y}=this.props;return x.default.createElement(k,{url:z,light:Q,playIcon:$,previewTabIndex:oe,previewAriaLabel:Y,oEmbedUrl:ue,onClick:this.handleClickPreview})}render(){const{url:z,style:Q,width:$,height:oe,fallback:ue,wrapper:Y}=this.props,{showPreview:O}=this.state,K=this.getAttributes(z),te=typeof Y=="string"?this.references.wrapper:void 0;return x.default.createElement(Y,{ref:te,style:{...Q,width:$,height:oe},...K},x.default.createElement(M,{fallback:ue},O?this.renderPreview(z):this.renderActivePlayer(z)))}},p(J,"displayName","ReactPlayer"),p(J,"propTypes",A.propTypes),p(J,"defaultProps",A.defaultProps),p(J,"addCustomPlayer",z=>{D.push(z)}),p(J,"removeCustomPlayers",()=>{D.length=0}),p(J,"canPlay",z=>{for(const Q of[...D,...P])if(Q.canPlay(z))return!0;return!1}),p(J,"canEnablePIP",z=>{for(const Q of[...D,...P])if(Q.canEnablePIP&&Q.canEnablePIP(z))return!0;return!1}),J};return Nh}var Ph,Xy;function IR(){if(Xy)return Ph;Xy=1;var r=Object.defineProperty,e=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(z,Q)=>{for(var $ in Q)r(z,$,{get:Q[$],enumerable:!0})},o=(z,Q,$,oe)=>{if(Q&&typeof Q=="object"||typeof Q=="function")for(let ue of t(Q))!s.call(z,ue)&&ue!==$&&r(z,ue,{get:()=>Q[ue],enumerable:!(oe=e(Q,ue))||oe.enumerable});return z},u=z=>o(r({},"__esModule",{value:!0}),z),c={};a(c,{AUDIO_EXTENSIONS:()=>B,DASH_EXTENSIONS:()=>N,FLV_EXTENSIONS:()=>P,HLS_EXTENSIONS:()=>D,MATCH_URL_DAILYMOTION:()=>C,MATCH_URL_FACEBOOK:()=>x,MATCH_URL_FACEBOOK_WATCH:()=>S,MATCH_URL_KALTURA:()=>U,MATCH_URL_MIXCLOUD:()=>k,MATCH_URL_MUX:()=>v,MATCH_URL_SOUNDCLOUD:()=>m,MATCH_URL_STREAMABLE:()=>E,MATCH_URL_TWITCH_CHANNEL:()=>w,MATCH_URL_TWITCH_VIDEO:()=>A,MATCH_URL_VIDYARD:()=>_,MATCH_URL_VIMEO:()=>p,MATCH_URL_WISTIA:()=>T,MATCH_URL_YOUTUBE:()=>d,VIDEO_EXTENSIONS:()=>M,canPlay:()=>J}),Ph=u(c);var h=Qu();const d=/(?:youtu\.be\/|youtube(?:-nocookie|education)?\.com\/(?:embed\/|v\/|watch\/|watch\?v=|watch\?.+&v=|shorts\/|live\/))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//,m=/(?:soundcloud\.com|snd\.sc)\/[^.]+$/,p=/vimeo\.com\/(?!progressive_redirect).+/,v=/stream\.mux\.com\/(?!\w+\.m3u8)(\w+)/,x=/^https?:\/\/(www\.)?facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/,S=/^https?:\/\/fb\.watch\/.+$/,E=/streamable\.com\/([a-z0-9]+)$/,T=/(?:wistia\.(?:com|net)|wi\.st)\/(?:medias|embed)\/(?:iframe\/)?([^?]+)/,A=/(?:www\.|go\.)?twitch\.tv\/videos\/(\d+)($|\?)/,w=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,C=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?(?:[\w.#_-]+)?/,k=/mixcloud\.com\/([^/]+\/[^/]+)/,_=/vidyard.com\/(?:watch\/)?([a-zA-Z0-9-_]+)/,U=/^https?:\/\/[a-zA-Z]+\.kaltura.(com|org)\/p\/([0-9]+)\/sp\/([0-9]+)00\/embedIframeJs\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+)(.*)entry_id.([a-zA-Z0-9-_].*)$/,B=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,M=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,D=/\.(m3u8)($|\?)/i,N=/\.(mpd)($|\?)/i,P=/\.(flv)($|\?)/i,G=z=>{if(z instanceof Array){for(const Q of z)if(typeof Q=="string"&&G(Q)||G(Q.src))return!0;return!1}return(0,h.isMediaStream)(z)||(0,h.isBlobUrl)(z)?!0:B.test(z)||M.test(z)||D.test(z)||N.test(z)||P.test(z)},J={youtube:z=>z instanceof Array?z.every(Q=>d.test(Q)):d.test(z),soundcloud:z=>m.test(z)&&!B.test(z),vimeo:z=>p.test(z)&&!M.test(z)&&!D.test(z),mux:z=>v.test(z),facebook:z=>x.test(z)||S.test(z),streamable:z=>E.test(z),wistia:z=>T.test(z),twitch:z=>A.test(z)||w.test(z),dailymotion:z=>C.test(z),mixcloud:z=>k.test(z),vidyard:z=>_.test(z),kaltura:z=>U.test(z),file:G};return Ph}var Fh,Qy;function MR(){if(Qy)return Fh;Qy=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,u=(M,D,N)=>D in M?e(M,D,{enumerable:!0,configurable:!0,writable:!0,value:N}):M[D]=N,c=(M,D)=>{for(var N in D)e(M,N,{get:D[N],enumerable:!0})},h=(M,D,N,P)=>{if(D&&typeof D=="object"||typeof D=="function")for(let G of s(D))!o.call(M,G)&&G!==N&&e(M,G,{get:()=>D[G],enumerable:!(P=t(D,G))||P.enumerable});return M},d=(M,D,N)=>(N=M!=null?r(a(M)):{},h(!M||!M.__esModule?e(N,"default",{value:M,enumerable:!0}):N,M)),m=M=>h(e({},"__esModule",{value:!0}),M),p=(M,D,N)=>(u(M,typeof D!="symbol"?D+"":D,N),N),v={};c(v,{default:()=>B}),Fh=m(v);var x=d(ws()),S=Qu(),E=IR();const T="https://www.youtube.com/iframe_api",A="YT",w="onYouTubeIframeAPIReady",C=/[?&](?:list|channel)=([a-zA-Z0-9_-]+)/,k=/user\/([a-zA-Z0-9_-]+)\/?/,_=/youtube-nocookie\.com/,U="https://www.youtube-nocookie.com";class B extends x.Component{constructor(){super(...arguments),p(this,"callPlayer",S.callPlayer),p(this,"parsePlaylist",D=>{if(D instanceof Array)return{listType:"playlist",playlist:D.map(this.getID).join(",")};if(C.test(D)){const[,N]=D.match(C);return{listType:"playlist",list:N.replace(/^UC/,"UU")}}if(k.test(D)){const[,N]=D.match(k);return{listType:"user_uploads",list:N}}return{}}),p(this,"onStateChange",D=>{const{data:N}=D,{onPlay:P,onPause:G,onBuffer:J,onBufferEnd:z,onEnded:Q,onReady:$,loop:oe,config:{playerVars:ue,onUnstarted:Y}}=this.props,{UNSTARTED:O,PLAYING:K,PAUSED:te,BUFFERING:ae,ENDED:re,CUED:me}=window[A].PlayerState;if(N===O&&Y(),N===K&&(P(),z()),N===te&&G(),N===ae&&J(),N===re){const de=!!this.callPlayer("getPlaylist");oe&&!de&&(ue.start?this.seekTo(ue.start):this.play()),Q()}N===me&&$()}),p(this,"mute",()=>{this.callPlayer("mute")}),p(this,"unmute",()=>{this.callPlayer("unMute")}),p(this,"ref",D=>{this.container=D})}componentDidMount(){this.props.onMount&&this.props.onMount(this)}getID(D){return!D||D instanceof Array||C.test(D)?null:D.match(E.MATCH_URL_YOUTUBE)[1]}load(D,N){const{playing:P,muted:G,playsinline:J,controls:z,loop:Q,config:$,onError:oe}=this.props,{playerVars:ue,embedOptions:Y}=$,O=this.getID(D);if(N){if(C.test(D)||k.test(D)||D instanceof Array){this.player.loadPlaylist(this.parsePlaylist(D));return}this.player.cueVideoById({videoId:O,startSeconds:(0,S.parseStartTime)(D)||ue.start,endSeconds:(0,S.parseEndTime)(D)||ue.end});return}(0,S.getSDK)(T,A,w,K=>K.loaded).then(K=>{this.container&&(this.player=new K.Player(this.container,{width:"100%",height:"100%",videoId:O,playerVars:{autoplay:P?1:0,mute:G?1:0,controls:z?1:0,start:(0,S.parseStartTime)(D),end:(0,S.parseEndTime)(D),origin:window.location.origin,playsinline:J?1:0,...this.parsePlaylist(D),...ue},events:{onReady:()=>{Q&&this.player.setLoop(!0),this.props.onReady()},onPlaybackRateChange:te=>this.props.onPlaybackRateChange(te.data),onPlaybackQualityChange:te=>this.props.onPlaybackQualityChange(te),onStateChange:this.onStateChange,onError:te=>oe(te.data)},host:_.test(D)?U:void 0,...Y}))},oe),Y.events&&console.warn("Using `embedOptions.events` will likely break things. Use ReactPlayer’s callback props instead, eg onReady, onPlay, onPause")}play(){this.callPlayer("playVideo")}pause(){this.callPlayer("pauseVideo")}stop(){document.body.contains(this.callPlayer("getIframe"))&&this.callPlayer("stopVideo")}seekTo(D,N=!1){this.callPlayer("seekTo",D),!N&&!this.props.playing&&this.pause()}setVolume(D){this.callPlayer("setVolume",D*100)}setPlaybackRate(D){this.callPlayer("setPlaybackRate",D)}setLoop(D){this.callPlayer("setLoop",D)}getDuration(){return this.callPlayer("getDuration")}getCurrentTime(){return this.callPlayer("getCurrentTime")}getSecondsLoaded(){return this.callPlayer("getVideoLoadedFraction")*this.getDuration()}render(){const{display:D}=this.props,N={width:"100%",height:"100%",display:D};return x.default.createElement("div",{style:N},x.default.createElement("div",{ref:this.ref}))}}return p(B,"displayName","YouTube"),p(B,"canPlay",E.canPlay.youtube),Fh}var Uh,Wy;function kR(){if(Wy)return Uh;Wy=1;var r=OR().createReactPlayer,e=MR().default;return Uh=r([{key:"youtube",canPlay:e.canPlay,lazyPlayer:e}]),Uh}var NR=kR();const PR=lx(NR);function FR({url:r,playing:e=!1,onPlay:t,onPause:s,onEnded:a,onError:o}){return L.jsx("div",{className:"w-full bg-black",children:L.jsxs("div",{className:"relative w-full pt-[56.25%]",children:[" ",L.jsx("div",{className:"absolute inset-0",children:L.jsx(PR,{url:r||"",playing:e,controls:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0},config:{playerVars:{autoplay:1,modestbranding:1,rel:0,origin:window.location.origin,enablejsapi:1,playsinline:1}},onPlay:t,onPause:s,onEnded:a,onError:o})})]})})}function UR({isOpen:r,onClose:e,videoUrl:t}){const s=fe.useRef(null);fe.useEffect(()=>{const o=s.current;if(o)return r?(o.showModal(),document.body.style.overflow="hidden"):(o.close(),document.body.style.overflow="unset"),()=>{document.body.style.overflow="unset"}},[r]);const a=o=>{const u=s.current;u&&o.target===u&&e()};return L.jsx("dialog",{ref:s,className:`fixed m-auto inset-0 p-4 max-h-[90vh] max-w-[90vw] w-full md:w-[800px] bg-transparent 
                 backdrop:bg-slate-900/90 backdrop:backdrop-blur-sm`,onClick:a,onClose:e,children:L.jsx("div",{className:"bg-slate-900 rounded-lg shadow-xl shadow-black/20 overflow-hidden",children:L.jsx(FR,{url:t,playing:r,onEnded:e})})})}function BR({studios:r}){return r.length===0?null:L.jsxs("div",{children:[L.jsxs("div",{className:"flex items-center gap-1 text-sky-400 mb-1",children:[L.jsx(Zd,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{className:"text-sm font-medium",children:"Studios"})]}),L.jsx("div",{className:"text-white",children:r.map((e,t)=>L.jsxs("span",{children:[e.name,t<r.length-1&&", "]},e.id))})]})}function jR({extras:r,onSelectVideo:e}){const t=a=>{const o=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,u=a.match(o);return u&&u[2].length===11?u[2]:null},s=(a,o)=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),e(o))};return L.jsxs("section",{className:"container mx-auto px-4 py-12 border-t border-sky-200/10",children:[L.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Extras"}),L.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(a=>{const o=t(a.url),u=o?`https://img.youtube.com/vi/${o}/maxresdefault.jpg`:"";return L.jsxs("button",{onClick:()=>e(a.url),onKeyDown:c=>s(c,a.url),className:`group relative aspect-video w-full rounded-xl overflow-hidden focus:outline-none 
                       focus:ring-2 focus:ring-sky-500/40 focus:ring-offset-2 focus:ring-offset-slate-800`,"aria-label":`Play ${a.title}`,children:[L.jsx("img",{src:u,alt:a.title,className:`w-full h-full object-cover transition-transform duration-300 
                         group-hover:scale-105`,loading:"lazy"}),L.jsx("div",{className:`absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent 
                          opacity-80 group-hover:opacity-90 transition-opacity`}),L.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:L.jsx("div",{className:`rounded-full bg-sky-500/90 p-4 transform transition-all duration-300 
                            group-hover:bg-sky-400 group-hover:scale-110`,children:L.jsx(ZA,{className:"w-8 h-8 text-white","aria-hidden":"true"})})}),L.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[L.jsx("h3",{className:`text-base font-medium text-white line-clamp-2 mb-1 group-hover:text-sky-200 
                           transition-colors`,children:a.title}),L.jsx("p",{className:"text-sm text-sky-200/80 capitalize",children:a.kind})]})]},a.id)})})]})}const Qx=fe.forwardRef(({trigger:r,items:e,align:t="right",label:s},a)=>{const[o,u]=fe.useState(!1),[c,h]=fe.useState(-1),d=fe.useRef([]),m=fe.useRef(null),p=a||m;fe.useEffect(()=>{const x=S=>{const E=p.current;E&&!E.contains(S.target)&&(u(!1),h(-1))};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[p]),fe.useEffect(()=>{var x;o&&c>=0&&((x=d.current[c])==null||x.focus())},[o,c]);const v=x=>{if(!o){(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),u(!0),h(0));return}switch(x.key){case"ArrowDown":x.preventDefault(),h(S=>S<e.length-1?S+1:0);break;case"ArrowUp":x.preventDefault(),h(S=>S>0?S-1:e.length-1);break;case"Home":x.preventDefault(),h(0);break;case"End":x.preventDefault(),h(e.length-1);break;case"Escape":x.preventDefault(),u(!1),h(-1);break;case"Tab":u(!1),h(-1);break}};return L.jsxs("div",{className:"relative",ref:a,onKeyDown:v,children:[L.jsx("div",{role:"button","aria-haspopup":"true","aria-expanded":o,"aria-label":s,onClick:()=>{u(!o),o||h(0)},tabIndex:0,children:r}),o&&L.jsx("div",{className:`absolute z-50 ${t==="right"?"right-0":"left-0"} mt-2 w-48 rounded-lg bg-slate-800 shadow-lg ring-1 ring-black ring-opacity-5`,role:"menu","aria-orientation":"vertical","aria-label":`${s} options`,children:L.jsx("div",{className:"py-1",children:e.map((x,S)=>L.jsxs("button",{ref:E=>{d.current[S]=E},onClick:()=>{x.onClick(),u(!1),h(-1)},className:`flex w-full items-center px-4 py-2 text-sm text-sky-200 
                           hover:bg-slate-700 hover:text-sky-100 transition-colors
                           ${c===S?"bg-slate-700 text-sky-100":""}`,role:"menuitem","aria-label":x.label,tabIndex:o?0:-1,children:[x.icon&&L.jsx("span",{className:"mr-3","aria-hidden":"true",children:x.icon}),x.label]},S))})})]})});Qx.displayName="Dropdown";function GR({isOpen:r,onClose:e,audioOpts:t,subtitleOpts:s}){const a=fe.useRef(null),o=fe.useRef(null);fe.useEffect(()=>{const c=a.current;c&&(r?c.showModal():c.close())},[r]);const u=()=>{var c;(c=o.current)==null||c.reset(),e()};return L.jsx("dialog",{ref:a,className:"fixed inset-0 bg-transparent p-0 m-0 h-full w-full outline-none",onClick:c=>{c.target===a.current&&e()},children:L.jsxs("div",{className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 
                    w-[600px] max-w-[90vw] bg-slate-900 rounded-xl shadow-2xl`,children:[L.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-sky-200/10",children:[L.jsx("h2",{className:"text-xl font-medium text-white",children:"Playback Settings"}),L.jsx("button",{type:"button",onClick:u,className:"text-sky-200 hover:text-sky-100 transition-colors",children:L.jsx(Jd,{className:"w-6 h-6","aria-hidden":"true"})})]}),L.jsx("div",{className:"p-6",children:L.jsxs("form",{ref:o,className:"space-y-6",children:[L.jsxs("div",{children:[L.jsx("label",{htmlFor:"audioTrack",className:"block text-base font-medium text-sky-200 mb-2",children:"Audio Track"}),L.jsx("select",{id:"audioTrack",name:"audioTrack",className:`w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white 
                         focus:outline-none focus:ring-2 focus:ring-sky-500/40`,defaultValue:"english",children:t.map(c=>L.jsx("option",{value:c.value,children:c.label}))})]}),L.jsxs("div",{children:[L.jsx("label",{htmlFor:"subtitles",className:"block text-base font-medium text-sky-200 mb-2",children:"Subtitles"}),L.jsxs("select",{id:"subtitles",name:"subtitles",className:`w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white 
                         focus:outline-none focus:ring-2 focus:ring-sky-500/40`,defaultValue:"none",children:[L.jsx("option",{value:"none",children:"None"}),s.map(c=>L.jsx("option",{value:c.value,children:c.label}))]})]}),L.jsxs("div",{children:[L.jsx("label",{htmlFor:"resolution",className:"block text-base font-medium text-sky-200 mb-2",children:"Resolution"}),L.jsxs("select",{id:"resolution",name:"resolution",className:`w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white 
                         focus:outline-none focus:ring-2 focus:ring-sky-500/40`,defaultValue:"1080p",children:[L.jsx("option",{value:"2160p",children:"4K (2160p)"}),L.jsx("option",{value:"1080p",children:"Full HD (1080p)"}),L.jsx("option",{value:"720p",children:"HD (720p)"}),L.jsx("option",{value:"480p",children:"SD (480p)"})]})]}),L.jsxs("div",{className:"pt-4 flex gap-4",children:[L.jsx("button",{type:"submit",className:`flex-1 px-6 py-3 bg-sky-500 hover:bg-sky-400 text-white text-base font-medium 
                         rounded-lg transition-colors`,children:"Apply Settings"}),L.jsx("button",{type:"button",onClick:u,className:`flex-1 px-6 py-3 bg-slate-800 hover:bg-slate-700 text-sky-200 hover:text-sky-100 
                         text-base font-medium rounded-lg transition-colors`,children:"Cancel"})]})]})})]})})}const _d=ts("/movies/$movieID/")({component:HR,loader:async({params:r})=>{const e=await fetch(`/api/v1/movies/${r.movieID}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch movie details");return e.json()}});function HR(){const{movie:r}=_d.useLoaderData(),e=r.audio_streams.length>0?r.audio_streams.map(d=>({value:d.index,label:`${d.title} ${d.language}`})):[],t=r.subtitles.length>0?r.subtitles.map(d=>({value:d.index,label:`${d.title} ${d.language}`})):[],[s,a]=fe.useState(null),[o,u]=fe.useState(!1),c=_d.useNavigate(),h=async()=>{const d={title:r.title,audio_codec:"aac",audio_bit_rate:192,audio_channels:2,audio_stream_index:r.audio_streams[0].index,video_stream_index:r.video_streams[0].index,video_codec:"copy"},p=await(await fetch(`/api/v1/ffmpeg/movie/create-hls/${r.id}`,{method:"post",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json();if(p.error){alert(p.error);return}c({to:"/movies/$movieID/play",params:{movieID:r.id.toString()},search:{pid:p.pid,title:r.title}})};return L.jsxs("main",{className:"min-h-screen pt-16",children:[L.jsxs("div",{className:"relative min-h-[90vh] w-full",children:[L.jsxs("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${Lo(r.art)})`},children:[L.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-900/80 via-slate-900/50 to-transparent"}),L.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/40 to-transparent"})]}),L.jsx("div",{className:"relative h-full container mx-auto px-4 py-12 flex flex-col justify-end",children:L.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-end md:items-end",children:[L.jsx("div",{className:"relative z-10 md:translate-y-16",children:L.jsx("div",{className:"w-48 md:w-72 aspect-[2/3] rounded-lg overflow-hidden ring-1 ring-white/10 shadow-xl shadow-black/50",children:L.jsx("img",{src:Lo(r.thumb),alt:`${r.title} Poster`,className:"w-full h-full object-cover"})})}),L.jsxs("div",{className:"flex-1 max-w-3xl relative z-10",children:[L.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-xl",children:r.title}),r.tag_line&&L.jsx("p",{className:"text-xl text-sky-200 mb-4 italic drop-shadow-xl",children:r.tag_line}),L.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-sky-200 mb-6 drop-shadow-lg bg-slate-900/20 backdrop-blur-sm rounded-lg px-4 py-2",children:[L.jsxs("div",{className:"flex items-center gap-1",children:[L.jsx(kA,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{children:pR(r.release_date)})]}),L.jsxs("div",{className:"flex items-center gap-1",children:[L.jsx(FA,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{children:yR(r.run_time)})]}),r.content_rating&&L.jsx("span",{className:"px-2 py-0.5 bg-sky-500/20 rounded",children:r.content_rating}),L.jsx(SR,{genres:r.genres})]}),L.jsxs("div",{className:"flex gap-6 mb-6",children:[r.audience_rating>0&&L.jsxs("div",{className:"flex items-center gap-2",children:[L.jsx(XA,{className:"w-5 h-5 text-sky-400","aria-hidden":"true"}),L.jsxs("div",{children:[L.jsx("div",{className:"text-lg font-medium text-white",children:r.audience_rating.toFixed(1)}),L.jsx("div",{className:"text-xs text-sky-200",children:"Audience Rating"})]})]}),r.critic_rating>0&&L.jsxs("div",{className:"flex items-center gap-2",children:[L.jsx(MA,{className:"w-5 h-5 text-sky-400","aria-hidden":"true"}),L.jsxs("div",{children:[L.jsx("div",{className:"text-lg font-medium text-white",children:r.critic_rating.toFixed(1)}),L.jsx("div",{className:"text-xs text-sky-200",children:"Critic Rating"})]})]})]}),L.jsx("p",{className:"text-sky-200 leading-relaxed mb-8",children:r.summary}),L.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-8",children:[L.jsxs("button",{type:"button",onClick:h,className:`inline-flex items-center gap-2 px-6 py-3 bg-sky-500 hover:bg-sky-400 
                           text-white font-medium rounded-lg transition-colors`,children:[L.jsx(ku,{className:"w-5 h-5","aria-hidden":"true"}),"Play"]}),L.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 px-4 py-3 bg-rose-500/20 hover:bg-rose-500/30 
                           text-rose-300 hover:text-rose-200 font-medium rounded-lg transition-colors`,children:[L.jsx(BA,{className:"w-5 h-5","aria-hidden":"true"}),"Like"]}),L.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 px-4 py-3 bg-emerald-500/20 hover:bg-emerald-500/30 
                           text-emerald-300 hover:text-emerald-200 font-medium rounded-lg transition-colors`,children:[L.jsx(jx,{className:"w-5 h-5","aria-hidden":"true"}),"Mark as Watched"]}),L.jsx(Qx,{trigger:L.jsx("button",{type:"button",className:`inline-flex items-center justify-center w-12 h-12 bg-slate-800/50 hover:bg-slate-800 
                               text-sky-200 hover:text-sky-100 rounded-lg transition-colors`,children:L.jsx(KA,{className:"w-5 h-5","aria-hidden":"true"})}),label:`More options for ${r.title}`,items:[{label:"Playback Settings",icon:L.jsx(ku,{className:"w-4 h-4"}),onClick:()=>u(!0)},{label:"Movie Details",icon:L.jsx(GA,{className:"w-4 h-4"}),onClick:()=>{console.log("Show details")}}]})]}),L.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[r.budget>0&&L.jsxs("div",{children:[L.jsxs("div",{className:"flex items-center gap-1 text-sky-400 mb-1",children:[L.jsx(Ny,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{className:"text-sm font-medium",children:"Budget"})]}),L.jsx("div",{className:"text-white",children:Fy(r.budget)})]}),r.revenue>0&&L.jsxs("div",{children:[L.jsxs("div",{className:"flex items-center gap-1 text-sky-400 mb-1",children:[L.jsx(Ny,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{className:"text-sm font-medium",children:"Revenue"})]}),L.jsx("div",{className:"text-white",children:Fy(r.revenue)})]}),L.jsx(BR,{studios:r.studios})]})]})]})})]}),L.jsxs("section",{className:"container mx-auto px-4 py-12",children:[L.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Cast & Crew"}),r.cast.length>0&&L.jsx(vR,{cast:r.cast}),r.crew.length>0&&L.jsx(xR,{crew:r.crew})]}),L.jsx(jR,{extras:r.extras,onSelectVideo:d=>a(d)}),L.jsx(UR,{isOpen:!!s,onClose:()=>a(null),videoUrl:s}),L.jsx(GR,{isOpen:o,onClose:()=>u(!1),audioOpts:e,subtitleOpts:t})]})}function $R(){return document.createElement("video").canPlayType("application/vnd.apple.mpegurl")!==""}function VR(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Wx={exports:{}};(function(r,e){(function(t){var s=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,a=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(h,d,m){if(m=m||{},h=h.trim(),d=d.trim(),!d){if(!m.alwaysNormalize)return h;var p=c.parseURL(h);if(!p)throw new Error("Error trying to parse base URL.");return p.path=c.normalizePath(p.path),c.buildURLFromParts(p)}var v=c.parseURL(d);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return m.alwaysNormalize?(v.path=c.normalizePath(v.path),c.buildURLFromParts(v)):d;var x=c.parseURL(h);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&x.path[0]!=="/"){var S=a.exec(x.path);x.netLoc=S[1],x.path=S[2]}x.netLoc&&!x.path&&(x.path="/");var E={scheme:x.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(E.netLoc=x.netLoc,v.path[0]!=="/"))if(!v.path)E.path=x.path,v.params||(E.params=x.params,v.query||(E.query=x.query));else{var T=x.path,A=T.substring(0,T.lastIndexOf("/")+1)+v.path;E.path=c.normalizePath(A)}return E.path===null&&(E.path=m.alwaysNormalize?c.normalizePath(v.path):v.path),c.buildURLFromParts(E)},parseURL:function(h){var d=s.exec(h);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(h){for(h=h.split("").reverse().join("").replace(o,"");h.length!==(h=h.replace(u,"")).length;);return h.split("").reverse().join("")},buildURLFromParts:function(h){return h.scheme+h.netLoc+h.path+h.params+h.query+h.fragment}};r.exports=c})()})(Wx);var e0=Wx.exports;function Zy(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,s)}return t}function Lt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Zy(Object(t),!0).forEach(function(s){YR(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Zy(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}function KR(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function zR(r){var e=KR(r,"string");return typeof e=="symbol"?e:String(e)}function YR(r,e,t){return e=zR(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function mt(){return mt=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},mt.apply(this,arguments)}const ye=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},qR=Number.isSafeInteger||function(r){return typeof r=="number"&&Math.abs(r)<=XR},XR=Number.MAX_SAFE_INTEGER||9007199254740991;let R=function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",r}({}),Ae=function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r}({}),ie=function(r){return r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_PARSING_ERROR="levelParsingError",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.FRAG_GAP="fragGap",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.UNKNOWN="unknown",r}({});const jn=function(){},Dd={trace:jn,debug:jn,log:jn,warn:jn,info:jn,error:jn};let bo=Dd;function QR(r){const e=self.console[r];return e?e.bind(self.console,`[${r}] >`):jn}function WR(r,...e){e.forEach(function(t){bo[t]=r[t]?r[t].bind(r):QR(t)})}function ZR(r,e){if(typeof console=="object"&&r===!0||typeof r=="object"){WR(r,"debug","log","info","warn","error");try{bo.log(`Debug logs enabled for "${e}" in hls.js version 1.5.20`)}catch{bo=Dd}}else bo=Dd}const X=bo,JR=/^(\d+)x(\d+)$/,Jy=/(.+?)=(".*?"|.*?)(?:,|$)/g;class nt{constructor(e){typeof e=="string"&&(e=nt.parseAttrList(e)),mt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const s=new Uint8Array(t.length/2);for(let a=0;a<t.length/2;a++)s[a]=parseInt(t.slice(a*2,a*2+2),16);return s}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const s=this[e];return s?parseFloat(s):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=JR.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const s={},a='"';for(Jy.lastIndex=0;(t=Jy.exec(e))!==null;){let o=t[2];o.indexOf(a)===0&&o.lastIndexOf(a)===o.length-1&&(o=o.slice(1,-1));const u=t[1].trim();s[u]=o}return s}}function eL(r){return r!=="ID"&&r!=="CLASS"&&r!=="START-DATE"&&r!=="DURATION"&&r!=="END-DATE"&&r!=="END-ON-NEXT"}function tL(r){return r==="SCTE35-OUT"||r==="SCTE35-IN"}class Zx{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const s=t.attr;for(const a in s)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==s[a]){X.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=mt(new nt({}),s,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const s=new Date(this.attr["END-DATE"]);ye(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(ye(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&ye(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Wu{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ze={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Jx{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ze.AUDIO]:null,[ze.VIDEO]:null,[ze.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const s=e.split("@",2);let a;s.length===1?a=(t==null?void 0:t.byteRangeEndOffset)||0:a=parseInt(s[1]),this._byteRange=[a,parseInt(s[0])+a]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=e0.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Bh extends Jx{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Wu,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const s=Object.keys(this.levelkeys);if(s.length===1)return this._decryptdata=this.levelkeys[s[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!ye(this.programDateTime))return null;const e=ye(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),s=t.length;if(s>1||s===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,s,a,o,u=!1){const{elementaryStreams:c}=this,h=c[e];if(!h){c[e]={startPTS:t,endPTS:s,startDTS:a,endDTS:o,partial:u};return}h.startPTS=Math.min(h.startPTS,t),h.endPTS=Math.max(h.endPTS,s),h.startDTS=Math.min(h.startDTS,a),h.endDTS=Math.max(h.endDTS,o)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ze.AUDIO]=null,e[ze.VIDEO]=null,e[ze.AUDIOVIDEO]=null}}class iL extends Jx{constructor(e,t,s,a,o){super(s),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Wu,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=a;const u=e.enumeratedString("BYTERANGE");u&&this.setByteRange(u,o),o&&(this.fragOffset=o.fragOffset+o.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const sL=10;class nL{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,s=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!s||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&s>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?ye(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||sL}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function t0(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0))}function rL(r){const e=Cd(r).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function aL(r){const e=function(s,a,o){const u=s[a];s[a]=s[o],s[o]=u};e(r,0,3),e(r,1,2),e(r,4,5),e(r,6,7)}function oL(r){const e=r.split(":");let t=null;if(e[0]==="data"&&e.length===2){const s=e[1].split(";"),a=s[s.length-1].split(",");if(a.length===2){const o=a[0]==="base64",u=a[1];o?(s.splice(-1,1),t=t0(u)):t=rL(u)}}return t}function Cd(r){return Uint8Array.from(unescape(encodeURIComponent(r)),e=>e.charCodeAt(0))}const ma=typeof self<"u"?self:void 0;var Ve={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Xt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function jh(r){switch(r){case Xt.FAIRPLAY:return Ve.FAIRPLAY;case Xt.PLAYREADY:return Ve.PLAYREADY;case Xt.WIDEVINE:return Ve.WIDEVINE;case Xt.CLEARKEY:return Ve.CLEARKEY}}var Zl={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Gh(r){if(r===Zl.WIDEVINE)return Ve.WIDEVINE;if(r===Zl.PLAYREADY)return Ve.PLAYREADY;if(r===Zl.CENC||r===Zl.CLEARKEY)return Ve.CLEARKEY}function Hh(r){switch(r){case Ve.FAIRPLAY:return Xt.FAIRPLAY;case Ve.PLAYREADY:return Xt.PLAYREADY;case Ve.WIDEVINE:return Xt.WIDEVINE;case Ve.CLEARKEY:return Xt.CLEARKEY}}function Jl(r){const{drmSystems:e,widevineLicenseUrl:t}=r,s=e?[Ve.FAIRPLAY,Ve.WIDEVINE,Ve.PLAYREADY,Ve.CLEARKEY].filter(a=>!!e[a]):[];return!s[Ve.WIDEVINE]&&t&&s.push(Ve.WIDEVINE),s}const eS=function(r){return ma!=null&&(r=ma.navigator)!=null&&r.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function lL(r,e,t,s){let a;switch(r){case Ve.FAIRPLAY:a=["cenc","sinf"];break;case Ve.WIDEVINE:case Ve.PLAYREADY:a=["cenc"];break;case Ve.CLEARKEY:a=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${r}`)}return uL(a,e,t,s)}function uL(r,e,t,s){return[{initDataTypes:r,persistentState:s.persistentState||"optional",distinctiveIdentifier:s.distinctiveIdentifier||"optional",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:e.map(o=>({contentType:`audio/mp4; codecs="${o}"`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null})),videoCapabilities:t.map(o=>({contentType:`video/mp4; codecs="${o}"`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null}))}]}function tS(r){const e=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),s=t.substring(t.indexOf("<"),t.length),u=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("KID")[0];if(u){const c=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(c){const h=t0(c).subarray(0,16);return aL(h),h}}return null}function er(r,e,t){return Uint8Array.prototype.slice?r.slice(e,t):new Uint8Array(Array.prototype.slice.call(r,e,t))}const i0=(r,e)=>e+10<=r.length&&r[e]===73&&r[e+1]===68&&r[e+2]===51&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,iS=(r,e)=>e+10<=r.length&&r[e]===51&&r[e+1]===68&&r[e+2]===73&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,_o=(r,e)=>{const t=e;let s=0;for(;i0(r,e);){s+=10;const a=Zu(r,e+6);s+=a,iS(r,e+10)&&(s+=10),e+=s}if(s>0)return r.subarray(t,t+s)},Zu=(r,e)=>{let t=0;return t=(r[e]&127)<<21,t|=(r[e+1]&127)<<14,t|=(r[e+2]&127)<<7,t|=r[e+3]&127,t},cL=(r,e)=>i0(r,e)&&Zu(r,e+6)+10<=r.length-e,s0=r=>{const e=nS(r);for(let t=0;t<e.length;t++){const s=e[t];if(sS(s))return pL(s)}},sS=r=>r&&r.key==="PRIV"&&r.info==="com.apple.streaming.transportStreamTimestamp",fL=r=>{const e=String.fromCharCode(r[0],r[1],r[2],r[3]),t=Zu(r,4),s=10;return{type:e,size:t,data:r.subarray(s,s+t)}},nS=r=>{let e=0;const t=[];for(;i0(r,e);){const s=Zu(r,e+6);e+=10;const a=e+s;for(;e+8<a;){const o=fL(r.subarray(e)),u=hL(o);u&&t.push(u),e+=o.size+10}iS(r,e)&&(e+=10)}return t},hL=r=>r.type==="PRIV"?dL(r):r.type[0]==="W"?gL(r):mL(r),dL=r=>{if(r.size<2)return;const e=Zi(r.data,!0),t=new Uint8Array(r.data.subarray(e.length+1));return{key:r.type,info:e,data:t.buffer}},mL=r=>{if(r.size<2)return;if(r.type==="TXXX"){let t=1;const s=Zi(r.data.subarray(t),!0);t+=s.length+1;const a=Zi(r.data.subarray(t));return{key:r.type,info:s,data:a}}const e=Zi(r.data.subarray(1));return{key:r.type,data:e}},gL=r=>{if(r.type==="WXXX"){if(r.size<2)return;let t=1;const s=Zi(r.data.subarray(t),!0);t+=s.length+1;const a=Zi(r.data.subarray(t));return{key:r.type,info:s,data:a}}const e=Zi(r.data);return{key:r.type,data:e}},pL=r=>{if(r.data.byteLength===8){const e=new Uint8Array(r.data),t=e[3]&1;let s=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return s/=45,t&&(s+=4772185884e-2),Math.round(s)}},Zi=(r,e=!1)=>{const t=yL();if(t){const d=t.decode(r);if(e){const m=d.indexOf("\0");return m!==-1?d.substring(0,m):d}return d.replace(/\0/g,"")}const s=r.length;let a,o,u,c="",h=0;for(;h<s;){if(a=r[h++],a===0&&e)return c;if(a===0||a===3)continue;switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(a);break;case 12:case 13:o=r[h++],c+=String.fromCharCode((a&31)<<6|o&63);break;case 14:o=r[h++],u=r[h++],c+=String.fromCharCode((a&15)<<12|(o&63)<<6|(u&63)<<0);break}}return c};let $h;function yL(){if(!navigator.userAgent.includes("PlayStation 4"))return!$h&&typeof self.TextDecoder<"u"&&($h=new self.TextDecoder("utf-8")),$h}const Vi={hexDump:function(r){let e="";for(let t=0;t<r.length;t++){let s=r[t].toString(16);s.length<2&&(s="0"+s),e+=s}return e}},Nu=Math.pow(2,32)-1,vL=[].push,rS={video:1,audio:2,id3:3,text:4};function vt(r){return String.fromCharCode.apply(null,r)}function aS(r,e){const t=r[e]<<8|r[e+1];return t<0?65536+t:t}function Te(r,e){const t=oS(r,e);return t<0?4294967296+t:t}function ev(r,e){let t=Te(r,e);return t*=Math.pow(2,32),t+=Te(r,e+4),t}function oS(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}function Vh(r,e,t){r[e]=t>>24,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t&255}function xL(r){const e=r.byteLength;for(let t=0;t<e;){const s=Te(r,t);if(s>8&&r[t+4]===109&&r[t+5]===111&&r[t+6]===111&&r[t+7]===102)return!0;t=s>1?t+s:e}return!1}function Ce(r,e){const t=[];if(!e.length)return t;const s=r.byteLength;for(let a=0;a<s;){const o=Te(r,a),u=vt(r.subarray(a+4,a+8)),c=o>1?a+o:s;if(u===e[0])if(e.length===1)t.push(r.subarray(a+8,c));else{const h=Ce(r.subarray(a+8,c),e.slice(1));h.length&&vL.apply(t,h)}a=c}return t}function SL(r){const e=[],t=r[0];let s=8;const a=Te(r,s);s+=4;let o=0,u=0;t===0?(o=Te(r,s),u=Te(r,s+4),s+=8):(o=ev(r,s),u=ev(r,s+8),s+=16),s+=2;let c=r.length+u;const h=aS(r,s);s+=2;for(let d=0;d<h;d++){let m=s;const p=Te(r,m);m+=4;const v=p&2147483647;if((p&2147483648)>>>31===1)return X.warn("SIDX has hierarchical references (not supported)"),null;const S=Te(r,m);m+=4,e.push({referenceSize:v,subsegmentDuration:S,info:{duration:S/a,start:c,end:c+v-1}}),c+=v,m+=4,s=m}return{earliestPresentationTime:o,timescale:a,version:t,referencesCount:h,references:e}}function lS(r){const e=[],t=Ce(r,["moov","trak"]);for(let a=0;a<t.length;a++){const o=t[a],u=Ce(o,["tkhd"])[0];if(u){let c=u[0];const h=Te(u,c===0?12:20),d=Ce(o,["mdia","mdhd"])[0];if(d){c=d[0];const m=Te(d,c===0?12:20),p=Ce(o,["mdia","hdlr"])[0];if(p){const v=vt(p.subarray(8,12)),x={soun:ze.AUDIO,vide:ze.VIDEO}[v];if(x){const S=Ce(o,["mdia","minf","stbl","stsd"])[0],E=EL(S);e[h]={timescale:m,type:x},e[x]=Lt({timescale:m,id:h},E)}}}}}return Ce(r,["moov","mvex","trex"]).forEach(a=>{const o=Te(a,4),u=e[o];u&&(u.default={duration:Te(a,12),flags:Te(a,20)})}),e}function EL(r){const e=r.subarray(8),t=e.subarray(86),s=vt(e.subarray(4,8));let a=s;const o=s==="enca"||s==="encv";if(o){const c=Ce(e,[s])[0].subarray(s==="enca"?28:78);Ce(c,["sinf"]).forEach(d=>{const m=Ce(d,["schm"])[0];if(m){const p=vt(m.subarray(4,8));if(p==="cbcs"||p==="cenc"){const v=Ce(d,["frma"])[0];v&&(a=vt(v))}}})}switch(a){case"avc1":case"avc2":case"avc3":case"avc4":{const u=Ce(t,["avcC"])[0];a+="."+eu(u[1])+eu(u[2])+eu(u[3]);break}case"mp4a":{const u=Ce(e,[s])[0],c=Ce(u.subarray(28),["esds"])[0];if(c&&c.length>12){let h=4;if(c[h++]!==3)break;h=Kh(c,h),h+=2;const d=c[h++];if(d&128&&(h+=2),d&64&&(h+=c[h++]),c[h++]!==4)break;h=Kh(c,h);const m=c[h++];if(m===64)a+="."+eu(m);else break;if(h+=12,c[h++]!==5)break;h=Kh(c,h);const p=c[h++];let v=(p&248)>>3;v===31&&(v+=1+((p&7)<<3)+((c[h]&224)>>5)),a+="."+v}break}case"hvc1":case"hev1":{const u=Ce(t,["hvcC"])[0],c=u[1],h=["","A","B","C"][c>>6],d=c&31,m=Te(u,2),p=(c&32)>>5?"H":"L",v=u[12],x=u.subarray(6,12);a+="."+h+d,a+="."+m.toString(16).toUpperCase(),a+="."+p+v;let S="";for(let E=x.length;E--;){const T=x[E];(T||S)&&(S="."+T.toString(16).toUpperCase()+S)}a+=S;break}case"dvh1":case"dvhe":{const u=Ce(t,["dvcC"])[0],c=u[2]>>1&127,h=u[2]<<5&32|u[3]>>3&31;a+="."+$i(c)+"."+$i(h);break}case"vp09":{const u=Ce(t,["vpcC"])[0],c=u[4],h=u[5],d=u[6]>>4&15;a+="."+$i(c)+"."+$i(h)+"."+$i(d);break}case"av01":{const u=Ce(t,["av1C"])[0],c=u[1]>>>5,h=u[1]&31,d=u[2]>>>7?"H":"M",m=(u[2]&64)>>6,p=(u[2]&32)>>5,v=c===2&&m?p?12:10:m?10:8,x=(u[2]&16)>>4,S=(u[2]&8)>>3,E=(u[2]&4)>>2,T=u[2]&3;a+="."+c+"."+$i(h)+d+"."+$i(v)+"."+x+"."+S+E+T+"."+$i(1)+"."+$i(1)+"."+$i(1)+"."+0;break}}return{codec:a,encrypted:o}}function Kh(r,e){const t=e+5;for(;r[e++]&128&&e<t;);return e}function eu(r){return("0"+r.toString(16).toUpperCase()).slice(-2)}function $i(r){return(r<10?"0":"")+r}function TL(r,e){if(!r||!e)return r;const t=e.keyId;return t&&e.isCommonEncryption&&Ce(r,["moov","trak"]).forEach(a=>{const u=Ce(a,["mdia","minf","stbl","stsd"])[0].subarray(8);let c=Ce(u,["enca"]);const h=c.length>0;h||(c=Ce(u,["encv"])),c.forEach(d=>{const m=h?d.subarray(28):d.subarray(78);Ce(m,["sinf"]).forEach(v=>{const x=uS(v);if(x){const S=x.subarray(8,24);S.some(E=>E!==0)||(X.log(`[eme] Patching keyId in 'enc${h?"a":"v"}>sinf>>tenc' box: ${Vi.hexDump(S)} -> ${Vi.hexDump(t)}`),x.set(t,8))}})})}),r}function uS(r){const e=Ce(r,["schm"])[0];if(e){const t=vt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Ce(r,["schi","tenc"])[0]}return null}function bL(r,e){return Ce(e,["moof","traf"]).reduce((t,s)=>{const a=Ce(s,["tfdt"])[0],o=a[0],u=Ce(s,["tfhd"]).reduce((c,h)=>{const d=Te(h,4),m=r[d];if(m){let p=Te(a,4);if(o===1){if(p===Nu)return X.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),c;p*=Nu+1,p+=Te(a,8)}const v=m.timescale||9e4,x=p/v;if(ye(x)&&(c===null||x<c))return x}return c},null);return u!==null&&ye(u)&&(t===null||u<t)?u:t},null)}function AL(r,e){let t=0,s=0,a=0;const o=Ce(r,["moof","traf"]);for(let u=0;u<o.length;u++){const c=o[u],h=Ce(c,["tfhd"])[0],d=Te(h,4),m=e[d];if(!m)continue;const p=m.default,v=Te(h,0)|(p==null?void 0:p.flags);let x=p==null?void 0:p.duration;v&8&&(v&2?x=Te(h,12):x=Te(h,8));const S=m.timescale||9e4,E=Ce(c,["trun"]);for(let T=0;T<E.length;T++){if(t=RL(E[T]),!t&&x){const A=Te(E[T],4);t=x*A}m.type===ze.VIDEO?s+=t/S:m.type===ze.AUDIO&&(a+=t/S)}}if(s===0&&a===0){let u=1/0,c=0,h=0;const d=Ce(r,["sidx"]);for(let m=0;m<d.length;m++){const p=SL(d[m]);if(p!=null&&p.references){u=Math.min(u,p.earliestPresentationTime/p.timescale);const v=p.references.reduce((x,S)=>x+S.info.duration||0,0);c=Math.max(c,v+p.earliestPresentationTime/p.timescale),h=c-u}}if(h&&ye(h))return h}return s||a}function RL(r){const e=Te(r,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let s=0;const a=Te(r,4);for(let o=0;o<a;o++){if(e&256){const u=Te(r,t);s+=u,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return s}function LL(r,e,t){Ce(e,["moof","traf"]).forEach(s=>{Ce(s,["tfhd"]).forEach(a=>{const o=Te(a,4),u=r[o];if(!u)return;const c=u.timescale||9e4;Ce(s,["tfdt"]).forEach(h=>{const d=h[0],m=t*c;if(m){let p=Te(h,4);if(d===0)p-=m,p=Math.max(p,0),Vh(h,4,p);else{p*=Math.pow(2,32),p+=Te(h,8),p-=m,p=Math.max(p,0);const v=Math.floor(p/(Nu+1)),x=Math.floor(p%(Nu+1));Vh(h,4,v),Vh(h,8,x)}}})})})}function _L(r){const e={valid:null,remainder:null},t=Ce(r,["moof"]);if(t.length<2)return e.remainder=r,e;const s=t[t.length-1];return e.valid=er(r,0,s.byteOffset-8),e.remainder=er(r,s.byteOffset-8),e}function bi(r,e){const t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function tv(r,e){const t=[],s=e.samples,a=e.timescale,o=e.id;let u=!1;return Ce(s,["moof"]).map(h=>{const d=h.byteOffset-8;Ce(h,["traf"]).map(p=>{const v=Ce(p,["tfdt"]).map(x=>{const S=x[0];let E=Te(x,4);return S===1&&(E*=Math.pow(2,32),E+=Te(x,8)),E/a})[0];return v!==void 0&&(r=v),Ce(p,["tfhd"]).map(x=>{const S=Te(x,4),E=Te(x,0)&16777215,T=(E&1)!==0,A=(E&2)!==0,w=(E&8)!==0;let C=0;const k=(E&16)!==0;let _=0;const U=(E&32)!==0;let B=8;S===o&&(T&&(B+=8),A&&(B+=4),w&&(C=Te(x,B),B+=4),k&&(_=Te(x,B),B+=4),U&&(B+=4),e.type==="video"&&(u=DL(e.codec)),Ce(p,["trun"]).map(M=>{const D=M[0],N=Te(M,0)&16777215,P=(N&1)!==0;let G=0;const J=(N&4)!==0,z=(N&256)!==0;let Q=0;const $=(N&512)!==0;let oe=0;const ue=(N&1024)!==0,Y=(N&2048)!==0;let O=0;const K=Te(M,4);let te=8;P&&(G=Te(M,te),te+=4),J&&(te+=4);let ae=G+d;for(let re=0;re<K;re++){if(z?(Q=Te(M,te),te+=4):Q=C,$?(oe=Te(M,te),te+=4):oe=_,ue&&(te+=4),Y&&(D===0?O=Te(M,te):O=oS(M,te),te+=4),e.type===ze.VIDEO){let me=0;for(;me<oe;){const de=Te(s,ae);if(ae+=4,CL(u,s[ae])){const _e=s.subarray(ae,ae+de);cS(_e,u?2:1,r+O/a,t)}ae+=de,me+=de+4}}r+=Q/a}}))})})}),t}function DL(r){if(!r)return!1;const e=r.indexOf("."),t=e<0?r:r.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function CL(r,e){if(r){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function cS(r,e,t,s){const a=fS(r);let o=0;o+=e;let u=0,c=0,h=0;for(;o<a.length;){u=0;do{if(o>=a.length)break;h=a[o++],u+=h}while(h===255);c=0;do{if(o>=a.length)break;h=a[o++],c+=h}while(h===255);const d=a.length-o;let m=o;if(c<d)o+=c;else if(c>d){X.error(`Malformed SEI payload. ${c} is too small, only ${d} bytes left to parse.`);break}if(u===4){if(a[m++]===181){const v=aS(a,m);if(m+=2,v===49){const x=Te(a,m);if(m+=4,x===1195456820){const S=a[m++];if(S===3){const E=a[m++],T=31&E,A=64&E,w=A?2+T*3:0,C=new Uint8Array(w);if(A){C[0]=E;for(let k=1;k<w;k++)C[k]=a[m++]}s.push({type:S,payloadType:u,pts:t,bytes:C})}}}}}else if(u===5&&c>16){const p=[];for(let S=0;S<16;S++){const E=a[m++].toString(16);p.push(E.length==1?"0"+E:E),(S===3||S===5||S===7||S===9)&&p.push("-")}const v=c-16,x=new Uint8Array(v);for(let S=0;S<v;S++)x[S]=a[m++];s.push({payloadType:u,pts:t,uuid:p.join(""),userData:Zi(x),userDataBytes:x})}}}function fS(r){const e=r.byteLength,t=[];let s=1;for(;s<e-2;)r[s]===0&&r[s+1]===0&&r[s+2]===3?(t.push(s+2),s+=2):s++;if(t.length===0)return r;const a=e-t.length,o=new Uint8Array(a);let u=0;for(s=0;s<a;u++,s++)u===t[0]&&(u++,t.shift()),o[s]=r[u];return o}function wL(r){const e=r[0];let t="",s="",a=0,o=0,u=0,c=0,h=0,d=0;if(e===0){for(;vt(r.subarray(d,d+1))!=="\0";)t+=vt(r.subarray(d,d+1)),d+=1;for(t+=vt(r.subarray(d,d+1)),d+=1;vt(r.subarray(d,d+1))!=="\0";)s+=vt(r.subarray(d,d+1)),d+=1;s+=vt(r.subarray(d,d+1)),d+=1,a=Te(r,12),o=Te(r,16),c=Te(r,20),h=Te(r,24),d=28}else if(e===1){d+=4,a=Te(r,d),d+=4;const p=Te(r,d);d+=4;const v=Te(r,d);for(d+=4,u=2**32*p+v,qR(u)||(u=Number.MAX_SAFE_INTEGER,X.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=Te(r,d),d+=4,h=Te(r,d),d+=4;vt(r.subarray(d,d+1))!=="\0";)t+=vt(r.subarray(d,d+1)),d+=1;for(t+=vt(r.subarray(d,d+1)),d+=1;vt(r.subarray(d,d+1))!=="\0";)s+=vt(r.subarray(d,d+1)),d+=1;s+=vt(r.subarray(d,d+1)),d+=1}const m=r.subarray(d,r.byteLength);return{schemeIdUri:t,value:s,timeScale:a,presentationTime:u,presentationTimeDelta:o,eventDuration:c,id:h,payload:m}}function OL(r,...e){const t=e.length;let s=8,a=t;for(;a--;)s+=e[a].byteLength;const o=new Uint8Array(s);for(o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=s&255,o.set(r,4),a=0,s=8;a<t;a++)o.set(e[a],s),s+=e[a].byteLength;return o}function IL(r,e,t){if(r.byteLength!==16)throw new RangeError("Invalid system id");let s,a;s=0,a=new Uint8Array;let o;s>0?(o=new Uint8Array(4),e.length>0&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;const u=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(u.buffer).setUint32(0,t.byteLength,!1),OL([112,115,115,104],new Uint8Array([s,0,0,0]),r,o,a,u,t||new Uint8Array)}function ML(r){const e=[];if(r instanceof ArrayBuffer){const t=r.byteLength;let s=0;for(;s+32<t;){const a=new DataView(r,s),o=kL(a);e.push(o),s+=o.size}}return e}function kL(r){const e=r.getUint32(0),t=r.byteOffset,s=r.byteLength;if(s<e)return{offset:t,size:s};if(r.getUint32(4)!==1886614376)return{offset:t,size:e};const o=r.getUint32(8)>>>24;if(o!==0&&o!==1)return{offset:t,size:e};const u=r.buffer,c=Vi.hexDump(new Uint8Array(u,t+12,16)),h=r.getUint32(28);let d=null,m=null;if(o===0){if(e-32<h||h<22)return{offset:t,size:e};m=new Uint8Array(u,t+32,h)}else if(o===1){if(!h||s<t+32+h*16+16)return{offset:t,size:e};d=[];for(let p=0;p<h;p++)d.push(new Uint8Array(u,t+32+p*16,16))}return{version:o,systemId:c,kids:d,data:m,offset:t,size:e}}let tu={};class Do{static clearKeyUriToKeyIdMap(){tu={}}constructor(e,t,s,a=[1],o=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=s,this.keyFormatVersions=a,this.iv=o,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Xt.FAIRPLAY:case Xt.WIDEVINE:case Xt.PLAYREADY:case Xt.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&X.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const s=NL(e);return new Do(this.method,this.uri,"identity",this.keyFormatVersions,s)}const t=oL(this.uri);if(t)switch(this.keyFormat){case Xt.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Xt.PLAYREADY:{const s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=IL(s,null,t),this.keyId=tS(t);break}default:{let s=t.subarray(0,16);if(s.length!==16){const a=new Uint8Array(16);a.set(s,16-s.length),s=a}this.keyId=s;break}}if(!this.keyId||this.keyId.byteLength!==16){let s=tu[this.uri];if(!s){const a=Object.keys(tu).length%Number.MAX_SAFE_INTEGER;s=new Uint8Array(16),new DataView(s.buffer,12,4).setUint32(0,a),tu[this.uri]=s}this.keyId=s}return this}}function NL(r){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=r>>8*(15-t)&255;return e}const hS=/\{\$([a-zA-Z0-9-_]+)\}/g;function iv(r){return hS.test(r)}function Kt(r,e,t){if(r.variableList!==null||r.hasVariableRefs)for(let s=t.length;s--;){const a=t[s],o=e[a];o&&(e[a]=wd(r,o))}}function wd(r,e){if(r.variableList!==null||r.hasVariableRefs){const t=r.variableList;return e.replace(hS,s=>{const a=s.substring(2,s.length-1),o=t==null?void 0:t[a];return o===void 0?(r.playlistParsingError||(r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${a}"`)),s):o})}return e}function sv(r,e,t){let s=r.variableList;s||(r.variableList=s={});let a,o;if("QUERYPARAM"in e){a=e.QUERYPARAM;try{const u=new self.URL(t).searchParams;if(u.has(a))o=u.get(a);else throw new Error(`"${a}" does not match any query parameter in URI: "${t}"`)}catch(u){r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${u.message}`))}}else a=e.NAME,o=e.VALUE;a in s?r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${a}"`)):s[a]=o||""}function PL(r,e,t){const s=e.IMPORT;if(t&&s in t){let a=r.variableList;a||(r.variableList=a={}),a[s]=t[s]}else r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${s}"`))}function nr(r=!0){return typeof self>"u"?void 0:(r||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function FL(r){return typeof self<"u"&&r===self.ManagedMediaSource}const Pu={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function UL(r,e){const t=Pu[e];return!!t&&!!t[r.slice(0,4)]}function zh(r,e,t=!0){return!r.split(",").some(s=>!dS(s,e,t))}function dS(r,e,t=!0){var s;const a=nr(t);return(s=a==null?void 0:a.isTypeSupported(Co(r,e)))!=null?s:!1}function Co(r,e){return`${e}/mp4;codecs="${r}"`}function nv(r){if(r){const e=r.substring(0,4);return Pu.video[e]}return 2}function Fu(r){return r.split(",").reduce((e,t)=>{const s=Pu.video[t];return s?(s*2+e)/(e?3:2):(Pu.audio[t]+e)/(e?2:1)},0)}const Yh={};function BL(r,e=!0){if(Yh[r])return Yh[r];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[r];for(let s=0;s<t.length;s++)if(dS(t[s],"audio",e))return Yh[r]=t[s],t[s];return r}const jL=/flac|opus/i;function Uu(r,e=!0){return r.replace(jL,t=>BL(t.toLowerCase(),e))}function rv(r,e){return r&&r!=="mp4a"?r:e&&e.split(",")[0]}function GL(r){const e=r.split(",");for(let t=0;t<e.length;t++){const s=e[t].split(".");if(s.length>2){let a=s.shift()+".";a+=parseInt(s.shift()).toString(16),a+=("000"+parseInt(s.shift()).toString(16)).slice(-4),e[t]=a}}return e.join(",")}const av=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,ov=/#EXT-X-MEDIA:(.*)/g,HL=/^#EXT(?:INF|-X-TARGETDURATION):/m,lv=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),$L=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Qi{static findGroup(e,t){for(let s=0;s<e.length;s++){const a=e[s];if(a.id===t)return a}}static resolve(e,t){return e0.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return HL.test(e)}static parseMasterPlaylist(e,t){const s=iv(e),a={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:s},o=[];av.lastIndex=0;let u;for(;(u=av.exec(e))!=null;)if(u[1]){var c;const d=new nt(u[1]);Kt(a,d,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const m=wd(a,u[2]),p={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:Qi.resolve(m,t)},v=d.decimalResolution("RESOLUTION");v&&(p.width=v.width,p.height=v.height),VL(d.CODECS,p),(c=p.unknownCodecs)!=null&&c.length||o.push(p),a.levels.push(p)}else if(u[3]){const d=u[3],m=u[4];switch(d){case"SESSION-DATA":{const p=new nt(m);Kt(a,p,["DATA-ID","LANGUAGE","VALUE","URI"]);const v=p["DATA-ID"];v&&(a.sessionData===null&&(a.sessionData={}),a.sessionData[v]=p);break}case"SESSION-KEY":{const p=uv(m,t,a);p.encrypted&&p.isSupported()?(a.sessionKeys===null&&(a.sessionKeys=[]),a.sessionKeys.push(p)):X.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const p=new nt(m);Kt(a,p,["NAME","VALUE","QUERYPARAM"]),sv(a,p,t)}break}case"CONTENT-STEERING":{const p=new nt(m);Kt(a,p,["SERVER-URI","PATHWAY-ID"]),a.contentSteering={uri:Qi.resolve(p["SERVER-URI"],t),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{a.startTimeOffset=cv(m);break}}}const h=o.length>0&&o.length<a.levels.length;return a.levels=h?o:a.levels,a.levels.length===0&&(a.playlistParsingError=new Error("no levels found in manifest")),a}static parseMasterPlaylistMedia(e,t,s){let a;const o={},u=s.levels,c={AUDIO:u.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:u.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let h=0;for(ov.lastIndex=0;(a=ov.exec(e))!==null;){const d=new nt(a[1]),m=d.TYPE;if(m){const p=c[m],v=o[m]||[];o[m]=v,Kt(s,d,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const x=d.LANGUAGE,S=d["ASSOC-LANGUAGE"],E=d.CHANNELS,T=d.CHARACTERISTICS,A=d["INSTREAM-ID"],w={attrs:d,bitrate:0,id:h++,groupId:d["GROUP-ID"]||"",name:d.NAME||x||"",type:m,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:x,url:d.URI?Qi.resolve(d.URI,t):""};if(S&&(w.assocLang=S),E&&(w.channels=E),T&&(w.characteristics=T),A&&(w.instreamId=A),p!=null&&p.length){const C=Qi.findGroup(p,w.groupId)||p[0];fv(w,C,"audioCodec"),fv(w,C,"textCodec")}v.push(w)}}return o}static parseLevelPlaylist(e,t,s,a,o,u){const c=new nL(t),h=c.fragments;let d=null,m=0,p=0,v=0,x=0,S=null,E=new Bh(a,t),T,A,w,C=-1,k=!1,_=null;for(lv.lastIndex=0,c.m3u8=e,c.hasVariableRefs=iv(e);(T=lv.exec(e))!==null;){k&&(k=!1,E=new Bh(a,t),E.start=v,E.sn=m,E.cc=x,E.level=s,d&&(E.initSegment=d,E.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null,_&&(E.setByteRange(_),_=null)));const D=T[1];if(D){E.duration=parseFloat(D);const N=(" "+T[2]).slice(1);E.title=N||null,E.tagList.push(N?["INF",D,N]:["INF",D])}else if(T[3]){if(ye(E.duration)){E.start=v,w&&mv(E,w,c),E.sn=m,E.level=s,E.cc=x,h.push(E);const N=(" "+T[3]).slice(1);E.relurl=wd(c,N),hv(E,S),S=E,v+=E.duration,m++,p=0,k=!0}}else if(T[4]){const N=(" "+T[4]).slice(1);S?E.setByteRange(N,S):E.setByteRange(N)}else if(T[5])E.rawProgramDateTime=(" "+T[5]).slice(1),E.tagList.push(["PROGRAM-DATE-TIME",E.rawProgramDateTime]),C===-1&&(C=h.length);else{if(T=T[0].match($L),!T){X.warn("No matches on slow regex match for level playlist!");continue}for(A=1;A<T.length&&!(typeof T[A]<"u");A++);const N=(" "+T[A]).slice(1),P=(" "+T[A+1]).slice(1),G=T[A+2]?(" "+T[A+2]).slice(1):"";switch(N){case"PLAYLIST-TYPE":c.type=P.toUpperCase();break;case"MEDIA-SEQUENCE":m=c.startSN=parseInt(P);break;case"SKIP":{const J=new nt(P);Kt(c,J,["RECENTLY-REMOVED-DATERANGES"]);const z=J.decimalInteger("SKIPPED-SEGMENTS");if(ye(z)){c.skippedSegments=z;for(let $=z;$--;)h.unshift(null);m+=z}const Q=J.enumeratedString("RECENTLY-REMOVED-DATERANGES");Q&&(c.recentlyRemovedDateranges=Q.split("	"));break}case"TARGETDURATION":c.targetduration=Math.max(parseInt(P),1);break;case"VERSION":c.version=parseInt(P);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(P||G)&&E.tagList.push(G?[P,G]:[P]);break;case"DISCONTINUITY":x++,E.tagList.push(["DIS"]);break;case"GAP":E.gap=!0,E.tagList.push([N]);break;case"BITRATE":E.tagList.push([N,P]);break;case"DATERANGE":{const J=new nt(P);Kt(c,J,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Kt(c,J,J.clientAttrs);const z=new Zx(J,c.dateRanges[J.ID]);z.isValid||c.skippedSegments?c.dateRanges[z.id]=z:X.warn(`Ignoring invalid DATERANGE tag: "${P}"`),E.tagList.push(["EXT-X-DATERANGE",P]);break}case"DEFINE":{{const J=new nt(P);Kt(c,J,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in J?PL(c,J,u):sv(c,J,t)}break}case"DISCONTINUITY-SEQUENCE":x=parseInt(P);break;case"KEY":{const J=uv(P,t,c);if(J.isSupported()){if(J.method==="NONE"){w=void 0;break}w||(w={}),w[J.keyFormat]&&(w=mt({},w)),w[J.keyFormat]=J}else X.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${P}"`);break}case"START":c.startTimeOffset=cv(P);break;case"MAP":{const J=new nt(P);if(Kt(c,J,["BYTERANGE","URI"]),E.duration){const z=new Bh(a,t);dv(z,J,s,w),d=z,E.initSegment=d,d.rawProgramDateTime&&!E.rawProgramDateTime&&(E.rawProgramDateTime=d.rawProgramDateTime)}else{const z=E.byteRangeEndOffset;if(z){const Q=E.byteRangeStartOffset;_=`${z-Q}@${Q}`}else _=null;dv(E,J,s,w),d=E,k=!0}break}case"SERVER-CONTROL":{const J=new nt(P);c.canBlockReload=J.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=J.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&J.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=J.optionalFloat("PART-HOLD-BACK",0),c.holdBack=J.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const J=new nt(P);c.partTarget=J.decimalFloatingPoint("PART-TARGET");break}case"PART":{let J=c.partList;J||(J=c.partList=[]);const z=p>0?J[J.length-1]:void 0,Q=p++,$=new nt(P);Kt(c,$,["BYTERANGE","URI"]);const oe=new iL($,E,t,Q,z);J.push(oe),E.duration+=oe.duration;break}case"PRELOAD-HINT":{const J=new nt(P);Kt(c,J,["URI"]),c.preloadHint=J;break}case"RENDITION-REPORT":{const J=new nt(P);Kt(c,J,["URI"]),c.renditionReports=c.renditionReports||[],c.renditionReports.push(J);break}default:X.warn(`line parsed but not handled: ${T}`);break}}}S&&!S.relurl?(h.pop(),v-=S.duration,c.partList&&(c.fragmentHint=S)):c.partList&&(hv(E,S),E.cc=x,c.fragmentHint=E,w&&mv(E,w,c));const U=h.length,B=h[0],M=h[U-1];if(v+=c.skippedSegments*c.targetduration,v>0&&U&&M){c.averagetargetduration=v/U;const D=M.sn;c.endSN=D!=="initSegment"?D:0,c.live||(M.endList=!0),B&&(c.startCC=B.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(v+=c.fragmentHint.duration),c.totalduration=v,c.endCC=x,C>0&&KL(h,C),c}}function uv(r,e,t){var s,a;const o=new nt(r);Kt(t,o,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const u=(s=o.METHOD)!=null?s:"",c=o.URI,h=o.hexadecimalInteger("IV"),d=o.KEYFORMATVERSIONS,m=(a=o.KEYFORMAT)!=null?a:"identity";c&&o.IV&&!h&&X.error(`Invalid IV: ${o.IV}`);const p=c?Qi.resolve(c,e):"",v=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Do(u,p,m,v,h)}function cv(r){const t=new nt(r).decimalFloatingPoint("TIME-OFFSET");return ye(t)?t:null}function VL(r,e){let t=(r||"").split(/[ ,]+/).filter(s=>s);["video","audio","text"].forEach(s=>{const a=t.filter(o=>UL(o,s));a.length&&(e[`${s}Codec`]=a.join(","),t=t.filter(o=>a.indexOf(o)===-1))}),e.unknownCodecs=t}function fv(r,e,t){const s=e[t];s&&(r[t]=s)}function KL(r,e){let t=r[e];for(let s=e;s--;){const a=r[s];if(!a)return;a.programDateTime=t.programDateTime-a.duration*1e3,t=a}}function hv(r,e){r.rawProgramDateTime?r.programDateTime=Date.parse(r.rawProgramDateTime):e!=null&&e.programDateTime&&(r.programDateTime=e.endProgramDateTime),ye(r.programDateTime)||(r.programDateTime=null,r.rawProgramDateTime=null)}function dv(r,e,t,s){r.relurl=e.URI,e.BYTERANGE&&r.setByteRange(e.BYTERANGE),r.level=t,r.sn="initSegment",s&&(r.levelkeys=s),r.initSegment=null}function mv(r,e,t){r.levelkeys=e;const{encryptedFragments:s}=t;(!s.length||s[s.length-1].levelkeys!==e)&&Object.keys(e).some(a=>e[a].isCommonEncryption)&&s.push(r)}var Be={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},be={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function gv(r){const{type:e}=r;switch(e){case Be.AUDIO_TRACK:return be.AUDIO;case Be.SUBTITLE_TRACK:return be.SUBTITLE;default:return be.MAIN}}function qh(r,e){let t=r.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class zL{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,s=t.pLoader,a=t.loader,o=s||a,u=new o(t);return this.loaders[e.type]=u,u}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:s}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Be.MANIFEST,url:s,deliveryDirectives:null})}onLevelLoading(e,t){const{id:s,level:a,pathwayId:o,url:u,deliveryDirectives:c}=t;this.load({id:s,level:a,pathwayId:o,responseType:"text",type:Be.LEVEL,url:u,deliveryDirectives:c})}onAudioTrackLoading(e,t){const{id:s,groupId:a,url:o,deliveryDirectives:u}=t;this.load({id:s,groupId:a,level:null,responseType:"text",type:Be.AUDIO_TRACK,url:o,deliveryDirectives:u})}onSubtitleTrackLoading(e,t){const{id:s,groupId:a,url:o,deliveryDirectives:u}=t;this.load({id:s,groupId:a,level:null,responseType:"text",type:Be.SUBTITLE_TRACK,url:o,deliveryDirectives:u})}load(e){var t;const s=this.hls.config;let a=this.getInternalLoader(e);if(a){const d=a.context;if(d&&d.url===e.url&&d.level===e.level){X.trace("[playlist-loader]: playlist request ongoing");return}X.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),a.abort()}let o;if(e.type===Be.MANIFEST?o=s.manifestLoadPolicy.default:o=mt({},s.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),a=this.createInternalLoader(e),ye((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===Be.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===Be.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===Be.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const m=d.partTarget,p=d.targetduration;if(m&&p){const v=Math.max(m*3,p*.8)*1e3;o=mt({},o,{maxTimeToFirstByteMs:Math.min(v,o.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(v,o.maxTimeToFirstByteMs)})}}}const u=o.errorRetry||o.timeoutRetry||{},c={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},h={onSuccess:(d,m,p,v)=>{const x=this.getInternalLoader(p);this.resetInternalLoader(p.type);const S=d.data;if(S.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(d,p,new Error("no EXTM3U delimiter"),v||null,m);return}m.parsing.start=performance.now(),Qi.isMediaPlaylist(S)?this.handleTrackOrLevelPlaylist(d,m,p,v||null,x):this.handleMasterPlaylist(d,m,p,v)},onError:(d,m,p,v)=>{this.handleNetworkError(m,p,!1,d,v)},onTimeout:(d,m,p)=>{this.handleNetworkError(m,p,!0,void 0,d)}};a.load(e,c,h)}handleMasterPlaylist(e,t,s,a){const o=this.hls,u=e.data,c=qh(e,s),h=Qi.parseMasterPlaylist(u,c);if(h.playlistParsingError){this.handleManifestParsingError(e,s,h.playlistParsingError,a,t);return}const{contentSteering:d,levels:m,sessionData:p,sessionKeys:v,startTimeOffset:x,variableList:S}=h;this.variableList=S;const{AUDIO:E=[],SUBTITLES:T,"CLOSED-CAPTIONS":A}=Qi.parseMasterPlaylistMedia(u,c,h);E.length&&!E.some(C=>!C.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(X.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),E.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new nt({}),bitrate:0,url:""})),o.trigger(R.MANIFEST_LOADED,{levels:m,audioTracks:E,subtitles:T,captions:A,contentSteering:d,url:c,stats:t,networkDetails:a,sessionData:p,sessionKeys:v,startTimeOffset:x,variableList:S})}handleTrackOrLevelPlaylist(e,t,s,a,o){const u=this.hls,{id:c,level:h,type:d}=s,m=qh(e,s),p=0,v=ye(h)?h:ye(c)?c:0,x=gv(s),S=Qi.parseLevelPlaylist(e.data,m,v,x,p,this.variableList);if(d===Be.MANIFEST){const E={attrs:new nt({}),bitrate:0,details:S,name:"",url:m};u.trigger(R.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:m,stats:t,networkDetails:a,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),s.levelDetails=S,this.handlePlaylistLoaded(S,e,t,s,a,o)}handleManifestParsingError(e,t,s,a,o){this.hls.trigger(R.ERROR,{type:Ae.NETWORK_ERROR,details:ie.MANIFEST_PARSING_ERROR,fatal:t.type===Be.MANIFEST,url:e.url,err:s,error:s,reason:s.message,response:e,context:t,networkDetails:a,stats:o})}handleNetworkError(e,t,s=!1,a,o){let u=`A network ${s?"timeout":"error"+(a?" (status "+a.code+")":"")} occurred while loading ${e.type}`;e.type===Be.LEVEL?u+=`: ${e.level} id: ${e.id}`:(e.type===Be.AUDIO_TRACK||e.type===Be.SUBTITLE_TRACK)&&(u+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(u);X.warn(`[playlist-loader]: ${u}`);let h=ie.UNKNOWN,d=!1;const m=this.getInternalLoader(e);switch(e.type){case Be.MANIFEST:h=s?ie.MANIFEST_LOAD_TIMEOUT:ie.MANIFEST_LOAD_ERROR,d=!0;break;case Be.LEVEL:h=s?ie.LEVEL_LOAD_TIMEOUT:ie.LEVEL_LOAD_ERROR,d=!1;break;case Be.AUDIO_TRACK:h=s?ie.AUDIO_TRACK_LOAD_TIMEOUT:ie.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Be.SUBTITLE_TRACK:h=s?ie.SUBTITLE_TRACK_LOAD_TIMEOUT:ie.SUBTITLE_LOAD_ERROR,d=!1;break}m&&this.resetInternalLoader(e.type);const p={type:Ae.NETWORK_ERROR,details:h,fatal:d,url:e.url,loader:m,context:e,error:c,networkDetails:t,stats:o};if(a){const v=(t==null?void 0:t.url)||e.url;p.response=Lt({url:v,data:void 0},a)}this.hls.trigger(R.ERROR,p)}handlePlaylistLoaded(e,t,s,a,o,u){const c=this.hls,{type:h,level:d,id:m,groupId:p,deliveryDirectives:v}=a,x=qh(t,a),S=gv(a),E=typeof a.level=="number"&&S===be.MAIN?d:void 0;if(!e.fragments.length){const A=new Error("No Segments found in Playlist");c.trigger(R.ERROR,{type:Ae.NETWORK_ERROR,details:ie.LEVEL_EMPTY_ERROR,fatal:!1,url:x,error:A,reason:A.message,response:t,context:a,level:E,parent:S,networkDetails:o,stats:s});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const T=e.playlistParsingError;if(T){c.trigger(R.ERROR,{type:Ae.NETWORK_ERROR,details:ie.LEVEL_PARSING_ERROR,fatal:!1,url:x,error:T,reason:T.message,response:t,context:a,level:E,parent:S,networkDetails:o,stats:s});return}switch(e.live&&u&&(u.getCacheAge&&(e.ageHeader=u.getCacheAge()||0),(!u.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),h){case Be.MANIFEST:case Be.LEVEL:c.trigger(R.LEVEL_LOADED,{details:e,level:E||0,id:m||0,stats:s,networkDetails:o,deliveryDirectives:v});break;case Be.AUDIO_TRACK:c.trigger(R.AUDIO_TRACK_LOADED,{details:e,id:m||0,groupId:p||"",stats:s,networkDetails:o,deliveryDirectives:v});break;case Be.SUBTITLE_TRACK:c.trigger(R.SUBTITLE_TRACK_LOADED,{details:e,id:m||0,groupId:p||"",stats:s,networkDetails:o,deliveryDirectives:v});break}}}function mS(r,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=r,e.dispatchEvent(t)}function gS(r,e){const t=r.mode;if(t==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(e.id))try{if(r.addCue(e),!r.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(s){X.debug(`[texttrack-utils]: ${s}`);try{const a=new self.TextTrackCue(e.startTime,e.endTime,e.text);a.id=e.id,r.addCue(a)}catch(a){X.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${a}`)}}t==="disabled"&&(r.mode=t)}function Yr(r){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues)for(let t=r.cues.length;t--;)r.removeCue(r.cues[t]);e==="disabled"&&(r.mode=e)}function Od(r,e,t,s){const a=r.mode;if(a==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){const o=qL(r.cues,e,t);for(let u=0;u<o.length;u++)(!s||s(o[u]))&&r.removeCue(o[u])}a==="disabled"&&(r.mode=a)}function YL(r,e){if(e<r[0].startTime)return 0;const t=r.length-1;if(e>r[t].endTime)return-1;let s=0,a=t;for(;s<=a;){const o=Math.floor((a+s)/2);if(e<r[o].startTime)a=o-1;else if(e>r[o].startTime&&s<t)s=o+1;else return o}return r[s].startTime-e<e-r[a].startTime?s:a}function qL(r,e,t){const s=[],a=YL(r,e);if(a>-1)for(let o=a,u=r.length;o<u;o++){const c=r[o];if(c.startTime>=e&&c.endTime<=t)s.push(c);else if(c.startTime>t)return s}return s}function gu(r){const e=[];for(let t=0;t<r.length;t++){const s=r[t];(s.kind==="subtitles"||s.kind==="captions")&&s.label&&e.push(r[t])}return e}var ki={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const XL=.25;function Id(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function pv(r,e,t,s,a){let o=new r(e,t,"");try{o.value=s,a&&(o.type=a)}catch{o=new r(e,t,JSON.stringify(a?Lt({type:a},s):s))}return o}const iu=(()=>{const r=Id();try{r&&new r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Xh(r,e){return r.getTime()/1e3-e}function QL(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class WL{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Yr(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const s=e[t];if(s.kind==="metadata"&&s.label==="id3")return mS(s,this.media),s}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:s,enableID3MetadataCues:a}}}=this;if(!s&&!a)return;const{samples:o}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=Id();if(u)for(let c=0;c<o.length;c++){const h=o[c].type;if(h===ki.emsg&&!s||!a)continue;const d=nS(o[c].data);if(d){const m=o[c].pts;let p=m+o[c].duration;p>iu&&(p=iu),p-m<=0&&(p=m+XL);for(let x=0;x<d.length;x++){const S=d[x];if(!sS(S)){this.updateId3CueEnds(m,h);const E=pv(u,m,p,S,h);E&&this.id3Track.addCue(E)}}}}}updateId3CueEnds(e,t){var s;const a=(s=this.id3Track)==null?void 0:s.cues;if(a)for(let o=a.length;o--;){const u=a[o];u.type===t&&u.startTime<e&&u.endTime===iu&&(u.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:s,type:a}){const{id3Track:o,hls:u}=this;if(!u)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:h}}=u;if(o&&(c||h)){let d;a==="audio"?d=m=>m.type===ki.audioId3&&h:a==="video"?d=m=>m.type===ki.emsg&&c:d=m=>m.type===ki.audioId3&&h||m.type===ki.emsg&&c,Od(o,t,s,d)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:s,id3Track:a}=this,{dateRanges:o}=t,u=Object.keys(o);if(a){const m=Object.keys(s).filter(p=>!u.includes(p));for(let p=m.length;p--;){const v=m[p];Object.keys(s[v].cues).forEach(x=>{a.removeCue(s[v].cues[x])}),delete s[v]}}const c=t.fragments[t.fragments.length-1];if(u.length===0||!ye(c==null?void 0:c.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const h=c.programDateTime/1e3-c.start,d=Id();for(let m=0;m<u.length;m++){const p=u[m],v=o[p],x=Xh(v.startDate,h),S=s[p],E=(S==null?void 0:S.cues)||{};let T=(S==null?void 0:S.durationKnown)||!1,A=iu;const w=v.endDate;if(w)A=Xh(w,h),T=!0;else if(v.endOnNext&&!T){const k=u.reduce((_,U)=>{if(U!==v.id){const B=o[U];if(B.class===v.class&&B.startDate>v.startDate&&(!_||v.startDate<_.startDate))return B}return _},null);k&&(A=Xh(k.startDate,h),T=!0)}const C=Object.keys(v.attr);for(let k=0;k<C.length;k++){const _=C[k];if(!eL(_))continue;const U=E[_];if(U)T&&!S.durationKnown&&(U.endTime=A);else if(d){let B=v.attr[_];tL(_)&&(B=QL(B));const M=pv(d,x,A,{key:_,data:B},ki.dateRange);M&&(M.id=p,this.id3Track.addCue(M),E[_]=M)}}s[p]={cues:E,dateRange:v,durationKnown:T}}}}class ZL{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:s,targetduration:a}=e,{liveSyncDuration:o,liveSyncDurationCount:u,lowLatencyMode:c}=this.config,h=this.hls.userConfig;let d=c&&s||t;(h.liveSyncDuration||h.liveSyncDurationCount||d===0)&&(d=o!==void 0?o:u*a);const m=a;return d+Math.min(this.stallCount*1,m)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,s=this.levelDetails;if(e===null||t===null||s===null)return null;const a=s.edge,o=e-t-this.edgeStalled,u=a-s.totalduration,c=a-(this.config.lowLatencyMode&&s.partTarget||s.targetduration);return Math.min(Math.max(u,o),c)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const s=e.buffered.length;return(s?e.buffered.end(s-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(R.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(R.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var s;t.details===ie.BUFFER_STALLED_ERROR&&(this.stallCount++,(s=this.levelDetails)!=null&&s.live&&X.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:o}=this.config;if(!a||o===1||!t.live)return;const u=this.targetLatency;if(u===null)return;const c=s-u,h=Math.min(this.maxLatency,u+t.targetduration);if(c<h&&c>.05&&this.forwardBufferLength>1){const m=Math.min(2,Math.max(1,o)),p=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;e.playbackRate=Math.min(m,Math.max(1,p))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const Md=["NONE","TYPE-0","TYPE-1",null];function JL(r){return Md.indexOf(r)>-1}const Bu=["SDR","PQ","HLG"];function e_(r){return!!r&&Bu.indexOf(r)>-1}var pu={No:"",Yes:"YES",v2:"v2"};function yv(r){const{canSkipUntil:e,canSkipDateRanges:t,age:s}=r,a=s<e/2;return e&&a?t?pu.v2:pu.Yes:pu.No}class vv{constructor(e,t,s){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=s}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class ga{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return xv(this._audioGroups,e)}hasSubtitleGroup(e){return xv(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let s=this._audioGroups;s||(s=this._audioGroups=[]),s.indexOf(t)===-1&&s.push(t)}else if(e==="text"){let s=this._subtitleGroups;s||(s=this._subtitleGroups=[]),s.indexOf(t)===-1&&s.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function xv(r,e){return!e||!r?!1:r.indexOf(e)!==-1}function Qh(r,e){const t=e.startPTS;if(ye(t)){let s=0,a;e.sn>r.sn?(s=t-r.start,a=r):(s=r.start-t,a=e),a.duration!==s&&(a.duration=s)}else e.sn>r.sn?r.cc===e.cc&&r.minEndPTS?e.start=r.start+(r.minEndPTS-r.start):e.start=r.start+r.duration:e.start=Math.max(r.start-e.duration,0)}function pS(r,e,t,s,a,o){s-t<=0&&(X.warn("Fragment should have a positive duration",e),s=t+e.duration,o=a+e.duration);let c=t,h=s;const d=e.startPTS,m=e.endPTS;if(ye(d)){const T=Math.abs(d-t);ye(e.deltaPTS)?e.deltaPTS=Math.max(T,e.deltaPTS):e.deltaPTS=T,c=Math.max(t,d),t=Math.min(t,d),a=Math.min(a,e.startDTS),h=Math.min(s,m),s=Math.max(s,m),o=Math.max(o,e.endDTS)}const p=t-e.start;e.start!==0&&(e.start=t),e.duration=s-e.start,e.startPTS=t,e.maxStartPTS=c,e.startDTS=a,e.endPTS=s,e.minEndPTS=h,e.endDTS=o;const v=e.sn;if(!r||v<r.startSN||v>r.endSN)return 0;let x;const S=v-r.startSN,E=r.fragments;for(E[S]=e,x=S;x>0;x--)Qh(E[x],E[x-1]);for(x=S;x<E.length-1;x++)Qh(E[x],E[x+1]);return r.fragmentHint&&Qh(E[E.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,p}function t_(r,e){let t=null;const s=r.fragments;for(let c=s.length-1;c>=0;c--){const h=s[c].initSegment;if(h){t=h;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let a;n_(r,e,(c,h,d,m)=>{if(e.skippedSegments&&h.cc!==c.cc){const p=c.cc-h.cc;for(let v=d;v<m.length;v++)m[v].cc+=p}ye(c.startPTS)&&ye(c.endPTS)&&(h.start=h.startPTS=c.startPTS,h.startDTS=c.startDTS,h.maxStartPTS=c.maxStartPTS,h.endPTS=c.endPTS,h.endDTS=c.endDTS,h.minEndPTS=c.minEndPTS,h.duration=c.endPTS-c.startPTS,h.duration&&(a=h),e.PTSKnown=e.alignedSliding=!0),h.elementaryStreams=c.elementaryStreams,h.loader=c.loader,h.stats=c.stats,c.initSegment&&(h.initSegment=c.initSegment,t=c.initSegment)});const o=e.fragments;if(t&&(e.fragmentHint?o.concat(e.fragmentHint):o).forEach(h=>{var d;h&&(!h.initSegment||h.initSegment.relurl===((d=t)==null?void 0:d.relurl))&&(h.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=o.some(c=>!c),e.deltaUpdateFailed){X.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let c=e.skippedSegments;c--;)o.shift();e.startSN=o[0].sn}else e.canSkipDateRanges&&(e.dateRanges=i_(r.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));e.startCC=e.fragments[0].cc,e.endCC=o[o.length-1].cc}s_(r.partList,e.partList,(c,h)=>{h.elementaryStreams=c.elementaryStreams,h.stats=c.stats}),a?pS(e,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):yS(r,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=r.driftStartTime,e.driftStart=r.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const c=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=c),e.driftEndTime=u,e.driftEnd=c}else e.driftEndTime=r.driftEndTime,e.driftEnd=r.driftEnd,e.advancedDateTime=r.advancedDateTime}function i_(r,e,t){const s=mt({},r);return t&&t.forEach(a=>{delete s[a]}),Object.keys(e).forEach(a=>{const o=new Zx(e[a].attr,s[a]);o.isValid?s[a]=o:X.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[a].attr)}"`)}),s}function s_(r,e,t){if(r&&e){let s=0;for(let a=0,o=r.length;a<=o;a++){const u=r[a],c=e[a+s];u&&c&&u.index===c.index&&u.fragment.sn===c.fragment.sn?t(u,c):s--}}}function n_(r,e,t){const s=e.skippedSegments,a=Math.max(r.startSN,e.startSN)-e.startSN,o=(r.fragmentHint?1:0)+(s?e.endSN:Math.min(r.endSN,e.endSN))-e.startSN,u=e.startSN-r.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,h=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let d=a;d<=o;d++){const m=h[u+d];let p=c[d];s&&!p&&d<s&&(p=e.fragments[d]=m),m&&p&&t(m,p,d,c)}}function yS(r,e){const t=e.startSN+e.skippedSegments-r.startSN,s=r.fragments;t<0||t>=s.length||kd(e,s[t].start)}function kd(r,e){if(e){const t=r.fragments;for(let s=r.skippedSegments;s<t.length;s++)t[s].start+=e;r.fragmentHint&&(r.fragmentHint.start+=e)}}function r_(r,e=1/0){let t=1e3*r.targetduration;if(r.updated){const s=r.fragments;if(s.length&&t*4>e){const o=s[s.length-1].duration*1e3;o<t&&(t=o)}}else t/=2;return Math.round(t)}function a_(r,e,t){if(!(r!=null&&r.details))return null;const s=r.details;let a=s.fragments[e-s.startSN];return a||(a=s.fragmentHint,a&&a.sn===e)?a:e<s.startSN&&t&&t.sn===e?t:null}function Sv(r,e,t){var s;return r!=null&&r.details?vS((s=r.details)==null?void 0:s.partList,e,t):null}function vS(r,e,t){if(r)for(let s=r.length;s--;){const a=r[s];if(a.index===t&&a.fragment.sn===e)return a}return null}function xS(r){r.forEach((e,t)=>{const{details:s}=e;s!=null&&s.fragments&&s.fragments.forEach(a=>{a.level=t})})}function ju(r){switch(r.details){case ie.FRAG_LOAD_TIMEOUT:case ie.KEY_LOAD_TIMEOUT:case ie.LEVEL_LOAD_TIMEOUT:case ie.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Ev(r,e){const t=ju(e);return r.default[`${t?"timeout":"error"}Retry`]}function n0(r,e){const t=r.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*r.retryDelayMs,r.maxRetryDelayMs)}function Tv(r){return Lt(Lt({},r),{errorRetry:null,timeoutRetry:null})}function Gu(r,e,t,s){if(!r)return!1;const a=s==null?void 0:s.code,o=e<r.maxNumRetry&&(o_(a)||!!t);return r.shouldRetry?r.shouldRetry(r,e,t,s,o):o}function o_(r){return r===0&&navigator.onLine===!1||!!r&&(r<400||r>499)}const SS={search:function(r,e){let t=0,s=r.length-1,a=null,o=null;for(;t<=s;){a=(t+s)/2|0,o=r[a];const u=e(o);if(u>0)t=a+1;else if(u<0)s=a-1;else return o}return null}};function l_(r,e,t){if(e===null||!Array.isArray(r)||!r.length||!ye(e))return null;const s=r[0].programDateTime;if(e<(s||0))return null;const a=r[r.length-1].endProgramDateTime;if(e>=(a||0))return null;t=t||0;for(let o=0;o<r.length;++o){const u=r[o];if(c_(e,t,u))return u}return null}function Hu(r,e,t=0,s=0,a=.005){let o=null;if(r){o=e[r.sn-e[0].sn+1]||null;const c=r.endDTS-t;c>0&&c<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(o=e[0]);if(o&&((!r||r.level===o.level)&&Nd(t,s,o)===0||u_(o,r,Math.min(a,s))))return o;const u=SS.search(e,Nd.bind(null,t,s));return u&&(u!==r||!o)?u:o}function u_(r,e,t){if(e&&e.start===0&&e.level<r.level&&(e.endPTS||0)>0){const s=e.tagList.reduce((a,o)=>(o[0]==="INF"&&(a+=parseFloat(o[1])),a),t);return r.start<=s}return!1}function Nd(r=0,e=0,t){if(t.start<=r&&t.start+t.duration>r)return 0;const s=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-s<=r?1:t.start-s>r&&t.start?-1:0}function c_(r,e,t){const s=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-s>r}function f_(r,e){return SS.search(r,t=>t.cc<e?1:t.cc>e?-1:0)}var Ot={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Ci={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class h_{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=X.log.bind(X,"[info]:"),this.warn=X.warn.bind(X,"[warning]:"),this.error=X.error.bind(X,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(R.ERROR,this.onError,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(R.ERROR,this.onError,this),e.off(R.ERROR,this.onErrorOut,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===be.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var s,a;if(t.fatal)return;const o=this.hls,u=t.context;switch(t.details){case ie.FRAG_LOAD_ERROR:case ie.FRAG_LOAD_TIMEOUT:case ie.KEY_LOAD_ERROR:case ie.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case ie.FRAG_PARSING_ERROR:if((s=t.frag)!=null&&s.gap){t.errorAction={action:Ot.DoNothing,flags:Ci.None};return}case ie.FRAG_GAP:case ie.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Ot.SendAlternateToPenaltyBox;return}case ie.LEVEL_EMPTY_ERROR:case ie.LEVEL_PARSING_ERROR:{var c,h;const d=t.parent===be.MAIN?t.level:o.loadLevel;t.details===ie.LEVEL_EMPTY_ERROR&&((c=t.context)!=null&&(h=c.levelDetails)!=null&&h.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,d):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,d))}return;case ie.LEVEL_LOAD_ERROR:case ie.LEVEL_LOAD_TIMEOUT:typeof(u==null?void 0:u.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u.level));return;case ie.AUDIO_TRACK_LOAD_ERROR:case ie.AUDIO_TRACK_LOAD_TIMEOUT:case ie.SUBTITLE_LOAD_ERROR:case ie.SUBTITLE_TRACK_LOAD_TIMEOUT:if(u){const d=o.levels[o.loadLevel];if(d&&(u.type===Be.AUDIO_TRACK&&d.hasAudioGroup(u.groupId)||u.type===Be.SUBTITLE_TRACK&&d.hasSubtitleGroup(u.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.loadLevel),t.errorAction.action=Ot.SendAlternateToPenaltyBox,t.errorAction.flags=Ci.MoveAllAlternatesMatchingHost;return}}return;case ie.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const d=o.levels[o.loadLevel],m=d==null?void 0:d.attrs["HDCP-LEVEL"];m?t.errorAction={action:Ot.SendAlternateToPenaltyBox,flags:Ci.MoveAllAlternatesMatchingHDCP,hdcpLevel:m}:this.keySystemError(t)}return;case ie.BUFFER_ADD_CODEC_ERROR:case ie.REMUX_ALLOC_ERROR:case ie.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(a=t.level)!=null?a:o.loadLevel);return;case ie.INTERNAL_EXCEPTION:case ie.BUFFER_APPENDING_ERROR:case ie.BUFFER_FULL_ERROR:case ie.LEVEL_SWITCH_ERROR:case ie.BUFFER_STALLED_ERROR:case ie.BUFFER_SEEK_OVER_HOLE:case ie.BUFFER_NUDGE_ON_STALL:t.errorAction={action:Ot.DoNothing,flags:Ci.None};return}t.type===Ae.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const s=this.hls,a=Ev(s.config.playlistLoadPolicy,e),o=this.playlistError++;if(Gu(a,o,ju(e),e.response))return{action:Ot.RetryRequest,flags:Ci.None,retryConfig:a,retryCount:o};const c=this.getLevelSwitchAction(e,t);return a&&(c.retryConfig=a,c.retryCount=o),c}getFragRetryOrSwitchAction(e){const t=this.hls,s=this.getVariantLevelIndex(e.frag),a=t.levels[s],{fragLoadPolicy:o,keyLoadPolicy:u}=t.config,c=Ev(e.details.startsWith("key")?u:o,e),h=t.levels.reduce((m,p)=>m+p.fragmentError,0);if(a&&(e.details!==ie.FRAG_GAP&&a.fragmentError++,Gu(c,h,ju(e),e.response)))return{action:Ot.RetryRequest,flags:Ci.None,retryConfig:c,retryCount:h};const d=this.getLevelSwitchAction(e,s);return c&&(d.retryConfig=c,d.retryCount=h),d}getLevelSwitchAction(e,t){const s=this.hls;t==null&&(t=s.loadLevel);const a=this.hls.levels[t];if(a){var o,u;const d=e.details;a.loadError++,d===ie.BUFFER_APPEND_ERROR&&a.fragmentError++;let m=-1;const{levels:p,loadLevel:v,minAutoLevel:x,maxAutoLevel:S}=s;s.autoLevelEnabled||(s.loadLevel=-1);const E=(o=e.frag)==null?void 0:o.type,A=(E===be.AUDIO&&d===ie.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===ie.BUFFER_ADD_CODEC_ERROR||d===ie.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:U})=>a.audioCodec!==U),C=e.sourceBufferName==="video"&&(d===ie.BUFFER_ADD_CODEC_ERROR||d===ie.BUFFER_APPEND_ERROR)&&p.some(({codecSet:U,audioCodec:B})=>a.codecSet!==U&&a.audioCodec===B),{type:k,groupId:_}=(u=e.context)!=null?u:{};for(let U=p.length;U--;){const B=(U+v)%p.length;if(B!==v&&B>=x&&B<=S&&p[B].loadError===0){var c,h;const M=p[B];if(d===ie.FRAG_GAP&&E===be.MAIN&&e.frag){const D=p[B].details;if(D){const N=Hu(e.frag,D.fragments,e.frag.start);if(N!=null&&N.gap)continue}}else{if(k===Be.AUDIO_TRACK&&M.hasAudioGroup(_)||k===Be.SUBTITLE_TRACK&&M.hasSubtitleGroup(_))continue;if(E===be.AUDIO&&(c=a.audioGroups)!=null&&c.some(D=>M.hasAudioGroup(D))||E===be.SUBTITLE&&(h=a.subtitleGroups)!=null&&h.some(D=>M.hasSubtitleGroup(D))||A&&a.audioCodec===M.audioCodec||!A&&a.audioCodec!==M.audioCodec||C&&a.codecSet===M.codecSet)continue}m=B;break}}if(m>-1&&s.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:Ot.SendAlternateToPenaltyBox,flags:Ci.None,nextAutoLevel:m}}return{action:Ot.SendAlternateToPenaltyBox,flags:Ci.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var s;switch((s=t.errorAction)==null?void 0:s.action){case Ot.DoNothing:break;case Ot.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==ie.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,s=e.errorAction;if(!s)return;const{flags:a,hdcpLevel:o,nextAutoLevel:u}=s;switch(a){case Ci.None:this.switchLevel(e,u);break;case Ci.MoveAllAlternatesMatchingHDCP:o&&(t.maxHdcpLevel=Md[Md.indexOf(o)-1],s.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}s.resolved||this.switchLevel(e,u)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class r0{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=X.log.bind(X,`${t}:`),this.warn=X.warn.bind(X,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,s){const a=t==null?void 0:t.renditionReports;if(a){let o=-1;for(let u=0;u<a.length;u++){const c=a[u];let h;try{h=new self.URL(c.URI,t.url).href}catch(d){X.warn(`Could not construct new URL for Rendition Report: ${d}`),h=c.URI||""}if(h===e){o=u;break}else h===e.substring(0,h.length)&&(o=u)}if(o!==-1){const u=a[o],c=parseInt(u["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let h=parseInt(u["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const m=Math.min(t.age-t.partTarget,t.targetduration);h>=0&&m>t.partTarget&&(h+=1)}const d=s&&yv(s);return new vv(c,h>=0?h:void 0,d)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,s){const{details:a,stats:o}=t,u=self.performance.now(),c=o.loading.first?Math.max(0,u-o.loading.first):0;if(a.advancedDateTime=Date.now()-c,a.live||s!=null&&s.live){if(a.reloaded(s),s&&this.log(`live playlist ${e} ${a.advanced?"REFRESHED "+a.lastPartSn+"-"+a.lastPartIndex:a.updated?"UPDATED":"MISSED"}`),s&&a.fragments.length>0&&t_(s,a),!this.canLoad||!a.live)return;let h,d,m;if(a.canBlockReload&&a.endSN&&a.advanced){const T=this.hls.config.lowLatencyMode,A=a.lastPartSn,w=a.endSN,C=a.lastPartIndex,k=C!==-1,_=A===w,U=T?0:C;k?(d=_?w+1:A,m=_?U:C+1):d=w+1;const B=a.age,M=B+a.ageHeader;let D=Math.min(M-a.partTarget,a.targetduration*1.5);if(D>0){if(s&&D>s.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${s.tuneInGoal} to: ${D} with playlist age: ${a.age}`),D=0;else{const N=Math.floor(D/a.targetduration);if(d+=N,m!==void 0){const P=Math.round(D%a.targetduration/a.partTarget);m+=P}this.log(`CDN Tune-in age: ${a.ageHeader}s last advanced ${B.toFixed(2)}s goal: ${D} skip sn ${N} to part ${m}`)}a.tuneInGoal=D}if(h=this.getDeliveryDirectives(a,t.deliveryDirectives,d,m),T||!_){this.loadPlaylist(h);return}}else(a.canBlockReload||a.canSkipUntil)&&(h=this.getDeliveryDirectives(a,t.deliveryDirectives,d,m));const p=this.hls.mainForwardBufferInfo,v=p?p.end-p.len:0,x=(a.edge-v)*1e3,S=r_(a,x);a.updated&&u>this.requestScheduled+S&&(this.requestScheduled=o.loading.start),d!==void 0&&a.canBlockReload?this.requestScheduled=o.loading.first+S-(a.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+S<u?this.requestScheduled=u:this.requestScheduled-u<=0&&(this.requestScheduled+=S);let E=this.requestScheduled-u;E=Math.max(0,E),this.log(`reload live playlist ${e} in ${Math.round(E)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(h),E)}else this.clearTimer()}getDeliveryDirectives(e,t,s,a){let o=yv(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(s=t.msn,a=t.part,o=pu.No),new vv(s,a,o)}checkRetry(e){const t=e.details,s=ju(e),a=e.errorAction,{action:o,retryCount:u=0,retryConfig:c}=a||{},h=!!a&&!!c&&(o===Ot.RetryRequest||!a.resolved&&o===Ot.SendAlternateToPenaltyBox);if(h){var d;if(this.requestScheduled=-1,u>=c.maxNumRetry)return!1;if(s&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${u+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const m=n0(c,u);this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${u+1}/${c.maxNumRetry} after "${t}" in ${m}ms`)}e.levelRetry=!0,a.resolved=!0}return h}}class jr{constructor(e,t=0,s=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=s}sample(e,t){const s=Math.pow(this.alpha_,e);this.estimate_=t*(1-s)+s*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class d_{constructor(e,t,s,a=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=s,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new jr(e),this.fast_=new jr(t),this.defaultTTFB_=a,this.ttfb_=new jr(e)}update(e,t){const{slow_:s,fast_:a,ttfb_:o}=this;s.halfLife!==e&&(this.slow_=new jr(e,s.getEstimate(),s.getTotalWeight())),a.halfLife!==t&&(this.fast_=new jr(t,a.getEstimate(),a.getTotalWeight())),o.halfLife!==e&&(this.ttfb_=new jr(e,o.getEstimate(),o.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const s=8*t,a=e/1e3,o=s/a;this.fast_.sample(a,o),this.slow_.sample(a,o)}sampleTTFB(e){const t=e/1e3,s=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(s,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const ES={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},bv={};function m_(r,e,t,s,a,o){const u=r.audioCodec?r.audioGroups:null,c=o==null?void 0:o.audioCodec,h=o==null?void 0:o.channels,d=h?parseInt(h):c?1/0:2;let m=null;if(u!=null&&u.length)try{u.length===1&&u[0]?m=e.groups[u[0]].channels:m=u.reduce((p,v)=>{if(v){const x=e.groups[v];if(!x)throw new Error(`Audio track group ${v} not found`);Object.keys(x.channels).forEach(S=>{p[S]=(p[S]||0)+x.channels[S]})}return p},{2:0})}catch{return!0}return r.videoCodec!==void 0&&(r.width>1920&&r.height>1088||r.height>1920&&r.width>1088||r.frameRate>Math.max(s,30)||r.videoRange!=="SDR"&&r.videoRange!==t||r.bitrate>Math.max(a,8e6))||!!m&&ye(d)&&Object.keys(m).some(p=>parseInt(p)>d)}function g_(r,e,t){const s=r.videoCodec,a=r.audioCodec;if(!s||!a||!t)return Promise.resolve(ES);const o={width:r.width,height:r.height,bitrate:Math.ceil(Math.max(r.bitrate*.9,r.averageBitrate)),framerate:r.frameRate||30},u=r.videoRange;u!=="SDR"&&(o.transferFunction=u.toLowerCase());const c=s.split(",").map(h=>({type:"media-source",video:Lt(Lt({},o),{},{contentType:Co(h,"video")})}));return a&&r.audioGroups&&r.audioGroups.forEach(h=>{var d;h&&((d=e.groups[h])==null||d.tracks.forEach(m=>{if(m.groupId===h){const p=m.channels||"",v=parseFloat(p);ye(v)&&v>2&&c.push.apply(c,a.split(",").map(x=>({type:"media-source",audio:{contentType:Co(x,"audio"),channels:""+v}})))}}))}),Promise.all(c.map(h=>{const d=p_(h);return bv[d]||(bv[d]=t.decodingInfo(h))})).then(h=>({supported:!h.some(d=>!d.supported),configurations:c,decodingInfoResults:h})).catch(h=>({supported:!1,configurations:c,decodingInfoResults:[],error:h}))}function p_(r){const{audio:e,video:t}=r,s=t||e;if(s){const a=s.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${a}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${a}`}return""}function y_(){if(typeof matchMedia=="function"){const r=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(r.media!==e.media)return r.matches===!0}return!1}function v_(r,e){let t=!1,s=[];return r&&(t=r!=="SDR",s=[r]),e&&(s=e.allowedVideoRanges||Bu.slice(0),t=e.preferHDR!==void 0?e.preferHDR:y_(),t?s=s.filter(a=>a!=="SDR"):s=["SDR"]),{preferHDR:t,allowedVideoRanges:s}}function x_(r,e,t,s,a){const o=Object.keys(r),u=s==null?void 0:s.channels,c=s==null?void 0:s.audioCodec,h=u&&parseInt(u)===2;let d=!0,m=!1,p=1/0,v=1/0,x=1/0,S=0,E=[];const{preferHDR:T,allowedVideoRanges:A}=v_(e,a);for(let _=o.length;_--;){const U=r[o[_]];d=U.channels[2]>0,p=Math.min(p,U.minHeight),v=Math.min(v,U.minFramerate),x=Math.min(x,U.minBitrate);const B=A.filter(M=>U.videoRanges[M]>0);B.length>0&&(m=!0,E=B)}p=ye(p)?p:0,v=ye(v)?v:0;const w=Math.max(1080,p),C=Math.max(30,v);return x=ye(x)?x:t,t=Math.max(x,t),m||(e=void 0,E=[]),{codecSet:o.reduce((_,U)=>{const B=r[U];if(U===_)return _;if(B.minBitrate>t)return Ss(U,`min bitrate of ${B.minBitrate} > current estimate of ${t}`),_;if(!B.hasDefaultAudio)return Ss(U,"no renditions with default or auto-select sound found"),_;if(c&&U.indexOf(c.substring(0,4))%5!==0)return Ss(U,`audio codec preference "${c}" not found`),_;if(u&&!h){if(!B.channels[u])return Ss(U,`no renditions with ${u} channel sound found (channels options: ${Object.keys(B.channels)})`),_}else if((!c||h)&&d&&B.channels[2]===0)return Ss(U,"no renditions with stereo sound found"),_;return B.minHeight>w?(Ss(U,`min resolution of ${B.minHeight} > maximum of ${w}`),_):B.minFramerate>C?(Ss(U,`min framerate of ${B.minFramerate} > maximum of ${C}`),_):E.some(M=>B.videoRanges[M]>0)?B.maxScore<S?(Ss(U,`max score of ${B.maxScore} < selected max of ${S}`),_):_&&(Fu(U)>=Fu(_)||B.fragmentError>r[_].fragmentError)?_:(S=B.maxScore,U):(Ss(U,`no variants with VIDEO-RANGE of ${JSON.stringify(E)} found`),_)},void 0),videoRanges:E,preferHDR:T,minFramerate:v,minBitrate:x}}function Ss(r,e){X.log(`[abr] start candidates with "${r}" ignored because ${e}`)}function S_(r){return r.reduce((e,t)=>{let s=e.groups[t.groupId];s||(s=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),s.tracks.push(t);const a=t.channels||"2";return s.channels[a]=(s.channels[a]||0)+1,s.hasDefault=s.hasDefault||t.default,s.hasAutoSelect=s.hasAutoSelect||t.autoselect,s.hasDefault&&(e.hasDefaultAudio=!0),s.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function E_(r,e,t,s){return r.slice(t,s+1).reduce((a,o)=>{if(!o.codecSet)return a;const u=o.audioGroups;let c=a[o.codecSet];c||(a[o.codecSet]=c={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),c.minBitrate=Math.min(c.minBitrate,o.bitrate);const h=Math.min(o.height,o.width);return c.minHeight=Math.min(c.minHeight,h),c.minFramerate=Math.min(c.minFramerate,o.frameRate),c.maxScore=Math.max(c.maxScore,o.score),c.fragmentError+=o.fragmentError,c.videoRanges[o.videoRange]=(c.videoRanges[o.videoRange]||0)+1,u&&u.forEach(d=>{if(!d)return;const m=e.groups[d];m&&(c.hasDefaultAudio=c.hasDefaultAudio||e.hasDefaultAudio?m.hasDefault:m.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(m.channels).forEach(p=>{c.channels[p]=(c.channels[p]||0)+m.channels[p]}))}),a},{})}function Wi(r,e,t){if("attrs"in r){const s=e.indexOf(r);if(s!==-1)return s}for(let s=0;s<e.length;s++){const a=e[s];if(tr(r,a,t))return s}return-1}function tr(r,e,t){const{groupId:s,name:a,lang:o,assocLang:u,default:c}=r,h=r.forced;return(s===void 0||e.groupId===s)&&(a===void 0||e.name===a)&&(o===void 0||e.lang===o)&&(o===void 0||e.assocLang===u)&&(c===void 0||e.default===c)&&(h===void 0||e.forced===h)&&(!("characteristics"in r)||T_(r.characteristics||"",e.characteristics))&&(t===void 0||t(r,e))}function T_(r,e=""){const t=r.split(","),s=e.split(",");return t.length===s.length&&!t.some(a=>s.indexOf(a)===-1)}function Gn(r,e){const{audioCodec:t,channels:s}=r;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(s===void 0||s===(e.channels||"2"))}function b_(r,e,t,s,a){const o=e[s],c=e.reduce((v,x,S)=>{const E=x.uri;return(v[E]||(v[E]=[])).push(S),v},{})[o.uri];c.length>1&&(s=Math.max.apply(Math,c));const h=o.videoRange,d=o.frameRate,m=o.codecSet.substring(0,4),p=Av(e,s,v=>{if(v.videoRange!==h||v.frameRate!==d||v.codecSet.substring(0,4)!==m)return!1;const x=v.audioGroups,S=t.filter(E=>!x||x.indexOf(E.groupId)!==-1);return Wi(r,S,a)>-1});return p>-1?p:Av(e,s,v=>{const x=v.audioGroups,S=t.filter(E=>!x||x.indexOf(E.groupId)!==-1);return Wi(r,S,a)>-1})}function Av(r,e,t){for(let s=e;s>-1;s--)if(t(r[s]))return s;for(let s=e+1;s<r.length;s++)if(t(r[s]))return s;return-1}class A_{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:s,hls:a}=this,{autoLevelEnabled:o,media:u}=a;if(!t||!u)return;const c=performance.now(),h=s?s.stats:t.stats,d=s?s.duration:t.duration,m=c-h.loading.start,p=a.minAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||t.level<=p){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o||u.paused||!u.playbackRate||!u.readyState)return;const v=a.mainForwardBufferInfo;if(v===null)return;const x=this.bwEstimator.getEstimateTTFB(),S=Math.abs(u.playbackRate);if(m<=Math.max(x,1e3*(d/(S*2))))return;const E=v.len/S,T=h.loading.first?h.loading.first-h.loading.start:-1,A=h.loaded&&T>-1,w=this.getBwEstimate(),C=a.levels,k=C[t.level],_=h.total||Math.max(h.loaded,Math.round(d*k.averageBitrate/8));let U=A?m-T:m;U<1&&A&&(U=Math.min(m,h.loaded*8/w));const B=A?h.loaded*1e3/U:0,M=B?(_-h.loaded)/B:_*8/w+x/1e3;if(M<=E)return;const D=B?B*8:w;let N=Number.POSITIVE_INFINITY,P;for(P=t.level-1;P>p;P--){const J=C[P].maxBitrate;if(N=this.getTimeToLoadFrag(x/1e3,D,d*J,!C[P].details),N<E)break}if(N>=M||N>d*10)return;a.nextLoadLevel=a.nextAutoLevel=P,A?this.bwEstimator.sample(m-Math.min(x,T),h.loaded):this.bwEstimator.sampleTTFB(m);const G=C[P].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>G&&this.resetEstimator(G),this.clearTimer(),X.warn(`[abr] Fragment ${t.sn}${s?" part "+s.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${E.toFixed(3)} s
      Estimated load time for current fragment: ${M.toFixed(3)} s
      Estimated load time for down switch fragment: ${N.toFixed(3)} s
      TTFB estimate: ${T|0} ms
      Current BW estimate: ${ye(w)?w|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${P} @ ${G|0} bps`),a.trigger(R.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:s,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(X.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new d_(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(R.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const s=t.frag;if(!this.ignoreFragment(s)){if(!s.bitrateTest){var a;this.fragCurrent=s,this.partCurrent=(a=t.part)!=null?a:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case ie.BUFFER_ADD_CODEC_ERROR:case ie.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ie.FRAG_LOAD_TIMEOUT:{const s=t.frag,{fragCurrent:a,partCurrent:o}=this;if(s&&a&&s.sn===a.sn&&s.level===a.level){const u=performance.now(),c=o?o.stats:s.stats,h=u-c.loading.start,d=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&d>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(h-Math.min(p,d),c.loaded)}else this.bwEstimator.sampleTTFB(h)}break}}}getTimeToLoadFrag(e,t,s,a){const o=e+s/t,u=a?this.lastLevelLoadSec:0;return o+u}onLevelLoaded(e,t){const s=this.hls.config,{loading:a}=t.stats,o=a.end-a.start;ye(o)&&(this.lastLevelLoadSec=o/1e3),t.details.live?this.bwEstimator.update(s.abrEwmaSlowLive,s.abrEwmaFastLive):this.bwEstimator.update(s.abrEwmaSlowVoD,s.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:s}){const a=s?s.stats:t.stats;if(t.type===be.MAIN&&this.bwEstimator.sampleTTFB(a.loading.first-a.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=s?s.duration:t.duration,u=this.hls.levels[t.level],c=(u.loaded?u.loaded.bytes:0)+a.loaded,h=(u.loaded?u.loaded.duration:0)+o;u.loaded={bytes:c,duration:h},u.realBitrate=Math.round(8*c/h)}if(t.bitrateTest){const o={stats:a,frag:t,part:s,id:t.type};this.onFragBuffered(R.FRAG_BUFFERED,o),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:s,part:a}=t,o=a!=null&&a.stats.loaded?a.stats:s.stats;if(o.aborted||this.ignoreFragment(s))return;const u=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(u,o.loaded),o.bwEstimate=this.getBwEstimate(),s.bitrateTest?this.bitrateTestDelay=u/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==be.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,s=this.getBwEstimate(),a=this.hls.config.maxStarvationDelay,o=this.findBestLevel(s,t,e,0,a,1,1);if(o>-1)return o;const u=this.hls.firstLevel,c=Math.min(Math.max(u,t),e);return X.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${u} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,s=this.bwEstimator.canEstimate(),a=this.lastLoadedFragLevel>-1;if(e!==-1&&(!s||!a||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const o=s&&a?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const u=this.hls.levels;if(u.length>Math.max(e,o)&&u[e].loadError<=u[o].loadError)return e}return this._nextAutoLevel=o,this.nextAutoLevelKey=this.getAutoLevelKey(),o}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:s}=this,{maxAutoLevel:a,config:o,minAutoLevel:u}=s,c=t?t.duration:e?e.duration:0,h=this.getBwEstimate(),d=this.getStarvationDelay();let m=o.abrBandWidthFactor,p=o.abrBandWidthUpFactor;if(d){const T=this.findBestLevel(h,u,a,d,0,m,p);if(T>=0)return T}let v=c?Math.min(c,o.maxStarvationDelay):o.maxStarvationDelay;if(!d){const T=this.bitrateTestDelay;T&&(v=(c?Math.min(c,o.maxLoadingDelay):o.maxLoadingDelay)-T,X.info(`[abr] bitrate test took ${Math.round(1e3*T)}ms, set first fragment max fetchDuration to ${Math.round(1e3*v)} ms`),m=p=1)}const x=this.findBestLevel(h,u,a,d,v,m,p);if(X.info(`[abr] ${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${x}`),x>-1)return x;const S=s.levels[u],E=s.levels[s.loadLevel];return(S==null?void 0:S.bitrate)<(E==null?void 0:E.bitrate)?u:s.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const s=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,a=e.mainForwardBufferInfo;return(a?a.len:0)/s}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,s,a,o,u,c){var h;const d=a+o,m=this.lastLoadedFragLevel,p=m===-1?this.hls.firstLevel:m,{fragCurrent:v,partCurrent:x}=this,{levels:S,allAudioTracks:E,loadLevel:T,config:A}=this.hls;if(S.length===1)return 0;const w=S[p],C=!!(w!=null&&(h=w.details)!=null&&h.live),k=T===-1||m===-1;let _,U="SDR",B=(w==null?void 0:w.frameRate)||0;const{audioPreference:M,videoPreference:D}=A,N=this.audioTracksByGroup||(this.audioTracksByGroup=S_(E));if(k){if(this.firstSelection!==-1)return this.firstSelection;const Q=this.codecTiers||(this.codecTiers=E_(S,N,t,s)),$=x_(Q,U,e,M,D),{codecSet:oe,videoRanges:ue,minFramerate:Y,minBitrate:O,preferHDR:K}=$;_=oe,U=K?ue[ue.length-1]:ue[0],B=Y,e=Math.max(e,O),X.log(`[abr] picked start tier ${JSON.stringify($)}`)}else _=w==null?void 0:w.codecSet,U=w==null?void 0:w.videoRange;const P=x?x.duration:v?v.duration:0,G=this.bwEstimator.getEstimateTTFB()/1e3,J=[];for(let Q=s;Q>=t;Q--){var z;const $=S[Q],oe=Q>p;if(!$)continue;if(A.useMediaCapabilities&&!$.supportedResult&&!$.supportedPromise){const re=navigator.mediaCapabilities;typeof(re==null?void 0:re.decodingInfo)=="function"&&m_($,N,U,B,e,M)?($.supportedPromise=g_($,N,re),$.supportedPromise.then(me=>{if(!this.hls)return;$.supportedResult=me;const de=this.hls.levels,_e=de.indexOf($);me.error?X.warn(`[abr] MediaCapabilities decodingInfo error: "${me.error}" for level ${_e} ${JSON.stringify(me)}`):me.supported||(X.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${_e} ${JSON.stringify(me)}`),_e>-1&&de.length>1&&(X.log(`[abr] Removing unsupported level ${_e}`),this.hls.removeLevel(_e)))})):$.supportedResult=ES}if(_&&$.codecSet!==_||U&&$.videoRange!==U||oe&&B>$.frameRate||!oe&&B>0&&B<$.frameRate||$.supportedResult&&!((z=$.supportedResult.decodingInfoResults)!=null&&z[0].smooth)){J.push(Q);continue}const ue=$.details,Y=(x?ue==null?void 0:ue.partTarget:ue==null?void 0:ue.averagetargetduration)||P;let O;oe?O=c*e:O=u*e;const K=P&&a>=P*2&&o===0?S[Q].averageBitrate:S[Q].maxBitrate,te=this.getTimeToLoadFrag(G,O,K*Y,ue===void 0);if(O>=K&&(Q===m||$.loadError===0&&$.fragmentError===0)&&(te<=G||!ye(te)||C&&!this.bitrateTestDelay||te<d)){const re=this.forcedAutoLevel;return Q!==T&&(re===-1||re!==T)&&(J.length&&X.trace(`[abr] Skipped level(s) ${J.join(",")} of ${s} max with CODECS and VIDEO-RANGE:"${S[J[0]].codecs}" ${S[J[0]].videoRange}; not compatible with "${w.codecs}" ${U}`),X.info(`[abr] switch candidate:${p}->${Q} adjustedbw(${Math.round(O)})-bitrate=${Math.round(O-K)} ttfb:${G.toFixed(1)} avgDuration:${Y.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${te.toFixed(1)} firstSelection:${k} codecSet:${_} videoRange:${U} hls.loadLevel:${T}`)),k&&(this.firstSelection=Q),Q}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:s}=this.hls,a=Math.min(Math.max(e,s),t);this._nextAutoLevel!==a&&(this.nextAutoLevelKey="",this._nextAutoLevel=a)}}class R_{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Rt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class L_{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(R.BUFFER_APPENDED,this.onBufferAppended,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.BUFFER_APPENDED,this.onBufferAppended,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const s=this.activePartLists[t];if(s)for(let a=s.length;a--;){const o=s[a];if(!o)break;const u=o.end;if(o.start<=e&&u!==null&&e<=u)return o}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:s}=this,a=Object.keys(s);for(let o=a.length;o--;){const u=s[a[o]];if((u==null?void 0:u.body.type)===t&&u.buffered){const c=u.body;if(c.start<=e&&e<=c.end)return c}}return null}detectEvictedFragments(e,t,s,a){this.timeRanges&&(this.timeRanges[e]=t);const o=(a==null?void 0:a.fragment.sn)||-1;Object.keys(this.fragments).forEach(u=>{const c=this.fragments[u];if(!c||o>=c.body.sn)return;if(!c.buffered&&!c.loaded){c.body.type===s&&this.removeFragment(c.body);return}const h=c.range[e];h&&h.time.some(d=>{const m=!this.isTimeBuffered(d.startPTS,d.endPTS,t);return m&&this.removeFragment(c.body),m})})}detectPartialFragments(e){const t=this.timeRanges,{frag:s,part:a}=e;if(!t||s.sn==="initSegment")return;const o=Gr(s),u=this.fragments[o];if(!u||u.buffered&&s.gap)return;const c=!s.relurl;Object.keys(t).forEach(h=>{const d=s.elementaryStreams[h];if(!d)return;const m=t[h],p=c||d.partial===!0;u.range[h]=this.getBufferedTimes(s,a,p,m)}),u.loaded=null,Object.keys(u.range).length?(u.buffered=!0,(u.body.endList=s.endList||u.body.endList)&&(this.endListFragments[u.body.type]=u),su(u)||this.removeParts(s.sn-1,s.type)):this.removeFragment(u.body)}removeParts(e,t){const s=this.activePartLists[t];s&&(this.activePartLists[t]=s.filter(a=>a.fragment.sn>=e))}fragBuffered(e,t){const s=Gr(e);let a=this.fragments[s];!a&&t&&(a=this.fragments[s]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),a&&(a.loaded=null,a.buffered=!0)}getBufferedTimes(e,t,s,a){const o={time:[],partial:s},u=e.start,c=e.end,h=e.minEndPTS||c,d=e.maxStartPTS||u;for(let m=0;m<a.length;m++){const p=a.start(m)-this.bufferPadding,v=a.end(m)+this.bufferPadding;if(d>=p&&h<=v){o.time.push({startPTS:Math.max(u,a.start(m)),endPTS:Math.min(c,a.end(m))});break}else if(u<v&&c>p){const x=Math.max(u,a.start(m)),S=Math.min(c,a.end(m));S>x&&(o.partial=!0,o.time.push({startPTS:x,endPTS:S}))}else if(c<=p)break}return o}getPartialFragment(e){let t=null,s,a,o,u=0;const{bufferPadding:c,fragments:h}=this;return Object.keys(h).forEach(d=>{const m=h[d];m&&su(m)&&(a=m.body.start-c,o=m.body.end+c,e>=a&&e<=o&&(s=Math.min(e-a,o-e),u<=s&&(t=m.body,u=s)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||su(t))}getState(e){const t=Gr(e),s=this.fragments[t];return s?s.buffered?su(s)?Rt.PARTIAL:Rt.OK:Rt.APPENDING:Rt.NOT_LOADED}isTimeBuffered(e,t,s){let a,o;for(let u=0;u<s.length;u++){if(a=s.start(u)-this.bufferPadding,o=s.end(u)+this.bufferPadding,e>=a&&t<=o)return!0;if(t<=a)return!1}return!1}onFragLoaded(e,t){const{frag:s,part:a}=t;if(s.sn==="initSegment"||s.bitrateTest)return;const o=a?null:t,u=Gr(s);this.fragments[u]={body:s,appendedPTS:null,loaded:o,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:s,part:a,timeRanges:o}=t;if(s.sn==="initSegment")return;const u=s.type;if(a){let c=this.activePartLists[u];c||(this.activePartLists[u]=c=[]),c.push(a)}this.timeRanges=o,Object.keys(o).forEach(c=>{const h=o[c];this.detectEvictedFragments(c,h,u,a)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Gr(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,s,a,o){a&&!this.hasGaps||Object.keys(this.fragments).forEach(u=>{const c=this.fragments[u];if(!c)return;const h=c.body;h.type!==s||a&&!h.gap||h.start<t&&h.end>e&&(c.buffered||o)&&this.removeFragment(h)})}removeFragment(e){const t=Gr(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const s=this.activePartLists[e.type];if(s){const a=e.sn;this.activePartLists[e.type]=s.filter(o=>o.fragment.sn!==a)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function su(r){var e,t,s;return r.buffered&&(r.body.gap||((e=r.range.video)==null?void 0:e.partial)||((t=r.range.audio)==null?void 0:t.partial)||((s=r.range.audiovideo)==null?void 0:s.partial))}function Gr(r){return`${r.type}_${r.level}_${r.sn}`}const __={length:0,start:()=>0,end:()=>0};class Ze{static isBuffered(e,t){try{if(e){const s=Ze.getBuffered(e);for(let a=0;a<s.length;a++)if(t>=s.start(a)&&t<=s.end(a))return!0}}catch{}return!1}static bufferInfo(e,t,s){try{if(e){const a=Ze.getBuffered(e),o=[];let u;for(u=0;u<a.length;u++)o.push({start:a.start(u),end:a.end(u)});return this.bufferedInfo(o,t,s)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,s){t=Math.max(0,t),e.sort(function(d,m){const p=d.start-m.start;return p||m.end-d.end});let a=[];if(s)for(let d=0;d<e.length;d++){const m=a.length;if(m){const p=a[m-1].end;e[d].start-p<s?e[d].end>p&&(a[m-1].end=e[d].end):a.push(e[d])}else a.push(e[d])}else a=e;let o=0,u,c=t,h=t;for(let d=0;d<a.length;d++){const m=a[d].start,p=a[d].end;if(t+s>=m&&t<p)c=m,h=p,o=h-t;else if(t+s<m){u=m;break}}return{len:o,start:c||0,end:h||0,nextStart:u}}static getBuffered(e){try{return e.buffered}catch(t){return X.log("failed to get media.buffered",t),__}}}class a0{constructor(e,t,s,a=0,o=-1,u=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=nu(),this.buffering={audio:nu(),video:nu(),audiovideo:nu()},this.level=e,this.sn=t,this.id=s,this.size=a,this.part=o,this.partial=u}}function nu(){return{start:0,executeStart:0,executeEnd:0,end:0}}function yu(r,e){for(let s=0,a=r.length;s<a;s++){var t;if(((t=r[s])==null?void 0:t.cc)===e)return r[s]}return null}function D_(r,e,t){return!!(e&&(t.endCC>t.startCC||r&&r.cc<t.startCC))}function C_(r,e){const t=r.fragments,s=e.fragments;if(!s.length||!t.length){X.log("No fragments to align");return}const a=yu(t,s[0].cc);if(!a||a&&!a.startPTS){X.log("No frag in previous level to align on");return}return a}function Rv(r,e){if(r){const t=r.start+e;r.start=r.startPTS=t,r.endPTS=t+r.duration}}function TS(r,e){const t=e.fragments;for(let s=0,a=t.length;s<a;s++)Rv(t[s],r);e.fragmentHint&&Rv(e.fragmentHint,r),e.alignedSliding=!0}function w_(r,e,t){e&&(O_(r,t,e),!t.alignedSliding&&e&&$u(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&yS(e,t))}function O_(r,e,t){if(D_(r,t,e)){const s=C_(t,e);s&&ye(s.start)&&(X.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),TS(s.start,e))}}function $u(r,e){if(!r.hasProgramDateTime||!e.hasProgramDateTime)return;const t=r.fragments,s=e.fragments;if(!t.length||!s.length)return;let a,o;const u=Math.min(e.endCC,r.endCC);e.startCC<u&&r.startCC<u&&(a=yu(s,u),o=yu(t,u)),(!a||!o)&&(a=s[Math.floor(s.length/2)],o=yu(t,a.cc)||t[Math.floor(t.length/2)]);const c=a.programDateTime,h=o.programDateTime;if(!c||!h)return;const d=(h-c)/1e3-(o.start-a.start);TS(d,r)}const Lv=Math.pow(2,17);class I_{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const s=e.url;if(!s)return Promise.reject(new bs({type:Ae.NETWORK_ERROR,details:ie.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${s?"part list":"url"}`),networkDetails:null}));this.abort();const a=this.config,o=a.fLoader,u=a.loader;return new Promise((c,h)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(x=>x[0]==="GAP")){h(Dv(e));return}else e.gap=!1;const d=this.loader=e.loader=o?new o(a):new u(a),m=_v(e),p=Tv(a.fragLoadPolicy.default),v={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Lv};e.stats=d.stats,d.load(m,v,{onSuccess:(x,S,E,T)=>{this.resetLoader(e,d);let A=x.data;E.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(A.slice(0,16)),A=A.slice(16)),c({frag:e,part:null,payload:A,networkDetails:T})},onError:(x,S,E,T)=>{this.resetLoader(e,d),h(new bs({type:Ae.NETWORK_ERROR,details:ie.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Lt({url:s,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:E,stats:T}))},onAbort:(x,S,E)=>{this.resetLoader(e,d),h(new bs({type:Ae.NETWORK_ERROR,details:ie.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:E,stats:x}))},onTimeout:(x,S,E)=>{this.resetLoader(e,d),h(new bs({type:Ae.NETWORK_ERROR,details:ie.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:E,stats:x}))},onProgress:(x,S,E,T)=>{t&&t({frag:e,part:null,payload:E,networkDetails:T})}})})}loadPart(e,t,s){this.abort();const a=this.config,o=a.fLoader,u=a.loader;return new Promise((c,h)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){h(Dv(e,t));return}const d=this.loader=e.loader=o?new o(a):new u(a),m=_v(e,t),p=Tv(a.fragLoadPolicy.default),v={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Lv};t.stats=d.stats,d.load(m,v,{onSuccess:(x,S,E,T)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:x.data,networkDetails:T};s(A),c(A)},onError:(x,S,E,T)=>{this.resetLoader(e,d),h(new bs({type:Ae.NETWORK_ERROR,details:ie.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Lt({url:m.url,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:E,stats:T}))},onAbort:(x,S,E)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),h(new bs({type:Ae.NETWORK_ERROR,details:ie.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:E,stats:x}))},onTimeout:(x,S,E)=>{this.resetLoader(e,d),h(new bs({type:Ae.NETWORK_ERROR,details:ie.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:E,stats:x}))}})})}updateStatsFromPart(e,t){const s=e.stats,a=t.stats,o=a.total;if(s.loaded+=a.loaded,o){const h=Math.round(e.duration/t.duration),d=Math.min(Math.round(s.loaded/o),h),p=(h-d)*Math.round(s.loaded/d);s.total=s.loaded+p}else s.total=Math.max(s.loaded,s.total);const u=s.loading,c=a.loading;u.start?u.first+=c.first-c.start:(u.start=c.start,u.first=c.first),u.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function _v(r,e=null){const t=e||r,s={frag:r,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},a=t.byteRangeStartOffset,o=t.byteRangeEndOffset;if(ye(a)&&ye(o)){var u;let c=a,h=o;if(r.sn==="initSegment"&&((u=r.decryptdata)==null?void 0:u.method)==="AES-128"){const d=o-a;d%16&&(h=o+(16-d%16)),a!==0&&(s.resetIV=!0,c=a-16)}s.rangeStart=c,s.rangeEnd=h}return s}function Dv(r,e){const t=new Error(`GAP ${r.gap?"tag":"attribute"} found`),s={type:Ae.MEDIA_ERROR,details:ie.FRAG_GAP,fatal:!1,frag:r,error:t,networkDetails:null};return e&&(s.part=e),(e||r).stats.aborted=!0,new bs(s)}class bs extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class M_{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class k_{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function N_(r){const e=r.byteLength,t=e&&new DataView(r.buffer).getUint8(e-1);return t?er(r,0,e-t):r}class P_{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),s=new Uint32Array(4);for(let a=0;a<4;a++)s[a]=t.getUint32(a*4);return s}initTable(){const e=this.sBox,t=this.invSBox,s=this.subMix,a=s[0],o=s[1],u=s[2],c=s[3],h=this.invSubMix,d=h[0],m=h[1],p=h[2],v=h[3],x=new Uint32Array(256);let S=0,E=0,T=0;for(T=0;T<256;T++)T<128?x[T]=T<<1:x[T]=T<<1^283;for(T=0;T<256;T++){let A=E^E<<1^E<<2^E<<3^E<<4;A=A>>>8^A&255^99,e[S]=A,t[A]=S;const w=x[S],C=x[w],k=x[C];let _=x[A]*257^A*16843008;a[S]=_<<24|_>>>8,o[S]=_<<16|_>>>16,u[S]=_<<8|_>>>24,c[S]=_,_=k*16843009^C*65537^w*257^S*16843008,d[A]=_<<24|_>>>8,m[A]=_<<16|_>>>16,p[A]=_<<8|_>>>24,v[A]=_,S?(S=w^x[x[x[k^w]]],E^=x[x[E]]):S=E=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let s=!0,a=0;for(;a<t.length&&s;)s=t[a]===this.key[a],a++;if(s)return;this.key=t;const o=this.keySize=t.length;if(o!==4&&o!==6&&o!==8)throw new Error("Invalid aes key size="+o);const u=this.ksRows=(o+6+1)*4;let c,h;const d=this.keySchedule=new Uint32Array(u),m=this.invKeySchedule=new Uint32Array(u),p=this.sBox,v=this.rcon,x=this.invSubMix,S=x[0],E=x[1],T=x[2],A=x[3];let w,C;for(c=0;c<u;c++){if(c<o){w=d[c]=t[c];continue}C=w,c%o===0?(C=C<<8|C>>>24,C=p[C>>>24]<<24|p[C>>>16&255]<<16|p[C>>>8&255]<<8|p[C&255],C^=v[c/o|0]<<24):o>6&&c%o===4&&(C=p[C>>>24]<<24|p[C>>>16&255]<<16|p[C>>>8&255]<<8|p[C&255]),d[c]=w=(d[c-o]^C)>>>0}for(h=0;h<u;h++)c=u-h,h&3?C=d[c]:C=d[c-4],h<4||c<=4?m[h]=C:m[h]=S[p[C>>>24]]^E[p[C>>>16&255]]^T[p[C>>>8&255]]^A[p[C&255]],m[h]=m[h]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,s){const a=this.keySize+6,o=this.invKeySchedule,u=this.invSBox,c=this.invSubMix,h=c[0],d=c[1],m=c[2],p=c[3],v=this.uint8ArrayToUint32Array_(s);let x=v[0],S=v[1],E=v[2],T=v[3];const A=new Int32Array(e),w=new Int32Array(A.length);let C,k,_,U,B,M,D,N,P,G,J,z,Q,$;const oe=this.networkToHostOrderSwap;for(;t<A.length;){for(P=oe(A[t]),G=oe(A[t+1]),J=oe(A[t+2]),z=oe(A[t+3]),B=P^o[0],M=z^o[1],D=J^o[2],N=G^o[3],Q=4,$=1;$<a;$++)C=h[B>>>24]^d[M>>16&255]^m[D>>8&255]^p[N&255]^o[Q],k=h[M>>>24]^d[D>>16&255]^m[N>>8&255]^p[B&255]^o[Q+1],_=h[D>>>24]^d[N>>16&255]^m[B>>8&255]^p[M&255]^o[Q+2],U=h[N>>>24]^d[B>>16&255]^m[M>>8&255]^p[D&255]^o[Q+3],B=C,M=k,D=_,N=U,Q=Q+4;C=u[B>>>24]<<24^u[M>>16&255]<<16^u[D>>8&255]<<8^u[N&255]^o[Q],k=u[M>>>24]<<24^u[D>>16&255]<<16^u[N>>8&255]<<8^u[B&255]^o[Q+1],_=u[D>>>24]<<24^u[N>>16&255]<<16^u[B>>8&255]<<8^u[M&255]^o[Q+2],U=u[N>>>24]<<24^u[B>>16&255]<<16^u[M>>8&255]<<8^u[D&255]^o[Q+3],w[t]=oe(C^x),w[t+1]=oe(U^S),w[t+2]=oe(_^E),w[t+3]=oe(k^T),x=P,S=G,E=J,T=z,t=t+4}return w.buffer}}const F_=16;class o0{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const s=self.crypto;s&&(this.subtle=s.subtle||s.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const s=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?N_(s):s}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,s){return this.useSoftware?new Promise((a,o)=>{this.softwareDecrypt(new Uint8Array(e),t,s);const u=this.flush();u?a(u.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,s)}softwareDecrypt(e,t,s){const{currentIV:a,currentResult:o,remainderData:u}=this;this.logOnce("JS AES decrypt"),u&&(e=bi(u,e),this.remainderData=null);const c=this.getValidChunk(e);if(!c.length)return null;a&&(s=a);let h=this.softwareDecrypter;h||(h=this.softwareDecrypter=new P_),h.expandKey(t);const d=o;return this.currentResult=h.decrypt(c.buffer,0,s),this.currentIV=er(c,-16).buffer,d||null}webCryptoDecrypt(e,t,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,s));this.key=t,this.fastAesKey=new k_(this.subtle,t)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new M_(this.subtle,new Uint8Array(s)).decrypt(e.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(X.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,s)))}onWebCryptoError(e,t,s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,s);const a=this.flush();if(a)return a.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const s=e.length-e.length%F_;return s!==e.length&&(t=er(e,0,s),this.remainderData=er(e,s)),t}logOnce(e){this.logEnabled&&(X.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const U_={toString:function(r){let e="";const t=r.length;for(let s=0;s<t;s++)e+=`[${r.start(s).toFixed(3)}-${r.end(s).toFixed(3)}]`;return e}},ce={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class l0 extends R_{constructor(e,t,s,a,o){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ce.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=o,this.logPrefix=a,this.log=X.log.bind(X,`${a}:`),this.warn=X.warn.bind(X,`${a}:`),this.hls=e,this.fragmentLoader=new I_(e.config),this.keyLoader=s,this.fragmentTracker=t,this.config=e.config,this.decrypter=new o0(e.config),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ce.STOPPED}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const s=t.partList;if(s!=null&&s.length){const o=s[s.length-1];return Ze.isBuffered(this.media,o.start+o.duration/2)}const a=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(a)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const s=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),s.addEventListener("seeking",this.onvseeking),s.addEventListener("ended",this.onvended);const a=this.config;this.levels&&a.autoStartLoad&&this.state===ce.STOPPED&&this.startLoad(a.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:s,mediaBuffer:a,state:o}=this,u=s?s.currentTime:0,c=Ze.bufferInfo(a||s,u,e.maxBufferHole);if(this.log(`media seeking to ${ye(u)?u.toFixed(3):u}, state: ${o}`),this.state===ce.ENDED)this.resetLoadingState();else if(t){const h=e.maxFragLookUpTolerance,d=t.start-h,m=t.start+t.duration+h;if(!c.len||m<c.start||d>c.end){const p=u>m;(u<d||p)&&(p&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}s&&(this.fragmentTracker.removeFragmentsInRange(u,1/0,this.playlistType,!0),this.lastCurrentTime=u),!this.loadedmetadata&&!c.len&&(this.nextLoadPosition=this.startPosition=u),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=ce.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,s){this._loadFragForPlayback(e,t,s)}_loadFragForPlayback(e,t,s){const a=o=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${o.part?" p: "+o.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(o)};this._doFragLoad(e,t,s,a).then(o=>{if(!o)return;const u=this.state;if(this.fragContextChanged(e)){(u===ce.FRAG_LOADING||!this.fragCurrent&&u===ce.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=ce.IDLE);return}"payload"in o&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(R.FRAG_LOADED,o)),this._handleFragmentLoadComplete(o)}).catch(o=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(`Frag error: ${(o==null?void 0:o.message)||o}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:s}=this;if(s.getState(e)===Rt.APPENDING){const o=e.type,u=this.getFwdBufferInfo(this.mediaBuffer,o),c=Math.max(e.duration,u?u.len:this.config.maxBufferLength),h=this.backtrackFragment;((h?e.sn-h.sn:0)===1||this.reduceMaxBufferLength(c,e.duration))&&s.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?s.removeAllFragments():s.hasParts(e.type)&&(s.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),s.getState(e)===Rt.PARTIAL&&s.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,s=null){if(!(e-t))return;const a={startOffset:e,endOffset:t,type:s};this.hls.trigger(R.BUFFER_FLUSHING,a)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(s=>{if(!s||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return s}).then(s=>{const{hls:a}=this,{payload:o}=s,u=e.decryptdata;if(o&&o.byteLength>0&&u!=null&&u.key&&u.iv&&u.method==="AES-128"){const c=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),u.key.buffer,u.iv.buffer).catch(h=>{throw a.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.FRAG_DECRYPT_ERROR,fatal:!1,error:h,reason:h.message,frag:e}),h}).then(h=>{const d=self.performance.now();return a.trigger(R.FRAG_DECRYPTED,{frag:e,payload:h,stats:{tstart:c,tdecrypt:d}}),s.payload=h,this.completeInitSegmentLoad(s)})}return this.completeInitSegmentLoad(s)}).catch(s=>{this.state===ce.STOPPED||this.state===ce.ERROR||(this.warn(s),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const s=e.frag.stats;this.state=ce.IDLE,e.frag.data=new Uint8Array(e.payload),s.parsing.start=s.buffering.start=self.performance.now(),s.parsing.end=s.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var s,a,o,u;const c=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===be.MAIN?"level":"track"} ${e.level} (frag:[${((s=e.startPTS)!=null?s:NaN).toFixed(3)}-${((a=e.endPTS)!=null?a:NaN).toFixed(3)}] > buffer:${c?U_.toString(Ze.getBuffered(c)):"(detached)"})`),e.sn!=="initSegment"){var h;if(e.type!==be.SUBTITLE){const m=e.elementaryStreams;if(!Object.keys(m).some(p=>!!m[p])){this.state=ce.IDLE;return}}const d=(h=this.levels)==null?void 0:h[e.level];d!=null&&d.fragmentError&&(this.log(`Resetting level fragment error count of ${d.fragmentError} on frag buffered`),d.fragmentError=0)}this.state=ce.IDLE,c&&(!this.loadedmetadata&&e.type==be.MAIN&&c.buffered.length&&((o=this.fragCurrent)==null?void 0:o.sn)===((u=this.fragPrevious)==null?void 0:u.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:s,part:a,partsLoaded:o}=e,u=!o||o.length===0||o.some(h=>!h),c=new a0(s.level,s.sn,s.stats.chunkCount+1,0,a?a.index:-1,!u);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,s=null,a){var o;const u=t==null?void 0:t.details;if(!this.levels||!u)throw new Error(`frag load aborted, missing level${u?"":" detail"}s`);let c=null;if(e.encrypted&&!((o=e.decryptdata)!=null&&o.key)?(this.log(`Loading key for ${e.sn} of [${u.startSN}-${u.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=ce.KEY_LOADING,this.fragCurrent=e,c=this.keyLoader.load(e).then(m=>{if(!this.fragContextChanged(m.frag))return this.hls.trigger(R.KEY_LOADED,m),this.state===ce.KEY_LOADING&&(this.state=ce.IDLE),m}),this.hls.trigger(R.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(c=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&u.encryptedFragments.length&&this.keyLoader.loadClear(e,u.encryptedFragments),s=Math.max(e.start,s||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const m=u.partList;if(m&&a){s>e.end&&u.fragmentHint&&(e=u.fragmentHint);const p=this.getNextPart(m,e,s);if(p>-1){const v=m[p];this.log(`Loading part sn: ${e.sn} p: ${v.index} cc: ${e.cc} of playlist [${u.startSN}-${u.endSN}] parts [0-${p}-${m.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(s.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=ce.FRAG_LOADING;let x;return c?x=c.then(S=>!S||this.fragContextChanged(S.frag)?null:this.doFragPartsLoad(e,v,t,a)).catch(S=>this.handleFragLoadError(S)):x=this.doFragPartsLoad(e,v,t,a).catch(S=>this.handleFragLoadError(S)),this.hls.trigger(R.FRAG_LOADING,{frag:e,part:v,targetBufferTime:s}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}else if(!e.url||this.loadedEndOfParts(m,s))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${u?"of ["+u.startSN+"-"+u.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(s.toFixed(3))}`),ye(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ce.FRAG_LOADING;const h=this.config.progressive;let d;return h&&c?d=c.then(m=>!m||this.fragContextChanged(m==null?void 0:m.frag)?null:this.fragmentLoader.load(e,a)).catch(m=>this.handleFragLoadError(m)):d=Promise.all([this.fragmentLoader.load(e,h?a:void 0),c]).then(([m])=>(!h&&m&&a&&a(m),m)).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(R.FRAG_LOADING,{frag:e,targetBufferTime:s}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(e,t,s,a){return new Promise((o,u)=>{var c;const h=[],d=(c=s.details)==null?void 0:c.partList,m=p=>{this.fragmentLoader.loadPart(e,p,a).then(v=>{h[p.index]=v;const x=v.part;this.hls.trigger(R.FRAG_LOADED,v);const S=Sv(s,e.sn,p.index+1)||vS(d,e.sn,p.index+1);if(S)m(S);else return o({frag:e,part:x,partsLoaded:h})}).catch(u)};m(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===ie.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(R.ERROR,t)}else this.hls.trigger(R.ERROR,{type:Ae.OTHER_ERROR,details:ie.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ce.PARSING){!this.fragCurrent&&this.state!==ce.STOPPED&&this.state!==ce.ERROR&&(this.state=ce.IDLE);return}const{frag:s,part:a,level:o}=t,u=self.performance.now();s.stats.parsing.end=u,a&&(a.stats.parsing.end=u),this.updateLevelTiming(s,a,o,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:s}=this,{level:a,sn:o,part:u}=e;if(!(t!=null&&t[a]))return this.warn(`Levels object was unset while buffering fragment ${o} of level ${a}. The current chunk will not be buffered.`),null;const c=t[a],h=u>-1?Sv(c,o,u):null,d=h?h.fragment:a_(c,o,s);return d?(s&&s!==d&&(d.stats=s.stats),{frag:d,part:h,level:c}):null}bufferFragmentData(e,t,s,a,o){var u;if(!e||this.state!==ce.PARSING)return;const{data1:c,data2:h}=e;let d=c;if(c&&h&&(d=bi(c,h)),!((u=d)!=null&&u.length))return;const m={type:e.type,frag:t,part:s,chunkMeta:a,parent:t.type,data:d};if(this.hls.trigger(R.BUFFER_APPENDING,m),e.dropped&&e.independent&&!s){if(o)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ze.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const s=t.currentTime,a=Ze.bufferInfo(t,s,0),o=e.duration,u=Math.min(this.config.maxFragLookUpTolerance*2,o*.25),c=Math.max(Math.min(e.start-u,a.end-u),s+u);e.start-c>u&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){const s=this.getLoadPosition();return ye(s)?this.getFwdBufferInfoAtPos(e,s,t):null}getFwdBufferInfoAtPos(e,t,s){const{config:{maxBufferHole:a}}=this,o=Ze.bufferInfo(e,t,a);if(o.len===0&&o.nextStart!==void 0){const u=this.fragmentTracker.getBufferedFrag(t,s);if(u&&o.nextStart<u.end)return Ze.bufferInfo(e,t,Math.max(o.nextStart,a))}return o}getMaxBufferLength(e){const{config:t}=this;let s;return e?s=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):s=t.maxBufferLength,Math.min(s,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const s=this.config,a=Math.max(Math.min(e-t,s.maxBufferLength),t),o=Math.max(e-t*3,s.maxMaxBufferLength/2,a);return o>=a?(s.maxMaxBufferLength=o,this.warn(`Reduce max buffer length to ${o}s`),!0):!1}getAppendedFrag(e,t=be.MAIN){const s=this.fragmentTracker.getAppendedFrag(e,be.MAIN);return s&&"fragment"in s?s.fragment:s}getNextFragment(e,t){const s=t.fragments,a=s.length;if(!a)return null;const{config:o}=this,u=s[0].start;let c;if(t.live){const h=o.initialLiveManifestSize;if(a<h)return this.warn(`Not enough fragments to start playback (have: ${a}, need: ${h})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<u)&&(c=this.getInitialLiveFragment(t,s),this.startPosition=this.nextLoadPosition=c?this.hls.liveSyncPosition||c.start:e)}else e<=u&&(c=s[0]);if(!c){const h=o.lowLatencyMode?t.partEnd:t.fragmentEnd;c=this.getFragmentAtPosition(e,h,t)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const s=this.fragmentTracker.getState(e);return(s===Rt.OK||s===Rt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,s,a,o){const u=e.gap,c=this.getNextFragment(this.nextLoadPosition,t);if(c===null)return c;if(e=c,u&&e&&!e.gap&&s.nextStart){const h=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,s.nextStart,a);if(h!==null&&s.len+h.len>=o)return this.log(`buffer full after gaps in "${a}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,s){let a=-1,o=!1,u=!0;for(let c=0,h=e.length;c<h;c++){const d=e[c];if(u=u&&!d.independent,a>-1&&s<d.start)break;const m=d.loaded;m?a=-1:(o||d.independent||u)&&d.fragment===t&&(a=c),o=m}return a}loadedEndOfParts(e,t){const s=e[e.length-1];return s&&t>s.start&&s.loaded}getInitialLiveFragment(e,t){const s=this.fragPrevious;let a=null;if(s){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${s.programDateTime}`),a=l_(t,s.endProgramDateTime,this.config.maxFragLookUpTolerance)),!a){const o=s.sn+1;if(o>=e.startSN&&o<=e.endSN){const u=t[o-e.startSN];s.cc===u.cc&&(a=u,this.log(`Live playlist, switching playlist, load frag with next SN: ${a.sn}`))}a||(a=f_(t,s.cc),a&&this.log(`Live playlist, switching playlist, load frag with same CC: ${a.sn}`))}}else{const o=this.hls.liveSyncPosition;o!==null&&(a=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return a}getFragmentAtPosition(e,t,s){const{config:a}=this;let{fragPrevious:o}=this,{fragments:u,endSN:c}=s;const{fragmentHint:h}=s,{maxFragLookUpTolerance:d}=a,m=s.partList,p=!!(a.lowLatencyMode&&m!=null&&m.length&&h);p&&h&&!this.bitrateTest&&(u=u.concat(h),c=h.sn);let v;if(e<t){const x=e>t-d?0:d;v=Hu(o,u,e,x)}else v=u[u.length-1];if(v){const x=v.sn-s.startSN,S=this.fragmentTracker.getState(v);if((S===Rt.OK||S===Rt.PARTIAL&&v.gap)&&(o=v),o&&v.sn===o.sn&&(!p||m[0].fragment.sn>v.sn)&&o&&v.level===o.level){const T=u[x+1];v.sn<c&&this.fragmentTracker.getState(T)!==Rt.OK?v=T:v=null}}return v}synchronizeToLiveEdge(e){const{config:t,media:s}=this;if(!s)return;const a=this.hls.liveSyncPosition,o=s.currentTime,u=e.fragments[0].start,c=e.edge,h=o>=u-t.maxFragLookUpTolerance&&o<=c;if(a!==null&&s.duration>a&&(o<a||!h)){const d=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!h&&s.readyState<4||o<c-d)&&(this.loadedmetadata||(this.nextLoadPosition=a),s.readyState&&(this.warn(`Playback: ${o.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${a.toFixed(3)}`),s.currentTime=a))}}alignPlaylists(e,t,s){const a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;const o=e.fragments[0].start,u=!t,c=e.alignedSliding&&ye(o);if(u||!c&&!o){const{fragPrevious:h}=this;w_(h,s,e);const d=e.fragments[0].start;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${h?h.sn:"na"} fragments: ${a}`),d}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let s=this.startPosition;if(s<t&&(s=-1),s===-1||this.lastCurrentTime===-1){const a=this.startTimeOffset!==null,o=a?this.startTimeOffset:e.startTimeOffset;o!==null&&ye(o)?(s=t+o,o<0&&(s+=e.totalduration),s=Math.min(Math.max(t,s),t+e.totalduration),this.log(`Start time offset ${o} found in ${a?"multivariant":"media"} playlist, adjust startPosition to ${s}`),this.startPosition=s):e.live?s=this.hls.liveSyncPosition||t:this.startPosition=s=0,this.lastCurrentTime=s}this.nextLoadPosition=s}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ce.FRAG_LOADING_WAITING_RETRY)&&(this.state=ce.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const m=this.getCurrentContext(t.chunkMeta);m&&(t.frag=m.frag)}const s=t.frag;if(!s||s.type!==e||!this.levels)return;if(this.fragContextChanged(s)){var a;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(a=this.fragCurrent)==null?void 0:a.url}`);return}const o=t.details===ie.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(s,!0);const u=t.errorAction,{action:c,retryCount:h=0,retryConfig:d}=u||{};if(u&&c===Ot.RetryRequest&&d){this.resetStartWhenNotLoaded(this.levelLastLoaded);const m=n0(d,h);this.warn(`Fragment ${s.sn} of ${e} ${s.level} errored with ${t.details}, retrying loading ${h+1}/${d.maxNumRetry} in ${m}ms`),u.resolved=!0,this.retryDate=self.performance.now()+m,this.state=ce.FRAG_LOADING_WAITING_RETRY}else if(d&&u)if(this.resetFragmentErrors(e),h<d.maxNumRetry)!o&&c!==Ot.RemoveAlternatePermanently&&(u.resolved=!0);else{X.warn(`${t.details} reached or exceeded max retry (${h})`);return}else(u==null?void 0:u.action)===Ot.SendAlternateToPenaltyBox?this.state=ce.WAITING_LEVEL:this.state=ce.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===ce.PARSING||this.state===ce.PARSED){const t=e.frag,s=e.parent,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=a&&a.len>.5;o&&this.reduceMaxBufferLength(a.len,(t==null?void 0:t.duration)||10);const u=!o;return u&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${s} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),u}return!1}resetFragmentErrors(e){e===be.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==ce.STOPPED&&(this.state=ce.IDLE)}afterBufferFlushed(e,t,s){if(!e)return;const a=Ze.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,a,s),this.state===ce.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=ce.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,s,a){var o;const u=s.details;if(!u){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((h,d)=>{const m=e.elementaryStreams[d];if(m){const p=m.endPTS-m.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${p})`),h||!1;const v=a?0:pS(u,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS);return this.hls.trigger(R.LEVEL_PTS_UPDATED,{details:u,level:s,drift:v,type:d,frag:e,start:m.startPTS,end:m.endPTS}),!0}return h},!1)&&((o=this.transmuxer)==null?void 0:o.error)===null){const h=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(s.fragmentError===0&&(s.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(h.message),this.hls.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.FRAG_PARSING_ERROR,fatal:!1,error:h,frag:e,reason:`Found no media in msn ${e.sn} of level "${s.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=ce.PARSED,this.hls.trigger(R.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class bS{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let s;if(e.length)e.length===1?s=e[0]:s=B_(e,t);else return new Uint8Array(0);return this.reset(),s}reset(){this.chunks.length=0,this.dataLength=0}}function B_(r,e){const t=new Uint8Array(e);let s=0;for(let a=0;a<r.length;a++){const o=r[a];t.set(o,s),s+=o.length}return t}function j_(){return typeof __HLS_WORKER_BUNDLE__=="function"}function G_(){const r=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(r);return{worker:new self.Worker(e),objectURL:e}}function H_(r){const e=new self.URL(r,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function Xi(r="",e=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class u0{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,s,a){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,s){}demux(e,t){this.cachedData&&(e=bi(this.cachedData,e),this.cachedData=null);let s=_o(e,0),a=s?s.length:0,o;const u=this._audioTrack,c=this._id3Track,h=s?s0(s):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&ye(h))&&(this.basePTS=$_(h,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),s&&s.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:ki.audioId3,duration:Number.POSITIVE_INFINITY});a<d;){if(this.canParse(e,a)){const m=this.appendFrame(u,e,a);m?(this.frameIndex++,this.lastPTS=m.sample.pts,a+=m.length,o=a):a=d}else cL(e,a)?(s=_o(e,a),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:ki.audioId3,duration:Number.POSITIVE_INFINITY}),a+=s.length,o=a):a++;if(a===d&&o!==d){const m=er(e,o);this.cachedData?this.cachedData=bi(this.cachedData,m):this.cachedData=m}}return{audioTrack:u,videoTrack:Xi(),id3Track:c,textTrack:Xi()}}demuxSampleAes(e,t,s){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Xi(),id3Track:this._id3Track,textTrack:Xi()}}destroy(){}}const $_=(r,e,t)=>{if(ye(r))return r*90;const s=t?t.baseTime*9e4/t.timescale:0;return e*9e4+s};function V_(r,e,t,s){let a,o,u,c;const h=navigator.userAgent.toLowerCase(),d=s,m=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((e[t+2]&192)>>>6)+1;const p=(e[t+2]&60)>>>2;if(p>m.length-1){const v=new Error(`invalid ADTS sampling index:${p}`);r.emit(R.ERROR,R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}return u=(e[t+2]&1)<<2,u|=(e[t+3]&192)>>>6,X.log(`manifest codec:${s}, ADTS type:${a}, samplingIndex:${p}`),/firefox/i.test(h)?p>=6?(a=5,c=new Array(4),o=p-3):(a=2,c=new Array(2),o=p):h.indexOf("android")!==-1?(a=2,c=new Array(2),o=p):(a=5,c=new Array(4),s&&(s.indexOf("mp4a.40.29")!==-1||s.indexOf("mp4a.40.5")!==-1)||!s&&p>=6?o=p-3:((s&&s.indexOf("mp4a.40.2")!==-1&&(p>=6&&u===1||/vivaldi/i.test(h))||!s&&u===1)&&(a=2,c=new Array(2)),o=p)),c[0]=a<<3,c[0]|=(p&14)>>1,c[1]|=(p&1)<<7,c[1]|=u<<3,a===5&&(c[1]|=(o&14)>>1,c[2]=(o&1)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:m[p],channelCount:u,codec:"mp4a.40."+a,manifestCodec:d}}function AS(r,e){return r[e]===255&&(r[e+1]&246)===240}function RS(r,e){return r[e+1]&1?7:9}function c0(r,e){return(r[e+3]&3)<<11|r[e+4]<<3|(r[e+5]&224)>>>5}function K_(r,e){return e+5<r.length}function Vu(r,e){return e+1<r.length&&AS(r,e)}function z_(r,e){return K_(r,e)&&AS(r,e)&&c0(r,e)<=r.length-e}function Y_(r,e){if(Vu(r,e)){const t=RS(r,e);if(e+t>=r.length)return!1;const s=c0(r,e);if(s<=t)return!1;const a=e+s;return a===r.length||Vu(r,a)}return!1}function LS(r,e,t,s,a){if(!r.samplerate){const o=V_(e,t,s,a);if(!o)return;r.config=o.config,r.samplerate=o.samplerate,r.channelCount=o.channelCount,r.codec=o.codec,r.manifestCodec=o.manifestCodec,X.log(`parsed codec:${r.codec}, rate:${o.samplerate}, channels:${o.channelCount}`)}}function _S(r){return 1024*9e4/r}function q_(r,e){const t=RS(r,e);if(e+t<=r.length){const s=c0(r,e)-t;if(s>0)return{headerLength:t,frameLength:s}}}function DS(r,e,t,s,a){const o=_S(r.samplerate),u=s+a*o,c=q_(e,t);let h;if(c){const{frameLength:p,headerLength:v}=c,x=v+p,S=Math.max(0,t+x-e.length);S?(h=new Uint8Array(x-v),h.set(e.subarray(t+v,e.length),0)):h=e.subarray(t+v,t+x);const E={unit:h,pts:u};return S||r.samples.push(E),{sample:E,length:x,missing:S}}const d=e.length-t;return h=new Uint8Array(d),h.set(e.subarray(t,e.length),0),{sample:{unit:h,pts:u},length:d,missing:-1}}let ru=null;const X_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Q_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],W_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Z_=[0,1,1,4];function CS(r,e,t,s,a){if(t+24>e.length)return;const o=wS(e,t);if(o&&t+o.frameLength<=e.length){const u=o.samplesPerFrame*9e4/o.sampleRate,c=s+a*u,h={unit:e.subarray(t,t+o.frameLength),pts:c,dts:c};return r.config=[],r.channelCount=o.channelCount,r.samplerate=o.sampleRate,r.samples.push(h),{sample:h,length:o.frameLength,missing:0}}}function wS(r,e){const t=r[e+1]>>3&3,s=r[e+1]>>1&3,a=r[e+2]>>4&15,o=r[e+2]>>2&3;if(t!==1&&a!==0&&a!==15&&o!==3){const u=r[e+2]>>1&1,c=r[e+3]>>6,h=t===3?3-s:s===3?3:4,d=X_[h*14+a-1]*1e3,p=Q_[(t===3?0:t===2?1:2)*3+o],v=c===3?1:2,x=W_[t][s],S=Z_[s],E=x*8*S,T=Math.floor(x*d/p+u)*S;if(ru===null){const C=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ru=C?parseInt(C[1]):0}return!!ru&&ru<=87&&s===2&&d>=224e3&&c===0&&(r[e+3]=r[e+3]|128),{sampleRate:p,channelCount:v,frameLength:T,samplesPerFrame:E}}}function f0(r,e){return r[e]===255&&(r[e+1]&224)===224&&(r[e+1]&6)!==0}function OS(r,e){return e+1<r.length&&f0(r,e)}function J_(r,e){return f0(r,e)&&4<=r.length-e}function IS(r,e){if(e+1<r.length&&f0(r,e)){const s=wS(r,e);let a=4;s!=null&&s.frameLength&&(a=s.frameLength);const o=e+a;return o===r.length||OS(r,o)}return!1}class eD extends u0{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,s,a){super.resetInitSegment(e,t,s,a),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=_o(e,0);let s=(t==null?void 0:t.length)||0;if(IS(e,s))return!1;for(let a=e.length;s<a;s++)if(Y_(e,s))return X.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return z_(e,t)}appendFrame(e,t,s){LS(e,this.observer,t,s,e.manifestCodec);const a=DS(e,t,s,this.basePTS,this.frameIndex);if(a&&a.missing===0)return a}}const tD=/\/emsg[-/]ID3/i;class iD{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,s,a){const o=this.videoTrack=Xi("video",1),u=this.audioTrack=Xi("audio",1),c=this.txtTrack=Xi("text",1);if(this.id3Track=Xi("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const h=lS(e);if(h.video){const{id:d,timescale:m,codec:p}=h.video;o.id=d,o.timescale=c.timescale=m,o.codec=p}if(h.audio){const{id:d,timescale:m,codec:p}=h.audio;u.id=d,u.timescale=m,u.codec=p}c.id=rS.text,o.sampleDuration=0,o.duration=u.duration=a}resetContiguity(){this.remainderData=null}static probe(e){return xL(e)}demux(e,t){this.timeOffset=t;let s=e;const a=this.videoTrack,o=this.txtTrack;if(this.config.progressive){this.remainderData&&(s=bi(this.remainderData,e));const c=_L(s);this.remainderData=c.remainder,a.samples=c.valid||new Uint8Array}else a.samples=s;const u=this.extractID3Track(a,t);return o.samples=tv(t,a),{videoTrack:a,audioTrack:this.audioTrack,id3Track:u,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,s=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const a=this.extractID3Track(t,this.timeOffset);return s.samples=tv(e,t),{videoTrack:t,audioTrack:Xi(),id3Track:a,textTrack:Xi()}}extractID3Track(e,t){const s=this.id3Track;if(e.samples.length){const a=Ce(e.samples,["emsg"]);a&&a.forEach(o=>{const u=wL(o);if(tD.test(u.schemeIdUri)){const c=ye(u.presentationTime)?u.presentationTime/u.timeScale:t+u.presentationTimeDelta/u.timeScale;let h=u.eventDuration===4294967295?Number.POSITIVE_INFINITY:u.eventDuration/u.timeScale;h<=.001&&(h=Number.POSITIVE_INFINITY);const d=u.payload;s.samples.push({data:d,len:d.byteLength,dts:c,pts:c,type:ki.emsg,duration:h})}})}return s}demuxSampleAes(e,t,s){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const MS=(r,e)=>{let t=0,s=5;e+=s;const a=new Uint32Array(1),o=new Uint32Array(1),u=new Uint8Array(1);for(;s>0;){u[0]=r[e];const c=Math.min(s,8),h=8-c;o[0]=4278190080>>>24+h<<h,a[0]=(u[0]&o[0])>>h,t=t?t<<c|a[0]:a[0],e+=1,s-=c}return t};class sD extends u0{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,s,a){super.resetInitSegment(e,t,s,a),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,s){const a=kS(e,t,s,this.basePTS,this.frameIndex);if(a!==-1)return{sample:e.samples[e.samples.length-1],length:a,missing:0}}static probe(e){if(!e)return!1;const t=_o(e,0);if(!t)return!1;const s=t.length;return e[s]===11&&e[s+1]===119&&s0(t)!==void 0&&MS(e,s)<16}}function kS(r,e,t,s,a){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const o=e[t+4]>>6;if(o>=3)return-1;const c=[48e3,44100,32e3][o],h=e[t+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][h*3+o]*2;if(t+m>e.length)return-1;const p=e[t+6]>>5;let v=0;p===2?v+=2:(p&1&&p!==1&&(v+=2),p&4&&(v+=2));const x=(e[t+6]<<8|e[t+7])>>12-v&1,E=[2,1,2,3,3,4,4,5][p]+x,T=e[t+5]>>3,A=e[t+5]&7,w=new Uint8Array([o<<6|T<<1|A>>2,(A&3)<<6|p<<3|x<<2|h>>4,h<<4&224]),C=1536/c*9e4,k=s+a*C,_=e.subarray(t,t+m);return r.config=w,r.channelCount=E,r.samplerate=c,r.samples.push({unit:_,pts:k}),m}class nD{constructor(){this.VideoSample=null}createVideoSample(e,t,s,a){return{key:e,frame:!1,pts:t,dts:s,units:[],debug:a,length:0}}getLastNalUnit(e){var t;let s=this.VideoSample,a;if((!s||s.units.length===0)&&(s=e[e.length-1]),(t=s)!=null&&t.units){const o=s.units;a=o[o.length-1]}return a}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const s=t.samples,a=s.length;if(a){const o=s[a-1];e.pts=o.pts,e.dts=o.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&X.log(e.pts+"/"+e.dts+":"+e.debug)}}class Cv{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,s=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(o===0)throw new Error("no bytes available");a.set(e.subarray(s,s+o)),this.word=new DataView(a.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const s=this.word>>>32-t;if(e>32&&X.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?s<<t|this.readBits(t):s}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,s=8,a;for(let o=0;o<e;o++)s!==0&&(a=this.readEG(),s=(t+a+256)%256),t=s===0?t:s}readSPS(){let e=0,t=0,s=0,a=0,o,u,c;const h=this.readUByte.bind(this),d=this.readBits.bind(this),m=this.readUEG.bind(this),p=this.readBoolean.bind(this),v=this.skipBits.bind(this),x=this.skipEG.bind(this),S=this.skipUEG.bind(this),E=this.skipScalingList.bind(this);h();const T=h();if(d(5),v(3),h(),S(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const U=m();if(U===3&&v(1),S(),S(),v(1),p())for(u=U!==3?8:12,c=0;c<u;c++)p()&&(c<6?E(16):E(64))}S();const A=m();if(A===0)m();else if(A===1)for(v(1),x(),x(),o=m(),c=0;c<o;c++)x();S(),v(1);const w=m(),C=m(),k=d(1);k===0&&v(1),v(1),p()&&(e=m(),t=m(),s=m(),a=m());let _=[1,1];if(p()&&p())switch(h()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:{_=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((w+1)*16-e*2-t*2),height:(2-k)*(C+1)*16-(k?2:4)*(s+a),pixelRatio:_}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class rD extends nD{parseAVCPES(e,t,s,a,o){const u=this.parseAVCNALu(e,s.data);let c=this.VideoSample,h,d=!1;s.data=null,c&&u.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts,"")),u.forEach(m=>{var p;switch(m.type){case 1:{let E=!1;h=!0;const T=m.data;if(d&&T.length>4){const A=new Cv(T).readSliceType();(A===2||A===4||A===7||A===9)&&(E=!0)}if(E){var v;(v=c)!=null&&v.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts,"")),c.frame=!0,c.key=E;break}case 5:h=!0,(p=c)!=null&&p.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,s.pts,s.dts,"")),c.key=!0,c.frame=!0;break;case 6:{h=!0,cS(m.data,1,s.pts,t.samples);break}case 7:{var x,S;h=!0,d=!0;const E=m.data,A=new Cv(E).readSPS();if(!e.sps||e.width!==A.width||e.height!==A.height||((x=e.pixelRatio)==null?void 0:x[0])!==A.pixelRatio[0]||((S=e.pixelRatio)==null?void 0:S[1])!==A.pixelRatio[1]){e.width=A.width,e.height=A.height,e.pixelRatio=A.pixelRatio,e.sps=[E],e.duration=o;const w=E.subarray(1,4);let C="avc1.";for(let k=0;k<3;k++){let _=w[k].toString(16);_.length<2&&(_="0"+_),C+=_}e.codec=C}break}case 8:h=!0,e.pps=[m.data];break;case 9:h=!0,e.audFound=!0,c&&this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,s.pts,s.dts,"");break;case 12:h=!0;break;default:h=!1,c&&(c.debug+="unknown NAL "+m.type+" ");break}c&&h&&c.units.push(m)}),a&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}parseAVCNALu(e,t){const s=t.byteLength;let a=e.naluState||0;const o=a,u=[];let c=0,h,d,m,p=-1,v=0;for(a===-1&&(p=0,v=t[0]&31,a=0,c=1);c<s;){if(h=t[c++],!a){a=h?0:1;continue}if(a===1){a=h?0:2;continue}if(!h)a=3;else if(h===1){if(d=c-a-1,p>=0){const x={data:t.subarray(p,d),type:v};u.push(x)}else{const x=this.getLastNalUnit(e.samples);x&&(o&&c<=4-o&&x.state&&(x.data=x.data.subarray(0,x.data.byteLength-o)),d>0&&(x.data=bi(x.data,t.subarray(0,d)),x.state=0))}c<s?(m=t[c]&31,p=c,v=m,a=0):a=-1}else a=0}if(p>=0&&a>=0){const x={data:t.subarray(p,s),type:v,state:a};u.push(x)}if(u.length===0){const x=this.getLastNalUnit(e.samples);x&&(x.data=bi(x.data,t))}return e.naluState=a,u}}class aD{constructor(e,t,s){this.keyData=void 0,this.decrypter=void 0,this.keyData=s,this.decrypter=new o0(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,s){const a=e[t].unit;if(a.length<=16)return;const o=a.subarray(16,a.length-a.length%16),u=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(u).then(c=>{const h=new Uint8Array(c);a.set(h,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,s)})}decryptAacSamples(e,t,s){for(;;t++){if(t>=e.length){s();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,s),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,s=new Int8Array(t);let a=0;for(let o=32;o<e.length-16;o+=160,a+=16)s.set(e.subarray(o,o+16),a);return s}getAvcDecryptedUnit(e,t){const s=new Uint8Array(t);let a=0;for(let o=32;o<e.length-16;o+=160,a+=16)e.set(s.subarray(a,a+16),o);return e}decryptAvcSample(e,t,s,a,o){const u=fS(o.data),c=this.getAvcEncryptedData(u);this.decryptBuffer(c.buffer).then(h=>{o.data=this.getAvcDecryptedUnit(u,h),this.decrypter.isSync()||this.decryptAvcSamples(e,t,s+1,a)})}decryptAvcSamples(e,t,s,a){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,s=0){if(t>=e.length){a();return}const o=e[t].units;for(;!(s>=o.length);s++){const u=o[s];if(!(u.data.length<=48||u.type!==1&&u.type!==5)&&(this.decryptAvcSample(e,t,s,a,u),!this.decrypter.isSync()))return}}}}const At=188;class nn{constructor(e,t,s){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=s,this.videoParser=new rD}static probe(e){const t=nn.syncOffset(e);return t>0&&X.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let s=Math.min(At*5,t-At)+1,a=0;for(;a<s;){let o=!1,u=-1,c=0;for(let h=a;h<t;h+=At)if(e[h]===71&&(t-h===At||e[h+At]===71)){if(c++,u===-1&&(u=h,u!==0&&(s=Math.min(u+At*99,e.length-At)+1)),o||(o=Pd(e,h)===0),o&&c>1&&(u===0&&c>2||h+At>s))return u}else{if(c)return-1;break}a++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:rS[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,s,a){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=nn.createTrack("video"),this._audioTrack=nn.createTrack("audio",a),this._id3Track=nn.createTrack("id3"),this._txtTrack=nn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=s,this._duration=a}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:s}=this;e&&(e.pesData=null),t&&(t.pesData=null),s&&(s.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,s=!1,a=!1){s||(this.sampleAes=null);let o;const u=this._videoTrack,c=this._audioTrack,h=this._id3Track,d=this._txtTrack;let m=u.pid,p=u.pesData,v=c.pid,x=h.pid,S=c.pesData,E=h.pesData,T=null,A=this.pmtParsed,w=this._pmtId,C=e.length;if(this.remainderData&&(e=bi(this.remainderData,e),C=e.length,this.remainderData=null),C<At&&!a)return this.remainderData=e,{audioTrack:c,videoTrack:u,id3Track:h,textTrack:d};const k=Math.max(0,nn.syncOffset(e));C-=(C-k)%At,C<e.byteLength&&!a&&(this.remainderData=new Uint8Array(e.buffer,C,e.buffer.byteLength-C));let _=0;for(let B=k;B<C;B+=At)if(e[B]===71){const M=!!(e[B+1]&64),D=Pd(e,B),N=(e[B+3]&48)>>4;let P;if(N>1){if(P=B+5+e[B+4],P===B+At)continue}else P=B+4;switch(D){case m:M&&(p&&(o=Hr(p))&&this.videoParser.parseAVCPES(u,d,o,!1,this._duration),p={data:[],size:0}),p&&(p.data.push(e.subarray(P,B+At)),p.size+=B+At-P);break;case v:if(M){if(S&&(o=Hr(S)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,o);break;case"mp3":this.parseMPEGPES(c,o);break;case"ac3":this.parseAC3PES(c,o);break}S={data:[],size:0}}S&&(S.data.push(e.subarray(P,B+At)),S.size+=B+At-P);break;case x:M&&(E&&(o=Hr(E))&&this.parseID3PES(h,o),E={data:[],size:0}),E&&(E.data.push(e.subarray(P,B+At)),E.size+=B+At-P);break;case 0:M&&(P+=e[P]+1),w=this._pmtId=oD(e,P);break;case w:{M&&(P+=e[P]+1);const G=lD(e,P,this.typeSupported,s,this.observer);m=G.videoPid,m>0&&(u.pid=m,u.segmentCodec=G.segmentVideoCodec),v=G.audioPid,v>0&&(c.pid=v,c.segmentCodec=G.segmentAudioCodec),x=G.id3Pid,x>0&&(h.pid=x),T!==null&&!A&&(X.warn(`MPEG-TS PMT found at ${B} after unknown PID '${T}'. Backtracking to sync byte @${k} to parse all TS packets.`),T=null,B=k-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:T=D;break}}else _++;_>0&&Ku(this.observer,new Error(`Found ${_} TS packet/s that do not start with 0x47`)),u.pesData=p,c.pesData=S,h.pesData=E;const U={audioTrack:c,videoTrack:u,id3Track:h,textTrack:d};return a&&this.extractRemainingSamples(U),U}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:s,id3Track:a,textTrack:o}=e,u=s.pesData,c=t.pesData,h=a.pesData;let d;if(u&&(d=Hr(u))?(this.videoParser.parseAVCPES(s,o,d,!0,this._duration),s.pesData=null):s.pesData=u,c&&(d=Hr(c))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else c!=null&&c.size&&X.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;h&&(d=Hr(h))?(this.parseID3PES(a,d),a.pesData=null):a.pesData=h}demuxSampleAes(e,t,s){const a=this.demux(e,s,!0,!this.config.progressive),o=this.sampleAes=new aD(this.observer,this.config,t);return this.decrypt(a,o)}decrypt(e,t){return new Promise(s=>{const{audioTrack:a,videoTrack:o}=e;a.samples&&a.segmentCodec==="aac"?t.decryptAacSamples(a.samples,0,()=>{o.samples?t.decryptAvcSamples(o.samples,0,0,()=>{s(e)}):s(e)}):o.samples&&t.decryptAvcSamples(o.samples,0,0,()=>{s(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let s=0;const a=this.aacOverFlow;let o=t.data;if(a){this.aacOverFlow=null;const p=a.missing,v=a.sample.unit.byteLength;if(p===-1)o=bi(a.sample.unit,o);else{const x=v-p;a.sample.unit.set(o.subarray(0,p),x),e.samples.push(a.sample),s=a.missing}}let u,c;for(u=s,c=o.length;u<c-1&&!Vu(o,u);u++);if(u!==s){let p;const v=u<c-1;if(v?p=`AAC PES did not start with ADTS header,offset:${u}`:p="No ADTS header found in AAC PES",Ku(this.observer,new Error(p),v),!v)return}LS(e,this.observer,o,u,this.audioCodec);let h;if(t.pts!==void 0)h=t.pts;else if(a){const p=_S(e.samplerate);h=a.sample.pts+p}else{X.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,m;for(;u<c;)if(m=DS(e,o,u,h,d),u+=m.length,m.missing){this.aacOverFlow=m;break}else for(d++;u<c-1&&!Vu(o,u);u++);}parseMPEGPES(e,t){const s=t.data,a=s.length;let o=0,u=0;const c=t.pts;if(c===void 0){X.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;u<a;)if(OS(s,u)){const h=CS(e,s,u,c,o);if(h)u+=h.length,o++;else break}else u++}parseAC3PES(e,t){{const s=t.data,a=t.pts;if(a===void 0){X.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const o=s.length;let u=0,c=0,h;for(;c<o&&(h=kS(e,s,c,a,u++))>0;)c+=h}}parseID3PES(e,t){if(t.pts===void 0){X.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const s=mt({},t,{type:this._videoTrack?ki.emsg:ki.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(s)}}function Pd(r,e){return((r[e+1]&31)<<8)+r[e+2]}function oD(r,e){return(r[e+10]&31)<<8|r[e+11]}function lD(r,e,t,s,a){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(r[e+1]&15)<<8|r[e+2],c=e+3+u-4,h=(r[e+10]&15)<<8|r[e+11];for(e+=12+h;e<c;){const d=Pd(r,e),m=(r[e+3]&15)<<8|r[e+4];switch(r[e]){case 207:if(!s){Wh("ADTS AAC");break}case 15:o.audioPid===-1&&(o.audioPid=d);break;case 21:o.id3Pid===-1&&(o.id3Pid=d);break;case 219:if(!s){Wh("H.264");break}case 27:o.videoPid===-1&&(o.videoPid=d,o.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?X.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=d,o.segmentAudioCodec="mp3");break;case 193:if(!s){Wh("AC-3");break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=d,o.segmentAudioCodec="ac3"):X.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&m>0){let p=e+5,v=m;for(;v>2;){switch(r[p]){case 106:t.ac3!==!0?X.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=d,o.segmentAudioCodec="ac3");break}const S=r[p+1]+2;p+=S,v-=S}}break;case 194:case 135:return Ku(a,new Error("Unsupported EC-3 in M2TS found")),o;case 36:return Ku(a,new Error("Unsupported HEVC in M2TS found")),o}e+=m+5}return o}function Ku(r,e,t){X.warn(`parsing error: ${e.message}`),r.emit(R.ERROR,R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Wh(r){X.log(`${r} with AES-128-CBC encryption found in unencrypted stream`)}function Hr(r){let e=0,t,s,a,o,u;const c=r.data;if(!r||r.size===0)return null;for(;c[0].length<19&&c.length>1;)c[0]=bi(c[0],c[1]),c.splice(1,1);if(t=c[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(s=(t[4]<<8)+t[5],s&&s>r.size-6)return null;const d=t[7];d&192&&(o=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,d&64?(u=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,o-u>60*9e4&&(X.warn(`${Math.round((o-u)/9e4)}s delta between PTS and DTS, align them`),o=u)):u=o),a=t[8];let m=a+9;if(r.size<=m)return null;r.size-=m;const p=new Uint8Array(r.size);for(let v=0,x=c.length;v<x;v++){t=c[v];let S=t.byteLength;if(m)if(m>S){m-=S;continue}else t=t.subarray(m),S-=m,m=0;p.set(t,e),e+=S}return s&&(s-=a+3),{data:p,pts:o,dts:u,len:s}}return null}class uD extends u0{resetInitSegment(e,t,s,a){super.resetInitSegment(e,t,s,a),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=_o(e,0);let s=(t==null?void 0:t.length)||0;if(t&&e[s]===11&&e[s+1]===119&&s0(t)!==void 0&&MS(e,s)<=16)return!1;for(let a=e.length;s<a;s++)if(IS(e,s))return X.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return J_(e,t)}appendFrame(e,t,s){if(this.basePTS!==null)return CS(e,t,s,this.basePTS,this.frameIndex)}}class wv{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const tn=Math.pow(2,32)-1;class Z{static init(){Z.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Z.types)Z.types.hasOwnProperty(e)&&(Z.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),s=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Z.HDLR_TYPES={video:t,audio:s};const a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);Z.STTS=Z.STSC=Z.STCO=o,Z.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Z.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Z.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Z.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const u=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),h=new Uint8Array([0,0,0,1]);Z.FTYP=Z.box(Z.types.ftyp,u,h,u,c),Z.DINF=Z.box(Z.types.dinf,Z.box(Z.types.dref,a))}static box(e,...t){let s=8,a=t.length;const o=a;for(;a--;)s+=t[a].byteLength;const u=new Uint8Array(s);for(u[0]=s>>24&255,u[1]=s>>16&255,u[2]=s>>8&255,u[3]=s&255,u.set(e,4),a=0,s=8;a<o;a++)u.set(t[a],s),s+=t[a].byteLength;return u}static hdlr(e){return Z.box(Z.types.hdlr,Z.HDLR_TYPES[e])}static mdat(e){return Z.box(Z.types.mdat,e)}static mdhd(e,t){t*=e;const s=Math.floor(t/(tn+1)),a=Math.floor(t%(tn+1));return Z.box(Z.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255,85,196,0,0]))}static mdia(e){return Z.box(Z.types.mdia,Z.mdhd(e.timescale,e.duration),Z.hdlr(e.type),Z.minf(e))}static mfhd(e){return Z.box(Z.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Z.box(Z.types.minf,Z.box(Z.types.smhd,Z.SMHD),Z.DINF,Z.stbl(e)):Z.box(Z.types.minf,Z.box(Z.types.vmhd,Z.VMHD),Z.DINF,Z.stbl(e))}static moof(e,t,s){return Z.box(Z.types.moof,Z.mfhd(e),Z.traf(s,t))}static moov(e){let t=e.length;const s=[];for(;t--;)s[t]=Z.trak(e[t]);return Z.box.apply(null,[Z.types.moov,Z.mvhd(e[0].timescale,e[0].duration)].concat(s).concat(Z.mvex(e)))}static mvex(e){let t=e.length;const s=[];for(;t--;)s[t]=Z.trex(e[t]);return Z.box.apply(null,[Z.types.mvex,...s])}static mvhd(e,t){t*=e;const s=Math.floor(t/(tn+1)),a=Math.floor(t%(tn+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Z.box(Z.types.mvhd,o)}static sdtp(e){const t=e.samples||[],s=new Uint8Array(4+t.length);let a,o;for(a=0;a<t.length;a++)o=t[a].flags,s[a+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return Z.box(Z.types.sdtp,s)}static stbl(e){return Z.box(Z.types.stbl,Z.stsd(e),Z.box(Z.types.stts,Z.STTS),Z.box(Z.types.stsc,Z.STSC),Z.box(Z.types.stsz,Z.STSZ),Z.box(Z.types.stco,Z.STCO))}static avc1(e){let t=[],s=[],a,o,u;for(a=0;a<e.sps.length;a++)o=e.sps[a],u=o.byteLength,t.push(u>>>8&255),t.push(u&255),t=t.concat(Array.prototype.slice.call(o));for(a=0;a<e.pps.length;a++)o=e.pps[a],u=o.byteLength,s.push(u>>>8&255),s.push(u&255),s=s.concat(Array.prototype.slice.call(o));const c=Z.box(Z.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(s))),h=e.width,d=e.height,m=e.pixelRatio[0],p=e.pixelRatio[1];return Z.box(Z.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,Z.box(Z.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Z.box(Z.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Z.box(Z.types.mp4a,Z.audioStsd(e),Z.box(Z.types.esds,Z.esds(e)))}static mp3(e){return Z.box(Z.types[".mp3"],Z.audioStsd(e))}static ac3(e){return Z.box(Z.types["ac-3"],Z.audioStsd(e),Z.box(Z.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?Z.box(Z.types.stsd,Z.STSD,Z.mp3(e)):e.segmentCodec==="ac3"?Z.box(Z.types.stsd,Z.STSD,Z.ac3(e)):Z.box(Z.types.stsd,Z.STSD,Z.mp4a(e)):Z.box(Z.types.stsd,Z.STSD,Z.avc1(e))}static tkhd(e){const t=e.id,s=e.duration*e.timescale,a=e.width,o=e.height,u=Math.floor(s/(tn+1)),c=Math.floor(s%(tn+1));return Z.box(Z.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,a&255,0,0,o>>8&255,o&255,0,0]))}static traf(e,t){const s=Z.sdtp(e),a=e.id,o=Math.floor(t/(tn+1)),u=Math.floor(t%(tn+1));return Z.box(Z.types.traf,Z.box(Z.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255])),Z.box(Z.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,u>>24,u>>16&255,u>>8&255,u&255])),Z.trun(e,s.length+16+20+8+16+8+8),s)}static trak(e){return e.duration=e.duration||4294967295,Z.box(Z.types.trak,Z.tkhd(e),Z.mdia(e))}static trex(e){const t=e.id;return Z.box(Z.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const s=e.samples||[],a=s.length,o=12+16*a,u=new Uint8Array(o);let c,h,d,m,p,v;for(t+=8+o,u.set([e.type==="video"?1:0,0,15,1,a>>>24&255,a>>>16&255,a>>>8&255,a&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),c=0;c<a;c++)h=s[c],d=h.duration,m=h.size,p=h.flags,v=h.cts,u.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,v>>>24&255,v>>>16&255,v>>>8&255,v&255],12+16*c);return Z.box(Z.types.trun,u)}static initSegment(e){Z.types||Z.init();const t=Z.moov(e);return bi(Z.FTYP,t)}}Z.types=void 0;Z.HDLR_TYPES=void 0;Z.STTS=void 0;Z.STSC=void 0;Z.STCO=void 0;Z.STSZ=void 0;Z.VMHD=void 0;Z.SMHD=void 0;Z.STSD=void 0;Z.FTYP=void 0;Z.DINF=void 0;const NS=9e4;function h0(r,e,t=1,s=!1){const a=r*e*t;return s?Math.round(a):a}function cD(r,e,t=1,s=!1){return h0(r,e,1/t,s)}function yo(r,e=!1){return h0(r,1e3,1/NS,e)}function fD(r,e=1){return h0(r,NS,1/e)}const hD=10*1e3,Ov=1024,dD=1152,mD=1536;let $r=null,Zh=null;class vu{constructor(e,t,s,a=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=s,this.ISGenerated=!1,$r===null){const u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);$r=u?parseInt(u[1]):0}if(Zh===null){const o=navigator.userAgent.match(/Safari\/(\d+)/i);Zh=o?parseInt(o[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){X.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){X.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){X.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const s=e[0].pts,a=e.reduce((o,u)=>{let c=u.pts,h=c-o;return h<-4294967296&&(t=!0,c=Ti(c,s),h=c-o),h>0?o:c},s);return t&&X.debug("PTS rollover detected"),a}remux(e,t,s,a,o,u,c,h){let d,m,p,v,x,S,E=o,T=o;const A=e.pid>-1,w=t.pid>-1,C=t.samples.length,k=e.samples.length>0,_=c&&C>0||C>1;if((!A||k)&&(!w||_)||this.ISGenerated||c){if(this.ISGenerated){var B,M,D,N;const z=this.videoTrackConfig;z&&(t.width!==z.width||t.height!==z.height||((B=t.pixelRatio)==null?void 0:B[0])!==((M=z.pixelRatio)==null?void 0:M[0])||((D=t.pixelRatio)==null?void 0:D[1])!==((N=z.pixelRatio)==null?void 0:N[1]))&&this.resetInitSegment()}else p=this.generateIS(e,t,o,u);const P=this.isVideoContiguous;let G=-1,J;if(_&&(G=gD(t.samples),!P&&this.config.forceKeyFrameOnDiscontinuity))if(S=!0,G>0){X.warn(`[mp4-remuxer]: Dropped ${G} out of ${C} video samples due to a missing keyframe`);const z=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(G),t.dropped+=G,T+=(t.samples[0].pts-z)/t.inputTimeScale,J=T}else G===-1&&(X.warn(`[mp4-remuxer]: No keyframe found out of ${C} video samples`),S=!1);if(this.ISGenerated){if(k&&_){const z=this.getVideoStartPts(t.samples),$=(Ti(e.samples[0].pts,z)-z)/t.inputTimeScale;E+=Math.max(0,$),T+=Math.max(0,-$)}if(k){if(e.samplerate||(X.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),p=this.generateIS(e,t,o,u)),m=this.remuxAudio(e,E,this.isAudioContiguous,u,w||_||h===be.AUDIO?T:void 0),_){const z=m?m.endPTS-m.startPTS:0;t.inputTimeScale||(X.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),p=this.generateIS(e,t,o,u)),d=this.remuxVideo(t,T,P,z)}}else _&&(d=this.remuxVideo(t,T,P,0));d&&(d.firstKeyFrame=G,d.independent=G!==-1,d.firstKeyFramePTS=J)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(s.samples.length&&(x=PS(s,o,this._initPTS,this._initDTS)),a.samples.length&&(v=FS(a,o,this._initPTS))),{audio:m,video:d,initSegment:p,independent:S,text:v,id3:x}}generateIS(e,t,s,a){const o=e.samples,u=t.samples,c=this.typeSupported,h={},d=this._initPTS;let m=!d||a,p="audio/mp4",v,x,S;if(m&&(v=x=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":c.mpeg?(p="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}h.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):Z.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(S=e.inputTimeScale,!d||S!==d.timescale?v=x=o[0].pts-Math.round(S*s):m=!1)}if(t.sps&&t.pps&&u.length){if(t.timescale=t.inputTimeScale,h.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Z.initSegment([t]),metadata:{width:t.width,height:t.height}},m)if(S=t.inputTimeScale,!d||S!==d.timescale){const E=this.getVideoStartPts(u),T=Math.round(S*s);x=Math.min(x,Ti(u[0].dts,E)-T),v=Math.min(v,E-T)}else m=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(h).length)return this.ISGenerated=!0,m?(this._initPTS={baseTime:v,timescale:S},this._initDTS={baseTime:x,timescale:S}):v=S=void 0,{tracks:h,initPTS:v,timescale:S}}remuxVideo(e,t,s,a){const o=e.inputTimeScale,u=e.samples,c=[],h=u.length,d=this._initPTS;let m=this.nextAvcDts,p=8,v=this.videoSampleDuration,x,S,E=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,A=!1;if(!s||m===null){const Y=t*o,O=u[0].pts-Ti(u[0].dts,u[0].pts);$r&&m!==null&&Math.abs(Y-O-m)<15e3?s=!0:m=Y-O}const w=d.baseTime*o/d.timescale;for(let Y=0;Y<h;Y++){const O=u[Y];O.pts=Ti(O.pts-w,m),O.dts=Ti(O.dts-w,m),O.dts<u[Y>0?Y-1:Y].dts&&(A=!0)}A&&u.sort(function(Y,O){const K=Y.dts-O.dts,te=Y.pts-O.pts;return K||te}),x=u[0].dts,S=u[u.length-1].dts;const C=S-x,k=C?Math.round(C/(h-1)):v||e.inputTimeScale/30;if(s){const Y=x-m,O=Y>k,K=Y<-1;if((O||K)&&(O?X.warn(`AVC: ${yo(Y,!0)} ms (${Y}dts) hole between fragments detected at ${t.toFixed(3)}`):X.warn(`AVC: ${yo(-Y,!0)} ms (${Y}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!K||m>=u[0].pts||$r)){x=m;const te=u[0].pts-Y;if(O)u[0].dts=x,u[0].pts=te;else for(let ae=0;ae<u.length&&!(u[ae].dts>te);ae++)u[ae].dts-=Y,u[ae].pts-=Y;X.log(`Video: Initial PTS/DTS adjusted: ${yo(te,!0)}/${yo(x,!0)}, delta: ${yo(Y,!0)} ms`)}}x=Math.max(0,x);let _=0,U=0,B=x;for(let Y=0;Y<h;Y++){const O=u[Y],K=O.units,te=K.length;let ae=0;for(let re=0;re<te;re++)ae+=K[re].data.length;U+=ae,_+=te,O.length=ae,O.dts<B?(O.dts=B,B+=k/4|0||1):B=O.dts,E=Math.min(O.pts,E),T=Math.max(O.pts,T)}S=u[h-1].dts;const M=U+4*_+8;let D;try{D=new Uint8Array(M)}catch(Y){this.observer.emit(R.ERROR,R.ERROR,{type:Ae.MUX_ERROR,details:ie.REMUX_ALLOC_ERROR,fatal:!1,error:Y,bytes:M,reason:`fail allocating video mdat ${M}`});return}const N=new DataView(D.buffer);N.setUint32(0,M),D.set(Z.types.mdat,4);let P=!1,G=Number.POSITIVE_INFINITY,J=Number.POSITIVE_INFINITY,z=Number.NEGATIVE_INFINITY,Q=Number.NEGATIVE_INFINITY;for(let Y=0;Y<h;Y++){const O=u[Y],K=O.units;let te=0;for(let me=0,de=K.length;me<de;me++){const _e=K[me],pe=_e.data,Le=_e.data.byteLength;N.setUint32(p,Le),p+=4,D.set(pe,p),p+=Le,te+=4+Le}let ae;if(Y<h-1)v=u[Y+1].dts-O.dts,ae=u[Y+1].pts-O.pts;else{const me=this.config,de=Y>0?O.dts-u[Y-1].dts:k;if(ae=Y>0?O.pts-u[Y-1].pts:k,me.stretchShortVideoTrack&&this.nextAudioPts!==null){const _e=Math.floor(me.maxBufferHole*o),pe=(a?E+a*o:this.nextAudioPts)-O.pts;pe>_e?(v=pe-de,v<0?v=de:P=!0,X.log(`[mp4-remuxer]: It is approximately ${pe/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=de}else v=de}const re=Math.round(O.pts-O.dts);G=Math.min(G,v),z=Math.max(z,v),J=Math.min(J,ae),Q=Math.max(Q,ae),c.push(new Iv(O.key,v,te,re))}if(c.length){if($r){if($r<70){const Y=c[0].flags;Y.dependsOn=2,Y.isNonSync=0}}else if(Zh&&Q-J<z-G&&k/z<.025&&c[0].cts===0){X.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Y=x;for(let O=0,K=c.length;O<K;O++){const te=Y+c[O].duration,ae=Y+c[O].cts;if(O<K-1){const re=te+c[O+1].cts;c[O].duration=re-ae}else c[O].duration=O?c[O-1].duration:k;c[O].cts=0,Y=te}}}v=P||!v?k:v,this.nextAvcDts=m=S+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;const ue={data1:Z.moof(e.sequenceNumber++,x,mt({},e,{samples:c})),data2:D,startPTS:E/o,endPTS:(T+v)/o,startDTS:x/o,endDTS:m/o,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ue}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return dD;case"ac3":return mD;default:return Ov}}remuxAudio(e,t,s,a,o){const u=e.inputTimeScale,c=e.samplerate?e.samplerate:u,h=u/c,d=this.getSamplesPerFrame(e),m=d*h,p=this._initPTS,v=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,x=[],S=o!==void 0;let E=e.samples,T=v?0:8,A=this.nextAudioPts||-1;const w=t*u,C=p.baseTime*u/p.timescale;if(this.isAudioContiguous=s=s||E.length&&A>0&&(a&&Math.abs(w-A)<9e3||Math.abs(Ti(E[0].pts-C,w)-A)<20*m),E.forEach(function($){$.pts=Ti($.pts-C,w)}),!s||A<0){if(E=E.filter($=>$.pts>=0),!E.length)return;o===0?A=0:a&&!S?A=Math.max(0,w):A=E[0].pts}if(e.segmentCodec==="aac"){const $=this.config.maxAudioFramesDrift;for(let oe=0,ue=A;oe<E.length;oe++){const Y=E[oe],O=Y.pts,K=O-ue,te=Math.abs(1e3*K/u);if(K<=-$*m&&S)oe===0&&(X.warn(`Audio frame @ ${(O/u).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*K/u)} ms.`),this.nextAudioPts=A=ue=O);else if(K>=$*m&&te<hD&&S){let ae=Math.round(K/m);ue=O-ae*m,ue<0&&(ae--,ue+=m),oe===0&&(this.nextAudioPts=A=ue),X.warn(`[mp4-remuxer]: Injecting ${ae} audio frame @ ${(ue/u).toFixed(3)}s due to ${Math.round(1e3*K/u)} ms gap.`);for(let re=0;re<ae;re++){const me=Math.max(ue,0);let de=wv.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);de||(X.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),de=Y.unit.subarray()),E.splice(oe,0,{unit:de,pts:me}),ue+=m,oe++}}Y.pts=ue,ue+=m}}let k=null,_=null,U,B=0,M=E.length;for(;M--;)B+=E[M].unit.byteLength;for(let $=0,oe=E.length;$<oe;$++){const ue=E[$],Y=ue.unit;let O=ue.pts;if(_!==null){const te=x[$-1];te.duration=Math.round((O-_)/h)}else if(s&&e.segmentCodec==="aac"&&(O=A),k=O,B>0){B+=T;try{U=new Uint8Array(B)}catch(te){this.observer.emit(R.ERROR,R.ERROR,{type:Ae.MUX_ERROR,details:ie.REMUX_ALLOC_ERROR,fatal:!1,error:te,bytes:B,reason:`fail allocating audio mdat ${B}`});return}v||(new DataView(U.buffer).setUint32(0,B),U.set(Z.types.mdat,4))}else return;U.set(Y,T);const K=Y.byteLength;T+=K,x.push(new Iv(!0,d,K,0)),_=O}const D=x.length;if(!D)return;const N=x[x.length-1];this.nextAudioPts=A=_+h*N.duration;const P=v?new Uint8Array(0):Z.moof(e.sequenceNumber++,k/h,mt({},e,{samples:x}));e.samples=[];const G=k/u,J=A/u,Q={data1:P,data2:U,startPTS:G,endPTS:J,startDTS:G,endDTS:J,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,Q}remuxEmptyAudio(e,t,s,a){const o=e.inputTimeScale,u=e.samplerate?e.samplerate:o,c=o/u,h=this.nextAudioPts,d=this._initDTS,m=d.baseTime*9e4/d.timescale,p=(h!==null?h:a.startDTS*o)+m,v=a.endDTS*o+m,x=c*Ov,S=Math.ceil((v-p)/x),E=wv.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(X.warn("[mp4-remuxer]: remux empty Audio"),!E){X.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const T=[];for(let A=0;A<S;A++){const w=p+A*x;T.push({unit:E,pts:w,dts:w})}return e.samples=T,this.remuxAudio(e,t,s,!1)}}function Ti(r,e){let t;if(e===null)return r;for(e<r?t=-8589934592:t=8589934592;Math.abs(r-e)>4294967296;)r+=t;return r}function gD(r){for(let e=0;e<r.length;e++)if(r[e].key)return e;return-1}function PS(r,e,t,s){const a=r.samples.length;if(!a)return;const o=r.inputTimeScale;for(let c=0;c<a;c++){const h=r.samples[c];h.pts=Ti(h.pts-t.baseTime*o/t.timescale,e*o)/o,h.dts=Ti(h.dts-s.baseTime*o/s.timescale,e*o)/o}const u=r.samples;return r.samples=[],{samples:u}}function FS(r,e,t){const s=r.samples.length;if(!s)return;const a=r.inputTimeScale;for(let u=0;u<s;u++){const c=r.samples[u];c.pts=Ti(c.pts-t.baseTime*a/t.timescale,e*a)/a}r.samples.sort((u,c)=>u.pts-c.pts);const o=r.samples;return r.samples=[],{samples:o}}class Iv{constructor(e,t,s,a){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=s,this.cts=a,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class pD{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,s,a){this.audioCodec=t,this.videoCodec=s,this.generateInitSegment(TL(e,a)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:s}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const a=this.initData=lS(e);a.audio&&(t=Mv(a.audio,ze.AUDIO)),a.video&&(s=Mv(a.video,ze.VIDEO));const o={};a.audio&&a.video?o.audiovideo={container:"video/mp4",codec:t+","+s,initSegment:e,id:"main"}:a.audio?o.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:a.video?o.video={container:"video/mp4",codec:s,initSegment:e,id:"main"}:X.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=o}remux(e,t,s,a,o,u){var c,h;let{initPTS:d,lastEndTime:m}=this;const p={audio:void 0,video:void 0,text:a,id3:s,initSegment:void 0};ye(m)||(m=this.lastEndTime=o||0);const v=t.samples;if(!(v!=null&&v.length))return p;const x={initPTS:void 0,timescale:1};let S=this.initData;if((c=S)!=null&&c.length||(this.generateInitSegment(v),S=this.initData),!((h=S)!=null&&h.length))return X.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),p;this.emitInitSegment&&(x.tracks=this.initTracks,this.emitInitSegment=!1);const E=AL(v,S),T=bL(S,v),A=T===null?o:T;(yD(d,A,o,E)||x.timescale!==d.timescale&&u)&&(x.initPTS=A-o,d&&d.timescale===1&&X.warn(`Adjusting initPTS by ${x.initPTS-d.baseTime}`),this.initPTS=d={baseTime:x.initPTS,timescale:1});const w=e?A-d.baseTime/d.timescale:m,C=w+E;LL(S,v,d.baseTime/d.timescale),E>0?this.lastEndTime=C:(X.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const k=!!S.audio,_=!!S.video;let U="";k&&(U+="audio"),_&&(U+="video");const B={data1:v,startPTS:w,startDTS:w,endPTS:C,endDTS:C,type:U,hasAudio:k,hasVideo:_,nb:1,dropped:0};return p.audio=B.type==="audio"?B:void 0,p.video=B.type!=="audio"?B:void 0,p.initSegment=x,p.id3=PS(s,o,d,d),a.samples.length&&(p.text=FS(a,o,d)),p}}function yD(r,e,t,s){if(r===null)return!0;const a=Math.max(s,1),o=e-r.baseTime/r.timescale;return Math.abs(o-t)>a}function Mv(r,e){const t=r==null?void 0:r.codec;if(t&&t.length>4)return t;if(e===ze.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return Uu(t,!1);const s="mp4a.40.5";return X.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${s}"`),s}return X.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let As;try{As=self.performance.now.bind(self.performance)}catch{X.debug("Unable to use Performance API on this environment"),As=ma==null?void 0:ma.Date.now}const xu=[{demux:iD,remux:pD},{demux:nn,remux:vu},{demux:eD,remux:vu},{demux:uD,remux:vu}];xu.splice(2,0,{demux:sD,remux:vu});class kv{constructor(e,t,s,a,o){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=s,this.vendor=a,this.id=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,s,a){const o=s.transmuxing;o.executeStart=As();let u=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:h}=this;a&&(this.currentTransmuxState=a);const{contiguous:d,discontinuity:m,trackSwitch:p,accurateTimeOffset:v,timeOffset:x,initSegmentChange:S}=a||c,{audioCodec:E,videoCodec:T,defaultInitPts:A,duration:w,initSegmentData:C}=h,k=vD(u,t);if(k&&k.method==="AES-128"){const M=this.getDecrypter();if(M.isSync()){let D=M.softwareDecrypt(u,k.key.buffer,k.iv.buffer);if(s.part>-1&&(D=M.flush()),!D)return o.executeEnd=As(),Jh(s);u=new Uint8Array(D)}else return this.decryptionPromise=M.webCryptoDecrypt(u,k.key.buffer,k.iv.buffer).then(D=>{const N=this.push(D,null,s);return this.decryptionPromise=null,N}),this.decryptionPromise}const _=this.needsProbing(m,p);if(_){const M=this.configureTransmuxer(u);if(M)return X.warn(`[transmuxer] ${M.message}`),this.observer.emit(R.ERROR,R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),o.executeEnd=As(),Jh(s)}(m||p||S||_)&&this.resetInitSegment(C,E,T,w,t),(m||S||_)&&this.resetInitialTimestamp(A),d||this.resetContiguity();const U=this.transmux(u,k,x,v,s),B=this.currentTransmuxState;return B.contiguous=!0,B.discontinuity=!1,B.trackSwitch=!1,o.executeEnd=As(),U}flush(e){const t=e.transmuxing;t.executeStart=As();const{decrypter:s,currentTransmuxState:a,decryptionPromise:o}=this;if(o)return o.then(()=>this.flush(e));const u=[],{timeOffset:c}=a;if(s){const p=s.flush();p&&u.push(this.push(p,null,e))}const{demuxer:h,remuxer:d}=this;if(!h||!d)return t.executeEnd=As(),[Jh(e)];const m=h.flush(c);return Su(m)?m.then(p=>(this.flushRemux(u,p,e),u)):(this.flushRemux(u,m,e),u)}flushRemux(e,t,s){const{audioTrack:a,videoTrack:o,id3Track:u,textTrack:c}=t,{accurateTimeOffset:h,timeOffset:d}=this.currentTransmuxState;X.log(`[transmuxer.ts]: Flushed fragment ${s.sn}${s.part>-1?" p: "+s.part:""} of level ${s.level}`);const m=this.remuxer.remux(a,o,u,c,d,h,!0,this.id);e.push({remuxResult:m,chunkMeta:s}),s.transmuxing.executeEnd=As()}resetInitialTimestamp(e){const{demuxer:t,remuxer:s}=this;!t||!s||(t.resetTimeStamp(e),s.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,s,a,o){const{demuxer:u,remuxer:c}=this;!u||!c||(u.resetInitSegment(e,t,s,a),c.resetInitSegment(e,t,s,o))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,s,a,o){let u;return t&&t.method==="SAMPLE-AES"?u=this.transmuxSampleAes(e,t,s,a,o):u=this.transmuxUnencrypted(e,s,a,o),u}transmuxUnencrypted(e,t,s,a){const{audioTrack:o,videoTrack:u,id3Track:c,textTrack:h}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(o,u,c,h,t,s,!1,this.id),chunkMeta:a}}transmuxSampleAes(e,t,s,a,o){return this.demuxer.demuxSampleAes(e,t,s).then(u=>({remuxResult:this.remuxer.remux(u.audioTrack,u.videoTrack,u.id3Track,u.textTrack,s,a,!1,this.id),chunkMeta:o}))}configureTransmuxer(e){const{config:t,observer:s,typeSupported:a,vendor:o}=this;let u;for(let v=0,x=xu.length;v<x;v++){var c;if((c=xu[v].demux)!=null&&c.probe(e)){u=xu[v];break}}if(!u)return new Error("Failed to find demuxer by probing fragment data");const h=this.demuxer,d=this.remuxer,m=u.remux,p=u.demux;(!d||!(d instanceof m))&&(this.remuxer=new m(s,t,a,o)),(!h||!(h instanceof p))&&(this.demuxer=new p(s,t,a),this.probe=p.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new o0(this.config)),e}}function vD(r,e){let t=null;return r.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Jh=r=>({remuxResult:{},chunkMeta:r});function Su(r){return"then"in r&&r.then instanceof Function}class xD{constructor(e,t,s,a,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=s,this.duration=a,this.defaultInitPts=o||null}}class SD{constructor(e,t,s,a,o,u){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=s,this.trackSwitch=a,this.timeOffset=o,this.initSegmentChange=u}}var US={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function a(h,d,m){this.fn=h,this.context=d,this.once=m||!1}function o(h,d,m,p,v){if(typeof m!="function")throw new TypeError("The listener must be a function");var x=new a(m,p||h,v),S=t?t+d:d;return h._events[S]?h._events[S].fn?h._events[S]=[h._events[S],x]:h._events[S].push(x):(h._events[S]=x,h._eventsCount++),h}function u(h,d){--h._eventsCount===0?h._events=new s:delete h._events[d]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],m,p;if(this._eventsCount===0)return d;for(p in m=this._events)e.call(m,p)&&d.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},c.prototype.listeners=function(d){var m=t?t+d:d,p=this._events[m];if(!p)return[];if(p.fn)return[p.fn];for(var v=0,x=p.length,S=new Array(x);v<x;v++)S[v]=p[v].fn;return S},c.prototype.listenerCount=function(d){var m=t?t+d:d,p=this._events[m];return p?p.fn?1:p.length:0},c.prototype.emit=function(d,m,p,v,x,S){var E=t?t+d:d;if(!this._events[E])return!1;var T=this._events[E],A=arguments.length,w,C;if(T.fn){switch(T.once&&this.removeListener(d,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,m),!0;case 3:return T.fn.call(T.context,m,p),!0;case 4:return T.fn.call(T.context,m,p,v),!0;case 5:return T.fn.call(T.context,m,p,v,x),!0;case 6:return T.fn.call(T.context,m,p,v,x,S),!0}for(C=1,w=new Array(A-1);C<A;C++)w[C-1]=arguments[C];T.fn.apply(T.context,w)}else{var k=T.length,_;for(C=0;C<k;C++)switch(T[C].once&&this.removeListener(d,T[C].fn,void 0,!0),A){case 1:T[C].fn.call(T[C].context);break;case 2:T[C].fn.call(T[C].context,m);break;case 3:T[C].fn.call(T[C].context,m,p);break;case 4:T[C].fn.call(T[C].context,m,p,v);break;default:if(!w)for(_=1,w=new Array(A-1);_<A;_++)w[_-1]=arguments[_];T[C].fn.apply(T[C].context,w)}}return!0},c.prototype.on=function(d,m,p){return o(this,d,m,p,!1)},c.prototype.once=function(d,m,p){return o(this,d,m,p,!0)},c.prototype.removeListener=function(d,m,p,v){var x=t?t+d:d;if(!this._events[x])return this;if(!m)return u(this,x),this;var S=this._events[x];if(S.fn)S.fn===m&&(!v||S.once)&&(!p||S.context===p)&&u(this,x);else{for(var E=0,T=[],A=S.length;E<A;E++)(S[E].fn!==m||v&&!S[E].once||p&&S[E].context!==p)&&T.push(S[E]);T.length?this._events[x]=T.length===1?T[0]:T:u(this,x)}return this},c.prototype.removeAllListeners=function(d){var m;return d?(m=t?t+d:d,this._events[m]&&u(this,m)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c})(US);var ED=US.exports,d0=VR(ED);class BS{constructor(e,t,s,a){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const o=e.config;this.hls=e,this.id=t,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=s,this.onFlush=a;const u=(d,m)=>{m=m||{},m.frag=this.frag,m.id=this.id,d===R.ERROR&&(this.error=m.error),this.hls.trigger(d,m)};this.observer=new d0,this.observer.on(R.FRAG_DECRYPTED,u),this.observer.on(R.ERROR,u);const c=nr(o.preferManagedMediaSource)||{isTypeSupported:()=>!1},h={mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:c.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(o.workerPath||j_())){try{o.workerPath?(X.log(`loading Web Worker ${o.workerPath} for "${t}"`),this.workerContext=H_(o.workerPath)):(X.log(`injecting Web Worker for "${t}"`),this.workerContext=G_()),this.onwmsg=p=>this.onWorkerMessage(p);const{worker:m}=this.workerContext;m.addEventListener("message",this.onwmsg),m.onerror=p=>{const v=new Error(`${p.message}  (${p.filename}:${p.lineno})`);o.enableWorker=!1,X.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(R.ERROR,{type:Ae.OTHER_ERROR,details:ie.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:v})},m.postMessage({cmd:"init",typeSupported:h,vendor:"",id:t,config:JSON.stringify(o)})}catch(m){X.warn(`Error setting up "${t}" Web Worker, fallback to inline`,m),this.resetWorker(),this.error=null,this.transmuxer=new kv(this.observer,h,o,"",t)}return}this.transmuxer=new kv(this.observer,h,o,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,s,a,o,u,c,h,d,m){var p,v;d.transmuxing.start=self.performance.now();const{transmuxer:x}=this,S=u?u.start:o.start,E=o.decryptdata,T=this.frag,A=!(T&&o.cc===T.cc),w=!(T&&d.level===T.level),C=T?d.sn-T.sn:-1,k=this.part?d.part-this.part.index:-1,_=C===0&&d.id>1&&d.id===(T==null?void 0:T.stats.chunkCount),U=!w&&(C===1||C===0&&(k===1||_&&k<=0)),B=self.performance.now();(w||C||o.stats.parsing.start===0)&&(o.stats.parsing.start=B),u&&(k||!U)&&(u.stats.parsing.start=B);const M=!(T&&((p=o.initSegment)==null?void 0:p.url)===((v=T.initSegment)==null?void 0:v.url)),D=new SD(A,U,h,w,S,M);if(!U||A||M){X.log(`[transmuxer-interface, ${o.type}]: Starting new transmux session for sn: ${d.sn} p: ${d.part} level: ${d.level} id: ${d.id}
        discontinuity: ${A}
        trackSwitch: ${w}
        contiguous: ${U}
        accurateTimeOffset: ${h}
        timeOffset: ${S}
        initSegmentChange: ${M}`);const N=new xD(s,a,t,c,m);this.configureTransmuxer(N)}if(this.frag=o,this.part=u,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:E,chunkMeta:d,state:D},e instanceof ArrayBuffer?[e]:[]);else if(x){const N=x.push(e,E,d,D);Su(N)?(x.async=!0,N.then(P=>{this.handleTransmuxComplete(P)}).catch(P=>{this.transmuxerError(P,d,"transmuxer-interface push error")})):(x.async=!1,this.handleTransmuxComplete(N))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let s=t.flush(e);Su(s)||t.async?(Su(s)||(s=Promise.resolve(s)),s.then(o=>{this.handleFlushResult(o,e)}).catch(o=>{this.transmuxerError(o,e,"transmuxer-interface flush error")})):this.handleFlushResult(s,e)}}transmuxerError(e,t,s){this.hls&&(this.error=e,this.hls.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:s}))}handleFlushResult(e,t){e.forEach(s=>{this.handleTransmuxComplete(s)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){X.warn(`worker message received with no ${t?"event name":"data"}`);return}const s=this.hls;if(this.hls)switch(t.event){case"init":{var a;const o=(a=this.workerContext)==null?void 0:a.objectURL;o&&self.URL.revokeObjectURL(o);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":X[t.data.logType]&&X[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,s.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Nv=100;class TD extends l0{constructor(e,t,s){super(e,t,s,"[audio-stream-controller]",be.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.ERROR,this.onError,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.ERROR,this.onError,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:s,initPTS:a,timescale:o}){if(s==="main"){const u=t.cc;this.initPTS[t.cc]={baseTime:a,timescale:o},this.log(`InitPTS for cc: ${u} found from main: ${a}`),this.videoTrackCC=u,this.state===ce.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=ce.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(Nv),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=ce.IDLE):(this.loadedmetadata=!1,this.state=ce.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case ce.IDLE:this.doTickIdle();break;case ce.WAITING_TRACK:{var e;const{levels:s,trackId:a}=this,o=s==null||(e=s[a])==null?void 0:e.details;if(o){if(this.waitForCdnTuneIn(o))break;this.state=ce.WAITING_INIT_PTS}break}case ce.FRAG_LOADING_WAITING_RETRY:{var t;const s=performance.now(),a=this.retryDate;if(!a||s>=a||(t=this.media)!=null&&t.seeking){const{levels:o,trackId:u}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((o==null?void 0:o[u])||null),this.state=ce.IDLE}break}case ce.WAITING_INIT_PTS:{const s=this.waitingData;if(s){const{frag:a,part:o,cache:u,complete:c}=s;if(this.initPTS[a.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=ce.FRAG_LOADING;const h=u.flush(),d={frag:a,part:o,payload:h,networkDetails:null};this._handleFragmentLoadProgress(d),c&&super._handleFragmentLoadComplete(d)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${a.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const h=this.getLoadPosition(),d=Ze.bufferInfo(this.mediaBuffer,h,this.config.maxBufferHole);Nd(d.end,this.config.maxFragLookUpTolerance,a)<0&&(this.log(`Waiting fragment cc (${a.cc}) @ ${a.start} cancelled because another fragment at ${d.end} is needed`),this.clearWaitingFragment())}}else this.state=ce.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=ce.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:s,trackId:a}=this,o=e.config;if(!this.buffering||!s&&(this.startFragRequested||!o.startFragPrefetch)||!(t!=null&&t[a]))return;const u=t[a],c=u.details;if(!c||c.live&&this.levelLastLoaded!==u||this.waitForCdnTuneIn(c)){this.state=ce.WAITING_TRACK;return}const h=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&h&&(this.bufferFlushed=!1,this.afterBufferFlushed(h,ze.AUDIO,be.AUDIO));const d=this.getFwdBufferInfo(h,be.AUDIO);if(d===null)return;if(!this.switchingTrack&&this._streamEnded(d,c)){e.trigger(R.BUFFER_EOS,{type:"audio"}),this.state=ce.ENDED;return}const m=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,be.MAIN),p=d.len,v=this.getMaxBufferLength(m==null?void 0:m.len),x=c.fragments,S=x[0].start,E=this.getLoadPosition(),T=this.flushing?E:d.end;if(this.switchingTrack&&s){const k=E;c.PTSKnown&&k<S&&(d.end>S||d.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=S+.05)}if(p>=v&&!this.switchingTrack&&T<x[x.length-1].start)return;let A=this.getNextFragment(T,c),w=!1;if(A&&this.isLoopLoading(A,T)&&(w=!!A.gap,A=this.getNextFragmentLoopLoading(A,c,d,be.MAIN,v)),!A){this.bufferFlushed=!0;return}const C=m&&A.start>m.end+c.targetduration;if(C||!(m!=null&&m.len)&&d.len){const k=this.getAppendedFrag(A.start,be.MAIN);if(k===null||(w||(w=!!k.gap||!!C&&m.len===0),C&&!w||w&&d.nextStart&&d.nextStart<k.end))return}this.loadFragment(A,u,T)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(s=>new ga(s))}onAudioTrackSwitching(e,t){const s=!!t.url;this.trackId=t.id;const{fragCurrent:a}=this;a&&(a.abortRequests(),this.removeUnbufferedFrags(a.start)),this.resetLoadingState(),s?this.setInterval(Nv):this.resetTransmuxer(),s?(this.switchingTrack=t,this.state=ce.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=ce.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(R.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var s;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:a}=this,{details:o,id:u}=t;if(!a){this.warn(`Audio tracks were reset while loading level ${u}`);return}this.log(`Audio track ${u} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`);const c=a[u];let h=0;if(o.live||(s=c.details)!=null&&s.live){this.checkLiveUpdate(o);const m=this.mainDetails;if(o.deltaUpdateFailed||!m)return;if(!c.details&&o.hasProgramDateTime&&m.hasProgramDateTime)$u(o,m),h=o.fragments[0].start;else{var d;h=this.alignPlaylists(o,c.details,(d=this.levelLastLoaded)==null?void 0:d.details)}}c.details=o,this.levelLastLoaded=c,!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,h),this.state===ce.WAITING_TRACK&&!this.waitForCdnTuneIn(o)&&(this.state=ce.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:s,part:a,payload:o}=e,{config:u,trackId:c,levels:h}=this;if(!h){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${s.sn} of level ${s.level} will not be buffered`);return}const d=h[c];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const m=d.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(s.start);return}const p=u.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let v=this.transmuxer;v||(v=this.transmuxer=new BS(this.hls,be.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const x=this.initPTS[s.cc],S=(t=s.initSegment)==null?void 0:t.data;if(x!==void 0){const T=a?a.index:-1,A=T!==-1,w=new a0(s.level,s.sn,s.stats.chunkCount,o.byteLength,T,A);v.push(o,S,p,"",s,a,m.totalduration,!1,w,x)}else{this.log(`Unknown video PTS for cc ${s.cc}, waiting for video PTS before demuxing audio frag ${s.sn} of [${m.startSN} ,${m.endSN}],track ${c}`);const{cache:E}=this.waitingData=this.waitingData||{frag:s,part:a,cache:new bS,complete:!1};E.push(new Uint8Array(o)),this.waitingVideoCC=this.videoTrackCC,this.state=ce.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const s=t.tracks.audio;s&&(this.mediaBuffer=s.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:s,part:a}=t;if(s.type!==be.AUDIO){if(!this.loadedmetadata&&s.type===be.MAIN){const o=this.videoBuffer||this.media;o&&Ze.getBuffered(o).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(s)){this.warn(`Fragment ${s.sn}${a?" p: "+a.index:""} of level ${s.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(s.sn!=="initSegment"){this.fragPrevious=s;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(R.AUDIO_TRACK_SWITCHED,Lt({},o)))}this.fragBufferedComplete(s,a)}onError(e,t){var s;if(t.fatal){this.state=ce.ERROR;return}switch(t.details){case ie.FRAG_GAP:case ie.FRAG_PARSING_ERROR:case ie.FRAG_DECRYPT_ERROR:case ie.FRAG_LOAD_ERROR:case ie.FRAG_LOAD_TIMEOUT:case ie.KEY_LOAD_ERROR:case ie.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(be.AUDIO,t);break;case ie.AUDIO_TRACK_LOAD_ERROR:case ie.AUDIO_TRACK_LOAD_TIMEOUT:case ie.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ce.WAITING_TRACK&&((s=t.context)==null?void 0:s.type)===Be.AUDIO_TRACK&&(this.state=ce.IDLE);break;case ie.BUFFER_APPEND_ERROR:case ie.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===ie.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ie.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==ze.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==ze.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ce.ENDED&&(this.state=ce.IDLE);const s=this.mediaBuffer||this.media;s&&(this.afterBufferFlushed(s,t,be.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const s="audio",{hls:a}=this,{remuxResult:o,chunkMeta:u}=e,c=this.getCurrentContext(u);if(!c){this.resetWhenMissingContext(u);return}const{frag:h,part:d,level:m}=c,{details:p}=m,{audio:v,text:x,id3:S,initSegment:E}=o;if(this.fragContextChanged(h)||!p){this.fragmentTracker.removeFragment(h);return}if(this.state=ce.PARSING,this.switchingTrack&&v&&this.completeAudioSwitch(this.switchingTrack),E!=null&&E.tracks){const T=h.initSegment||h;this._bufferInitSegment(m,E.tracks,T,u),a.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:s,tracks:E.tracks})}if(v){const{startPTS:T,endPTS:A,startDTS:w,endDTS:C}=v;d&&(d.elementaryStreams[ze.AUDIO]={startPTS:T,endPTS:A,startDTS:w,endDTS:C}),h.setElementaryStreamInfo(ze.AUDIO,T,A,w,C),this.bufferFragmentData(v,h,d,u)}if(S!=null&&(t=S.samples)!=null&&t.length){const T=mt({id:s,frag:h,details:p},S);a.trigger(R.FRAG_PARSING_METADATA,T)}if(x){const T=mt({id:s,frag:h,details:p},x);a.trigger(R.FRAG_PARSING_USERDATA,T)}}_bufferInitSegment(e,t,s,a){if(this.state!==ce.PARSING)return;t.video&&delete t.video;const o=t.audio;if(!o)return;o.id="audio";const u=e.audioCodec;this.log(`Init audio buffer, container:${o.container}, codecs[level/parsed]=[${u}/${o.codec}]`),u&&u.split(",").length===1&&(o.levelCodec=u),this.hls.trigger(R.BUFFER_CODECS,t);const c=o.initSegment;if(c!=null&&c.byteLength){const h={type:"audio",frag:s,part:null,chunkMeta:a,parent:s.type,data:c};this.hls.trigger(R.BUFFER_APPENDING,h)}this.tickImmediate()}loadFragment(e,t,s){const a=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||a===Rt.NOT_LOADED||a===Rt.PARTIAL){var o;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((o=t.details)!=null&&o.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ce.WAITING_INIT_PTS;const u=this.mainDetails;u&&u.fragments[0].start!==t.details.fragments[0].start&&$u(t.details,u)}else this.startFragRequested=!0,super.loadFragment(e,t,s)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:s,assocLang:a,characteristics:o,audioCodec:u,channels:c}=this.bufferedTrack;tr({name:t,lang:s,assocLang:a,characteristics:o,audioCodec:u,channels:c},e,Gn)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(R.AUDIO_TRACK_SWITCHED,Lt({},e))}}function jS(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!wo(r[t].attrs,e[t].attrs))return!1;return!0}function wo(r,e,t){const s=r["STABLE-RENDITION-ID"];return s&&!t?s===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(a=>r[a]!==e[a])}function Fd(r,e){return e.label.toLowerCase()===r.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(r.lang||"").toLowerCase())}class bD extends r0{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:s,groupId:a,details:o}=t,u=this.tracksInGroup[s];if(!u||u.groupId!==a){this.warn(`Audio track with id:${s} and group:${a} not found in active group ${u==null?void 0:u.groupId}`);return}const c=u.details;u.details=t.details,this.log(`Audio track ${s} "${u.name}" lang:${u.lang} group:${a} loaded [${o.startSN}-${o.endSN}]`),s===this.trackId&&this.playlistLoaded(s,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const s=t.audioGroups||null,a=this.groupIds;let o=this.currentTrack;if(!s||(a==null?void 0:a.length)!==(s==null?void 0:s.length)||s!=null&&s.some(c=>(a==null?void 0:a.indexOf(c))===-1)){this.groupIds=s,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(v=>!s||s.indexOf(v.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(v=>v.default)&&(this.selectDefaultTrack=!1),c.forEach((v,x)=>{v.id=x});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const h=this.hls.config.audioPreference;if(!o&&h){const v=Wi(h,c,Gn);if(v>-1)o=c[v];else{const x=Wi(h,this.tracks);o=this.tracks[x]}}let d=this.findTrackId(o);d===-1&&o&&(d=this.findTrackId(null));const m={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${s==null?void 0:s.join(",")}`),this.hls.trigger(R.AUDIO_TRACKS_UPDATED,m);const p=this.trackId;if(d!==-1&&p===-1)this.setAudioTrack(d);else if(c.length&&p===-1){var u;const v=new Error(`No audio track selected for current audio group-ID(s): ${(u=this.groupIds)==null?void 0:u.join(",")} track count: ${c.length}`);this.warn(v.message),this.hls.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:v})}}else this.shouldReloadPlaylist(o)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Be.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const s=this.allAudioTracks;if(this.selectDefaultTrack=!1,s.length){const a=this.currentTrack;if(a&&tr(e,a,Gn))return a;const o=Wi(e,this.tracksInGroup,Gn);if(o>-1){const u=this.tracksInGroup[o];return this.setAudioTrack(o),u}else if(a){let u=t.loadLevel;u===-1&&(u=t.firstAutoLevel);const c=b_(e,t.levels,s,u,Gn);if(c===-1)return null;t.nextLoadLevel=c}if(e.channels||e.audioCodec){const u=Wi(e,s);if(u>-1)return s[u]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const s=this.currentTrack,a=t[e],o=a.details&&!a.details.live;if(e===this.trackId&&a===s&&o||(this.log(`Switching to audio-track ${e} "${a.name}" lang:${a.lang} group:${a.groupId} channels:${a.channels}`),this.trackId=e,this.currentTrack=a,this.hls.trigger(R.AUDIO_TRACK_SWITCHING,Lt({},a)),o))return;const u=this.switchParams(a.url,s==null?void 0:s.details,a.details);this.loadPlaylist(u)}findTrackId(e){const t=this.tracksInGroup;for(let s=0;s<t.length;s++){const a=t[s];if(!(this.selectDefaultTrack&&!a.default)&&(!e||tr(e,a,Gn)))return s}if(e){const{name:s,lang:a,assocLang:o,characteristics:u,audioCodec:c,channels:h}=e;for(let d=0;d<t.length;d++){const m=t[d];if(tr({name:s,lang:a,assocLang:o,characteristics:u,audioCodec:c,channels:h},m,Gn))return d}for(let d=0;d<t.length;d++){const m=t[d];if(wo(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const m=t[d];if(wo(e.attrs,m.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const s=t.id,a=t.groupId;let o=t.url;if(e)try{o=e.addDirectives(o)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}this.log(`loading audio-track playlist ${s} "${t.name}" lang:${t.lang} group:${a}`),this.clearTimer(),this.hls.trigger(R.AUDIO_TRACK_LOADING,{url:o,id:s,groupId:a,deliveryDirectives:e||null})}}}const Pv=500;class AD extends l0{constructor(e,t,s){super(e,t,s,"[subtitle-stream-controller]",be.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.ERROR,this.onError,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.ERROR,this.onError,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=ce.IDLE,this.setInterval(Pv),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:s,success:a}=t;if(this.fragPrevious=s,this.state=ce.IDLE,!a)return;const o=this.tracksBuffered[this.currentTrackId];if(!o)return;let u;const c=s.start;for(let d=0;d<o.length;d++)if(c>=o[d].start&&c<=o[d].end){u=o[d];break}const h=s.start+s.duration;u?u.end=h:(u={start:c,end:h},o.push(u)),this.fragmentTracker.fragBuffered(s),this.fragBufferedComplete(s,null)}onBufferFlushing(e,t){const{startOffset:s,endOffset:a}=t;if(s===0&&a!==Number.POSITIVE_INFINITY){const o=a-1;if(o<=0)return;t.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach(u=>{for(let c=0;c<u.length;){if(u[c].end<=o){u.shift();continue}else if(u[c].start<o)u[c].start=o;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(s,o,be.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===be.MAIN){var s;(s=this.media)!=null&&s.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const s=t.frag;(s==null?void 0:s.type)===be.SUBTITLE&&(t.details===ie.FRAG_GAP&&this.fragmentTracker.fragBuffered(s,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ce.STOPPED&&(this.state=ce.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&jS(this.levels,t)){this.levels=t.map(s=>new ga(s));return}this.tracksBuffered=[],this.levels=t.map(s=>{const a=new ga(s);return this.tracksBuffered[a.id]=[],a}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,be.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var s;if(this.currentTrackId=t.id,!((s=this.levels)!=null&&s.length)||this.currentTrackId===-1){this.clearInterval();return}const a=this.levels[this.currentTrackId];a!=null&&a.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,a&&this.setInterval(Pv)}onSubtitleTrackLoaded(e,t){var s;const{currentTrackId:a,levels:o}=this,{details:u,id:c}=t;if(!o){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const h=o[c];if(c>=o.length||!h)return;this.log(`Subtitle track ${c} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""},duration:${u.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(u.live||(s=h.details)!=null&&s.live){const p=this.mainDetails;if(u.deltaUpdateFailed||!p)return;const v=p.fragments[0];if(!h.details)u.hasProgramDateTime&&p.hasProgramDateTime?($u(u,p),d=u.fragments[0].start):v&&(d=v.start,kd(u,d));else{var m;d=this.alignPlaylists(u,h.details,(m=this.levelLastLoaded)==null?void 0:m.details),d===0&&v&&(d=v.start,kd(u,d))}}h.details=u,this.levelLastLoaded=h,c===a&&(!this.startFragRequested&&(this.mainDetails||!u.live)&&this.setStartPosition(this.mainDetails||u,d),this.tick(),u.live&&!this.fragCurrent&&this.media&&this.state===ce.IDLE&&(Hu(null,u.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),h.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:s}=e,a=t.decryptdata,o=this.hls;if(!this.fragContextChanged(t)&&s&&s.byteLength>0&&a!=null&&a.key&&a.iv&&a.method==="AES-128"){const u=performance.now();this.decrypter.decrypt(new Uint8Array(s),a.key.buffer,a.iv.buffer).catch(c=>{throw o.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const h=performance.now();o.trigger(R.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:u,tdecrypt:h}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=ce.IDLE})}}doTick(){if(!this.media){this.state=ce.IDLE;return}if(this.state===ce.IDLE){const{currentTrackId:e,levels:t}=this,s=t==null?void 0:t[e];if(!s||!t.length||!s.details)return;const{config:a}=this,o=this.getLoadPosition(),u=Ze.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o,a.maxBufferHole),{end:c,len:h}=u,d=this.getFwdBufferInfo(this.media,be.MAIN),m=s.details,p=this.getMaxBufferLength(d==null?void 0:d.len)+m.levelTargetDuration;if(h>p)return;const v=m.fragments,x=v.length,S=m.edge;let E=null;const T=this.fragPrevious;if(c<S){const A=a.maxFragLookUpTolerance,w=c>S-A?0:A;E=Hu(T,v,Math.max(v[0].start,c),w),!E&&T&&T.start<v[0].start&&(E=v[0])}else E=v[x-1];if(!E)return;if(E=this.mapToInitFragWhenRequired(E),E.sn!=="initSegment"){const A=E.sn-m.startSN,w=v[A-1];w&&w.cc===E.cc&&this.fragmentTracker.getState(w)===Rt.NOT_LOADED&&(E=w)}this.fragmentTracker.getState(E)===Rt.NOT_LOADED&&this.loadFragment(E,s,c)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,s){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,s))}get mediaBufferTimeRanges(){return new RD(this.tracksBuffered[this.currentTrackId]||[])}}class RD{constructor(e){this.buffered=void 0;const t=(s,a,o)=>{if(a=a>>>0,a>o-1)throw new DOMException(`Failed to execute '${s}' on 'TimeRanges': The index provided (${a}) is greater than the maximum bound (${o})`);return e[a][s]};this.buffered={get length(){return e.length},end(s){return t("end",s,e.length)},start(s){return t("start",s,e.length)}}}}class LD extends r0{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const s=gu(this.media.textTracks);for(let o=0;o<s.length;o++)if(s[o].mode==="hidden")t=s[o];else if(s[o].mode==="showing"){t=s[o];break}const a=this.findTrackForTextTrack(t);this.subtitleTrack!==a&&this.setSubtitleTrack(a)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),gu(this.media.textTracks).forEach(t=>{Yr(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:s,groupId:a,details:o}=t,u=this.tracksInGroup[s];if(!u||u.groupId!==a){this.warn(`Subtitle track with id:${s} and group:${a} not found in active group ${u==null?void 0:u.groupId}`);return}const c=u.details;u.details=t.details,this.log(`Subtitle track ${s} "${u.name}" lang:${u.lang} group:${a} loaded [${o.startSN}-${o.endSN}]`),s===this.trackId&&this.playlistLoaded(s,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const s=t.subtitleGroups||null,a=this.groupIds;let o=this.currentTrack;if(!s||(a==null?void 0:a.length)!==(s==null?void 0:s.length)||s!=null&&s.some(u=>(a==null?void 0:a.indexOf(u))===-1)){this.groupIds=s,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(m=>!s||s.indexOf(m.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(m=>m.default)&&(this.selectDefaultTrack=!1),u.forEach((m,p)=>{m.id=p});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const c=this.hls.config.subtitlePreference;if(!o&&c){this.selectDefaultTrack=!1;const m=Wi(c,u);if(m>-1)o=u[m];else{const p=Wi(c,this.tracks);o=this.tracks[p]}}let h=this.findTrackId(o);h===-1&&o&&(h=this.findTrackId(null));const d={subtitleTracks:u};this.log(`Updating subtitle tracks, ${u.length} track(s) found in "${s==null?void 0:s.join(",")}" group-id`),this.hls.trigger(R.SUBTITLE_TRACKS_UPDATED,d),h!==-1&&this.trackId===-1&&this.setSubtitleTrack(h)}else this.shouldReloadPlaylist(o)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,s=this.selectDefaultTrack;for(let a=0;a<t.length;a++){const o=t[a];if(!(s&&!o.default||!s&&!e)&&(!e||tr(o,e)))return a}if(e){for(let a=0;a<t.length;a++){const o=t[a];if(wo(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return a}for(let a=0;a<t.length;a++){const o=t[a];if(wo(e.attrs,o.attrs,["LANGUAGE"]))return a}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let s=0;s<t.length;s++){const a=t[s];if(Fd(a,e))return s}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Be.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const s=this.currentTrack;if(s&&tr(e,s))return s;const a=Wi(e,this.tracksInGroup);if(a>-1){const o=this.tracksInGroup[a];return this.setSubtitleTrack(a),o}else{if(s)return null;{const o=Wi(e,t);if(o>-1)return t[o]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const s=t.id,a=t.groupId;let o=t.url;if(e)try{o=e.addDirectives(o)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}this.log(`Loading subtitle playlist for id ${s}`),this.hls.trigger(R.SUBTITLE_TRACK_LOADING,{url:o,id:s,groupId:a,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=gu(e.textTracks),s=this.currentTrack;let a;if(s&&(a=t.filter(o=>Fd(s,o))[0],a||this.warn(`Unable to find subtitle TextTrack with name "${s.name}" and language "${s.lang}"`)),[].slice.call(t).forEach(o=>{o.mode!=="disabled"&&o!==a&&(o.mode="disabled")}),a){const o=this.subtitleDisplay?"showing":"hidden";a.mode!==o&&(a.mode=o)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!ye(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const s=this.currentTrack,a=t[e]||null;if(this.trackId=e,this.currentTrack=a,this.toggleTrackModes(),!a){this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:e});return}const o=!!a.details&&!a.details.live;if(e===this.trackId&&a===s&&o)return;this.log(`Switching to subtitle-track ${e}`+(a?` "${a.name}" lang:${a.lang} group:${a.groupId}`:""));const{id:u,groupId:c="",name:h,type:d,url:m}=a;this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:u,groupId:c,name:h,type:d,url:m});const p=this.switchParams(a.url,s==null?void 0:s.details,a.details);this.loadPlaylist(p)}}class _D{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,s){const a=this.queues[t];a.push(e),a.length===1&&!s&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const s=new Promise(o=>{t=o}),a={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(a,e),s}executeNext(e){const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(a){X.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${a}`),s.onError(a);const o=this.buffers[e];o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Fv=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class DD{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=s=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=s=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:s,mediaSource:a}=this;this.log("Media source opened"),s&&(s.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(R.MEDIA_ATTACHED,{media:s,mediaSource:a})),a&&a.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:s,_objectUrl:a}=this;s!==a&&X.error(`Media element src was set while attaching MediaSource (${a} > ${s})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=FL(nr(e.config.preferManagedMediaSource)),this.log=X.log.bind(X,t),this.warn=X.warn.bind(X,t),this.error=X.error.bind(X,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_APPENDING,this.onBufferAppending,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.BUFFER_EOS,this.onBufferEos,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(R.FRAG_PARSED,this.onFragParsed,this),e.on(R.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_APPENDING,this.onBufferAppending,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.BUFFER_EOS,this.onBufferEos,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(R.FRAG_PARSED,this.onFragParsed,this),e.off(R.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new _D(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=s,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const s=this.media=t.media,a=nr(this.appendSource);if(s&&a){var o;const u=this.mediaSource=new a;this.log(`created media source: ${(o=u.constructor)==null?void 0:o.name}`),u.addEventListener("sourceopen",this._onMediaSourceOpen),u.addEventListener("sourceended",this._onMediaSourceEnded),u.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(u.addEventListener("startstreaming",this._onStartStreaming),u.addEventListener("endstreaming",this._onEndStreaming));const c=this._objectUrl=self.URL.createObjectURL(u);if(this.appendSource)try{s.removeAttribute("src");const h=self.ManagedMediaSource;s.disableRemotePlayback=s.disableRemotePlayback||h&&u instanceof h,Uv(s),CD(s,c),s.load()}catch{s.src=c}else s.src=c;s.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:s}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(a){this.warn(`onMediaDetaching: ${a.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(e.removeAttribute("src"),this.appendSource&&Uv(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(R.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var s;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(a){this.warn(`onBufferReset ${e}`,a)}}onBufferCodecs(e,t){const s=this.getSourceBufferTypes().length,a=Object.keys(t);if(a.forEach(u=>{if(s){const h=this.tracks[u];if(h&&typeof h.buffer.changeType=="function"){var c;const{id:d,codec:m,levelCodec:p,container:v,metadata:x}=t[u],S=rv(h.codec,h.levelCodec),E=S==null?void 0:S.replace(Fv,"$1");let T=rv(m,p);const A=(c=T)==null?void 0:c.replace(Fv,"$1");if(T&&E!==A){u.slice(0,5)==="audio"&&(T=Uu(T,this.appendSource));const w=`${v};codecs=${T}`;this.appendChangeType(u,w),this.log(`switching codec ${S} to ${T}`),this.tracks[u]={buffer:h.buffer,codec:m,container:v,levelCodec:p,metadata:x,id:d}}}}else this.pendingTracks[u]=t[u]}),s)return;const o=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==o&&(this.log(`${o} bufferCodec event(s) expected ${a.join(",")}`),this.bufferCodecEventsExpected=o),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:s}=this,a={execute:()=>{const o=this.sourceBuffer[e];o&&(this.log(`changing ${e} sourceBuffer type to ${t}`),o.changeType(t)),s.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};s.append(a,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:s,operationQueue:a,tracks:o}=this,{data:u,type:c,frag:h,part:d,chunkMeta:m}=t,p=m.buffering[c],v=self.performance.now();p.start=v;const x=h.stats.buffering,S=d?d.stats.buffering:null;x.start===0&&(x.start=v),S&&S.start===0&&(S.start=v);const E=o.audio;let T=!1;c==="audio"&&(E==null?void 0:E.container)==="audio/mpeg"&&(T=!this.lastMpegAudioChunk||m.id===1||this.lastMpegAudioChunk.sn!==m.sn,this.lastMpegAudioChunk=m);const A=h.start,w={execute:()=>{if(p.executeStart=self.performance.now(),T){const C=this.sourceBuffer[c];if(C){const k=A-C.timestampOffset;Math.abs(k)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${A} (delta: ${k}) sn: ${h.sn})`),C.timestampOffset=A)}}this.appendExecutor(u,c)},onStart:()=>{},onComplete:()=>{const C=self.performance.now();p.executeEnd=p.end=C,x.first===0&&(x.first=C),S&&S.first===0&&(S.first=C);const{sourceBuffer:k}=this,_={};for(const U in k)_[U]=Ze.getBuffered(k[U]);this.appendErrors[c]=0,c==="audio"||c==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(R.BUFFER_APPENDED,{type:c,frag:h,part:d,chunkMeta:m,parent:h.type,timeRanges:_})},onError:C=>{const k={type:Ae.MEDIA_ERROR,parent:h.type,details:ie.BUFFER_APPEND_ERROR,sourceBufferName:c,frag:h,part:d,chunkMeta:m,error:C,err:C,fatal:!1};if(C.code===DOMException.QUOTA_EXCEEDED_ERR)k.details=ie.BUFFER_FULL_ERROR;else{const _=++this.appendErrors[c];k.details=ie.BUFFER_APPEND_ERROR,this.warn(`Failed ${_}/${s.config.appendErrorMaxRetry} times to append segment in "${c}" sourceBuffer`),_>=s.config.appendErrorMaxRetry&&(k.fatal=!0)}s.trigger(R.ERROR,k)}};a.append(w,c,!!this.pendingTracks[c])}onBufferFlushing(e,t){const{operationQueue:s}=this,a=o=>({execute:this.removeExecutor.bind(this,o,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(R.BUFFER_FLUSHED,{type:o})},onError:u=>{this.warn(`Failed to remove from ${o} SourceBuffer`,u)}});t.type?s.append(a(t.type),t.type):this.getSourceBufferTypes().forEach(o=>{s.append(a(o),o)})}onFragParsed(e,t){const{frag:s,part:a}=t,o=[],u=a?a.elementaryStreams:s.elementaryStreams;u[ze.AUDIOVIDEO]?o.push("audiovideo"):(u[ze.AUDIO]&&o.push("audio"),u[ze.VIDEO]&&o.push("video"));const c=()=>{const h=self.performance.now();s.stats.buffering.end=h,a&&(a.stats.buffering.end=h);const d=a?a.stats:s.stats;this.hls.trigger(R.FRAG_BUFFERED,{frag:s,part:a,stats:d,id:s.type})};o.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${s.type} level: ${s.level} sn: ${s.sn}`),this.blockBuffers(c,o)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((a,o)=>{const u=this.sourceBuffer[o];return u&&(!t.type||t.type===o)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${o} sourceBuffer now EOS`))),a&&!!(!u||u.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(o=>{const u=this.sourceBuffer[o];u&&(u.ending=!1)});const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:s}=this;if(!s||t===null||!this.getSourceBufferTypes().length)return;const o=e.config,u=s.currentTime,c=t.levelTargetDuration,h=t.live&&o.liveBackBufferLength!==null?o.liveBackBufferLength:o.backBufferLength;if(ye(h)&&h>0){const d=Math.max(h,c),m=Math.floor(u/c)*c-d;this.flushBackBuffer(u,c,m)}if(ye(o.frontBufferFlushThreshold)&&o.frontBufferFlushThreshold>0){const d=Math.max(o.maxBufferLength,o.frontBufferFlushThreshold),m=Math.max(d,c),p=Math.floor(u/c)*c+m;this.flushFrontBuffer(u,c,p)}}flushBackBuffer(e,t,s){const{details:a,sourceBuffer:o}=this;this.getSourceBufferTypes().forEach(c=>{const h=o[c];if(h){const d=Ze.getBuffered(h);if(d.length>0&&s>d.start(0)){if(this.hls.trigger(R.BACK_BUFFER_REACHED,{bufferEnd:s}),a!=null&&a.live)this.hls.trigger(R.LIVE_BACK_BUFFER_REACHED,{bufferEnd:s});else if(h.ended&&d.end(d.length-1)-e<t*2){this.log(`Cannot flush ${c} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:s,type:c})}}})}flushFrontBuffer(e,t,s){const{sourceBuffer:a}=this;this.getSourceBufferTypes().forEach(u=>{const c=a[u];if(c){const h=Ze.getBuffered(c),d=h.length;if(d<2)return;const m=h.start(d-1),p=h.end(d-1);if(s>m||e>=m&&e<=p)return;if(c.ended&&e-p<2*t){this.log(`Cannot flush ${u} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:m,endOffset:1/0,type:u})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:s,mediaSource:a}=this,o=e.fragments[0].start+e.totalduration,u=s.duration,c=ye(a.duration)?a.duration:0;e.live&&t.config.liveDurationInfinity?(a.duration=1/0,this.updateSeekableRange(e)):(o>c&&o>u||!ye(u))&&(this.log(`Updating Media Source duration to ${o.toFixed(3)}`),a.duration=o)}updateSeekableRange(e){const t=this.mediaSource,s=e.fragments;if(s.length&&e.live&&t!=null&&t.setLiveSeekableRange){const o=Math.max(0,s[0].start),u=Math.max(o,o+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${o}-${u}.`),t.setLiveSeekableRange(o,u)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:s}=this,a=Object.keys(s).length;if(a&&(!e||a===2||"audiovideo"in s)){this.createSourceBuffers(s),this.pendingTracks={};const o=this.getSourceBufferTypes();if(o.length)this.hls.trigger(R.BUFFER_CREATED,{tracks:this.tracks}),o.forEach(u=>{t.executeNext(u)});else{const u=new Error("could not create source buffer for media codec(s)");this.hls.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:u,reason:u.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:s}=this;if(!s)throw Error("createSourceBuffers called when mediaSource was null");for(const o in e)if(!t[o]){var a;const u=e[o];if(!u)throw Error(`source buffer exists for track ${o}, however track does not`);let c=((a=u.levelCodec)==null?void 0:a.indexOf(","))===-1?u.levelCodec:u.codec;c&&o.slice(0,5)==="audio"&&(c=Uu(c,this.appendSource));const h=`${u.container};codecs=${c}`;this.log(`creating sourceBuffer(${h})`);try{const d=t[o]=s.addSourceBuffer(h),m=o;this.addBufferListener(m,"updatestart",this._onSBUpdateStart),this.addBufferListener(m,"updateend",this._onSBUpdateEnd),this.addBufferListener(m,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(m,"bufferedchange",(p,v)=>{const x=v.removedRanges;x!=null&&x.length&&this.hls.trigger(R.BUFFER_FLUSHED,{type:o})}),this.tracks[o]={buffer:d,codec:c,container:u.container,levelCodec:u.levelCodec,metadata:u.metadata,id:u.id}}catch(d){this.error(`error while trying to add sourceBuffer: ${d.message}`),this.hls.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,sourceBufferName:o,mimeType:h})}}}get mediaSrc(){var e,t;const s=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return s==null?void 0:s.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:s}=this;s.current(e).onComplete(),s.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var s;const a=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(s=this.mediaSource)==null?void 0:s.readyState}`);this.error(`${a}`,t),this.hls.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:a,fatal:!1});const o=this.operationQueue.current(e);o&&o.onError(a)}removeExecutor(e,t,s){const{media:a,mediaSource:o,operationQueue:u,sourceBuffer:c}=this,h=c[e];if(!a||!o||!h){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),u.shiftAndExecuteNext(e);return}const d=ye(a.duration)?a.duration:1/0,m=ye(o.duration)?o.duration:1/0,p=Math.max(0,t),v=Math.min(s,d,m);v>p&&(!h.ending||h.ended)?(h.ended=!1,this.log(`Removing [${p},${v}] from the ${e} SourceBuffer`),h.remove(p,v)):u.shiftAndExecuteNext(e)}appendExecutor(e,t){const s=this.sourceBuffer[t];if(!s){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}s.ended=!1,s.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:s}=this,a=t.map(o=>s.appendBlocker(o));Promise.all(a).then(()=>{e(),t.forEach(o=>{const u=this.sourceBuffer[o];u!=null&&u.updating||s.shiftAndExecuteNext(o)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,s){const a=this.sourceBuffer[e];if(!a)return;const o=s.bind(this,e);this.listeners[e].push({event:t,listener:o}),a.addEventListener(t,o)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(s=>{t.removeEventListener(s.event,s.listener)})}}function Uv(r){const e=r.querySelectorAll("source");[].slice.call(e).forEach(t=>{r.removeChild(t)})}function CD(r,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,r.appendChild(t)}const wD={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},GS=r=>String.fromCharCode(wD[r]||r),wi=15,Es=100,OD={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ID={17:2,18:4,21:6,22:8,23:10,19:13,20:15},MD={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},kD={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ND=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class PD{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const s=typeof t=="function"?t():t;X.log(`${this.time} [${e}] ${s}`)}}}const Un=function(e){const t=[];for(let s=0;s<e.length;s++)t.push(e[s].toString(16));return t};class HS{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let s=0;s<t.length;s++){const a=t[s];e.hasOwnProperty(a)&&(this[a]=e[a])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class FD{constructor(){this.uchar=" ",this.penState=new HS}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class UD{constructor(e){this.chars=[],this.pos=0,this.currPenState=new HS,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Es;t++)this.chars.push(new FD);this.logger=e}equals(e){for(let t=0;t<Es;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Es;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Es;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Es&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Es)}moveCursor(e){const t=this.pos+e;if(e>1)for(let s=this.pos+1;s<t+1;s++)this.chars[s].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=GS(e);if(this.pos>=Es){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Es;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let s=0;s<Es;s++){const a=this.chars[s].uchar;a!==" "&&(t=!1),e.push(a)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class ed{constructor(e){this.rows=[],this.currRow=wi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<wi;t++)this.rows.push(new UD(e));this.logger=e}reset(){for(let e=0;e<wi;e++)this.rows[e].clear();this.currRow=wi-1}equals(e){let t=!0;for(let s=0;s<wi;s++)if(!this.rows[s].equals(e.rows[s])){t=!1;break}return t}copy(e){for(let t=0;t<wi;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<wi;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<wi;c++)this.rows[c].clear();const o=this.currRow+1-this.nrRollUpRows,u=this.lastOutputScreen;if(u){const c=u.rows[o].cueStartTime,h=this.logger.time;if(c!==null&&h!==null&&c<h)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(u.rows[o+d])}}this.currRow=t;const s=this.rows[this.currRow];if(e.indent!==null){const o=e.indent,u=Math.max(o-1,0);s.setCursor(e.indent),e.color=s.chars[u].penState.foreground}const a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let s="",a=-1;for(let o=0;o<wi;o++){const u=this.rows[o].getTextString();u&&(a=o+1,e?t.push("Row "+a+": '"+u+"'"):t.push(u.trim()))}return t.length>0&&(e?s="["+t.join(" | ")+"]":s=t.join(`
`)),s}getTextAndFormat(){return this.rows}}class Bv{constructor(e,t,s){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ed(s),this.nonDisplayedMemory=new ed(s),this.lastOutputScreen=new ed(s),this.currRollUpRow=this.displayedMemory.rows[wi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=s}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[wi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let s=0;s<e.length;s++)this.writeScreen.insertChar(e[s]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const s=Math.floor(e/2)-16,a=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=a[s]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class jv{constructor(e,t,s){this.channels=void 0,this.currentChannel=0,this.cmdHistory=jD(),this.logger=void 0;const a=this.logger=new PD;this.channels=[null,new Bv(e,t,a),new Bv(e+1,s,a)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let s=0;s<t.length;s+=2){const a=t[s]&127,o=t[s+1]&127;let u=!1,c=null;if(a===0&&o===0)continue;this.logger.log(3,()=>"["+Un([t[s],t[s+1]])+"] -> ("+Un([a,o])+")");const h=this.cmdHistory;if(a>=16&&a<=31){if(BD(a,o,h)){au(null,null,h),this.logger.log(3,()=>"Repeated command ("+Un([a,o])+") is dropped");continue}au(a,o,this.cmdHistory),u=this.parseCmd(a,o),u||(u=this.parseMidrow(a,o)),u||(u=this.parsePAC(a,o)),u||(u=this.parseBackgroundAttributes(a,o))}else au(null,null,h);if(!u&&(c=this.parseChars(a,o),c)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!u&&!c&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Un([a,o])+" orig: "+Un([t[s],t[s+1]]))}}parseCmd(e,t){const s=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,a=(e===23||e===31)&&t>=33&&t<=35;if(!(s||a))return!1;const o=e===20||e===21||e===23?1:2,u=this.channels[o];return e===20||e===21||e===28||e===29?t===32?u.ccRCL():t===33?u.ccBS():t===34?u.ccAOF():t===35?u.ccAON():t===36?u.ccDER():t===37?u.ccRU(2):t===38?u.ccRU(3):t===39?u.ccRU(4):t===40?u.ccFON():t===41?u.ccRDC():t===42?u.ccTR():t===43?u.ccRTD():t===44?u.ccEDM():t===45?u.ccCR():t===46?u.ccENM():t===47&&u.ccEOC():u.ccTO(t-32),this.currentChannel=o,!0}parseMidrow(e,t){let s=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?s=1:s=2,s!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const a=this.channels[s];return a?(a.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Un([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let s;const a=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,o=(e===16||e===24)&&t>=64&&t<=95;if(!(a||o))return!1;const u=e<=23?1:2;t>=64&&t<=95?s=u===1?OD[e]:MD[e]:s=u===1?ID[e]:kD[e];const c=this.channels[u];return c?(c.setPAC(this.interpretPAC(s,t)),this.currentChannel=u,!0):!1}interpretPAC(e,t){let s;const a={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?s=t-96:s=t-64,a.underline=(s&1)===1,s<=13?a.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(s/2)]:s<=15?(a.italics=!0,a.color="white"):a.indent=Math.floor((s-16)/2)*4,a}parseChars(e,t){let s,a=null,o=null;if(e>=25?(s=2,o=e-8):(s=1,o=e),o>=17&&o<=19){let u;o===17?u=t+80:o===18?u=t+112:u=t+144,this.logger.log(2,()=>"Special char '"+GS(u)+"' in channel "+s),a=[u]}else e>=32&&e<=127&&(a=t===0?[e]:[e,t]);return a&&this.logger.log(3,()=>"Char codes =  "+Un(a).join(",")),a}parseBackgroundAttributes(e,t){const s=(e===16||e===24)&&t>=32&&t<=47,a=(e===23||e===31)&&t>=45&&t<=47;if(!(s||a))return!1;let o;const u={};e===16||e===24?(o=Math.floor((t-32)/2),u.background=ND[o],t%2===1&&(u.background=u.background+"_semi")):t===45?u.background="transparent":(u.foreground="black",t===47&&(u.underline=!0));const c=e<=23?1:2;return this.channels[c].setBkgData(u),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}au(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const s=this.channels[t];s&&s.cueSplitAtTime(e)}}}function au(r,e,t){t.a=r,t.b=e}function BD(r,e,t){return t.a===r&&t.b===e}function jD(){return{a:null,b:null}}class ou{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,s){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=s,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var m0=function(){if(ma!=null&&ma.VTTCue)return self.VTTCue;const r=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,h){if(typeof h!="string"||!Array.isArray(c))return!1;const d=h.toLowerCase();return~c.indexOf(d)?d:!1}function s(c){return t(r,c)}function a(c){return t(e,c)}function o(c,...h){let d=1;for(;d<arguments.length;d++){const m=arguments[d];for(const p in m)c[p]=m[p]}return c}function u(c,h,d){const m=this,p={enumerable:!0};m.hasBeenReset=!1;let v="",x=!1,S=c,E=h,T=d,A=null,w="",C=!0,k="auto",_="start",U=50,B="middle",M=50,D="middle";Object.defineProperty(m,"id",o({},p,{get:function(){return v},set:function(N){v=""+N}})),Object.defineProperty(m,"pauseOnExit",o({},p,{get:function(){return x},set:function(N){x=!!N}})),Object.defineProperty(m,"startTime",o({},p,{get:function(){return S},set:function(N){if(typeof N!="number")throw new TypeError("Start time must be set to a number.");S=N,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",o({},p,{get:function(){return E},set:function(N){if(typeof N!="number")throw new TypeError("End time must be set to a number.");E=N,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",o({},p,{get:function(){return T},set:function(N){T=""+N,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",o({},p,{get:function(){return A},set:function(N){A=N,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",o({},p,{get:function(){return w},set:function(N){const P=s(N);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");w=P,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",o({},p,{get:function(){return C},set:function(N){C=!!N,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",o({},p,{get:function(){return k},set:function(N){if(typeof N!="number"&&N!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");k=N,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",o({},p,{get:function(){return _},set:function(N){const P=a(N);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");_=P,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",o({},p,{get:function(){return U},set:function(N){if(N<0||N>100)throw new Error("Position must be between 0 and 100.");U=N,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",o({},p,{get:function(){return B},set:function(N){const P=a(N);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");B=P,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",o({},p,{get:function(){return M},set:function(N){if(N<0||N>100)throw new Error("Size must be between 0 and 100.");M=N,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",o({},p,{get:function(){return D},set:function(N){const P=a(N);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");D=P,this.hasBeenReset=!0}})),m.displayState=void 0}return u.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},u}();class GD{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function $S(r){function e(s,a,o,u){return(s|0)*3600+(a|0)*60+(o|0)+parseFloat(u||0)}const t=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class HD{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,s){return s?this.has(e)?this.values[e]:t[s]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,s){for(let a=0;a<s.length;++a)if(t===s[a]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const s=parseFloat(t);if(s>=0&&s<=100)return this.set(e,s),!0}return!1}}function VS(r,e,t,s){const a=s?r.split(s):[r];for(const o in a){if(typeof a[o]!="string")continue;const u=a[o].split(t);if(u.length!==2)continue;const c=u[0],h=u[1];e(c,h)}}const Ud=new m0(0,0,""),lu=Ud.align==="middle"?"middle":"center";function $D(r,e,t){const s=r;function a(){const c=$S(r);if(c===null)throw new Error("Malformed timestamp: "+s);return r=r.replace(/^[^\sa-zA-Z-]+/,""),c}function o(c,h){const d=new HD;VS(c,function(v,x){let S;switch(v){case"region":for(let E=t.length-1;E>=0;E--)if(t[E].id===x){d.set(v,t[E].region);break}break;case"vertical":d.alt(v,x,["rl","lr"]);break;case"line":S=x.split(","),d.integer(v,S[0]),d.percent(v,S[0])&&d.set("snapToLines",!1),d.alt(v,S[0],["auto"]),S.length===2&&d.alt("lineAlign",S[1],["start",lu,"end"]);break;case"position":S=x.split(","),d.percent(v,S[0]),S.length===2&&d.alt("positionAlign",S[1],["start",lu,"end","line-left","line-right","auto"]);break;case"size":d.percent(v,x);break;case"align":d.alt(v,x,["start",lu,"end","left","right"]);break}},/:/,/\s/),h.region=d.get("region",null),h.vertical=d.get("vertical","");let m=d.get("line","auto");m==="auto"&&Ud.line===-1&&(m=-1),h.line=m,h.lineAlign=d.get("lineAlign","start"),h.snapToLines=d.get("snapToLines",!0),h.size=d.get("size",100),h.align=d.get("align",lu);let p=d.get("position","auto");p==="auto"&&Ud.position===50&&(p=h.align==="start"||h.align==="left"?0:h.align==="end"||h.align==="right"?100:50),h.position=p}function u(){r=r.replace(/^\s+/,"")}if(u(),e.startTime=a(),u(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+s);r=r.slice(3),u(),e.endTime=a(),u(),o(r,e)}function KS(r){return r.replace(/<br(?: \/)?>/gi,`
`)}class VD{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new GD,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function s(){let o=t.buffer,u=0;for(o=KS(o);u<o.length&&o[u]!=="\r"&&o[u]!==`
`;)++u;const c=o.slice(0,u);return o[u]==="\r"&&++u,o[u]===`
`&&++u,t.buffer=o.slice(u),c}function a(o){VS(o,function(u,c){},/:/)}try{let o="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;o=s();const c=o.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let u=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(u?u=!1:o=s(),t.state){case"HEADER":/:/.test(o)?a(o):o||(t.state="ID");continue;case"NOTE":o||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){t.state="NOTE";break}if(!o)continue;if(t.cue=new m0(0,0,""),t.state="CUE",o.indexOf("-->")===-1){t.cue.id=o;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{$D(o,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=o.indexOf("-->")!==-1;if(!o||c&&(u=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=o}continue;case"BADCUE":o||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const KD=/\r\n|\n\r|\n|\r/g,td=function(e,t,s=0){return e.slice(s,s+t.length)===t},zD=function(e){let t=parseInt(e.slice(-3));const s=parseInt(e.slice(-6,-4)),a=parseInt(e.slice(-9,-7)),o=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!ye(t)||!ye(s)||!ye(a)||!ye(o))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*s,t+=60*1e3*a,t+=60*60*1e3*o,t},id=function(e){let t=5381,s=e.length;for(;s;)t=t*33^e.charCodeAt(--s);return(t>>>0).toString()};function g0(r,e,t){return id(r.toString())+id(e.toString())+id(t)}const YD=function(e,t,s){let a=e[t],o=e[a.prevCC];if(!o||!o.new&&a.new){e.ccOffset=e.presentationOffset=a.start,a.new=!1;return}for(;(u=o)!=null&&u.new;){var u;e.ccOffset+=a.start-o.start,a.new=!1,a=o,o=e[a.prevCC]}e.presentationOffset=s};function qD(r,e,t,s,a,o,u){const c=new VD,h=Zi(new Uint8Array(r)).trim().replace(KD,`
`).split(`
`),d=[],m=e?fD(e.baseTime,e.timescale):0;let p="00:00.000",v=0,x=0,S,E=!0;c.oncue=function(T){const A=t[s];let w=t.ccOffset;const C=(v-m)/9e4;if(A!=null&&A.new&&(x!==void 0?w=t.ccOffset=A.start:YD(t,s,C)),C){if(!e){S=new Error("Missing initPTS for VTT MPEGTS");return}w=C-t.presentationOffset}const k=T.endTime-T.startTime,_=Ti((T.startTime+w-x)*9e4,a*9e4)/9e4;T.startTime=Math.max(_,0),T.endTime=Math.max(_+k,0);const U=T.text.trim();T.text=decodeURIComponent(encodeURIComponent(U)),T.id||(T.id=g0(T.startTime,T.endTime,U)),T.endTime>0&&d.push(T)},c.onparsingerror=function(T){S=T},c.onflush=function(){if(S){u(S);return}o(d)},h.forEach(T=>{if(E)if(td(T,"X-TIMESTAMP-MAP=")){E=!1,T.slice(16).split(",").forEach(A=>{td(A,"LOCAL:")?p=A.slice(6):td(A,"MPEGTS:")&&(v=parseInt(A.slice(7)))});try{x=zD(p)/1e3}catch(A){S=A}return}else T===""&&(E=!1);c.parse(T+`
`)}),c.flush()}const sd="stpp.ttml.im1t",zS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,YS=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,XD={left:"start",center:"center",right:"end",start:"start",end:"end"};function Gv(r,e,t,s){const a=Ce(new Uint8Array(r),["mdat"]);if(a.length===0){s(new Error("Could not parse IMSC1 mdat"));return}const o=a.map(c=>Zi(c)),u=cD(e.baseTime,1,e.timescale);try{o.forEach(c=>t(QD(c,u)))}catch(c){s(c)}}function QD(r,e){const a=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!a)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},u=Object.keys(o).reduce((p,v)=>(p[v]=a.getAttribute(`ttp:${v}`)||o[v],p),{}),c=a.getAttribute("xml:space")!=="preserve",h=Hv(nd(a,"styling","style")),d=Hv(nd(a,"layout","region")),m=nd(a,"body","[begin]");return[].map.call(m,p=>{const v=qS(p,c);if(!v||!p.hasAttribute("begin"))return null;const x=ad(p.getAttribute("begin"),u),S=ad(p.getAttribute("dur"),u);let E=ad(p.getAttribute("end"),u);if(x===null)throw $v(p);if(E===null){if(S===null)throw $v(p);E=x+S}const T=new m0(x-e,E-e,v);T.id=g0(T.startTime,T.endTime,T.text);const A=d[p.getAttribute("region")],w=h[p.getAttribute("style")],C=WD(A,w,h),{textAlign:k}=C;if(k){const _=XD[k];_&&(T.lineAlign=_),T.align=k}return mt(T,C),T}).filter(p=>p!==null)}function nd(r,e,t){const s=r.getElementsByTagName(e)[0];return s?[].slice.call(s.querySelectorAll(t)):[]}function Hv(r){return r.reduce((e,t)=>{const s=t.getAttribute("xml:id");return s&&(e[s]=t),e},{})}function qS(r,e){return[].slice.call(r.childNodes).reduce((t,s,a)=>{var o;return s.nodeName==="br"&&a?t+`
`:(o=s.childNodes)!=null&&o.length?qS(s,e):e?t+s.textContent.trim().replace(/\s+/g," "):t+s.textContent},"")}function WD(r,e,t){const s="http://www.w3.org/ns/ttml#styling";let a=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],u=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return u&&t.hasOwnProperty(u)&&(a=t[u]),o.reduce((c,h)=>{const d=rd(e,s,h)||rd(r,s,h)||rd(a,s,h);return d&&(c[h]=d),c},{})}function rd(r,e,t){return r&&r.hasAttributeNS(e,t)?r.getAttributeNS(e,t):null}function $v(r){return new Error(`Could not parse ttml timestamp ${r}`)}function ad(r,e){if(!r)return null;let t=$S(r);return t===null&&(zS.test(r)?t=ZD(r,e):YS.test(r)&&(t=JD(r,e))),t}function ZD(r,e){const t=zS.exec(r),s=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+s/e.frameRate}function JD(r,e){const t=YS.exec(r),s=Number(t[1]);switch(t[2]){case"h":return s*3600;case"m":return s*60;case"ms":return s*1e3;case"f":return s/e.frameRate;case"t":return s/e.tickRate}return s}class eC{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Kv(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new ou(this,"textTrack1"),t=new ou(this,"textTrack2"),s=new ou(this,"textTrack3"),a=new ou(this,"textTrack4");this.cea608Parser1=new jv(1,e,t),this.cea608Parser2=new jv(3,s,a)}}addCues(e,t,s,a,o){let u=!1;for(let c=o.length;c--;){const h=o[c],d=tC(h[0],h[1],t,s);if(d>=0&&(h[0]=Math.min(h[0],t),h[1]=Math.max(h[1],s),u=!0,d/(s-t)>.5))return}if(u||o.push([t,s]),this.config.renderTextTracksNatively){const c=this.captionsTracks[e];this.Cues.newCue(c,t,s,a)}else{const c=this.Cues.newCue(null,t,s,a);this.hls.trigger(R.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:s,initPTS:a,timescale:o}){const{unparsedVttFrags:u}=this;s==="main"&&(this.initPTS[t.cc]={baseTime:a,timescale:o}),u.length&&(this.unparsedVttFrags=[],u.forEach(c=>{this.onFragLoaded(R.FRAG_LOADED,c)}))}getExistingTrack(e,t){const{media:s}=this;if(s)for(let a=0;a<s.textTracks.length;a++){const o=s.textTracks[a];if(Vv(o,{name:e,lang:t}))return o}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:s,media:a}=this,{label:o,languageCode:u}=t[e],c=this.getExistingTrack(o,u);if(c)s[e]=c,Yr(s[e]),mS(s[e],a);else{const h=this.createTextTrack("captions",o,u);h&&(h[e]=!0,s[e]=h)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const s=t.label,a={_id:e,label:s,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=a,this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[a]})}createTextTrack(e,t,s){const a=this.media;if(a)return a.addTextTrack(e,t,s)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Yr(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Kv(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let s=0;s<t.length;s++)Yr(t[s])}onSubtitleTracksUpdated(e,t){const s=t.subtitleTracks||[],a=s.some(o=>o.textCodec===sd);if(this.config.enableWebVTT||a&&this.config.enableIMSC1){if(jS(this.tracks,s)){this.tracks=s;return}if(this.textTracks=[],this.tracks=s,this.config.renderTextTracksNatively){const u=this.media,c=u?gu(u.textTracks):null;if(this.tracks.forEach((h,d)=>{let m;if(c){let p=null;for(let v=0;v<c.length;v++)if(c[v]&&Vv(c[v],h)){p=c[v],c[v]=null;break}p&&(m=p)}if(m)Yr(m);else{const p=XS(h);m=this.createTextTrack(p,h.name,h.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),c!=null&&c.length){const h=c.filter(d=>d!==null).map(d=>d.label);h.length&&X.warn(`Media element contains unused subtitle tracks: ${h.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const u=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:u})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(s=>{const a=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(!a)return;const o=`textTrack${a[1]}`,u=this.captionsProperties[o];u&&(u.label=s.name,s.lang&&(u.languageCode=s.lang),u.media=s)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===be.MAIN){var s,a;const{cea608Parser1:o,cea608Parser2:u,lastSn:c}=this,{cc:h,sn:d}=t.frag,m=(s=(a=t.part)==null?void 0:a.index)!=null?s:-1;o&&u&&(d!==c+1||d===c&&m!==this.lastPartIndex+1||h!==this.lastCc)&&(o.reset(),u.reset()),this.lastCc=h,this.lastSn=d,this.lastPartIndex=m}}onFragLoaded(e,t){const{frag:s,payload:a}=t;if(s.type===be.SUBTITLE)if(a.byteLength){const o=s.decryptdata,u="stats"in t;if(o==null||!o.encrypted||u){const c=this.tracks[s.level],h=this.vttCCs;h[s.cc]||(h[s.cc]={start:s.start,prevCC:this.prevCC,new:!0},this.prevCC=s.cc),c&&c.textCodec===sd?this._parseIMSC1(s,a):this._parseVTTs(t)}}else this.hls.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const s=this.hls;Gv(t,this.initPTS[e.cc],a=>{this._appendCues(a,e.level),s.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},a=>{X.log(`Failed to parse IMSC1: ${a}`),s.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:a})})}_parseVTTs(e){var t;const{frag:s,payload:a}=e,{initPTS:o,unparsedVttFrags:u}=this,c=o.length-1;if(!o[s.cc]&&c===-1){u.push(e);return}const h=this.hls,d=(t=s.initSegment)!=null&&t.data?bi(s.initSegment.data,new Uint8Array(a)):a;qD(d,this.initPTS[s.cc],this.vttCCs,s.cc,s.start,m=>{this._appendCues(m,s.level),h.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:s})},m=>{const p=m.message==="Missing initPTS for VTT MPEGTS";p?u.push(e):this._fallbackToIMSC1(s,a),X.log(`Failed to parse VTT cue: ${m}`),!(p&&c>s.cc)&&h.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:m})})}_fallbackToIMSC1(e,t){const s=this.tracks[e.level];s.textCodec||Gv(t,this.initPTS[e.cc],()=>{s.textCodec=sd,this._parseIMSC1(e,t)},()=>{s.textCodec="wvtt"})}_appendCues(e,t){const s=this.hls;if(this.config.renderTextTracksNatively){const a=this.textTracks[t];if(!a||a.mode==="disabled")return;e.forEach(o=>gS(a,o))}else{const a=this.tracks[t];if(!a)return;const o=a.default?"default":"subtitles"+t;s.trigger(R.CUES_PARSED,{type:"subtitles",cues:e,track:o})}}onFragDecrypted(e,t){const{frag:s}=t;s.type===be.SUBTITLE&&this.onFragLoaded(R.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:s,cea608Parser2:a}=this;if(!this.enabled||!s||!a)return;const{frag:o,samples:u}=t;if(!(o.type===be.MAIN&&this.closedCaptionsForLevel(o)==="NONE"))for(let c=0;c<u.length;c++){const h=u[c].bytes;if(h){const d=this.extractCea608Data(h);s.addData(u[c].pts,d[0]),a.addData(u[c].pts,d[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:s,endOffsetSubtitles:a,type:o}){const{media:u}=this;if(!(!u||u.currentTime<s)){if(!o||o==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(h=>Od(c[h],t,s))}if(this.config.renderTextTracksNatively&&t===0&&a!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(h=>Od(c[h],t,a))}}}extractCea608Data(e){const t=[[],[]],s=e[0]&31;let a=2;for(let o=0;o<s;o++){const u=e[a++],c=127&e[a++],h=127&e[a++];if(c===0&&h===0)continue;if((4&u)!==0){const m=3&u;(m===0||m===1)&&(t[m].push(c),t[m].push(h))}}return t}}function XS(r){return r.characteristics&&/transcribes-spoken-dialog/gi.test(r.characteristics)&&/describes-music-and-sound/gi.test(r.characteristics)?"captions":"subtitles"}function Vv(r,e){return!!r&&r.kind===XS(e)&&Fd(e,r)}function tC(r,e,t,s){return Math.min(e,s)-Math.max(r,t)}function Kv(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class p0{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const s=this.hls.levels[t.droppedLevel];this.isLevelAllowed(s)&&this.restrictedLevels.push({bitrate:s.bitrate,height:s.height,width:s.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const s=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,s.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&ye(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,s=this.getMaxLevel(e.length-1);s!==this.autoLevelCapping&&X.log(`Setting autoLevelCapping to ${s}: ${e[s].height}p@${e[s].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=s,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const s=t.filter((a,o)=>this.isLevelAllowed(a)&&o<=e);return this.clientRect=null,p0.getMaxLevelByMediaSize(s,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const s=e.getBoundingClientRect();t.width=s.width,t.height=s.height,!t.width&&!t.height&&(t.width=s.right-s.left||e.width||0,t.height=s.bottom-s.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(s=>e.bitrate===s.bitrate&&e.width===s.width&&e.height===s.height)}static getMaxLevelByMediaSize(e,t,s){if(!(e!=null&&e.length))return-1;const a=(c,h)=>h?c.width!==h.width||c.height!==h.height:!0;let o=e.length-1;const u=Math.max(t,s);for(let c=0;c<e.length;c+=1){const h=e[c];if((h.width>=u||h.height>=u)&&a(h,e[c+1])){o=c;break}}return o}}class iC{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const s=this.hls.config;if(s.capLevelOnFPSDrop){const a=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=a,a&&typeof a.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),s.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,s){const a=performance.now();if(t){if(this.lastTime){const o=a-this.lastTime,u=s-this.lastDroppedFrames,c=t-this.lastDecodedFrames,h=1e3*u/o,d=this.hls;if(d.trigger(R.FPS_DROP,{currentDropped:u,currentDecoded:c,totalDroppedFrames:s}),h>0&&u>d.config.fpsDroppedMonitoringThreshold*c){let m=d.currentLevel;X.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=m)&&(m=m-1,d.trigger(R.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:d.currentLevel}),d.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=s,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const uu="[eme]";class Jr{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Jr.CDMCleanupPromise?[Jr.CDMCleanupPromise]:[],this.debug=X.debug.bind(X,uu),this.log=X.log.bind(X,uu),this.warn=X.warn.bind(X,uu),this.error=X.error.bind(X,uu),this.onMediaEncrypted=t=>{const{initDataType:s,initData:a}=t,o=`"${t.type}" event: init data type: "${s}"`;if(this.debug(o),a!==null){if(!this.keyFormatPromise){let u=Object.keys(this.keySystemAccessPromises);u.length||(u=Jl(this.config));const c=u.map(Hh).filter(h=>!!h);this.keyFormatPromise=this.getKeyFormatPromise(c)}this.keyFormatPromise.then(u=>{const c=jh(u);let h,d;if(s==="sinf"){if(c!==Ve.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${s}" for selected key-system ${c}`);return}const S=vt(new Uint8Array(a));try{const E=t0(JSON.parse(S).sinf),T=uS(E);if(!T)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");h=T.subarray(8,24),d=Ve.FAIRPLAY}catch(E){this.warn(`${o} Failed to parse sinf: ${E}`);return}}else{if(c!==Ve.WIDEVINE&&c!==Ve.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${s}" for selected key-system ${c}`);return}const S=ML(a),E=S.filter(A=>!!A.systemId&&Gh(A.systemId)===c);E.length>1&&this.warn(`${o} Using first of ${E.length} pssh found for selected key-system ${c}`);const T=E[0];if(!T){S.length===0||S.some(A=>!A.systemId)?this.warn(`${o} contains incomplete or invalid pssh data`):this.log(`ignoring ${o} for ${S.map(A=>Gh(A.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(d=Gh(T.systemId),T.version===0&&T.data)if(d===Ve.WIDEVINE){const A=T.data.length-22;h=T.data.subarray(A,A+16)}else d===Ve.PLAYREADY&&(h=tS(T.data))}if(!d||!h){this.log(`Unable to handle ${o} with key-system ${c}`);return}const m=Vi.hexDump(h),{keyIdToKeySessionPromise:p,mediaKeySessions:v}=this;let x=p[m];for(let S=0;S<v.length;S++){const E=v[S],T=E.decryptdata;if(!T.keyId)continue;const A=Vi.hexDump(T.keyId);if(m===A||T.uri.replace(/-/g,"").indexOf(m)!==-1){if(x=p[A],T.pssh)break;delete p[A],T.pssh=new Uint8Array(a),T.keyId=h,x=p[m]=x.then(()=>this.generateRequestWithPreferredKeySession(E,s,a,"encrypted-event-key-match")),x.catch(w=>this.handleError(w));break}}if(!x){if(d!==c){this.log(`Ignoring "${o}" with ${d} init data for selected key-system ${c}`);return}x=p[m]=this.getKeySystemSelectionPromise([d]).then(({keySystem:S,mediaKeys:E})=>{var T;this.throwIfDestroyed();const A=new Do("ISO-23001-7",m,(T=Hh(S))!=null?T:"");return A.pssh=new Uint8Array(a),A.keyId=h,this.attemptSetMediaKeys(S,E).then(()=>{this.throwIfDestroyed();const w=this.createMediaKeySessionContext({decryptdata:A,keySystem:S,mediaKeys:E});return this.generateRequestWithPreferredKeySession(w,s,a,"encrypted-event-no-match")})}),x.catch(S=>this.handleError(S))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:s}=this.config,a=t[e];if(a)return a.licenseUrl;if(e===Ve.WIDEVINE&&s)return s}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,s=t[e];if(s)return s.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,s=(u,c,h)=>!!u&&h.indexOf(u)===c,a=t.map(u=>u.audioCodec).filter(s),o=t.map(u=>u.videoCodec).filter(s);return a.length+o.length===0&&o.push("avc1.42e01e"),new Promise((u,c)=>{const h=d=>{const m=d.shift();this.getMediaKeysPromise(m,a,o).then(p=>u({keySystem:m,mediaKeys:p})).catch(p=>{d.length?h(d):p instanceof yi?c(p):c(new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};h(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:s}=this.config;if(typeof s!="function"){let a=`Configured requestMediaKeySystemAccess is not a function ${s}`;return eS===null&&self.location.protocol==="http:"&&(a=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(a))}return s(e,t)}getMediaKeysPromise(e,t,s){const a=lL(e,t,s,this.config.drmSystemOptions),o=this.keySystemAccessPromises[e];let u=o==null?void 0:o.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(a)}`),u=this.requestMediaKeySystemAccess(e,a);const c=this.keySystemAccessPromises[e]={keySystemAccess:u};return u.catch(h=>{this.log(`Failed to obtain access to key-system "${e}": ${h}`)}),u.then(h=>{this.log(`Access for key-system "${h.keySystem}" obtained`);const d=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),c.mediaKeys=h.createMediaKeys().then(m=>(this.log(`Media-keys created for "${e}"`),d.then(p=>p?this.setMediaKeysServerCertificate(m,e,p):m))),c.mediaKeys.catch(m=>{this.error(`Failed to create media-keys for "${e}"}: ${m}`)}),c.mediaKeys})}return u.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:s}){this.log(`Creating key-system session "${t}" keyId: ${Vi.hexDump(e.keyId||[])}`);const a=s.createSession(),o={decryptdata:e,keySystem:t,mediaKeys:s,mediaKeysSession:a,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const s=this.createMediaKeySessionContext(e),a=this.getKeyIdString(t),o="cenc";this.keyIdToKeySessionPromise[a]=this.generateRequestWithPreferredKeySession(s,o,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Vi.hexDump(e.keyId)}updateKeySession(e,t){var s;const a=e.mediaKeysSession;return this.log(`Updating key-session "${a.sessionId}" for keyID ${Vi.hexDump(((s=e.decryptdata)==null?void 0:s.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),a.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,s)=>{const a=Jl(this.config),o=e.map(jh).filter(u=>!!u&&a.indexOf(u)!==-1);return this.getKeySystemSelectionPromise(o).then(({keySystem:u})=>{const c=Hh(u);c?t(c):s(new Error(`Unable to find format for key-system "${u}"`))}).catch(s)})}loadKey(e){const t=e.keyInfo.decryptdata,s=this.getKeyIdString(t),a=`(keyId: ${s} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${a}`);let o=this.keyIdToKeySessionPromise[s];return o||(o=this.keyIdToKeySessionPromise[s]=this.getKeySystemForKeyPromise(t).then(({keySystem:u,mediaKeys:c})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${a}`),this.attemptSetMediaKeys(u,c).then(()=>{this.throwIfDestroyed();const h=this.createMediaKeySessionContext({keySystem:u,mediaKeys:c,decryptdata:t});return this.generateRequestWithPreferredKeySession(h,"cenc",t.pssh,"playlist-key")}))),o.catch(u=>this.handleError(u))),o}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof yi?this.hls.trigger(R.ERROR,e.data):this.hls.trigger(R.ERROR,{type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),s=this.keyIdToKeySessionPromise[t];if(!s){const a=jh(e.keyFormat),o=a?[a]:Jl(this.config);return this.attemptKeySystemAccess(o)}return s}getKeySystemSelectionPromise(e){if(e.length||(e=Jl(this.config)),e.length===0)throw new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const s=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const a=Promise.all(s).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(a),a.then(()=>{this.log(`Media-keys set for "${e}"`),s.push(a),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>s.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(e,t,s,a){var o,u;const c=(o=this.config.drmSystems)==null||(u=o[e.keySystem])==null?void 0:u.generateRequest;if(c)try{const S=c.call(this.hls,t,s,e);if(!S)throw new Error("Invalid response from configured generateRequest filter");t=S.initDataType,s=e.decryptdata.pssh=S.initData?new Uint8Array(S.initData):null}catch(S){var h;if(this.warn(S.message),(h=this.hls)!=null&&h.config.debug)throw S}if(s===null)return this.log(`Skipping key-session request for "${a}" (no initData)`),Promise.resolve(e);const d=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${a}": ${d} (init data type: ${t} length: ${s?s.byteLength:null})`);const m=new d0,p=e._onmessage=S=>{const E=e.mediaKeysSession;if(!E){m.emit("error",new Error("invalid state"));return}const{messageType:T,message:A}=S;this.log(`"${T}" message event for session "${E.sessionId}" message size: ${A.byteLength}`),T==="license-request"||T==="license-renewal"?this.renewLicense(e,A).catch(w=>{this.handleError(w),m.emit("error",w)}):T==="license-release"?e.keySystem===Ve.FAIRPLAY&&(this.updateKeySession(e,Cd("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${T}"`)},v=e._onkeystatuseschange=S=>{if(!e.mediaKeysSession){m.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const T=e.keyStatus;m.emit("keyStatus",T),T==="expired"&&(this.warn(`${e.keySystem} expired for key ${d}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",p),e.mediaKeysSession.addEventListener("keystatuseschange",v);const x=new Promise((S,E)=>{m.on("error",E),m.on("keyStatus",T=>{T.startsWith("usable")?S():T==="output-restricted"?E(new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):T==="internal-error"?E(new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${T}"`)):T==="expired"?E(new Error("key expired while generating request")):this.warn(`unhandled key status change "${T}"`)})});return e.mediaKeysSession.generateRequest(t,s).then(()=>{var S;this.log(`Request generated for key-session "${(S=e.mediaKeysSession)==null?void 0:S.sessionId}" keyId: ${d}`)}).catch(S=>{throw new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_NO_SESSION,error:S,fatal:!1},`Error generating key-session request: ${S}`)}).then(()=>x).catch(S=>{throw m.removeAllListeners(),this.removeSession(e),S}).then(()=>(m.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,s)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Vi.hexDump("buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s))} session keyId: ${Vi.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,s=t.loader,a=new s(t),o=this.getServerCertificateUrl(e);return o?(this.log(`Fetching server certificate for "${e}"`),new Promise((u,c)=>{const h={responseType:"arraybuffer",url:o},d=t.certLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(v,x,S,E)=>{u(v.data)},onError:(v,x,S,E)=>{c(new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:Lt({url:h.url,data:void 0},v)},`"${e}" certificate request failed (${o}). Status: ${v.code} (${v.text})`))},onTimeout:(v,x,S)=>{c(new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:{url:h.url,data:void 0}},`"${e}" certificate request timed out (${o})`))},onAbort:(v,x,S)=>{c(new Error("aborted"))}};a.load(h,m,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,s){return new Promise((a,o)=>{e.setServerCertificate(s).then(u=>{this.log(`setServerCertificate ${u?"success":"not supported by CDM"} (${s==null?void 0:s.byteLength}) on "${t}"`),a(e)}).catch(u=>{o(new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:u,fatal:!0},u.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(s=>this.updateKeySession(e,new Uint8Array(s)).catch(a=>{throw new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:a,fatal:!0},a.message)}))}unpackPlayReadyKeyMessage(e,t){const s=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!s.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const a=new DOMParser().parseFromString(s,"application/xml"),o=a.querySelectorAll("HttpHeader");if(o.length>0){let m;for(let p=0,v=o.length;p<v;p++){var u,c;m=o[p];const x=(u=m.querySelector("name"))==null?void 0:u.textContent,S=(c=m.querySelector("value"))==null?void 0:c.textContent;x&&S&&e.setRequestHeader(x,S)}}const h=a.querySelector("Challenge"),d=h==null?void 0:h.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return Cd(atob(d))}setupLicenseXHR(e,t,s,a){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!s.decryptdata)throw new Error("Key removed");return o.call(this.hls,e,t,s,a)}).catch(u=>{if(!s.decryptdata)throw u;return e.open("POST",t,!0),o.call(this.hls,e,t,s,a)}).then(u=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:u||a})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:a}))}requestLicense(e,t){const s=this.config.keyLoadPolicy.default;return new Promise((a,o)=>{const u=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${u}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return o(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let h=c.response;this.log(`License received ${h instanceof ArrayBuffer?h.byteLength:h}`);const d=this.config.licenseResponseCallback;if(d)try{h=d.call(this.hls,c,u,e)}catch(m){this.error(m)}a(h)}else{const h=s.errorRetry,d=h?h.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||c.status>=400&&c.status<500)o(new yi({type:Ae.KEY_SYSTEM_ERROR,details:ie.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:c,response:{url:u,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${u}). Status: ${c.status} (${c.statusText})`));else{const m=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,t).then(a,o)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=c,this.setupLicenseXHR(c,u,e,t).then(({xhr:h,licenseChallenge:d})=>{e.keySystem==Ve.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(h,d)),h.send(d)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const s=t.media;this.media=s,s.removeEventListener("encrypted",this.onMediaEncrypted),s.removeEventListener("waitingforkey",this.onWaitingForKey),s.addEventListener("encrypted",this.onMediaEncrypted),s.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Do.clearKeyUriToKeyIdMap();const s=t.length;Jr.CDMCleanupPromise=Promise.all(t.map(a=>this.removeSession(a)).concat(e==null?void 0:e.setMediaKeys(null).catch(a=>{this.log(`Could not clear media keys: ${a}`)}))).then(()=>{s&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const s=t.reduce((a,o)=>(a.indexOf(o.keyFormat)===-1&&a.push(o.keyFormat),a),[]);this.log(`Selecting key-system from session-keys ${s.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(s)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:s}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),s&&s.readyState!==XMLHttpRequest.DONE&&s.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const a=this.mediaKeySessions.indexOf(e);return a>-1&&this.mediaKeySessions.splice(a,1),t.remove().catch(o=>{this.log(`Could not remove session: ${o}`)}).then(()=>t.close()).catch(o=>{this.log(`Could not close session: ${o}`)})}}}Jr.CDMCleanupPromise=void 0;class yi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var Nt;(function(r){r.MANIFEST="m",r.AUDIO="a",r.VIDEO="v",r.MUXED="av",r.INIT="i",r.CAPTION="c",r.TIMED_TEXT="tt",r.KEY="k",r.OTHER="o"})(Nt||(Nt={}));var Bd;(function(r){r.DASH="d",r.HLS="h",r.SMOOTH="s",r.OTHER="o"})(Bd||(Bd={}));var Vn;(function(r){r.OBJECT="CMCD-Object",r.REQUEST="CMCD-Request",r.SESSION="CMCD-Session",r.STATUS="CMCD-Status"})(Vn||(Vn={}));const sC={[Vn.OBJECT]:["br","d","ot","tb"],[Vn.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Vn.SESSION]:["cid","pr","sf","sid","st","v"],[Vn.STATUS]:["bs","rtp"]};class pa{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(s=>s instanceof pa?s:new pa(s))),this.value=e,this.params=t}}class QS{constructor(e){this.description=void 0,this.description=e}}const nC="Dict";function rC(r){return Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":typeof r=="object"?JSON.stringify(r):String(r)}function aC(r,e,t,s){return new Error(`failed to ${r} "${rC(e)}" as ${t}`,{cause:s})}const zv="Bare Item",oC="Boolean",lC="Byte Sequence",uC="Decimal",cC="Integer";function fC(r){return r<-999999999999999||999999999999999<r}const hC=/[\x00-\x1f\x7f]+/,dC="Token",mC="Key";function Ji(r,e,t){return aC("serialize",r,e,t)}function gC(r){if(typeof r!="boolean")throw Ji(r,oC);return r?"?1":"?0"}function pC(r){return btoa(String.fromCharCode(...r))}function yC(r){if(ArrayBuffer.isView(r)===!1)throw Ji(r,lC);return`:${pC(r)}:`}function WS(r){if(fC(r))throw Ji(r,cC);return r.toString()}function vC(r){return`@${WS(r.getTime()/1e3)}`}function ZS(r,e){if(r<0)return-ZS(-r,e);const t=Math.pow(10,e);if(Math.abs(r*t%1-.5)<Number.EPSILON){const a=Math.floor(r*t);return(a%2===0?a:a+1)/t}else return Math.round(r*t)/t}function xC(r){const e=ZS(r,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Ji(r,uC);const t=e.toString();return t.includes(".")?t:`${t}.0`}const SC="String";function EC(r){if(hC.test(r))throw Ji(r,SC);return`"${r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function TC(r){return r.description||r.toString().slice(7,-1)}function Yv(r){const e=TC(r);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Ji(e,dC);return e}function jd(r){switch(typeof r){case"number":if(!ye(r))throw Ji(r,zv);return Number.isInteger(r)?WS(r):xC(r);case"string":return EC(r);case"symbol":return Yv(r);case"boolean":return gC(r);case"object":if(r instanceof Date)return vC(r);if(r instanceof Uint8Array)return yC(r);if(r instanceof QS)return Yv(r);default:throw Ji(r,zv)}}function Gd(r){if(/^[a-z*][a-z0-9\-_.*]*$/.test(r)===!1)throw Ji(r,mC);return r}function y0(r){return r==null?"":Object.entries(r).map(([e,t])=>t===!0?`;${Gd(e)}`:`;${Gd(e)}=${jd(t)}`).join("")}function JS(r){return r instanceof pa?`${jd(r.value)}${y0(r.params)}`:jd(r)}function bC(r){return`(${r.value.map(JS).join(" ")})${y0(r.params)}`}function AC(r,e={whitespace:!0}){if(typeof r!="object")throw Ji(r,nC);const t=r instanceof Map?r.entries():Object.entries(r),s=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([a,o])=>{o instanceof pa||(o=new pa(o));let u=Gd(a);return o.value===!0?u+=y0(o.params):(u+="=",Array.isArray(o.value)?u+=bC(o):u+=JS(o)),u}).join(`,${s}`)}function RC(r,e){return AC(r,e)}const LC=r=>r==="ot"||r==="sf"||r==="st",_C=r=>typeof r=="number"?ye(r):r!=null&&r!==""&&r!==!1;function DC(r,e){const t=new URL(r),s=new URL(e);if(t.origin!==s.origin)return r;const a=t.pathname.split("/").slice(1),o=s.pathname.split("/").slice(1,-1);for(;a[0]===o[0];)a.shift(),o.shift();for(;o.length;)o.shift(),a.unshift("..");return a.join("/")}function CC(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(a=="x"?o:o&3|8).toString(16)})}}}const Eu=r=>Math.round(r),wC=(r,e)=>(e!=null&&e.baseUrl&&(r=DC(r,e.baseUrl)),encodeURIComponent(r)),cu=r=>Eu(r/100)*100,OC={br:Eu,d:Eu,bl:cu,dl:cu,mtp:cu,nor:wC,rtp:cu,tb:Eu};function IC(r,e){const t={};if(r==null||typeof r!="object")return t;const s=Object.keys(r).sort(),a=mt({},OC,e==null?void 0:e.formatters),o=e==null?void 0:e.filter;return s.forEach(u=>{if(o!=null&&o(u))return;let c=r[u];const h=a[u];h&&(c=h(c,e)),!(u==="v"&&c===1)&&(u=="pr"&&c===1||_C(c)&&(LC(u)&&typeof c=="string"&&(c=new QS(c)),t[u]=c))}),t}function eE(r,e={}){return r?RC(IC(r,e),mt({whitespace:!1},e)):""}function MC(r,e={}){if(!r)return{};const t=Object.entries(r),s=Object.entries(sC).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),a=t.reduce((o,u)=>{var c,h;const[d,m]=u,p=((c=s.find(v=>v[1].includes(d)))==null?void 0:c[0])||Vn.REQUEST;return(h=o[p])!=null||(o[p]={}),o[p][d]=m,o},{});return Object.entries(a).reduce((o,[u,c])=>(o[u]=eE(c,e),o),{})}function kC(r,e,t){return mt(r,MC(e,t))}const NC="CMCD";function PC(r,e={}){if(!r)return"";const t=eE(r,e);return`${NC}=${encodeURIComponent(t)}`}const qv=/CMCD=[^&#]+/;function FC(r,e,t){const s=PC(e,t);if(!s)return r;if(qv.test(r))return r.replace(qv,s);const a=r.includes("?")?"&":"?";return`${r}${a}${s}`}class UC{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=a=>{try{this.apply(a,{ot:Nt.MANIFEST,su:!this.initialized})}catch(o){X.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=a=>{try{const o=a.frag,u=this.hls.levels[o.level],c=this.getObjectType(o),h={d:o.duration*1e3,ot:c};(c===Nt.VIDEO||c===Nt.AUDIO||c==Nt.MUXED)&&(h.br=u.bitrate/1e3,h.tb=this.getTopBandwidth(c)/1e3,h.bl=this.getBufferLength(c)),this.apply(a,h)}catch(o){X.warn("Could not generate segment CMCD data.",o)}},this.hls=e;const t=this.config=e.config,{cmcd:s}=t;s!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=s.sessionId||CC(),this.cid=s.contentId,this.useHeaders=s.useHeaders===!0,this.includeKeys=s.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHED,this.onMediaDetached,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHED,this.onMediaDetached,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var s,a;this.audioBuffer=(s=t.tracks.audio)==null?void 0:s.buffer,this.videoBuffer=(a=t.tracks.video)==null?void 0:a.buffer}createData(){var e;return{v:1,sf:Bd.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){mt(t,this.createData());const s=t.ot===Nt.INIT||t.ot===Nt.VIDEO||t.ot===Nt.MUXED;this.starved&&s&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:a}=this;a&&(t=Object.keys(t).reduce((o,u)=>(a.includes(u)&&(o[u]=t[u]),o),{})),this.useHeaders?(e.headers||(e.headers={}),kC(e.headers,t)):e.url=FC(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Nt.TIMED_TEXT;if(e.sn==="initSegment")return Nt.INIT;if(t==="audio")return Nt.AUDIO;if(t==="main")return this.hls.audioTracks.length?Nt.VIDEO:Nt.MUXED}getTopBandwidth(e){let t=0,s;const a=this.hls;if(e===Nt.AUDIO)s=a.audioTracks;else{const o=a.maxAutoLevel,u=o>-1?o+1:a.levels.length;s=a.levels.slice(0,u)}for(const o of s)o.bitrate>t&&(t=o.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,s=e===Nt.AUDIO?this.audioBuffer:this.videoBuffer;return!s||!t?NaN:Ze.bufferInfo(s,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,s=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new s(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,u,c){t(o),this.loader.load(o,u,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,s=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new s(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,u,c){t(o),this.loader.load(o,u,c)}}}}const BC=3e5;class jC{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=X.log.bind(X,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(s=>s!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:s}=t;s!==null&&(this.pathwayId=s.pathwayId,this.uri=s.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:s}=t;if((s==null?void 0:s.action)===Ot.SendAlternateToPenaltyBox&&s.flags===Ci.MoveAllAlternatesMatchingHost){const a=this.levels;let o=this.pathwayPriority,u=this.pathwayId;if(t.context){const{groupId:c,pathwayId:h,type:d}=t.context;c&&a?u=this.getPathwayForGroupId(c,d,u):h&&(u=h)}u in this.penalizedPathways||(this.penalizedPathways[u]=performance.now()),!o&&a&&(o=a.reduce((c,h)=>(c.indexOf(h.pathwayId)===-1&&c.push(h.pathwayId),c),[])),o&&o.length>1&&(this.updatePathwayPriority(o),s.resolved=this.pathwayId!==u),s.resolved||X.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${u} levels: ${a&&a.length} priorities: ${JSON.stringify(o)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const s=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${s}"`),t=this.getLevelsForPathway(s),this.pathwayId=s}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const s=this.penalizedPathways,a=performance.now();Object.keys(s).forEach(o=>{a-s[o]>BC&&delete s[o]});for(let o=0;o<e.length;o++){const u=e[o];if(u in s)continue;if(u===this.pathwayId)return;const c=this.hls.nextLoadLevel,h=this.hls.levels[c];if(t=this.getLevelsForPathway(u),t.length>0){this.log(`Setting Pathway to "${u}"`),this.pathwayId=u,xS(t),this.hls.trigger(R.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[c];h&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==h.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==h.bitrate&&this.log(`Unstable Pathways change from bitrate ${h.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(e,t,s){const a=this.getLevelsForPathway(s).concat(this.levels||[]);for(let o=0;o<a.length;o++)if(t===Be.AUDIO_TRACK&&a[o].hasAudioGroup(e)||t===Be.SUBTITLE_TRACK&&a[o].hasSubtitleGroup(e))return a[o].pathwayId;return s}clonePathways(e){const t=this.levels;if(!t)return;const s={},a={};e.forEach(o=>{const{ID:u,"BASE-ID":c,"URI-REPLACEMENT":h}=o;if(t.some(m=>m.pathwayId===u))return;const d=this.getLevelsForPathway(c).map(m=>{const p=new nt(m.attrs);p["PATHWAY-ID"]=u;const v=p.AUDIO&&`${p.AUDIO}_clone_${u}`,x=p.SUBTITLES&&`${p.SUBTITLES}_clone_${u}`;v&&(s[p.AUDIO]=v,p.AUDIO=v),x&&(a[p.SUBTITLES]=x,p.SUBTITLES=x);const S=tE(m.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",h),E=new ga({attrs:p,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:S,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let T=1;T<m.audioGroups.length;T++)E.addGroupId("audio",`${m.audioGroups[T]}_clone_${u}`);if(m.subtitleGroups)for(let T=1;T<m.subtitleGroups.length;T++)E.addGroupId("text",`${m.subtitleGroups[T]}_clone_${u}`);return E});t.push(...d),Xv(this.audioTracks,s,h,u),Xv(this.subtitleTracks,a,h,u)})}loadSteeringManifest(e){const t=this.hls.config,s=t.loader;this.loader&&this.loader.destroy(),this.loader=new s(t);let a;try{a=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(a.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;a.searchParams.set("_HLS_pathway",this.pathwayId),a.searchParams.set("_HLS_throughput",""+m)}const o={responseType:"json",url:a.href},u=t.steeringManifestLoadPolicy.default,c=u.errorRetry||u.timeoutRetry||{},h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},d={onSuccess:(m,p,v,x)=>{this.log(`Loaded steering manifest: "${a}"`);const S=m.data;if(S.VERSION!==1){this.log(`Steering VERSION ${S.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=S.TTL;const{"RELOAD-URI":E,"PATHWAY-CLONES":T,"PATHWAY-PRIORITY":A}=S;if(E)try{this.uri=new self.URL(E,a).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${E}`);return}this.scheduleRefresh(this.uri||v.url),T&&this.clonePathways(T);const w={steeringManifest:S,url:a.toString()};this.hls.trigger(R.STEERING_MANIFEST_LOADED,w),A&&this.updatePathwayPriority(A)},onError:(m,p,v,x)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${p.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let S=this.timeToLoad*1e3;if(m.code===429){const E=this.loader;if(typeof(E==null?void 0:E.getResponseHeader)=="function"){const T=E.getResponseHeader("Retry-After");T&&(S=parseFloat(T)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,S)},onTimeout:(m,p,v)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${a}`),this.loader.load(o,h,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var s;const a=(s=this.hls)==null?void 0:s.media;if(a&&!a.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Xv(r,e,t,s){r&&Object.keys(e).forEach(a=>{const o=r.filter(u=>u.groupId===a).map(u=>{const c=mt({},u);return c.details=void 0,c.attrs=new nt(c.attrs),c.url=c.attrs.URI=tE(u.url,u.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[a],c.attrs["PATHWAY-ID"]=s,c});r.push(...o)})}function tE(r,e,t,s){const{HOST:a,PARAMS:o,[t]:u}=s;let c;e&&(c=u==null?void 0:u[e],c&&(r=c));const h=new self.URL(r);return a&&!c&&(h.host=a),o&&Object.keys(o).sort().forEach(d=>{d&&h.searchParams.set(d,o[d])}),h.href}const GC=/^age:\s*[\d.]+\s*$/im;class iE{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Wu,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,s){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=s,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const s=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0,a.aborted=!1;const o=this.xhrSetup;o?Promise.resolve().then(()=>{if(!(this.loader!==s||this.stats.aborted))return o(s,t.url)}).catch(u=>{if(!(this.loader!==s||this.stats.aborted))return s.open("GET",t.url,!0),o(s,t.url)}).then(()=>{this.loader!==s||this.stats.aborted||this.openAndSendXhr(s,t,e)}).catch(u=>{this.callbacks.onError({code:s.status,text:u.message},t,s,a)}):this.openAndSendXhr(s,t,e)}openAndSendXhr(e,t,s){e.readyState||e.open("GET",t.url,!0);const a=t.headers,{maxTimeToFirstByteMs:o,maxLoadTimeMs:u}=s.loadPolicy;if(a)for(const c in a)e.setRequestHeader(c,a[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),s.timeout=o&&ye(o)?o:u,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:s}=this;if(!e||!t)return;const a=t.readyState,o=this.config;if(!s.aborted&&a>=2&&(s.loading.first===0&&(s.loading.first=Math.max(self.performance.now(),s.loading.start),o.timeout!==o.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),o.timeout=o.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.loadPolicy.maxLoadTimeMs-(s.loading.first-s.loading.start)))),a===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,c=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const p=c??t.response;if(p!=null){s.loading.end=Math.max(self.performance.now(),s.loading.first);const v=t.responseType==="arraybuffer"?p.byteLength:p.length;if(s.loaded=s.total=v,s.bwEstimate=s.total*8e3/(s.loading.end-s.loading.first),!this.callbacks)return;const x=this.callbacks.onProgress;if(x&&x(s,e,p,t),!this.callbacks)return;const S={url:t.responseURL,data:p,code:u};this.callbacks.onSuccess(S,s,e,t);return}}const h=o.loadPolicy.errorRetry,d=s.retry,m={url:e.url,data:void 0,code:u};Gu(h,d,!1,m)?this.retry(h):(X.error(`${u} while loading ${e.url}`),this.callbacks.onError({code:u,text:t.statusText},e,t,s))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Gu(e,t,!0))this.retry(e);else{var s;X.warn(`timeout while loading ${(s=this.context)==null?void 0:s.url}`);const a=this.callbacks;a&&(this.abortInternal(),a.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:s}=this;this.retryDelay=n0(e,s.retry),s.retry++,X.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${s.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&GC.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function HC(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const $C=/(\d+)-(\d+)\/(\d+)/;class Qv{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||YC,this.controller=new self.AbortController,this.stats=new Wu}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,s){const a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();const o=VC(e,this.controller.signal),u=s.onProgress,c=e.responseType==="arraybuffer",h=c?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:m}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=s,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),t.timeout=d&&ye(d)?d:m,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),s.onTimeout(a,e,this.response)},t.timeout),self.fetch(this.request).then(p=>{this.response=this.loader=p;const v=Math.max(self.performance.now(),a.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=m,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),s.onTimeout(a,e,this.response)},m-(v-a.loading.start)),!p.ok){const{status:x,statusText:S}=p;throw new qC(S||"fetch, bad network response",x,p)}return a.loading.first=v,a.total=zC(p.headers)||a.total,u&&ye(t.highWaterMark)?this.loadProgressively(p,a,e,t.highWaterMark,u):c?p.arrayBuffer():e.responseType==="json"?p.json():p.text()}).then(p=>{const v=this.response;if(!v)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first);const x=p[h];x&&(a.loaded=a.total=x);const S={url:v.url,data:p,code:v.status};u&&!ye(t.highWaterMark)&&u(a,e,p,v),s.onSuccess(S,a,e,v)}).catch(p=>{if(self.clearTimeout(this.requestTimeout),a.aborted)return;const v=p&&p.code||0,x=p?p.message:null;s.onError({code:v,text:x},e,p?p.details:null,a)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,s,a=0,o){const u=new bS,c=e.body.getReader(),h=()=>c.read().then(d=>{if(d.done)return u.dataLength&&o(t,s,u.flush(),e),Promise.resolve(new ArrayBuffer(0));const m=d.value,p=m.length;return t.loaded+=p,p<a||u.dataLength?(u.push(m),u.dataLength>=a&&o(t,s,u.flush(),e)):o(t,s,m,e),h()}).catch(()=>Promise.reject());return h()}}function VC(r,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(mt({},r.headers))};return r.rangeEnd&&t.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),t}function KC(r){const e=$C.exec(r);if(e)return parseInt(e[2])-parseInt(e[1])+1}function zC(r){const e=r.get("Content-Range");if(e){const s=KC(e);if(ye(s))return s}const t=r.get("Content-Length");if(t)return parseInt(t)}function YC(r,e){return new self.Request(r.url,e)}class qC extends Error{constructor(e,t,s){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=s}}const XC=/\s/,QC={newCue(r,e,t,s){const a=[];let o,u,c,h,d;const m=self.VTTCue||self.TextTrackCue;for(let v=0;v<s.rows.length;v++)if(o=s.rows[v],c=!0,h=0,d="",!o.isEmpty()){var p;for(let E=0;E<o.chars.length;E++)XC.test(o.chars[E].uchar)&&c?h++:(d+=o.chars[E].uchar,c=!1);o.cueStartTime=e,e===t&&(t+=1e-4),h>=16?h--:h++;const x=KS(d.trim()),S=g0(e,t,x);r!=null&&(p=r.cues)!=null&&p.getCueById(S)||(u=new m(e,t,x),u.id=S,u.line=v+1,u.align="left",u.position=10+Math.min(80,Math.floor(h*8/32)*10),a.push(u))}return r&&a.length&&(a.sort((v,x)=>v.line==="auto"||x.line==="auto"?0:v.line>8&&x.line>8?x.line-v.line:v.line-x.line),a.forEach(v=>gS(r,v))),a}},WC={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},sE=Lt(Lt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:iE,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:A_,bufferController:DD,capLevelController:p0,errorController:h_,fpsController:iC,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:eS,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:WC},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},ZC()),{},{subtitleStreamController:AD,subtitleTrackController:LD,timelineController:eC,audioStreamController:TD,audioTrackController:bD,emeController:Jr,cmcdController:UC,contentSteeringController:jC});function ZC(){return{cueHandler:QC,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function JC(r,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=Hd(r),s=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(o=>{const u=`${o==="level"?"playlist":o}LoadPolicy`,c=e[u]===void 0,h=[];a.forEach(d=>{const m=`${o}Loading${d}`,p=e[m];if(p!==void 0&&c){h.push(m);const v=t[u].default;switch(e[u]={default:v},d){case"TimeOut":v.maxLoadTimeMs=p,v.maxTimeToFirstByteMs=p;break;case"MaxRetry":v.errorRetry.maxNumRetry=p,v.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":v.errorRetry.retryDelayMs=p,v.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=p,v.timeoutRetry.maxRetryDelayMs=p;break}}}),h.length&&X.warn(`hls.js config: "${h.join('", "')}" setting(s) are deprecated, use "${u}": ${JSON.stringify(e[u])}`)}),Lt(Lt({},t),e)}function Hd(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(Hd):Object.keys(r).reduce((e,t)=>(e[t]=Hd(r[t]),e),{}):r}function ew(r){const e=r.loader;e!==Qv&&e!==iE?(X.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):HC()&&(r.loader=Qv,r.progressive=!0,r.enableSoftwareAES=!0,X.log("[config]: Progressive streaming enabled, using FetchLoader"))}let od;class tw extends r0{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const s=this.hls.config.preferManagedMediaSource,a=[],o={},u={};let c=!1,h=!1,d=!1;t.levels.forEach(m=>{var p,v;const x=m.attrs;let{audioCodec:S,videoCodec:E}=m;((p=S)==null?void 0:p.indexOf("mp4a.40.34"))!==-1&&(od||(od=/chrome|firefox/i.test(navigator.userAgent)),od&&(m.audioCodec=S=void 0)),S&&(m.audioCodec=S=Uu(S,s)),((v=E)==null?void 0:v.indexOf("avc1"))===0&&(E=m.videoCodec=GL(E));const{width:T,height:A,unknownCodecs:w}=m;if(c||(c=!!(T&&A)),h||(h=!!E),d||(d=!!S),w!=null&&w.length||S&&!zh(S,"audio",s)||E&&!zh(E,"video",s))return;const{CODECS:C,"FRAME-RATE":k,"HDCP-LEVEL":_,"PATHWAY-ID":U,RESOLUTION:B,"VIDEO-RANGE":M}=x,N=`${`${U||"."}-`}${m.bitrate}-${B}-${k}-${C}-${M}-${_}`;if(o[N])if(o[N].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const P=u[N]+=1;m.attrs["PATHWAY-ID"]=new Array(P+1).join(".");const G=new ga(m);o[N]=G,a.push(G)}else o[N].addGroupId("audio",x.AUDIO),o[N].addGroupId("text",x.SUBTITLES);else{const P=new ga(m);o[N]=P,u[N]=1,a.push(P)}}),this.filterAndSortMediaOptions(a,t,c,h,d)}filterAndSortMediaOptions(e,t,s,a,o){let u=[],c=[],h=e;if((s||a)&&o&&(h=h.filter(({videoCodec:S,videoRange:E,width:T,height:A})=>(!!S||!!(T&&A))&&e_(E))),h.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const S=new Error("no level with compatible codecs found in manifest");this.hls.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:S,reason:S.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:S}=this.hls.config;u=t.audioTracks.filter(E=>!E.audioCodec||zh(E.audioCodec,"audio",S)),Wv(u)}t.subtitles&&(c=t.subtitles,Wv(c));const d=h.slice(0);h.sort((S,E)=>{if(S.attrs["HDCP-LEVEL"]!==E.attrs["HDCP-LEVEL"])return(S.attrs["HDCP-LEVEL"]||"")>(E.attrs["HDCP-LEVEL"]||"")?1:-1;if(s&&S.height!==E.height)return S.height-E.height;if(S.frameRate!==E.frameRate)return S.frameRate-E.frameRate;if(S.videoRange!==E.videoRange)return Bu.indexOf(S.videoRange)-Bu.indexOf(E.videoRange);if(S.videoCodec!==E.videoCodec){const T=nv(S.videoCodec),A=nv(E.videoCodec);if(T!==A)return A-T}if(S.uri===E.uri&&S.codecSet!==E.codecSet){const T=Fu(S.codecSet),A=Fu(E.codecSet);if(T!==A)return A-T}return S.averageBitrate!==E.averageBitrate?S.averageBitrate-E.averageBitrate:0});let m=d[0];if(this.steering&&(h=this.steering.filterParsedLevels(h),h.length!==d.length)){for(let S=0;S<d.length;S++)if(d[S].pathwayId===h[0].pathwayId){m=d[S];break}}this._levels=h;for(let S=0;S<h.length;S++)if(h[S]===m){var p;this._firstLevel=S;const E=m.bitrate,T=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${h.length} level(s) found, first bitrate: ${E}`),((p=this.hls.userConfig)==null?void 0:p.abrEwmaDefaultEstimate)===void 0){const A=Math.min(E,this.hls.config.abrEwmaDefaultEstimateMax);A>T&&T===sE.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=A)}break}const v=o&&!a,x={levels:h,audioTracks:u,subtitleTracks:c,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:a,altAudio:!v&&u.some(S=>!!S.url)};this.hls.trigger(R.MANIFEST_PARSED,x),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const m=new Error("invalid level idx"),p=e<0;if(this.hls.trigger(R.ERROR,{type:Ae.OTHER_ERROR,details:ie.LEVEL_SWITCH_ERROR,level:e,fatal:p,error:m,reason:m.message}),p)return;e=Math.min(e,t.length-1)}const s=this.currentLevelIndex,a=this.currentLevel,o=a?a.attrs["PATHWAY-ID"]:void 0,u=t[e],c=u.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=u,s===e&&u.details&&a&&o===c)return;this.log(`Switching to level ${e} (${u.height?u.height+"p ":""}${u.videoRange?u.videoRange+" ":""}${u.codecSet?u.codecSet+" ":""}@${u.bitrate})${c?" with Pathway "+c:""} from level ${s}${o?" with Pathway "+o:""}`);const h={level:e,attrs:u.attrs,details:u.details,bitrate:u.bitrate,averageBitrate:u.averageBitrate,maxBitrate:u.maxBitrate,realBitrate:u.realBitrate,width:u.width,height:u.height,codecSet:u.codecSet,audioCodec:u.audioCodec,videoCodec:u.videoCodec,audioGroups:u.audioGroups,subtitleGroups:u.subtitleGroups,loaded:u.loaded,loadError:u.loadError,fragmentError:u.fragmentError,name:u.name,id:u.id,uri:u.uri,url:u.url,urlId:0,audioGroupIds:u.audioGroupIds,textGroupIds:u.textGroupIds};this.hls.trigger(R.LEVEL_SWITCHING,h);const d=u.details;if(!d||d.live){const m=this.switchParams(u.uri,a==null?void 0:a.details,d);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Be.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===be.MAIN){const s=t.elementaryStreams;if(!Object.keys(s).some(o=>!!s[o]))return;const a=this._levels[t.level];a!=null&&a.loadError&&(this.log(`Resetting level error count of ${a.loadError} on frag buffered`),a.loadError=0)}}onLevelLoaded(e,t){var s;const{level:a,details:o}=t,u=this._levels[a];if(!u){var c;this.warn(`Invalid level index ${a}`),(c=t.deliveryDirectives)!=null&&c.skip&&(o.deltaUpdateFailed=!0);return}a===this.currentLevelIndex?(u.fragmentError===0&&(u.loadError=0),this.playlistLoaded(a,t,u.details)):(s=t.deliveryDirectives)!=null&&s.skip&&(o.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,s=this.currentLevel;if(s&&this.shouldLoadPlaylist(s)){let a=s.uri;if(e)try{a=e.addDirectives(a)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}const o=s.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${o?" Pathway "+o:""} ${a}`),this.clearTimer(),this.hls.trigger(R.LEVEL_LOADING,{url:a,level:t,pathwayId:s.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const s=this._levels.filter((a,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(u=>u.level=-1)),!1));xS(s),this._levels=s,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(R.LEVELS_UPDATED,{levels:s})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:s}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(R.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:s}))}}function Wv(r){const e={};r.forEach(t=>{const s=t.groupId||"";t.id=e[s]=e[s]||0,e[s]++})}class iw{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const s in this.keyUriToKeyInfo){const a=this.keyUriToKeyInfo[s].loader;if(a){var t;if(e&&e!==((t=a.context)==null?void 0:t.frag.type))return;a.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=ie.KEY_LOAD_ERROR,s,a,o){return new bs({type:Ae.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:o,error:s,networkDetails:a})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:s,cc:a}=e;for(let o=0;o<t.length;o++){const u=t[o];if(a<=u.cc&&(s==="initSegment"||u.sn==="initSegment"||s<u.sn)){this.emeController.selectKeySystemFormat(u).then(c=>{u.setKeyFormat(c)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var s,a;t&&e.setKeyFormat(t);const o=e.decryptdata;if(!o){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,ie.KEY_LOAD_ERROR,d))}const u=o.uri;if(!u)return Promise.reject(this.createKeyLoadError(e,ie.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${u}"`)));let c=this.keyUriToKeyInfo[u];if((s=c)!=null&&s.decryptdata.key)return o.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});if((a=c)!=null&&a.keyLoadPromise){var h;switch((h=c.mediaKeySessionContext)==null?void 0:h.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return c.keyLoadPromise.then(d=>(o.key=d.keyInfo.decryptdata.key,{frag:e,keyInfo:c}))}}switch(c=this.keyUriToKeyInfo[u]={decryptdata:o,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},o.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return o.keyFormat==="identity"?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,ie.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${o.method}"`)))}}loadKeyEME(e,t){const s={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const a=this.emeController.loadKey(s);if(a)return(e.keyLoadPromise=a.then(o=>(e.mediaKeySessionContext=o,s))).catch(o=>{throw e.keyLoadPromise=null,o})}return Promise.resolve(s)}loadKeyHTTP(e,t){const s=this.config,a=s.loader,o=new a(s);return t.keyLoader=e.loader=o,e.keyLoadPromise=new Promise((u,c)=>{const h={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=s.keyLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(v,x,S,E)=>{const{frag:T,keyInfo:A,url:w}=S;if(!T.decryptdata||A!==this.keyUriToKeyInfo[w])return c(this.createKeyLoadError(T,ie.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),E));A.decryptdata.key=T.decryptdata.key=new Uint8Array(v.data),T.keyLoader=null,A.loader=null,u({frag:T,keyInfo:A})},onError:(v,x,S,E)=>{this.resetLoader(x),c(this.createKeyLoadError(t,ie.KEY_LOAD_ERROR,new Error(`HTTP Error ${v.code} loading key ${v.text}`),S,Lt({url:h.url,data:void 0},v)))},onTimeout:(v,x,S)=>{this.resetLoader(x),c(this.createKeyLoadError(t,ie.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),S))},onAbort:(v,x,S)=>{this.resetLoader(x),c(this.createKeyLoadError(t,ie.INTERNAL_ABORTED,new Error("key loading aborted"),S))}};o.load(h,m,p)})}resetLoader(e){const{frag:t,keyInfo:s,url:a}=e,o=s.loader;t.keyLoader===o&&(t.keyLoader=null,s.loader=null),delete this.keyUriToKeyInfo[a],o&&o.destroy()}}function nE(){return self.SourceBuffer||self.WebKitSourceBuffer}function rE(){if(!nr())return!1;const e=nE();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function sw(){if(!rE())return!1;const r=nr();return typeof(r==null?void 0:r.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>r.isTypeSupported(Co(e,"video")))||["mp4a.40.2","fLaC"].some(e=>r.isTypeSupported(Co(e,"audio"))))}function nw(){var r;const e=nE();return typeof(e==null||(r=e.prototype)==null?void 0:r.changeType)=="function"}const rw=250,Tu=2,aw=.1,ow=.05;class lw{constructor(e,t,s,a){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=s,this.hls=a}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:s,media:a,stalled:o}=this;if(a===null)return;const{currentTime:u,seeking:c}=a,h=this.seeking&&!c,d=!this.seeking&&c;if(this.seeking=c,u!==e){if(this.moved=!0,c||(this.nudgeRetry=0),o!==null){if(this.stallReported){const T=self.performance.now()-o;X.warn(`playback not stuck anymore @${u}, after ${Math.round(T)}ms`),this.stallReported=!1}this.stalled=null}return}if(d||h){this.stalled=null;return}if(a.paused&&!c||a.ended||a.playbackRate===0||!Ze.getBuffered(a).length){this.nudgeRetry=0;return}const m=Ze.bufferInfo(a,u,0),p=m.nextStart||0;if(c){const T=m.len>Tu,A=!p||t&&t.start<=u||p-u>Tu&&!this.fragmentTracker.getPartialFragment(u);if(T||A)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var v;if(!(m.len>0)&&!p)return;const A=Math.max(p,m.start||0)-u,w=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,k=(w==null||(v=w.details)==null?void 0:v.live)?w.details.targetduration*2:Tu,_=this.fragmentTracker.getPartialFragment(u);if(A>0&&(A<=k||_)){a.paused||this._trySkipBufferHole(_);return}}const x=self.performance.now();if(o===null){this.stalled=x;return}const S=x-o;if(!c&&S>=rw&&(this._reportStall(m),!this.media))return;const E=Ze.bufferInfo(a,u,s.maxBufferHole);this._tryFixBufferStall(E,S)}_tryFixBufferStall(e,t){const{config:s,fragmentTracker:a,media:o}=this;if(o===null)return;const u=o.currentTime,c=a.getPartialFragment(u);c&&(this._trySkipBufferHole(c)||!this.media)||(e.len>s.maxBufferHole||e.nextStart&&e.nextStart-u<s.maxBufferHole)&&t>s.highBufferWatchdogPeriod*1e3&&(X.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:s,stallReported:a}=this;if(!a&&s){this.stallReported=!0;const o=new Error(`Playback stalling at @${s.currentTime} due to low buffer (${JSON.stringify(e)})`);X.warn(o.message),t.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:s,media:a}=this;if(a===null)return 0;const o=a.currentTime,u=Ze.bufferInfo(a,o,0),c=o<u.start?u.start:u.nextStart;if(c){const h=u.len<=t.maxBufferHole,d=u.len>0&&u.len<1&&a.readyState<3,m=c-o;if(m>0&&(h||d)){if(m>t.maxBufferHole){const{fragmentTracker:v}=this;let x=!1;if(o===0){const S=v.getAppendedFrag(0,be.MAIN);S&&c<S.end&&(x=!0)}if(!x){const S=e||v.getAppendedFrag(o,be.MAIN);if(S){let E=!1,T=S.end;for(;T<c;){const A=v.getPartialFragment(T);if(A)T+=A.duration;else{E=!0;break}}if(E)return 0}}}const p=Math.max(c+ow,o+aw);if(X.warn(`skipping hole, adjusting currentTime from ${o} to ${p}`),this.moved=!0,this.stalled=null,a.currentTime=p,e&&!e.gap){const v=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${p}`);s.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,frag:e})}return p}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:s,nudgeRetry:a}=this;if(s===null)return;const o=s.currentTime;if(this.nudgeRetry++,a<e.nudgeMaxRetry){const u=o+(a+1)*e.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${o} to ${u}`);X.warn(c.message),s.currentTime=u,t.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1})}else{const u=new Error(`Playhead still not moving while enough data buffered @${o} after ${e.nudgeMaxRetry} nudges`);X.error(u.message),t.trigger(R.ERROR,{type:Ae.MEDIA_ERROR,details:ie.BUFFER_STALLED_ERROR,error:u,fatal:!0})}}}const uw=100;class cw extends l0{constructor(e,t,s){super(e,t,s,"[stream-controller]",be.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(R.ERROR,this.onError,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(R.ERROR,this.onError,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:s}=this;if(this.stopLoad(),this.setInterval(uw),this.level=-1,!this.startFragRequested){let a=s.startLevel;a===-1&&(s.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=s.firstAutoLevel),s.nextLoadLevel=a,this.level=s.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=ce.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=ce.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ce.WAITING_LEVEL:{const{levels:t,level:s}=this,a=t==null?void 0:t[s],o=a==null?void 0:a.details;if(o&&(!o.live||this.levelLastLoaded===a)){if(this.waitForCdnTuneIn(o))break;this.state=ce.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ce.IDLE;break}break}case ce.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),s=this.retryDate;if(!s||t>=s||(e=this.media)!=null&&e.seeking){const{levels:a,level:o}=this,u=a==null?void 0:a[o];this.resetStartWhenNotLoaded(u||null),this.state=ce.IDLE}}break}this.state===ce.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:s,media:a}=this;if(t===null||!a&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const o=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(s!=null&&s[o]))return;const u=s[o],c=this.getMainFwdBufferInfo();if(c===null)return;const h=this.getLevelDetails();if(h&&this._streamEnded(c,h)){const E={};this.altAudio&&(E.type="video"),this.hls.trigger(R.BUFFER_EOS,E),this.state=ce.ENDED;return}if(!this.buffering)return;e.loadLevel!==o&&e.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const d=u.details;if(!d||this.state===ce.WAITING_LEVEL||d.live&&this.levelLastLoaded!==u){this.level=o,this.state=ce.WAITING_LEVEL;return}const m=c.len,p=this.getMaxBufferLength(u.maxBitrate);if(m>=p)return;this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);const v=this.backtrackFragment?this.backtrackFragment.start:c.end;let x=this.getNextFragment(v,d);if(this.couldBacktrack&&!this.fragPrevious&&x&&x.sn!=="initSegment"&&this.fragmentTracker.getState(x)!==Rt.OK){var S;const T=((S=this.backtrackFragment)!=null?S:x).sn-d.startSN,A=d.fragments[T-1];A&&x.cc===A.cc&&(x=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(x&&this.isLoopLoading(x,v)){if(!x.gap){const T=this.audioOnly&&!this.altAudio?ze.AUDIO:ze.VIDEO,A=(T===ze.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,T,be.MAIN)}x=this.getNextFragmentLoopLoading(x,d,c,be.MAIN,p)}x&&(x.initSegment&&!x.initSegment.data&&!this.bitrateTest&&(x=x.initSegment),this.loadFragment(x,u,v))}loadFragment(e,t,s){const a=this.fragmentTracker.getState(e);this.fragCurrent=e,a===Rt.NOT_LOADED||a===Rt.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,s)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,be.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let s;const a=this.getAppendedFrag(t.currentTime);a&&a.start>1&&this.flushMainBuffer(0,a.start-1);const o=this.getLevelDetails();if(o!=null&&o.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<o.targetduration*2)return}if(!t.paused&&e){const c=this.hls.nextLoadLevel,h=e[c],d=this.fragLastKbps;d&&this.fragCurrent?s=this.fragCurrent.duration*h.maxBitrate/(1e3*d)+1:s=0}else s=0;const u=this.getBufferedFrag(t.currentTime+s);if(u){const c=this.followingBufferedFrag(u);if(c){this.abortCurrentFrag();const h=c.maxStartPTS?c.maxStartPTS:c.start,d=c.duration,m=Math.max(u.end,h+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ce.KEY_LOADING:case ce.FRAG_LOADING:case ce.FRAG_LOADING_WAITING_RETRY:case ce.PARSING:case ce.PARSED:this.state=ce.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const s=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),s.addEventListener("playing",this.onvplaying),s.addEventListener("seeked",this.onvseeked),this.gapController=new lw(this.config,s,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;ye(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const s=this.getMainFwdBufferInfo();if(s===null||s.len===0){this.warn(`Main forward buffer length on "seeked" event ${s?s.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(R.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let s=!1,a=!1;t.levels.forEach(o=>{const u=o.audioCodec;u&&(s=s||u.indexOf("mp4a.40.2")!==-1,a=a||u.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=s&&a&&!nw(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:s}=this;if(!s||this.state!==ce.IDLE)return;const a=s[t.level];(!a.details||a.details.live&&this.levelLastLoaded!==a||this.waitForCdnTuneIn(a.details))&&(this.state=ce.WAITING_LEVEL)}onLevelLoaded(e,t){var s;const{levels:a}=this,o=t.level,u=t.details,c=u.totalduration;if(!a){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${c}`);const h=a[o],d=this.fragCurrent;d&&(this.state===ce.FRAG_LOADING||this.state===ce.FRAG_LOADING_WAITING_RETRY)&&d.level!==t.level&&d.loader&&this.abortCurrentFrag();let m=0;if(u.live||(s=h.details)!=null&&s.live){var p;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;m=this.alignPlaylists(u,h.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(h.details=u,this.levelLastLoaded=h,this.hls.trigger(R.LEVEL_UPDATED,{details:u,level:o}),this.state===ce.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=ce.IDLE}this.startFragRequested?u.live&&this.synchronizeToLiveEdge(u):this.setStartPosition(u,m),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:s,part:a,payload:o}=e,{levels:u}=this;if(!u){this.warn(`Levels were reset while fragment load was in progress. Fragment ${s.sn} of level ${s.level} will not be buffered`);return}const c=u[s.level],h=c.details;if(!h){this.warn(`Dropping fragment ${s.sn} of level ${s.level} after level details were reset`),this.fragmentTracker.removeFragment(s);return}const d=c.videoCodec,m=h.PTSKnown||!h.live,p=(t=s.initSegment)==null?void 0:t.data,v=this._getAudioCodec(c),x=this.transmuxer=this.transmuxer||new BS(this.hls,be.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),S=a?a.index:-1,E=S!==-1,T=new a0(s.level,s.sn,s.stats.chunkCount,o.byteLength,S,E),A=this.initPTS[s.cc];x.push(o,p,v,d,s,a,h.totalduration,m,T,A)}onAudioTrackSwitching(e,t){const s=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const u=this.fragCurrent;u&&(this.log("Switching to main audio track, cancel main fragment load"),u.abortRequests(),this.fragmentTracker.removeFragment(u)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const o=this.hls;s&&(o.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),o.trigger(R.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const s=t.id,a=!!this.hls.audioTracks[s].url;if(a){const o=this.videoBuffer;o&&this.mediaBuffer!==o&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=o)}this.altAudio=a,this.tick()}onBufferCreated(e,t){const s=t.tracks;let a,o,u=!1;for(const c in s){const h=s[c];if(h.id==="main"){if(o=c,a=h,c==="video"){const d=s[c];d&&(this.videoBuffer=d.buffer)}}else u=!0}u&&a?(this.log(`Alternate track found, use ${o}.buffered to schedule main fragment loading`),this.mediaBuffer=a.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:s,part:a}=t;if(s&&s.type!==be.MAIN)return;if(this.fragContextChanged(s)){this.warn(`Fragment ${s.sn}${a?" p: "+a.index:""} of level ${s.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ce.PARSED&&(this.state=ce.IDLE);return}const o=a?a.stats:s.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),s.sn!=="initSegment"&&(this.fragPrevious=s),this.fragBufferedComplete(s,a)}onError(e,t){var s;if(t.fatal){this.state=ce.ERROR;return}switch(t.details){case ie.FRAG_GAP:case ie.FRAG_PARSING_ERROR:case ie.FRAG_DECRYPT_ERROR:case ie.FRAG_LOAD_ERROR:case ie.FRAG_LOAD_TIMEOUT:case ie.KEY_LOAD_ERROR:case ie.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(be.MAIN,t);break;case ie.LEVEL_LOAD_ERROR:case ie.LEVEL_LOAD_TIMEOUT:case ie.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ce.WAITING_LEVEL&&((s=t.context)==null?void 0:s.type)===Be.LEVEL&&(this.state=ce.IDLE);break;case ie.BUFFER_APPEND_ERROR:case ie.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===ie.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case ie.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Ze.getBuffered(e).length){const s=this.state!==ce.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,s)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=ce.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==ze.AUDIO||this.audioOnly&&!this.altAudio){const s=(t===ze.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(s,t,be.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let s=this.startPosition;if(s>=0&&t<s){if(e.seeking){this.log(`could not seek to ${s}, already seeking at ${t}`);return}const a=Ze.getBuffered(e),u=(a.length?a.start(0):0)-s;u>0&&(u<this.config.maxBufferHole||u<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${u} to match buffer start`),s+=u,this.startPosition=s),this.log(`seek to target start position ${s} from current time ${t}`),e.currentTime=s}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(s=>{const{hls:a}=this;if(!s||this.fragContextChanged(e))return;t.fragmentError=0,this.state=ce.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=e.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),a.trigger(R.FRAG_LOADED,s),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const s="main",{hls:a}=this,{remuxResult:o,chunkMeta:u}=e,c=this.getCurrentContext(u);if(!c){this.resetWhenMissingContext(u);return}const{frag:h,part:d,level:m}=c,{video:p,text:v,id3:x,initSegment:S}=o,{details:E}=m,T=this.altAudio?void 0:o.audio;if(this.fragContextChanged(h)){this.fragmentTracker.removeFragment(h);return}if(this.state=ce.PARSING,S){if(S!=null&&S.tracks){const C=h.initSegment||h;this._bufferInitSegment(m,S.tracks,C,u),a.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:C,id:s,tracks:S.tracks})}const A=S.initPTS,w=S.timescale;ye(A)&&(this.initPTS[h.cc]={baseTime:A,timescale:w},a.trigger(R.INIT_PTS_FOUND,{frag:h,id:s,initPTS:A,timescale:w}))}if(p&&E&&h.sn!=="initSegment"){const A=E.fragments[h.sn-1-E.startSN],w=h.sn===E.startSN,C=!A||h.cc>A.cc;if(o.independent!==!1){const{startPTS:k,endPTS:_,startDTS:U,endDTS:B}=p;if(d)d.elementaryStreams[p.type]={startPTS:k,endPTS:_,startDTS:U,endDTS:B};else if(p.firstKeyFrame&&p.independent&&u.id===1&&!C&&(this.couldBacktrack=!0),p.dropped&&p.independent){const M=this.getMainFwdBufferInfo(),D=(M?M.end:this.getLoadPosition())+this.config.maxBufferHole,N=p.firstKeyFramePTS?p.firstKeyFramePTS:k;if(!w&&D<N-this.config.maxBufferHole&&!C){this.backtrack(h);return}else C&&(h.gap=!0);h.setElementaryStreamInfo(p.type,h.start,_,h.start,B,!0)}else w&&k>Tu&&(h.gap=!0);h.setElementaryStreamInfo(p.type,k,_,U,B),this.backtrackFragment&&(this.backtrackFragment=h),this.bufferFragmentData(p,h,d,u,w||C)}else if(w||C)h.gap=!0;else{this.backtrack(h);return}}if(T){const{startPTS:A,endPTS:w,startDTS:C,endDTS:k}=T;d&&(d.elementaryStreams[ze.AUDIO]={startPTS:A,endPTS:w,startDTS:C,endDTS:k}),h.setElementaryStreamInfo(ze.AUDIO,A,w,C,k),this.bufferFragmentData(T,h,d,u)}if(E&&x!=null&&(t=x.samples)!=null&&t.length){const A={id:s,frag:h,details:E,samples:x.samples};a.trigger(R.FRAG_PARSING_METADATA,A)}if(E&&v){const A={id:s,frag:h,details:E,samples:v.samples};a.trigger(R.FRAG_PARSING_USERDATA,A)}}_bufferInitSegment(e,t,s,a){if(this.state!==ce.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:o,video:u,audiovideo:c}=t;if(o){let h=e.audioCodec;const d=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){h&&(h.indexOf("mp4a.40.5")!==-1?h="mp4a.40.2":h="mp4a.40.5");const m=o.metadata;m&&"channelCount"in m&&(m.channelCount||1)!==1&&d.indexOf("firefox")===-1&&(h="mp4a.40.5")}h&&h.indexOf("mp4a.40.5")!==-1&&d.indexOf("android")!==-1&&o.container!=="audio/mpeg"&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),e.audioCodec&&e.audioCodec!==h&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${h}"`),o.levelCodec=h,o.id="main",this.log(`Init audio buffer, container:${o.container}, codecs[selected/level/parsed]=[${h||""}/${e.audioCodec||""}/${o.codec}]`)}u&&(u.levelCodec=e.videoCodec,u.id="main",this.log(`Init video buffer, container:${u.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u.codec}]`)),c&&this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.codecs}/${c.codec}]`),this.hls.trigger(R.BUFFER_CODECS,t),Object.keys(t).forEach(h=>{const m=t[h].initSegment;m!=null&&m.byteLength&&this.hls.trigger(R.BUFFER_APPENDING,{type:h,data:m,frag:s,part:null,chunkMeta:a,parent:s.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,be.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ce.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const s=e.currentTime;if(Ze.isBuffered(e,s)?t=this.getAppendedFrag(s):Ze.isBuffered(e,s+.1)&&(t=this.getAppendedFrag(s+.1)),t){this.backtrackFragment=null;const a=this.fragPlaying,o=t.level;(!a||t.sn!==a.sn||a.level!==o)&&(this.fragPlaying=t,this.hls.trigger(R.FRAG_CHANGED,{frag:t}),(!a||a.level!==o)&&this.hls.trigger(R.LEVEL_SWITCHED,{level:o}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,s=this.currentFrag;if(s&&ye(t)&&ye(s.programDateTime)){const a=s.programDateTime+(t-s.start)*1e3;return new Date(a)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class mn{static get version(){return"1.5.20"}static isMSESupported(){return rE()}static isSupported(){return sw()}static getMediaSource(){return nr()}static get Events(){return R}static get ErrorTypes(){return Ae}static get ErrorDetails(){return ie}static get DefaultConfig(){return mn.defaultConfig?mn.defaultConfig:sE}static set DefaultConfig(e){mn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new d0,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,ZR(e.debug||!1,"Hls instance");const t=this.config=JC(mn.DefaultConfig,e);this.userConfig=e,t.progressive&&ew(t);const{abrController:s,bufferController:a,capLevelController:o,errorController:u,fpsController:c}=t,h=new u(this),d=this.abrController=new s(this),m=this.bufferController=new a(this),p=this.capLevelController=new o(this),v=new c(this),x=new zL(this),S=new WL(this),E=t.contentSteeringController,T=E?new E(this):null,A=this.levelController=new tw(this,T),w=new L_(this),C=new iw(this.config),k=this.streamController=new cw(this,w,C);p.setStreamController(k),v.setStreamController(k);const _=[x,A,k];T&&_.splice(1,0,T),this.networkControllers=_;const U=[d,m,p,v,S,w];this.audioTrackController=this.createController(t.audioTrackController,_);const B=t.audioStreamController;B&&_.push(new B(this,w,C)),this.subtitleTrackController=this.createController(t.subtitleTrackController,_);const M=t.subtitleStreamController;M&&_.push(new M(this,w,C)),this.createController(t.timelineController,U),C.emeController=this.emeController=this.createController(t.emeController,U),this.cmcdController=this.createController(t.cmcdController,U),this.latencyController=this.createController(ZL,U),this.coreComponents=U,_.push(h);const D=h.onErrorOut;typeof D=="function"&&this.on(R.ERROR,D,h)}createController(e,t){if(e){const s=new e(this);return t&&t.push(s),s}return null}on(e,t,s=this){this._emitter.on(e,t,s)}once(e,t,s=this){this._emitter.once(e,t,s)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,s=this,a){this._emitter.off(e,t,s,a)}listeners(e){return this._emitter.listeners(e)}emit(e,t,s){return this._emitter.emit(e,t,s)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(s){if(X.error("An internal error happened while handling event "+e+'. Error message: "'+s.message+'". Here is a stacktrace:',s),!this.triggeringException){this.triggeringException=!0;const a=e===R.ERROR;this.trigger(R.ERROR,{type:Ae.OTHER_ERROR,details:ie.INTERNAL_EXCEPTION,fatal:a,event:e,error:s}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){X.log("destroy"),this.trigger(R.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){X.log("attachMedia"),this._media=e,this.trigger(R.MEDIA_ATTACHING,{media:e})}detachMedia(){X.log("detachMedia"),this.trigger(R.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,s=this.url,a=this.url=e0.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,X.log(`loadSource:${a}`),t&&s&&(s!==a||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(R.MANIFEST_LOADING,{url:e})}startLoad(e=-1){X.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),!(!this.started||!this.networkControllers));t++);}stopLoad(){X.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}resumeBuffering(){X.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()})}pauseBuffering(){X.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()})}swapAudioCodec(){X.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){X.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){X.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){X.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){X.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){X.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){X.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(X.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){JL(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const s=e.length;for(let a=0;a<s;a++)if(e[a].maxBitrate>=t)return a;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:s}=this;let a;if(t===-1&&e!=null&&e.length?a=e.length-1:a=t,s)for(let o=a;o--;){const u=e[o].attrs["HDCP-LEVEL"];if(u&&u<=s)return o}return a}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}mn.defaultConfig=void 0;const fw={debug:!1,enableWorker:!0,autoStartLoad:!0,startLevel:-1,manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:1e4,timeoutRetry:{maxNumRetry:3,retryDelayMs:1e3,maxRetryDelayMs:0},errorRetry:{maxNumRetry:3,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:1e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:2e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},maxBufferSize:0,maxBufferLength:30,maxMaxBufferLength:600,progressive:!1,lowLatencyMode:!1,enableSoftwareAES:!0,abrEwmaDefaultEstimate:5e5,backBufferLength:90},aE=fe.memo(({title:r})=>L.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 p-4 bg-gradient-to-b from-black/80 to-transparent",children:L.jsx("h1",{className:"text-white text-xl font-medium",children:r})}));aE.displayName="TitleOverlay";const oE=fe.memo(()=>L.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80",children:L.jsx("div",{className:"text-sky-200",children:"Loading..."})}));oE.displayName="LoadingOverlay";const hw=async r=>{console.log("Logging playback event:",r)};function dw({url:r,useHlsJs:e,title:t,playing:s=!1,startTime:a=0,onPlay:o,onPause:u,onEnded:c,onError:h,onProgress:d,onQualitiesLoaded:m}){const p=fe.useRef(null),v=fe.useRef(null),[x,S]=fe.useState(!0),[E,T]=fe.useState(null),[A,w]=fe.useState(!1),{mutate:C}=bA({mutationFn:hw,onError:P=>{console.warn("Failed to log playback event:",P)}}),k=fe.useCallback(()=>S(!0),[]),_=fe.useCallback(()=>S(!1),[]);fe.useEffect(()=>{w(!1)},[r]);const U=fe.useCallback(async()=>{const P=p.current;if(!(!P||A))try{P.currentTime=a,w(!0),s&&await P.play()}catch(G){console.error("Failed to set start time or play:",G),T(G instanceof Error?G:new Error("Playback failed"))}},[a,s,A]),B=fe.useCallback(()=>{_(),U()},[_,U]),M=fe.useCallback(()=>{if(!A){U();return}C({url:r,type:"play",timestamp:Date.now()}),o==null||o()},[r,C,o,A,U]),D=fe.useCallback(P=>{const G=P.currentTarget;d==null||d({played:G.currentTime/G.duration,playedSeconds:G.currentTime,loaded:G.buffered.length?G.buffered.end(0)/G.duration:0,loadedSeconds:G.buffered.length?G.buffered.end(0):0})},[d]),N=fe.useCallback(P=>{const G=p.current;if(G)switch(P.key.toLowerCase()){case" ":P.preventDefault(),G.paused?G.play():G.pause();break;case"arrowleft":P.preventDefault(),G.currentTime=Math.max(0,G.currentTime-10);break;case"arrowright":P.preventDefault(),G.currentTime=Math.min(G.duration,G.currentTime+10);break;case"arrowup":P.preventDefault(),G.volume=Math.min(1,G.volume+.1);break;case"arrowdown":P.preventDefault(),G.volume=Math.max(0,G.volume-.1);break;case"m":P.preventDefault(),G.muted=!G.muted;break;case"f":P.preventDefault(),document.fullscreenElement?document.exitFullscreen():G.requestFullscreen();break}},[]);return fe.useEffect(()=>{if(!p.current)return;if(!e){p.current.src=r;return}if(!mn.isSupported()){console.error("HLS.js is not supported"),T(new Error("HLS.js is not supported in this browser"));return}v.current&&v.current.destroy();const P=new mn(fw);v.current=P,P.attachMedia(p.current);const G=()=>{_(),U()},J=()=>{const Q=P.levels.map($=>({width:$.width,height:$.height,bitrate:$.bitrate}));m==null||m(Q)},z=(Q,$)=>{if($.fatal){const oe=new Error(`HLS.js Error: ${$.type}`);switch(console.error(oe,$),C({url:r,type:"error",timestamp:Date.now(),error:oe}),$.type){case Ae.NETWORK_ERROR:P.startLoad();break;case Ae.MEDIA_ERROR:P.recoverMediaError();break;default:P.destroy(),T(oe);break}h==null||h(oe)}};return P.on(R.MEDIA_ATTACHED,()=>{P.loadSource(r)}),P.on(R.MANIFEST_PARSED,G),P.on(R.LEVEL_LOADED,J),P.on(R.ERROR,z),()=>{P.off(R.MANIFEST_PARSED,G),P.off(R.LEVEL_LOADED,J),P.off(R.ERROR,z),P.destroy()}},[r,e,_,U,m,C,h]),fe.useEffect(()=>(window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)),[N]),E?L.jsx("div",{className:"relative w-full h-full flex items-center justify-center bg-slate-900",children:L.jsxs("div",{className:"text-red-500",children:[L.jsx("h3",{className:"font-medium",children:"Error playing video"}),L.jsx("p",{className:"text-sm opacity-75",children:E.message})]})}):L.jsxs("div",{className:"relative w-full h-full bg-black rounded-lg overflow-hidden shadow-2xl",children:[t&&L.jsx(aE,{title:t}),x&&L.jsx(oE,{}),L.jsx("video",{ref:p,controls:!0,playsInline:!0,style:{width:"100%",height:"100%"},onPlay:M,onPause:u,onEnded:c,onTimeUpdate:D,onLoadedData:B,onSeeking:k,onSeeked:_,onWaiting:k,onPlaying:_})]})}const mw=fe.memo(dw),$d=ts("/movies/$movieID/play")({validateSearch:r=>({title:String(r.title??"unknown"),pid:String(r.pid??"unknown")}),loaderDeps:({search:r})=>r,component:gw});function gw(){const{movieID:r}=$d.useParams(),{pid:e,title:t}=$d.useLoaderDeps();return fe.useEffect(()=>()=>{window.confirm("are you sure you wish to stop playback?")&&fetch(`/api/v1/ffmpeg/jobs/cancel/${e}`,{method:"delete",credentials:"include"}).then(s=>alert(`${s.status} - ${s.statusText}`))},[e]),L.jsx("div",{className:"min-h-screen bg-slate-900 flex flex-col",children:L.jsx("div",{className:"flex-1 flex items-center justify-center p-4 md:p-8",children:L.jsx("div",{className:"w-full max-w-7xl aspect-video",children:L.jsx(mw,{url:`/api/v1/hls/movies/${r}/playlist.m3u8`,useHlsJs:$R(),title:t,startTime:300,onError:s=>{console.error("Playback Error:",s)}})})})})}const pw=ts("/login")(),yw=ts("/settings/")(),vw=ts("/settings/users/create")(),xw=pw.update({id:"/login",path:"/login",getParentRoute:()=>Pi}).lazy(()=>Xu(()=>import("./login.lazy-BH8sXQWU.js"),[]).then(r=>r.Route)),Sw=oR.update({id:"/",path:"/",getParentRoute:()=>Pi}),Ew=yw.update({id:"/settings/",path:"/settings/",getParentRoute:()=>Pi}).lazy(()=>Xu(()=>import("./index.lazy-BjIIZmBY.js"),[]).then(r=>r.Route)),Tw=uR.update({id:"/tvshows/",path:"/tvshows/",getParentRoute:()=>Pi}),bw=fR.update({id:"/music/",path:"/music/",getParentRoute:()=>Pi}),Aw=Ld.update({id:"/movies/",path:"/movies/",getParentRoute:()=>Pi}),Rw=mu.update({id:"/settings/users/",path:"/settings/users/",getParentRoute:()=>Pi}),Lw=_d.update({id:"/movies/$movieID/",path:"/movies/$movieID/",getParentRoute:()=>Pi}),_w=vw.update({id:"/settings/users/create",path:"/settings/users/create",getParentRoute:()=>Pi}).lazy(()=>Xu(()=>import("./create.lazy-BIRripci.js"),[]).then(r=>r.Route)),Dw=$d.update({id:"/movies/$movieID/play",path:"/movies/$movieID/play",getParentRoute:()=>Pi}),Cw={IndexRoute:Sw,LoginLazyRoute:xw,MoviesIndexRoute:Aw,MusicIndexRoute:bw,TvshowsIndexRoute:Tw,SettingsIndexLazyRoute:Ew,MoviesMovieIDPlayRoute:Dw,SettingsUsersCreateLazyRoute:_w,MoviesMovieIDIndexRoute:Lw,SettingsUsersIndexRoute:Rw},ww=Pi._addFileChildren(Cw)._addFileTypes(),lE=F1({routeTree:ww,defaultPreload:"intent",defaultErrorComponent:({error:r})=>L.jsx("div",{className:"flex h-screen w-screen items-center justify-center",children:L.jsxs("div",{className:"text-center",children:[L.jsx("h1",{className:"text-2xl font-bold text-red-500",children:"Error"}),L.jsx("p",{className:"mt-2 text-gray-600",children:r.message})]})})});lE.subscribe("onResolved",()=>{window.scrollTo(0,0)});Fb.createRoot(document.getElementById("root")).render(L.jsx(fe.StrictMode,{children:L.jsx(H1,{router:lE})}));export{nR as E,Fw as F,zr as L,rR as S,Yd as a,$A as b,Mw as c,Pw as d,Uw as e,Jd as f,Nw as g,qA as h,ws as i,L as j,lx as k,fe as r,iR as u};

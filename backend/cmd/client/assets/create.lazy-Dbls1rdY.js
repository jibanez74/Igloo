import{c as L,r as n,a as U,j as e,S as P,E as S,f as R,F as y,g as C,b as I,d as q,h as A}from"./index-BmZi4aXC.js";const D=10*1024*1024,O=["image/jpeg","image/png","image/gif"],M=L("/settings/users/create")({component:T});function T(){const[a,x]=n.useState(null),[p,f]=n.useState(null),[t,b]=n.useState(!1),[m,c]=n.useState(""),[j,u]=n.useState(!1),w=U();n.useEffect(()=>()=>{a&&a.startsWith("blob:")&&URL.revokeObjectURL(a)},[a]),n.useEffect(()=>{if(m){u(!0);const r=setTimeout(()=>{u(!1),setTimeout(()=>c(""),300)},6e3);return()=>clearTimeout(r)}},[m]);const k=r=>r.size>D?"File size too large. Maximum size is 10MB":O.includes(r.type)?null:"Invalid file type. Allowed types: JPG, PNG, GIF",v=r=>{var i;const s=(i=r.target.files)==null?void 0:i[0];if(s){const l=k(s);if(l){c(l);return}a&&a.startsWith("blob:")&&URL.revokeObjectURL(a),f(s);const o=URL.createObjectURL(s);x(o)}},N=()=>{a&&a.startsWith("blob:")&&URL.revokeObjectURL(a),x(null),f(null)},F=r=>{const s=r.get("name"),i=r.get("username"),l=r.get("email"),o=r.get("password");return s!=null&&s.trim()?i!=null&&i.trim()?l!=null&&l.trim()?o!=null&&o.trim()?o.length<8?"Password must be at least 8 characters long":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)?null:"Please enter a valid email address":"Password is required":"Email is required":"Username is required":"Name is required"},E=async r=>{r.preventDefault(),b(!0),c(""),u(!1);try{const s=new FormData(r.currentTarget),i=F(s);if(i)throw new Error(i);let l="";if(p){const d=new FormData;d.append("photo",p);const g=await fetch("/api/v1/users/upload-photo",{method:"POST",body:d});if(!g.ok)throw new Error("Failed to upload profile photo");l=(await g.json()).path}const o={name:s.get("name"),username:s.get("username"),email:s.get("email"),password:s.get("password"),isAdmin:s.get("isAdmin")==="on",isActive:!0,thumb:l},h=await fetch("/api/v1/users/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!h.ok){const d=await h.json();throw new Error(d.error||"Failed to create user")}w({to:"/settings/users",search:{page:1,limit:10}})}catch(s){c(s instanceof Error?s.message:"Failed to create user")}finally{b(!1)}};return e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsx("section",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 shadow-lg",children:[e.jsxs("header",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Create New User"}),e.jsx("p",{className:"mt-2 text-sky-200",children:"Fill in the information to create a new user account."})]}),t&&e.jsx(P,{size:"lg"})]}),e.jsx(S,{error:m,isVisible:j}),e.jsxs("form",{className:"space-y-6",onSubmit:E,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"photo",className:"block text-sm font-medium text-sky-200 mb-2",children:"Profile Photo"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"relative w-24 h-24 rounded-lg bg-slate-900/50 border border-sky-200/10 overflow-hidden",children:a?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:a,alt:"Profile preview",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:N,disabled:t,className:`absolute top-1 right-1 p-1 rounded-full bg-slate-900/80 text-sky-200 
                                 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:e.jsx(R,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(y,{className:"w-8 h-8 text-sky-400/50"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{htmlFor:"photo-upload",className:`group relative flex items-center justify-center w-full h-24 border-2 
                             border-dashed border-sky-200/10 rounded-lg hover:border-sky-200/20 
                             transition-colors cursor-pointer ${t?"opacity-50 cursor-not-allowed":""}`,children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(C,{className:"w-6 h-6 text-sky-400/50 group-hover:text-sky-400/70 transition-colors"}),e.jsx("span",{className:"text-sm text-sky-200",children:a?"Change photo":"Upload photo"})]}),e.jsx("input",{type:"file",id:"photo-upload",accept:"image/*",onChange:v,disabled:t,className:"hidden"})]}),e.jsx("p",{className:"mt-2 text-xs text-sky-200/70",children:"JPG, PNG or GIF (max. 2MB)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-sky-200 mb-2",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(y,{className:"h-5 w-5 text-sky-400/50","aria-hidden":"true"})}),e.jsx("input",{type:"text",id:"name",name:"name",autoFocus:!0,disabled:t,className:`block w-full pl-10 pr-3 py-2.5 bg-slate-900/50 border border-sky-200/10 rounded-lg 
                           text-white placeholder:text-sky-200/50 
                           focus:outline-none focus:ring-2 focus:ring-sky-500/40 focus:border-transparent
                           transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,placeholder:"John Doe",required:!0,maxLength:60})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-sky-200 mb-2",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-sky-400/50",children:"@"})}),e.jsx("input",{type:"text",id:"username",name:"username",disabled:t,className:`block w-full pl-10 pr-3 py-2.5 bg-slate-900/50 border border-sky-200/10 rounded-lg 
                           text-white placeholder:text-sky-200/50 
                           focus:outline-none focus:ring-2 focus:ring-sky-500/40 focus:border-transparent
                           transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,placeholder:"johndoe",required:!0,maxLength:20})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-sky-200 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-sky-400/50","aria-hidden":"true"})}),e.jsx("input",{type:"email",id:"email",name:"email",disabled:t,className:`block w-full pl-10 pr-3 py-2.5 bg-slate-900/50 border border-sky-200/10 rounded-lg 
                           text-white placeholder:text-sky-200/50 
                           focus:outline-none focus:ring-2 focus:ring-sky-500/40 focus:border-transparent
                           transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,placeholder:"john@example.com",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-sky-200 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{className:"h-5 w-5 text-sky-400/50","aria-hidden":"true"})}),e.jsx("input",{type:"password",id:"password",name:"password",disabled:t,className:`block w-full pl-10 pr-3 py-2.5 bg-slate-900/50 border border-sky-200/10 rounded-lg 
                           text-white placeholder:text-sky-200/50 
                           focus:outline-none focus:ring-2 focus:ring-sky-500/40 focus:border-transparent
                           transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,placeholder:"••••••••",required:!0,minLength:9,maxLength:128})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-sky-400/50","aria-hidden":"true"}),e.jsx("span",{className:"text-sm font-medium text-sky-200",children:"Admin Privileges"})]}),e.jsxs("label",{className:`relative inline-flex items-center ${t?"cursor-not-allowed":"cursor-pointer"}`,children:[e.jsx("input",{type:"checkbox",disabled:t,className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 bg-slate-900/50 peer-focus:outline-none peer-focus:ring-2 
                              peer-focus:ring-sky-500/40 rounded-full peer 
                              peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full 
                              peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] 
                              after:start-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 
                              after:transition-all peer-checked:bg-sky-500/50 ${t?"opacity-50":""}`})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4",children:[e.jsx("button",{type:"button",disabled:t,className:`px-4 py-2 text-sm font-medium text-sky-200 hover:text-white transition-colors
                         disabled:opacity-50 disabled:cursor-not-allowed`,onClick:()=>window.history.back(),children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:`px-4 py-2 text-sm font-medium text-white bg-sky-500/20 rounded-lg 
                         hover:bg-sky-500/30 focus:outline-none focus:ring-2 focus:ring-sky-500/40 
                         transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:t?"Creating...":"Create User"})]})]})]})})})}export{M as Route};

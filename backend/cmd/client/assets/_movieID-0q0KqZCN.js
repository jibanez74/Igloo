import{t as v,i as t,b as c,l as P,z as p,f as O,s as w,A as ie,x as oe,r as J,B as W,S as de,C as B,h as M,m as ce,D as ue,E as ve,G as q,a as Q,H as ge,I as me,J as fe,K as be,n as he,N as xe,P as $e,Q as Z}from"./index-BeYixZIP.js";import{g as T}from"./getImgSrc-ClS6Ftii.js";function pe(l){const s=["January","February","March","April","May","June","July","August","September","October","November","December"],e=new Date(l).getDate(),i=new Date(l).getFullYear();return`${s[new Date(l).getMonth()]} ${e}, ${i}`}function _e(l){const s=Math.floor(l/60),e=l%60;return`${s}h ${e}m`}function ee(l){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(l)}var ye=v('<div class=mb-12><h3 class="text-lg font-medium text-sky-200 mb-4">Cast</h3><div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">'),we=v('<div class=text-center><div class="aspect-[2/3] mb-2 rounded-lg bg-slate-800/50 overflow-hidden"></div><div class="text-sm font-medium text-white"></div><div class="text-xs text-sky-200">'),ke=v('<img class="w-full h-full object-cover"loading=lazy>',!0,!1,!1),Ce=v('<div class="w-full h-full flex items-center justify-center bg-slate-800/50"><span class=text-sky-200/50>No Image');function Se(l){const s=l.cast.slice(0,12);return(()=>{var e=ye(),i=e.firstChild,n=i.nextSibling;return t(n,c(P,{each:s,children:r=>(()=>{var o=we(),m=o.firstChild,h=m.nextSibling,$=h.nextSibling;return t(m,(()=>{var x=p(()=>!!r.thumb);return()=>x()?(()=>{var d=ke();return O(a=>{var f=T(r.thumb),_=r.name;return f!==a.e&&w(d,"src",a.e=f),_!==a.t&&w(d,"alt",a.t=_),a},{e:void 0,t:void 0}),d})():Ce()})()),t(h,()=>r.name),t($,()=>r.character),o})()})),e})()}const te={Director:1,Producer:2,"Executive Producer":3,Screenplay:4,Writer:5,"Director of Photography":6,Editor:7,"Production Designer":8,"Art Director":9,"Costume Designer":10,"Makeup Artist":11,"Original Music Composer":12,"Sound Designer":13};function De(l,s=!0){const e=[...l];return e.sort((i,n)=>{const r=te[i.job]??Number.MAX_SAFE_INTEGER,o=te[n.job]??Number.MAX_SAFE_INTEGER;return r===o?i.job.localeCompare(n.job):r-o}),s?e.slice(0,12):e}var Ee=v('<div class=mb-12><h3 class="text-lg font-medium text-sky-200 mb-4">Crew</h3><div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">'),Fe=v('<div class=text-center><div class="aspect-[2/3] mb-2 rounded-lg bg-slate-800/50 overflow-hidden"></div><div class="text-sm font-medium text-white"></div><div class="text-xs text-sky-200">'),je=v('<img class="w-full h-full object-cover"loading=lazy>',!0,!1,!1),Pe=v('<div class="w-full h-full flex items-center justify-center bg-slate-800/50"><span class=text-sky-200/50>No Image');function Oe(l){const s=p(()=>De(l.crew,!0));return(()=>{var e=Ee(),i=e.firstChild,n=i.nextSibling;return t(n,c(P,{get each(){return s()},children:r=>(()=>{var o=Fe(),m=o.firstChild,h=m.nextSibling,$=h.nextSibling;return t(m,(()=>{var x=p(()=>!!r.thumb);return()=>x()?(()=>{var d=je();return O(a=>{var f=T(r.thumb),_=r.name;return f!==a.e&&w(d,"src",a.e=f),_!==a.t&&w(d,"alt",a.t=_),a},{e:void 0,t:void 0}),d})():Pe()})()),t(h,()=>r.name),t($,()=>r.job),o})()})),e})()}var Ae=v('<div class="flex flex-wrap gap-4 text-sm text-sky-200 mb-6 drop-shadow-lg bg-slate-900/20 backdrop-blur-sm rounded-lg px-4 py-2">'),Ie=v('<span class="px-2 py-0.5 bg-sky-500/10 rounded">');function Ne(l){return(()=>{var s=Ae();return t(s,c(P,{get each(){return l.genres},children:e=>(()=>{var i=Ie();return t(i,()=>e.tag),i})()})),s})()}function se(l){const s=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,e=l.match(s);return e&&e[2].length===11?e[2]:null}function Re(l){return`https://img.youtube.com/vi/${l}/maxresdefault.jpg`}var Te=v('<div><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"allowfullscreen class="w-full h-full">');function Me(l){const s=se(l.url);if(!s)return null;const e=new URLSearchParams({rel:"0",modestbranding:"1",...l.autoplay&&{autoplay:"1"},...l.onEnded&&{enablejsapi:"1"}});return(()=>{var i=Te(),n=i.firstChild;return ie(n,"ended",l.onEnded),O(r=>{var o=`aspect-video bg-slate-800 rounded-lg overflow-hidden ${l.class||""}`,m=`https://www.youtube.com/embed/${s}?${e.toString()}`,h=l.title||"YouTube video player";return o!==r.e&&oe(i,r.e=o),m!==r.t&&w(n,"src",r.t=m),h!==r.a&&w(n,"title",r.a=h),r},{e:void 0,t:void 0,a:void 0}),i})()}var Le=v('<dialog class="fixed m-auto inset-0 p-4 max-h-[90vh] max-w-[90vw] w-full md:w-[800px] bg-transparent backdrop:bg-slate-900/90 backdrop:backdrop-blur-sm"><div class="bg-slate-900 rounded-lg shadow-xl shadow-black/20 overflow-hidden">');function Ue(l){let s;J(()=>{s&&(l.isOpen&&l.videoUrl?(s.showModal(),document.body.style.overflow="hidden"):(s.close(),document.body.style.overflow="unset"))}),J(()=>{if(!l.isOpen)return;const i=n=>{n.key==="Escape"&&l.onClose()};document.addEventListener("keydown",i),W(()=>document.removeEventListener("keydown",i))}),W(()=>{document.body.style.overflow="unset"});const e=i=>{s&&i.target===s&&l.onClose()};return(()=>{var i=Le(),n=i.firstChild;ie(i,"close",l.onClose),i.$$click=e;var r=s;return typeof r=="function"?B(r,i):s=i,t(n,c(de,{get when(){return l.videoUrl},children:o=>c(Me,{get url(){return o()},autoplay:!0,class:"w-full",get onEnded(){return l.onClose}})})),i})()}M(["click"]);var ze=v('<div><div class="flex items-center gap-1 text-sky-400 mb-1"><span class="text-sm font-medium">Studios</span></div><div class=text-white>'),Ye=v("<span>");function Ve(l){return l.studios.length===0?null:(()=>{var s=ze(),e=s.firstChild,i=e.firstChild,n=e.nextSibling;return t(e,c(ce,{class:"w-4 h-4","aria-hidden":!0}),i),t(n,c(P,{get each(){return l.studios},children:(r,o)=>(()=>{var m=Ye();return t(m,()=>r.name,null),t(m,()=>o()<l.studios.length-1&&", ",null),m})()})),s})()}var Je=v('<section class="container mx-auto px-4 py-12 border-t border-sky-200/10"><h2 class="text-2xl font-bold text-white mb-6">Extras</h2><div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">'),Be=v('<button class="group relative aspect-video w-full rounded-xl overflow-hidden focus:outline-none focus:ring-2 focus:ring-sky-500/40 focus:ring-offset-2 focus:ring-offset-slate-800"><img class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"loading=lazy><div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent opacity-80 group-hover:opacity-90 transition-opacity"></div><div class="absolute inset-0 flex items-center justify-center"><div class="rounded-full bg-sky-500/90 p-4 transform transition-all duration-300 group-hover:bg-sky-400 group-hover:scale-110"></div></div><div class="absolute bottom-0 left-0 right-0 p-4"><h3 class="text-base font-medium text-white line-clamp-2 mb-1 group-hover:text-sky-200 transition-colors"></h3><p class="text-sm text-sky-200/80 capitalize">',!0,!1,!1);function Ge(l){const s=(i,n)=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),l.onSelectVideo(n))},e=i=>{const n=i.target;n.src=n.src.replace("maxresdefault.jpg","hqdefault.jpg")};return(()=>{var i=Je(),n=i.firstChild,r=n.nextSibling;return t(r,c(P,{get each(){return l.extras},children:o=>{const m=se(o.url),h=m?Re(m):"";return(()=>{var $=Be(),x=$.firstChild,d=x.nextSibling,a=d.nextSibling,f=a.firstChild,_=a.nextSibling,A=_.firstChild,E=A.nextSibling;return $.$$keydown=y=>s(y,o.url),$.$$click=()=>l.onSelectVideo(o.url),x.addEventListener("error",e),w(x,"src",h),t(f,c(ue,{class:"w-8 h-8 text-white","aria-hidden":"true"})),t(A,()=>o.title),t(E,()=>o.kind),O(y=>{var F=`Play ${o.title}`,j=o.title;return F!==y.e&&w($,"aria-label",y.e=F),j!==y.t&&w(x,"alt",y.t=j),y},{e:void 0,t:void 0}),$})()}})),i})()}M(["click","keydown"]);var He=v('<dialog class="fixed inset-0 bg-transparent p-0 m-0 h-full w-full outline-none"><div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] max-w-[90vw] bg-slate-900 rounded-xl shadow-2xl"><div class="flex items-center justify-between p-6 border-b border-sky-200/10"><h2 class="text-xl font-medium text-white">Playback Settings</h2><button type=button class="text-sky-200 hover:text-sky-100 transition-colors"></button></div><div class=p-6><form class=space-y-6><div><label for=audioTrack class="block text-base font-medium text-sky-200 mb-2">Audio Track</label><select id=audioTrack name=audioTrack class="w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white focus:outline-none focus:ring-2 focus:ring-sky-500/40"value=english></select></div><div><label for=subtitles class="block text-base font-medium text-sky-200 mb-2">Subtitles</label><select id=subtitles name=subtitles class="w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white focus:outline-none focus:ring-2 focus:ring-sky-500/40"value=none><option value=none>None</option></select></div><div><label for=resolution class="block text-base font-medium text-sky-200 mb-2">Resolution</label><select id=resolution name=resolution class="w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white focus:outline-none focus:ring-2 focus:ring-sky-500/40"value=1080p><option value=2160p>4K (2160p)</option><option value=1080p>Full HD (1080p)</option><option value=720p>HD (720p)</option><option value=480p>SD (480p)</option></select></div><div class="pt-4 flex gap-4"><button type=submit class="flex-1 px-6 py-3 bg-sky-500 hover:bg-sky-400 text-white text-base font-medium rounded-lg transition-colors">Apply Settings</button><button type=button class="flex-1 px-6 py-3 bg-slate-800 hover:bg-slate-700 text-sky-200 hover:text-sky-100 text-base font-medium rounded-lg transition-colors">Cancel'),le=v("<option>");function Ke(l){let s,e;J(()=>{s&&(l.isOpen?s.showModal():s.close())});const i=()=>{e==null||e.reset(),l.onClose()};return(()=>{var n=He(),r=n.firstChild,o=r.firstChild,m=o.firstChild,h=m.nextSibling,$=o.nextSibling,x=$.firstChild,d=x.firstChild,a=d.firstChild,f=a.nextSibling,_=d.nextSibling,A=_.firstChild,E=A.nextSibling;E.firstChild;var y=_.nextSibling,F=y.nextSibling,j=F.firstChild,N=j.nextSibling;n.$$click=k=>{k.target===s&&l.onClose()};var D=s;typeof D=="function"?B(D,n):s=n,h.$$click=i,t(h,c(ve,{class:"w-6 h-6","aria-hidden":"true"}));var I=e;return typeof I=="function"?B(I,x):e=x,t(f,c(P,{get each(){return l.audioOpts},children:k=>(()=>{var C=le();return t(C,()=>k.label),O(()=>C.value=k.value),C})()})),t(E,c(P,{get each(){return l.subtitleOpts},children:k=>(()=>{var C=le();return t(C,()=>k.label),O(()=>C.value=k.value),C})()}),null),N.$$click=i,n})()}M(["click"]);var Xe=v('<main class="min-h-screen pt-16"><div class="relative min-h-[90vh] w-full"><div class="absolute inset-0 bg-cover bg-center"><div class="absolute inset-0 bg-gradient-to-r from-slate-900/80 via-slate-900/50 to-transparent"></div><div class="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/40 to-transparent"></div></div><div class="relative h-full container mx-auto px-4 py-12 flex flex-col justify-end"><div class="flex flex-col md:flex-row gap-8 items-end md:items-end"><div class="relative z-10 md:translate-y-16"><div class="w-48 md:w-72 aspect-[2/3] rounded-lg overflow-hidden ring-1 ring-white/10 shadow-xl shadow-black/50"><img class="w-full h-full object-cover"></div></div><div class="flex-1 max-w-3xl relative z-10"><h1 class="text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-xl"></h1><div class="flex flex-wrap gap-4 text-sm text-sky-200 mb-6 drop-shadow-lg bg-slate-900/20 backdrop-blur-sm rounded-lg px-4 py-2"><div class="flex items-center gap-1"><span></span></div><div class="flex items-center gap-1"><span></span></div></div><div class="flex gap-6 mb-6"></div><p class="text-sky-200 leading-relaxed mb-8"></p><div class="flex flex-wrap items-center gap-4 mb-8"><button type=button class="inline-flex items-center gap-2 px-6 py-3 bg-sky-500 hover:bg-sky-400 text-white font-medium rounded-lg transition-colors">Play</button><button type=button class="inline-flex items-center gap-2 px-4 py-3 bg-rose-500/20 hover:bg-rose-500/30 text-rose-300 hover:text-rose-200 font-medium rounded-lg transition-colors">Like</button><button type=button class="inline-flex items-center gap-2 px-4 py-3 bg-emerald-500/20 hover:bg-emerald-500/30 text-emerald-300 hover:text-emerald-200 font-medium rounded-lg transition-colors">Mark as Watched</button></div><div class="grid grid-cols-2 md:grid-cols-3 gap-6"></div></div></div></div></div><section class="container mx-auto px-4 py-12"><h2 class="text-2xl font-bold text-white mb-6">Cast & Crew'),We=v('<p class="text-xl text-sky-200 mb-4 italic drop-shadow-xl">'),qe=v('<span class="px-2 py-0.5 bg-sky-500/20 rounded">'),Qe=v('<div class="flex items-center gap-2"><div><div class="text-lg font-medium text-white"></div><div class="text-xs text-sky-200">Audience Rating'),Ze=v('<div class="flex items-center gap-2"><div><div class="text-lg font-medium text-white"></div><div class="text-xs text-sky-200">Critic Rating'),et=v('<div><div class="flex items-center gap-1 text-sky-400 mb-1"><span class="text-sm font-medium">Budget</span></div><div class=text-white>'),tt=v('<div><div class="flex items-center gap-1 text-sky-400 mb-1"><span class="text-sm font-medium">Revenue</span></div><div class=text-white>');const st=function(){const s=q.useLoaderData(),{movie:e}=s(),i=p(()=>{if(!e.audio_streams.length)return[];const d=[];for(const a of e.audio_streams)d.push({value:a.index,label:`${a.title} ${a.language}`});return d}),n=p(()=>{if(!e.subtitles.length)return[];const d=[];for(const a of e.subtitles)d.push({value:a.index,label:`${a.title} ${a.language}`});return d}),[r,o]=Q(null),[m,h]=Q(!1),$=q.useNavigate(),x=async()=>{try{const d={title:e.title,audio_codec:"aac",audio_bit_rate:192,audio_channels:2,audio_stream_index:e.audio_streams[0].index,video_stream_index:e.video_streams[0].index,video_codec:"copy"},a=await fetch(`/api/v1/movies/create-hls/${e.id}`,{method:"post",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),f=await a.json();if(f.error){alert(`${a.status} - ${f.error?f.error:a.statusText}`);return}$({to:"/movies/$movieID/play",from:"/movies/$movieID",search:{title:e.title,thumb:e.thumb,pid:f.pid,m3u8Url:f.m3u8_url}})}catch(d){console.error(d),alert("an error occurred while playing the movie")}};return(()=>{var d=Xe(),a=d.firstChild,f=a.firstChild,_=f.nextSibling,A=_.firstChild,E=A.firstChild,y=E.firstChild,F=y.firstChild,j=E.nextSibling,N=j.firstChild,D=N.nextSibling,I=D.firstChild,k=I.firstChild,C=I.nextSibling,G=C.firstChild,L=D.nextSibling,H=L.nextSibling,K=H.nextSibling,R=K.firstChild,re=R.firstChild,U=R.nextSibling,ne=U.firstChild,X=U.nextSibling,ae=X.firstChild,z=K.nextSibling,Y=a.nextSibling;return Y.firstChild,t(N,()=>e.title),t(j,(()=>{var u=p(()=>!!e.tag_line);return()=>u()&&(()=>{var g=We();return t(g,()=>e.tag_line),g})()})(),D),t(I,c(ge,{class:"w-4 h-4","aria-hidden":"true"}),k),t(k,()=>pe(e.release_date)),t(C,c(me,{class:"w-4 h-4","aria-hidden":"true"}),G),t(G,()=>_e(e.run_time)),t(D,(()=>{var u=p(()=>!!e.content_rating);return()=>u()&&(()=>{var g=qe();return t(g,()=>e.content_rating),g})()})(),null),t(D,c(Ne,{get genres(){return e.genres}}),null),t(L,(()=>{var u=p(()=>e.audience_rating>0);return()=>u()&&(()=>{var g=Qe(),b=g.firstChild,S=b.firstChild;return t(g,c(fe,{class:"w-5 h-5 text-sky-400","aria-hidden":"true"}),b),t(S,()=>e.audience_rating.toFixed(1)),g})()})(),null),t(L,(()=>{var u=p(()=>e.critic_rating>0);return()=>u()&&(()=>{var g=Ze(),b=g.firstChild,S=b.firstChild;return t(g,c(be,{class:"w-5 h-5 text-sky-400","aria-hidden":"true"}),b),t(S,()=>e.critic_rating.toFixed(1)),g})()})(),null),t(H,()=>e.summary),R.$$click=x,t(R,c(he,{class:"w-5 h-5","aria-hidden":"true"}),re),t(U,c(xe,{class:"w-5 h-5","aria-hidden":"true"}),ne),t(X,c($e,{class:"w-5 h-5","aria-hidden":"true"}),ae),t(z,(()=>{var u=p(()=>e.budget>0);return()=>u()&&(()=>{var g=et(),b=g.firstChild,S=b.firstChild,V=b.nextSibling;return t(b,c(Z,{class:"w-4 h-4","aria-hidden":"true"}),S),t(V,()=>ee(e.budget)),g})()})(),null),t(z,(()=>{var u=p(()=>e.revenue>0);return()=>u()&&(()=>{var g=tt(),b=g.firstChild,S=b.firstChild,V=b.nextSibling;return t(b,c(Z,{class:"w-4 h-4","aria-hidden":"true"}),S),t(V,()=>ee(e.revenue)),g})()})(),null),t(z,c(Ve,{get studios(){return e.studios}}),null),t(Y,(()=>{var u=p(()=>e.cast.length>0);return()=>u()&&c(Se,{get cast(){return e.cast}})})(),null),t(Y,(()=>{var u=p(()=>e.crew.length>0);return()=>u()&&c(Oe,{get crew(){return e.crew}})})(),null),t(d,c(Ge,{get extras(){return e.extras},onSelectVideo:u=>o(u)}),null),t(d,c(Ue,{get isOpen(){return!!r()},onClose:()=>o(null),get videoUrl(){return r()}}),null),t(d,c(Ke,{get isOpen(){return m()},onClose:()=>h(!1),get audioOpts(){return i()},get subtitleOpts(){return n()}}),null),O(u=>{var g=`url(${T(e.art)})`,b=T(e.thumb),S=`${e.title} Poster`;return g!==u.e&&((u.e=g)!=null?f.style.setProperty("background-image",g):f.style.removeProperty("background-image")),b!==u.t&&w(F,"src",u.t=b),S!==u.a&&w(F,"alt",u.a=S),u},{e:void 0,t:void 0,a:void 0}),d})()};M(["click"]);export{st as component};

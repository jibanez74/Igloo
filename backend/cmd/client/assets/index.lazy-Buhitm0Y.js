import{a as z,j as D,d as I,t as i,i as e,f as s,k as K,l as P,m as q,n as Q,o as V,p as W,q as X,r as B,g as G,s as w,h as H,c as J,b as O,u as Y,L as Z,S as g}from"./index-q4ThUUcc.js";import{S as ee}from"./Spinner-BMY0AzbQ.js";import{E as te}from"./ErrorWarning-SbgSwUbR.js";var se=i('<div role=region aria-label=Users class=overflow-x-auto><table class=w-full role=grid aria-describedby=users-table-description><caption id=users-table-description class=sr-only>List of system users with their details including name, username, email, status, role, and available actions</caption><thead><tr class="text-left border-b border-blue-800/20"><th scope=col class="pb-3 text-sm font-medium text-white"><span class=sr-only>User </span>Name</th><th scope=col class="pb-3 text-sm font-medium text-white">Username</th><th scope=col class="pb-3 text-sm font-medium text-white">Email Address</th><th scope=col class="pb-3 text-sm font-medium text-white">Account Status</th><th scope=col class="pb-3 text-sm font-medium text-white">User Role</th><th scope=col class="pb-3 text-sm font-medium text-white"><span class=sr-only>User </span>Actions</th></tr></thead><tbody class="divide-y divide-blue-800/20">'),re=i('<tr class="hover:bg-blue-800/20 transition-colors"><th scope=row class="py-4 text-white font-normal"></th><td class="py-4 text-blue-200"></td><td class="py-4 text-blue-200"><div class="flex items-center gap-2"><span></span></div></td><td class=py-4></td><td class=py-4></td><td class=py-4><div class="flex items-center gap-2"role=group><button type=button class="p-1.5 text-blue-200 hover:text-yellow-300 rounded-lg hover:bg-blue-800/50 focus:outline-none focus:ring-2 focus:ring-yellow-300/50 focus:ring-offset-2 focus:ring-offset-blue-950 transition-colors"></button><button type=button class="p-1.5 text-blue-200 hover:text-red-400 rounded-lg hover:bg-blue-800/50 focus:outline-none focus:ring-2 focus:ring-red-400/50 focus:ring-offset-2 focus:ring-offset-blue-950 transition-colors">'),le=i('<span class="inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-blue-500/10 text-blue-200"role=status aria-label="User account is active">Active'),ae=i('<span class="inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-400/10 text-red-400"role=status aria-label="User account is inactive">Inactive'),ie=i('<span class="inline-flex items-center gap-1 text-yellow-300"role=status aria-label="User has administrator privileges">Admin'),ne=i('<span class=text-blue-200 role=status aria-label="User has standard privileges">User');function oe(c){const[l,n]=z(0),m=D("/_auth/_admin/users/"),f=m.useNavigate(),t=m.useRouteContext(),{queryClient:h}=t(),x=I(()=>({mutationFn:async()=>{try{return fetch(`/api/v1/users/delete/${l()}`,{method:"delete",credentials:"same-origin"})}catch(u){console.error(u)}},onSuccess:()=>{n(0),h.invalidateQueries({queryKey:["users"]})},onError:u=>{n(0),console.error(u)}})),p=u=>{const $=`Are you sure you want to delete user ${u.name}? This action cannot be undone.`;n(u.id),window.confirm($)&&x.mutate()};return(()=>{var u=se(),$=u.firstChild,L=$.firstChild,T=L.nextSibling,N=T.nextSibling;return e(N,s(K,{get each(){return c.users},children:o=>(()=>{var _=re(),y=_.firstChild,C=y.nextSibling,S=C.nextSibling,U=S.firstChild,k=U.firstChild,E=S.nextSibling,F=E.nextSibling,M=F.nextSibling,A=M.firstChild,b=A.firstChild,v=b.nextSibling;return e(y,()=>o.name),e(C,()=>o.username),e(U,s(P,{class:"w-4 h-4","aria-hidden":"true",role:"presentation"}),k),e(k,()=>o.email),e(E,(()=>{var a=q(()=>!!o.is_active);return()=>a()?(()=>{var r=le(),d=r.firstChild;return e(r,s(Q,{class:"w-3 h-3","aria-hidden":"true",role:"presentation"}),d),r})():(()=>{var r=ae(),d=r.firstChild;return e(r,s(V,{class:"w-3 h-3","aria-hidden":"true",role:"presentation"}),d),r})()})()),e(F,(()=>{var a=q(()=>!!o.is_admin);return()=>a()?(()=>{var r=ie(),d=r.firstChild;return e(r,s(W,{class:"w-4 h-4","aria-hidden":"true",role:"presentation"}),d),r})():ne()})()),b.$$click=()=>f({to:"/users/form",from:"/users",search:{id:o.id,update:!0}}),e(b,s(X,{class:"w-4 h-4","aria-hidden":"true",role:"presentation"})),v.$$click=()=>p(o),e(v,s(B,{class:"w-4 h-4","aria-hidden":"true",role:"presentation"})),G(a=>{var r=`Actions for ${o.name}`,d=`Edit user ${o.name}`,R=`Delete user ${o.name}`;return r!==a.e&&w(A,"aria-label",a.e=r),d!==a.t&&w(b,"aria-label",a.t=d),R!==a.a&&w(v,"aria-label",a.a=R),a},{e:void 0,t:void 0,a:void 0}),_})()})),u})()}H(["click"]);var ce=i('<p class="text-sm text-white">Total users: <span class="text-yellow-300 font-medium">'),ue=i("<div class=overflow-x-auto>"),de=i('<div class="container mx-auto"><section class="bg-blue-950/50 backdrop-blur-sm rounded-2xl p-6 shadow-lg shadow-blue-900/20 border border-blue-900/20"aria-label="Users list"><header class="mb-6 flex items-center justify-between"><div class="flex items-center gap-4"><h1 class="text-2xl font-bold text-yellow-300">Users'),j=i('<div class="h-40 flex items-center justify-center">'),he=i('<p class="h-40 flex items-center justify-center text-white"role=status>No users found');const ge=J("/_auth/_admin/users/")({component:me});function me(){const c=O(()=>({queryKey:["users"],queryFn:async()=>{try{const l=await fetch("/api/v1/users",{credentials:"same-origin"}),n=await l.json();if(!l.ok)throw new Error(`${l.status} - ${n.error?n.error:l.statusText}`);return n}catch(l){throw console.error(l),new Error("a network error occurred while fetching users")}}}));return(()=>{var l=de(),n=l.firstChild,m=n.firstChild,f=m.firstChild;return f.firstChild,e(f,s(Z,{to:"/users/form",search:{update:!1},class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-950 bg-yellow-300 rounded-lg hover:bg-yellow-400 focus:outline-none focus:ring-2 focus:ring-yellow-300/50 focus:ring-offset-2 focus:ring-offset-blue-950 transition-colors shadow-sm shadow-black/20",get children(){return[s(Y,{class:"w-4 h-4","aria-hidden":"true"}),"New User"]}}),null),e(m,s(g,{get when(){return c.isSuccess},get children(){var t=ce(),h=t.firstChild,x=h.nextSibling;return e(x,()=>{var p;return((p=c.data)==null?void 0:p.count)??0}),t}}),null),e(n,s(g,{get when(){return!c.isLoading},get fallback(){return(()=>{var t=j();return e(t,s(ee,{size:"lg"})),t})()},get children(){return s(g,{get when(){return!c.isError},get fallback(){return(()=>{var t=j();return e(t,s(te,{get error(){var h;return((h=c.error)==null?void 0:h.message)??""},isVisible:!0})),t})()},get children(){return s(g,{get when(){var t;return(t=c.data)==null?void 0:t.items.length},get fallback(){return he()},get children(){var t=ue();return e(t,s(oe,{get users(){return c.data.items}})),t}})}})}}),null),l})()}export{ge as Route};

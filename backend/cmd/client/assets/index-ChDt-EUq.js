(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var Gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function hE(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var a=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return r[n]}})}),t}var Hc={exports:{}},oa={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xg;function mE(){if(xg)return oa;xg=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var c in a)c!=="key"&&(l[c]=a[c])}else l=a;return a=l.ref,{$$typeof:r,type:n,key:u,ref:a!==void 0?a:null,props:l}}return oa.Fragment=e,oa.jsx=t,oa.jsxs=t,oa}var Sg;function gE(){return Sg||(Sg=1,Hc.exports=mE()),Hc.exports}var L=gE(),$c={exports:{}},_e={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eg;function pE(){if(Eg)return _e;Eg=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.iterator;function v(C){return C===null||typeof C!="object"?null:(C=p&&C[p]||C["@@iterator"],typeof C=="function"?C:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function b(C,H,ee){this.props=C,this.context=H,this.refs=E,this.updater=ee||x}b.prototype.isReactComponent={},b.prototype.setState=function(C,H){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,H,"setState")},b.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function A(){}A.prototype=b.prototype;function O(C,H,ee){this.props=C,this.context=H,this.refs=E,this.updater=ee||x}var _=O.prototype=new A;_.constructor=O,S(_,b.prototype),_.isPureReactComponent=!0;var k=Array.isArray,D={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function B(C,H,ee,re,se,de){return ee=de.ref,{$$typeof:r,type:C,key:H,ref:ee!==void 0?ee:null,props:de}}function M(C,H){return B(C.type,H,void 0,void 0,void 0,C.props)}function I(C){return typeof C=="object"&&C!==null&&C.$$typeof===r}function N(C){var H={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(ee){return H[ee]})}var U=/\/+/g;function Q(C,H){return typeof C=="object"&&C!==null&&C.key!=null?N(""+C.key):H.toString(36)}function Z(){}function V(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(Z,Z):(C.status="pending",C.then(function(H){C.status==="pending"&&(C.status="fulfilled",C.value=H)},function(H){C.status==="pending"&&(C.status="rejected",C.reason=H)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function X(C,H,ee,re,se){var de=typeof C;(de==="undefined"||de==="boolean")&&(C=null);var fe=!1;if(C===null)fe=!0;else switch(de){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(C.$$typeof){case r:case e:fe=!0;break;case g:return fe=C._init,X(fe(C._payload),H,ee,re,se)}}if(fe)return se=se(C),fe=re===""?"."+Q(C,0):re,k(se)?(ee="",fe!=null&&(ee=fe.replace(U,"$&/")+"/"),X(se,H,ee,"",function(be){return be})):se!=null&&(I(se)&&(se=M(se,ee+(se.key==null||C&&C.key===se.key?"":(""+se.key).replace(U,"$&/")+"/")+fe)),H.push(se)),1;fe=0;var Ae=re===""?".":re+":";if(k(C))for(var me=0;me<C.length;me++)re=C[me],de=Ae+Q(re,me),fe+=X(re,H,ee,de,se);else if(me=v(C),typeof me=="function")for(C=me.call(C),me=0;!(re=C.next()).done;)re=re.value,de=Ae+Q(re,me++),fe+=X(re,H,ee,de,se);else if(de==="object"){if(typeof C.then=="function")return X(V(C),H,ee,re,se);throw H=String(C),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return fe}function $(C,H,ee){if(C==null)return C;var re=[],se=0;return X(C,re,"","",function(de){return H.call(ee,de,se++)}),re}function oe(C){if(C._status===-1){var H=C._result;H=H(),H.then(function(ee){(C._status===0||C._status===-1)&&(C._status=1,C._result=ee)},function(ee){(C._status===0||C._status===-1)&&(C._status=2,C._result=ee)}),C._status===-1&&(C._status=0,C._result=H)}if(C._status===1)return C._result.default;throw C._result}var le=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)};function z(){}return _e.Children={map:$,forEach:function(C,H,ee){$(C,function(){H.apply(this,arguments)},ee)},count:function(C){var H=0;return $(C,function(){H++}),H},toArray:function(C){return $(C,function(H){return H})||[]},only:function(C){if(!I(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},_e.Component=b,_e.Fragment=t,_e.Profiler=a,_e.PureComponent=O,_e.StrictMode=n,_e.Suspense=d,_e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,_e.act=function(){throw Error("act(...) is not supported in production builds of React.")},_e.cache=function(C){return function(){return C.apply(null,arguments)}},_e.cloneElement=function(C,H,ee){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var re=S({},C.props),se=C.key,de=void 0;if(H!=null)for(fe in H.ref!==void 0&&(de=void 0),H.key!==void 0&&(se=""+H.key),H)!F.call(H,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&H.ref===void 0||(re[fe]=H[fe]);var fe=arguments.length-2;if(fe===1)re.children=ee;else if(1<fe){for(var Ae=Array(fe),me=0;me<fe;me++)Ae[me]=arguments[me+2];re.children=Ae}return B(C.type,se,void 0,void 0,de,re)},_e.createContext=function(C){return C={$$typeof:u,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:l,_context:C},C},_e.createElement=function(C,H,ee){var re,se={},de=null;if(H!=null)for(re in H.key!==void 0&&(de=""+H.key),H)F.call(H,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(se[re]=H[re]);var fe=arguments.length-2;if(fe===1)se.children=ee;else if(1<fe){for(var Ae=Array(fe),me=0;me<fe;me++)Ae[me]=arguments[me+2];se.children=Ae}if(C&&C.defaultProps)for(re in fe=C.defaultProps,fe)se[re]===void 0&&(se[re]=fe[re]);return B(C,de,void 0,void 0,null,se)},_e.createRef=function(){return{current:null}},_e.forwardRef=function(C){return{$$typeof:c,render:C}},_e.isValidElement=I,_e.lazy=function(C){return{$$typeof:g,_payload:{_status:-1,_result:C},_init:oe}},_e.memo=function(C,H){return{$$typeof:h,type:C,compare:H===void 0?null:H}},_e.startTransition=function(C){var H=D.T,ee={};D.T=ee;try{var re=C(),se=D.S;se!==null&&se(ee,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(z,le)}catch(de){le(de)}finally{D.T=H}},_e.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},_e.use=function(C){return D.H.use(C)},_e.useActionState=function(C,H,ee){return D.H.useActionState(C,H,ee)},_e.useCallback=function(C,H){return D.H.useCallback(C,H)},_e.useContext=function(C){return D.H.useContext(C)},_e.useDebugValue=function(){},_e.useDeferredValue=function(C,H){return D.H.useDeferredValue(C,H)},_e.useEffect=function(C,H){return D.H.useEffect(C,H)},_e.useId=function(){return D.H.useId()},_e.useImperativeHandle=function(C,H,ee){return D.H.useImperativeHandle(C,H,ee)},_e.useInsertionEffect=function(C,H){return D.H.useInsertionEffect(C,H)},_e.useLayoutEffect=function(C,H){return D.H.useLayoutEffect(C,H)},_e.useMemo=function(C,H){return D.H.useMemo(C,H)},_e.useOptimistic=function(C,H){return D.H.useOptimistic(C,H)},_e.useReducer=function(C,H,ee){return D.H.useReducer(C,H,ee)},_e.useRef=function(C){return D.H.useRef(C)},_e.useState=function(C){return D.H.useState(C)},_e.useSyncExternalStore=function(C,H,ee){return D.H.useSyncExternalStore(C,H,ee)},_e.useTransition=function(){return D.H.useTransition()},_e.version="19.0.0",_e}var Tg;function ln(){return Tg||(Tg=1,$c.exports=pE()),$c.exports}var he=ln();const cs=dd(he);var Vc={exports:{}},ua={},zc={exports:{}},Kc={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bg;function yE(){return bg||(bg=1,function(r){function e($,oe){var le=$.length;$.push(oe);e:for(;0<le;){var z=le-1>>>1,C=$[z];if(0<a(C,oe))$[z]=oe,$[le]=C,le=z;else break e}}function t($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var oe=$[0],le=$.pop();if(le!==oe){$[0]=le;e:for(var z=0,C=$.length,H=C>>>1;z<H;){var ee=2*(z+1)-1,re=$[ee],se=ee+1,de=$[se];if(0>a(re,le))se<C&&0>a(de,re)?($[z]=de,$[se]=le,z=se):($[z]=re,$[ee]=le,z=ee);else if(se<C&&0>a(de,le))$[z]=de,$[se]=le,z=se;else break e}}return oe}function a($,oe){var le=$.sortIndex-oe.sortIndex;return le!==0?le:$.id-oe.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;r.unstable_now=function(){return l.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var d=[],h=[],g=1,p=null,v=3,x=!1,S=!1,E=!1,b=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function _($){for(var oe=t(h);oe!==null;){if(oe.callback===null)n(h);else if(oe.startTime<=$)n(h),oe.sortIndex=oe.expirationTime,e(d,oe);else break;oe=t(h)}}function k($){if(E=!1,_($),!S)if(t(d)!==null)S=!0,V();else{var oe=t(h);oe!==null&&X(k,oe.startTime-$)}}var D=!1,F=-1,B=5,M=-1;function I(){return!(r.unstable_now()-M<B)}function N(){if(D){var $=r.unstable_now();M=$;var oe=!0;try{e:{S=!1,E&&(E=!1,A(F),F=-1),x=!0;var le=v;try{t:{for(_($),p=t(d);p!==null&&!(p.expirationTime>$&&I());){var z=p.callback;if(typeof z=="function"){p.callback=null,v=p.priorityLevel;var C=z(p.expirationTime<=$);if($=r.unstable_now(),typeof C=="function"){p.callback=C,_($),oe=!0;break t}p===t(d)&&n(d),_($)}else n(d);p=t(d)}if(p!==null)oe=!0;else{var H=t(h);H!==null&&X(k,H.startTime-$),oe=!1}}break e}finally{p=null,v=le,x=!1}oe=void 0}}finally{oe?U():D=!1}}}var U;if(typeof O=="function")U=function(){O(N)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,Z=Q.port2;Q.port1.onmessage=N,U=function(){Z.postMessage(null)}}else U=function(){b(N,0)};function V(){D||(D=!0,U())}function X($,oe){F=b(function(){$(r.unstable_now())},oe)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function($){$.callback=null},r.unstable_continueExecution=function(){S||x||(S=!0,V())},r.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<$?Math.floor(1e3/$):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function($){switch(v){case 1:case 2:case 3:var oe=3;break;default:oe=v}var le=v;v=oe;try{return $()}finally{v=le}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function($,oe){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var le=v;v=$;try{return oe()}finally{v=le}},r.unstable_scheduleCallback=function($,oe,le){var z=r.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?z+le:z):le=z,$){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=le+C,$={id:g++,callback:oe,priorityLevel:$,startTime:le,expirationTime:C,sortIndex:-1},le>z?($.sortIndex=le,e(h,$),t(d)===null&&$===t(h)&&(E?(A(F),F=-1):E=!0,X(k,le-z))):($.sortIndex=C,e(d,$),S||x||(S=!0,V())),$},r.unstable_shouldYield=I,r.unstable_wrapCallback=function($){var oe=v;return function(){var le=v;v=oe;try{return $.apply(this,arguments)}finally{v=le}}}}(Kc)),Kc}var Ag;function vE(){return Ag||(Ag=1,zc.exports=yE()),zc.exports}var Yc={exports:{}},_t={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rg;function xE(){if(Rg)return _t;Rg=1;var r=ln();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(d,h,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:d,containerInfo:h,implementation:g}}var u=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return _t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,_t.createPortal=function(d,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return l(d,h,null,g)},_t.flushSync=function(d){var h=u.T,g=n.p;try{if(u.T=null,n.p=2,d)return d()}finally{u.T=h,n.p=g,n.d.f()}},_t.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},_t.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},_t.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var g=h.as,p=c(g,h.crossOrigin),v=typeof h.integrity=="string"?h.integrity:void 0,x=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;g==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:x}):g==="script"&&n.d.X(d,{crossOrigin:p,integrity:v,fetchPriority:x,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},_t.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var g=c(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},_t.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var g=h.as,p=c(g,h.crossOrigin);n.d.L(d,g,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},_t.preloadModule=function(d,h){if(typeof d=="string")if(h){var g=c(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},_t.requestFormReset=function(d){n.d.r(d)},_t.unstable_batchedUpdates=function(d,h){return d(h)},_t.useFormState=function(d,h,g){return u.H.useFormState(d,h,g)},_t.useFormStatus=function(){return u.H.useHostTransitionStatus()},_t.version="19.0.0",_t}var Lg;function uy(){if(Lg)return Yc.exports;Lg=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Yc.exports=xE(),Yc.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _g;function SE(){if(_g)return ua;_g=1;var r=vE(),e=ln(),t=uy();function n(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var l=Symbol.for("react.element"),u=Symbol.for("react.transitional.element"),c=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),v=Symbol.for("react.consumer"),x=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),_=Symbol.for("react.offscreen"),k=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function F(i){return i===null||typeof i!="object"?null:(i=D&&i[D]||i["@@iterator"],typeof i=="function"?i:null)}var B=Symbol.for("react.client.reference");function M(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===B?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case d:return"Fragment";case c:return"Portal";case g:return"Profiler";case h:return"StrictMode";case E:return"Suspense";case b:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case x:return(i.displayName||"Context")+".Provider";case v:return(i._context.displayName||"Context")+".Consumer";case S:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case A:return s=i.displayName||null,s!==null?s:M(i.type)||"Memo";case O:s=i._payload,i=i._init;try{return M(i(s))}catch{}}return null}var I=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N=Object.assign,U,Q;function Z(i){if(U===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);U=s&&s[1]||"",Q=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+U+i+Q}var V=!1;function X(i,s){if(!i||V)return"";V=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(ie){var J=ie}Reflect.construct(i,[],ce)}else{try{ce.call()}catch(ie){J=ie}i.call(ce.prototype)}}else{try{throw Error()}catch(ie){J=ie}(ce=i())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(ie){if(ie&&J&&typeof ie.stack=="string")return[ie.stack,J.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),T=y[0],w=y[1];if(T&&w){var P=T.split(`
`),G=w.split(`
`);for(m=f=0;f<P.length&&!P[f].includes("DetermineComponentFrameRoot");)f++;for(;m<G.length&&!G[m].includes("DetermineComponentFrameRoot");)m++;if(f===P.length||m===G.length)for(f=P.length-1,m=G.length-1;1<=f&&0<=m&&P[f]!==G[m];)m--;for(;1<=f&&0<=m;f--,m--)if(P[f]!==G[m]){if(f!==1||m!==1)do if(f--,m--,0>m||P[f]!==G[m]){var ne=`
`+P[f].replace(" at new "," at ");return i.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",i.displayName)),ne}while(1<=f&&0<=m);break}}}finally{V=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?Z(o):""}function $(i){switch(i.tag){case 26:case 27:case 5:return Z(i.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 15:return i=X(i.type,!1),i;case 11:return i=X(i.type.render,!1),i;case 1:return i=X(i.type,!0),i;default:return""}}function oe(i){try{var s="";do s+=$(i),i=i.return;while(i);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function le(i){var s=i,o=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,s.flags&4098&&(o=s.return),i=s.return;while(i)}return s.tag===3?o:null}function z(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function C(i){if(le(i)!==i)throw Error(n(188))}function H(i){var s=i.alternate;if(!s){if(s=le(i),s===null)throw Error(n(188));return s!==i?null:i}for(var o=i,f=s;;){var m=o.return;if(m===null)break;var y=m.alternate;if(y===null){if(f=m.return,f!==null){o=f;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===o)return C(m),i;if(y===f)return C(m),s;y=y.sibling}throw Error(n(188))}if(o.return!==f.return)o=m,f=y;else{for(var T=!1,w=m.child;w;){if(w===o){T=!0,o=m,f=y;break}if(w===f){T=!0,f=m,o=y;break}w=w.sibling}if(!T){for(w=y.child;w;){if(w===o){T=!0,o=y,f=m;break}if(w===f){T=!0,f=y,o=m;break}w=w.sibling}if(!T)throw Error(n(189))}}if(o.alternate!==f)throw Error(n(190))}if(o.tag!==3)throw Error(n(188));return o.stateNode.current===o?i:s}function ee(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=ee(i),s!==null)return s;i=i.sibling}return null}var re=Array.isArray,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de={pending:!1,data:null,method:null,action:null},fe=[],Ae=-1;function me(i){return{current:i}}function be(i){0>Ae||(i.current=fe[Ae],fe[Ae]=null,Ae--)}function Oe(i,s){Ae++,fe[Ae]=i.current,i.current=s}var it=me(null),Kt=me(null),xt=me(null),qe=me(null);function ot(i,s){switch(Oe(xt,s),Oe(Kt,i),Oe(it,null),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)&&(s=s.namespaceURI)?qm(s):0;break;default:if(i=i===8?s.parentNode:s,s=i.tagName,i=i.namespaceURI)i=qm(i),s=Xm(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}be(it),Oe(it,s)}function Ye(){be(it),be(Kt),be(xt)}function fi(i){i.memoizedState!==null&&Oe(qe,i);var s=it.current,o=Xm(s,i.type);s!==o&&(Oe(Kt,i),Oe(it,o))}function Ei(i){Kt.current===i&&(be(it),be(Kt)),qe.current===i&&(be(qe),na._currentValue=de)}var on=Object.prototype.hasOwnProperty,Fe=r.unstable_scheduleCallback,Xe=r.unstable_cancelCallback,Pi=r.unstable_shouldYield,ba=r.unstable_requestPaint,Yt=r.unstable_now,No=r.unstable_getCurrentPriorityLevel,Ud=r.unstable_ImmediatePriority,Fd=r.unstable_UserBlockingPriority,Aa=r.unstable_NormalPriority,qv=r.unstable_LowPriority,Bd=r.unstable_IdlePriority,Xv=r.log,Wv=r.unstable_setDisableYieldValue,dr=null,Ft=null;function Qv(i){if(Ft&&typeof Ft.onCommitFiberRoot=="function")try{Ft.onCommitFiberRoot(dr,i,void 0,(i.current.flags&128)===128)}catch{}}function un(i){if(typeof Xv=="function"&&Wv(i),Ft&&typeof Ft.setStrictMode=="function")try{Ft.setStrictMode(dr,i)}catch{}}var Bt=Math.clz32?Math.clz32:ex,Zv=Math.log,Jv=Math.LN2;function ex(i){return i>>>=0,i===0?32:31-(Zv(i)/Jv|0)|0}var Ra=128,La=4194304;function Nn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function _a(i,s){var o=i.pendingLanes;if(o===0)return 0;var f=0,m=i.suspendedLanes,y=i.pingedLanes,T=i.warmLanes;i=i.finishedLanes!==0;var w=o&134217727;return w!==0?(o=w&~m,o!==0?f=Nn(o):(y&=w,y!==0?f=Nn(y):i||(T=w&~T,T!==0&&(f=Nn(T))))):(w=o&~m,w!==0?f=Nn(w):y!==0?f=Nn(y):i||(T=o&~T,T!==0&&(f=Nn(T)))),f===0?0:s!==0&&s!==f&&!(s&m)&&(m=f&-f,T=s&-s,m>=T||m===32&&(T&4194176)!==0)?s:f}function hr(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function tx(i,s){switch(i){case 1:case 2:case 4:case 8:return s+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jd(){var i=Ra;return Ra<<=1,!(Ra&4194176)&&(Ra=128),i}function Gd(){var i=La;return La<<=1,!(La&62914560)&&(La=4194304),i}function Po(i){for(var s=[],o=0;31>o;o++)s.push(i);return s}function mr(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ix(i,s,o,f,m,y){var T=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var w=i.entanglements,P=i.expirationTimes,G=i.hiddenUpdates;for(o=T&~o;0<o;){var ne=31-Bt(o),ce=1<<ne;w[ne]=0,P[ne]=-1;var J=G[ne];if(J!==null)for(G[ne]=null,ne=0;ne<J.length;ne++){var ie=J[ne];ie!==null&&(ie.lane&=-536870913)}o&=~ce}f!==0&&Hd(i,f,0),y!==0&&m===0&&i.tag!==0&&(i.suspendedLanes|=y&~(T&~s))}function Hd(i,s,o){i.pendingLanes|=s,i.suspendedLanes&=~s;var f=31-Bt(s);i.entangledLanes|=s,i.entanglements[f]=i.entanglements[f]|1073741824|o&4194218}function $d(i,s){var o=i.entangledLanes|=s;for(i=i.entanglements;o;){var f=31-Bt(o),m=1<<f;m&s|i[f]&s&&(i[f]|=s),o&=~m}}function Vd(i){return i&=-i,2<i?8<i?i&134217727?32:268435456:8:2}function zd(){var i=se.p;return i!==0?i:(i=window.event,i===void 0?32:hg(i.type))}function nx(i,s){var o=se.p;try{return se.p=i,s()}finally{se.p=o}}var cn=Math.random().toString(36).slice(2),Rt="__reactFiber$"+cn,It="__reactProps$"+cn,ms="__reactContainer$"+cn,Uo="__reactEvents$"+cn,sx="__reactListeners$"+cn,rx="__reactHandles$"+cn,Kd="__reactResources$"+cn,gr="__reactMarker$"+cn;function Fo(i){delete i[Rt],delete i[It],delete i[Uo],delete i[sx],delete i[rx]}function Pn(i){var s=i[Rt];if(s)return s;for(var o=i.parentNode;o;){if(s=o[ms]||o[Rt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(i=Zm(i);i!==null;){if(o=i[Rt])return o;i=Zm(i)}return s}i=o,o=i.parentNode}return null}function gs(i){if(i=i[Rt]||i[ms]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function pr(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(n(33))}function ps(i){var s=i[Kd];return s||(s=i[Kd]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function dt(i){i[gr]=!0}var Yd=new Set,qd={};function Un(i,s){ys(i,s),ys(i+"Capture",s)}function ys(i,s){for(qd[i]=s,i=0;i<s.length;i++)Yd.add(s[i])}var Ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ax=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xd={},Wd={};function lx(i){return on.call(Wd,i)?!0:on.call(Xd,i)?!1:ax.test(i)?Wd[i]=!0:(Xd[i]=!0,!1)}function Da(i,s,o){if(lx(s))if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+o)}}function Ca(i,s,o){if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+o)}}function Fi(i,s,o,f){if(f===null)i.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(s,o,""+f)}}function qt(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Qd(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ox(i){var s=Qd(i)?"checked":"value",o=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),f=""+i[s];if(!i.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var m=o.get,y=o.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return m.call(this)},set:function(T){f=""+T,y.call(this,T)}}),Object.defineProperty(i,s,{enumerable:o.enumerable}),{getValue:function(){return f},setValue:function(T){f=""+T},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function wa(i){i._valueTracker||(i._valueTracker=ox(i))}function Zd(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var o=s.getValue(),f="";return i&&(f=Qd(i)?i.checked?"true":"false":i.value),i=f,i!==o?(s.setValue(i),!0):!1}function Oa(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var ux=/[\n"\\]/g;function Xt(i){return i.replace(ux,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Bo(i,s,o,f,m,y,T,w){i.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.type=T:i.removeAttribute("type"),s!=null?T==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+qt(s)):i.value!==""+qt(s)&&(i.value=""+qt(s)):T!=="submit"&&T!=="reset"||i.removeAttribute("value"),s!=null?jo(i,T,qt(s)):o!=null?jo(i,T,qt(o)):f!=null&&i.removeAttribute("value"),m==null&&y!=null&&(i.defaultChecked=!!y),m!=null&&(i.checked=m&&typeof m!="function"&&typeof m!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?i.name=""+qt(w):i.removeAttribute("name")}function Jd(i,s,o,f,m,y,T,w){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null))return;o=o!=null?""+qt(o):"",s=s!=null?""+qt(s):o,w||s===i.value||(i.value=s),i.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=w?i.checked:!!f,i.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.name=T)}function jo(i,s,o){s==="number"&&Oa(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function vs(i,s,o,f){if(i=i.options,s){s={};for(var m=0;m<o.length;m++)s["$"+o[m]]=!0;for(o=0;o<i.length;o++)m=s.hasOwnProperty("$"+i[o].value),i[o].selected!==m&&(i[o].selected=m),m&&f&&(i[o].defaultSelected=!0)}else{for(o=""+qt(o),s=null,m=0;m<i.length;m++){if(i[m].value===o){i[m].selected=!0,f&&(i[m].defaultSelected=!0);return}s!==null||i[m].disabled||(s=i[m])}s!==null&&(s.selected=!0)}}function eh(i,s,o){if(s!=null&&(s=""+qt(s),s!==i.value&&(i.value=s),o==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=o!=null?""+qt(o):""}function th(i,s,o,f){if(s==null){if(f!=null){if(o!=null)throw Error(n(92));if(re(f)){if(1<f.length)throw Error(n(93));f=f[0]}o=f}o==null&&(o=""),s=o}o=qt(s),i.defaultValue=o,f=i.textContent,f===o&&f!==""&&f!==null&&(i.value=f)}function xs(i,s){if(s){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=s;return}}i.textContent=s}var cx=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ih(i,s,o){var f=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?f?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":f?i.setProperty(s,o):typeof o!="number"||o===0||cx.has(s)?s==="float"?i.cssFloat=o:i[s]=(""+o).trim():i[s]=o+"px"}function nh(i,s,o){if(s!=null&&typeof s!="object")throw Error(n(62));if(i=i.style,o!=null){for(var f in o)!o.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&o[m]!==f&&ih(i,m,f)}else for(var y in s)s.hasOwnProperty(y)&&ih(i,y,s[y])}function Go(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fx=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ia(i){return dx.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Ho=null;function $o(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ss=null,Es=null;function sh(i){var s=gs(i);if(s&&(i=s.stateNode)){var o=i[It]||null;e:switch(i=s.stateNode,s.type){case"input":if(Bo(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Xt(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var f=o[s];if(f!==i&&f.form===i.form){var m=f[It]||null;if(!m)throw Error(n(90));Bo(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<o.length;s++)f=o[s],f.form===i.form&&Zd(f)}break e;case"textarea":eh(i,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&vs(i,!!o.multiple,s,!1)}}}var Vo=!1;function rh(i,s,o){if(Vo)return i(s,o);Vo=!0;try{var f=i(s);return f}finally{if(Vo=!1,(Ss!==null||Es!==null)&&(gl(),Ss&&(s=Ss,i=Es,Es=Ss=null,sh(s),i)))for(s=0;s<i.length;s++)sh(i[s])}}function yr(i,s){var o=i.stateNode;if(o===null)return null;var f=o[It]||null;if(f===null)return null;o=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(n(231,s,typeof o));return o}var zo=!1;if(Ui)try{var vr={};Object.defineProperty(vr,"passive",{get:function(){zo=!0}}),window.addEventListener("test",vr,vr),window.removeEventListener("test",vr,vr)}catch{zo=!1}var fn=null,Ko=null,ka=null;function ah(){if(ka)return ka;var i,s=Ko,o=s.length,f,m="value"in fn?fn.value:fn.textContent,y=m.length;for(i=0;i<o&&s[i]===m[i];i++);var T=o-i;for(f=1;f<=T&&s[o-f]===m[y-f];f++);return ka=m.slice(i,1<f?1-f:void 0)}function Ma(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Na(){return!0}function lh(){return!1}function kt(i){function s(o,f,m,y,T){this._reactName=o,this._targetInst=m,this.type=f,this.nativeEvent=y,this.target=T,this.currentTarget=null;for(var w in i)i.hasOwnProperty(w)&&(o=i[w],this[w]=o?o(y):y[w]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Na:lh,this.isPropagationStopped=lh,this}return N(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Na)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Na)},persist:function(){},isPersistent:Na}),s}var Fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pa=kt(Fn),xr=N({},Fn,{view:0,detail:0}),hx=kt(xr),Yo,qo,Sr,Ua=N({},xr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Sr&&(Sr&&i.type==="mousemove"?(Yo=i.screenX-Sr.screenX,qo=i.screenY-Sr.screenY):qo=Yo=0,Sr=i),Yo)},movementY:function(i){return"movementY"in i?i.movementY:qo}}),oh=kt(Ua),mx=N({},Ua,{dataTransfer:0}),gx=kt(mx),px=N({},xr,{relatedTarget:0}),Xo=kt(px),yx=N({},Fn,{animationName:0,elapsedTime:0,pseudoElement:0}),vx=kt(yx),xx=N({},Fn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Sx=kt(xx),Ex=N({},Fn,{data:0}),uh=kt(Ex),Tx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ax={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rx(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Ax[i])?!!s[i]:!1}function Wo(){return Rx}var Lx=N({},xr,{key:function(i){if(i.key){var s=Tx[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Ma(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?bx[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wo,charCode:function(i){return i.type==="keypress"?Ma(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ma(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),_x=kt(Lx),Dx=N({},Ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ch=kt(Dx),Cx=N({},xr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wo}),wx=kt(Cx),Ox=N({},Fn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ix=kt(Ox),kx=N({},Ua,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Mx=kt(kx),Nx=N({},Fn,{newState:0,oldState:0}),Px=kt(Nx),Ux=[9,13,27,32],Qo=Ui&&"CompositionEvent"in window,Er=null;Ui&&"documentMode"in document&&(Er=document.documentMode);var Fx=Ui&&"TextEvent"in window&&!Er,fh=Ui&&(!Qo||Er&&8<Er&&11>=Er),dh=" ",hh=!1;function mh(i,s){switch(i){case"keyup":return Ux.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gh(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ts=!1;function Bx(i,s){switch(i){case"compositionend":return gh(s);case"keypress":return s.which!==32?null:(hh=!0,dh);case"textInput":return i=s.data,i===dh&&hh?null:i;default:return null}}function jx(i,s){if(Ts)return i==="compositionend"||!Qo&&mh(i,s)?(i=ah(),ka=Ko=fn=null,Ts=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return fh&&s.locale!=="ko"?null:s.data;default:return null}}var Gx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ph(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Gx[i.type]:s==="textarea"}function yh(i,s,o,f){Ss?Es?Es.push(f):Es=[f]:Ss=f,s=Sl(s,"onChange"),0<s.length&&(o=new Pa("onChange","change",null,o,f),i.push({event:o,listeners:s}))}var Tr=null,br=null;function Hx(i){$m(i,0)}function Fa(i){var s=pr(i);if(Zd(s))return i}function vh(i,s){if(i==="change")return s}var xh=!1;if(Ui){var Zo;if(Ui){var Jo="oninput"in document;if(!Jo){var Sh=document.createElement("div");Sh.setAttribute("oninput","return;"),Jo=typeof Sh.oninput=="function"}Zo=Jo}else Zo=!1;xh=Zo&&(!document.documentMode||9<document.documentMode)}function Eh(){Tr&&(Tr.detachEvent("onpropertychange",Th),br=Tr=null)}function Th(i){if(i.propertyName==="value"&&Fa(br)){var s=[];yh(s,br,i,$o(i)),rh(Hx,s)}}function $x(i,s,o){i==="focusin"?(Eh(),Tr=s,br=o,Tr.attachEvent("onpropertychange",Th)):i==="focusout"&&Eh()}function Vx(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Fa(br)}function zx(i,s){if(i==="click")return Fa(s)}function Kx(i,s){if(i==="input"||i==="change")return Fa(s)}function Yx(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var jt=typeof Object.is=="function"?Object.is:Yx;function Ar(i,s){if(jt(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var o=Object.keys(i),f=Object.keys(s);if(o.length!==f.length)return!1;for(f=0;f<o.length;f++){var m=o[f];if(!on.call(s,m)||!jt(i[m],s[m]))return!1}return!0}function bh(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ah(i,s){var o=bh(i);i=0;for(var f;o;){if(o.nodeType===3){if(f=i+o.textContent.length,i<=s&&f>=s)return{node:o,offset:s-i};i=f}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=bh(o)}}function Rh(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Rh(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Lh(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Oa(i.document);s instanceof i.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)i=s.contentWindow;else break;s=Oa(i.document)}return s}function eu(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function qx(i,s){var o=Lh(s);s=i.focusedElem;var f=i.selectionRange;if(o!==s&&s&&s.ownerDocument&&Rh(s.ownerDocument.documentElement,s)){if(f!==null&&eu(s)){if(i=f.start,o=f.end,o===void 0&&(o=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(o,s.value.length);else if(o=(i=s.ownerDocument||document)&&i.defaultView||window,o.getSelection){o=o.getSelection();var m=s.textContent.length,y=Math.min(f.start,m);f=f.end===void 0?y:Math.min(f.end,m),!o.extend&&y>f&&(m=f,f=y,y=m),m=Ah(s,y);var T=Ah(s,f);m&&T&&(o.rangeCount!==1||o.anchorNode!==m.node||o.anchorOffset!==m.offset||o.focusNode!==T.node||o.focusOffset!==T.offset)&&(i=i.createRange(),i.setStart(m.node,m.offset),o.removeAllRanges(),y>f?(o.addRange(i),o.extend(T.node,T.offset)):(i.setEnd(T.node,T.offset),o.addRange(i)))}}for(i=[],o=s;o=o.parentNode;)o.nodeType===1&&i.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)o=i[s],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Xx=Ui&&"documentMode"in document&&11>=document.documentMode,bs=null,tu=null,Rr=null,iu=!1;function _h(i,s,o){var f=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;iu||bs==null||bs!==Oa(f)||(f=bs,"selectionStart"in f&&eu(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Rr&&Ar(Rr,f)||(Rr=f,f=Sl(tu,"onSelect"),0<f.length&&(s=new Pa("onSelect","select",null,s,o),i.push({event:s,listeners:f}),s.target=bs)))}function Bn(i,s){var o={};return o[i.toLowerCase()]=s.toLowerCase(),o["Webkit"+i]="webkit"+s,o["Moz"+i]="moz"+s,o}var As={animationend:Bn("Animation","AnimationEnd"),animationiteration:Bn("Animation","AnimationIteration"),animationstart:Bn("Animation","AnimationStart"),transitionrun:Bn("Transition","TransitionRun"),transitionstart:Bn("Transition","TransitionStart"),transitioncancel:Bn("Transition","TransitionCancel"),transitionend:Bn("Transition","TransitionEnd")},nu={},Dh={};Ui&&(Dh=document.createElement("div").style,"AnimationEvent"in window||(delete As.animationend.animation,delete As.animationiteration.animation,delete As.animationstart.animation),"TransitionEvent"in window||delete As.transitionend.transition);function jn(i){if(nu[i])return nu[i];if(!As[i])return i;var s=As[i],o;for(o in s)if(s.hasOwnProperty(o)&&o in Dh)return nu[i]=s[o];return i}var Ch=jn("animationend"),wh=jn("animationiteration"),Oh=jn("animationstart"),Wx=jn("transitionrun"),Qx=jn("transitionstart"),Zx=jn("transitioncancel"),Ih=jn("transitionend"),kh=new Map,Mh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function di(i,s){kh.set(i,s),Un(s,[i])}var Wt=[],Rs=0,su=0;function Ba(){for(var i=Rs,s=su=Rs=0;s<i;){var o=Wt[s];Wt[s++]=null;var f=Wt[s];Wt[s++]=null;var m=Wt[s];Wt[s++]=null;var y=Wt[s];if(Wt[s++]=null,f!==null&&m!==null){var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}y!==0&&Nh(o,m,y)}}function ja(i,s,o,f){Wt[Rs++]=i,Wt[Rs++]=s,Wt[Rs++]=o,Wt[Rs++]=f,su|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function ru(i,s,o,f){return ja(i,s,o,f),Ga(i)}function dn(i,s){return ja(i,null,null,s),Ga(i)}function Nh(i,s,o){i.lanes|=o;var f=i.alternate;f!==null&&(f.lanes|=o);for(var m=!1,y=i.return;y!==null;)y.childLanes|=o,f=y.alternate,f!==null&&(f.childLanes|=o),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(m=!0)),i=y,y=y.return;m&&s!==null&&i.tag===3&&(y=i.stateNode,m=31-Bt(o),y=y.hiddenUpdates,i=y[m],i===null?y[m]=[s]:i.push(s),s.lane=o|536870912)}function Ga(i){if(50<Wr)throw Wr=0,fc=null,Error(n(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Ls={},Ph=new WeakMap;function Qt(i,s){if(typeof i=="object"&&i!==null){var o=Ph.get(i);return o!==void 0?o:(s={value:i,source:s,stack:oe(s)},Ph.set(i,s),s)}return{value:i,source:s,stack:oe(s)}}var _s=[],Ds=0,Ha=null,$a=0,Zt=[],Jt=0,Gn=null,Bi=1,ji="";function Hn(i,s){_s[Ds++]=$a,_s[Ds++]=Ha,Ha=i,$a=s}function Uh(i,s,o){Zt[Jt++]=Bi,Zt[Jt++]=ji,Zt[Jt++]=Gn,Gn=i;var f=Bi;i=ji;var m=32-Bt(f)-1;f&=~(1<<m),o+=1;var y=32-Bt(s)+m;if(30<y){var T=m-m%5;y=(f&(1<<T)-1).toString(32),f>>=T,m-=T,Bi=1<<32-Bt(s)+m|o<<m|f,ji=y+i}else Bi=1<<y|o<<m|f,ji=i}function au(i){i.return!==null&&(Hn(i,1),Uh(i,1,0))}function lu(i){for(;i===Ha;)Ha=_s[--Ds],_s[Ds]=null,$a=_s[--Ds],_s[Ds]=null;for(;i===Gn;)Gn=Zt[--Jt],Zt[Jt]=null,ji=Zt[--Jt],Zt[Jt]=null,Bi=Zt[--Jt],Zt[Jt]=null}var Ct=null,St=null,Pe=!1,hi=null,Ti=!1,ou=Error(n(519));function $n(i){var s=Error(n(418,""));throw Dr(Qt(s,i)),ou}function Fh(i){var s=i.stateNode,o=i.type,f=i.memoizedProps;switch(s[Rt]=i,s[It]=f,o){case"dialog":Ie("cancel",s),Ie("close",s);break;case"iframe":case"object":case"embed":Ie("load",s);break;case"video":case"audio":for(o=0;o<Zr.length;o++)Ie(Zr[o],s);break;case"source":Ie("error",s);break;case"img":case"image":case"link":Ie("error",s),Ie("load",s);break;case"details":Ie("toggle",s);break;case"input":Ie("invalid",s),Jd(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),wa(s);break;case"select":Ie("invalid",s);break;case"textarea":Ie("invalid",s),th(s,f.value,f.defaultValue,f.children),wa(s)}o=f.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||f.suppressHydrationWarning===!0||Ym(s.textContent,o)?(f.popover!=null&&(Ie("beforetoggle",s),Ie("toggle",s)),f.onScroll!=null&&Ie("scroll",s),f.onScrollEnd!=null&&Ie("scrollend",s),f.onClick!=null&&(s.onclick=El),s=!0):s=!1,s||$n(i)}function Bh(i){for(Ct=i.return;Ct;)switch(Ct.tag){case 3:case 27:Ti=!0;return;case 5:case 13:Ti=!1;return;default:Ct=Ct.return}}function Lr(i){if(i!==Ct)return!1;if(!Pe)return Bh(i),Pe=!0,!1;var s=!1,o;if((o=i.tag!==3&&i.tag!==27)&&((o=i.tag===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||Dc(i.type,i.memoizedProps)),o=!o),o&&(s=!0),s&&St&&$n(i),Bh(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(o=i.data,o==="/$"){if(s===0){St=gi(i.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;i=i.nextSibling}St=null}}else St=Ct?gi(i.stateNode.nextSibling):null;return!0}function _r(){St=Ct=null,Pe=!1}function Dr(i){hi===null?hi=[i]:hi.push(i)}var Cr=Error(n(460)),jh=Error(n(474)),uu={then:function(){}};function Gh(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Va(){}function Hh(i,s,o){switch(o=i[o],o===void 0?i.push(s):o!==s&&(s.then(Va,Va),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i===Cr?Error(n(483)):i;default:if(typeof s.status=="string")s.then(Va,Va);else{if(i=Ve,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=s,i.status="pending",i.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i===Cr?Error(n(483)):i}throw wr=s,Cr}}var wr=null;function $h(){if(wr===null)throw Error(n(459));var i=wr;return wr=null,i}var Cs=null,Or=0;function za(i){var s=Or;return Or+=1,Cs===null&&(Cs=[]),Hh(Cs,i,s)}function Ir(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Ka(i,s){throw s.$$typeof===l?Error(n(525)):(i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Vh(i){var s=i._init;return s(i._payload)}function zh(i){function s(K,j){if(i){var q=K.deletions;q===null?(K.deletions=[j],K.flags|=16):q.push(j)}}function o(K,j){if(!i)return null;for(;j!==null;)s(K,j),j=j.sibling;return null}function f(K){for(var j=new Map;K!==null;)K.key!==null?j.set(K.key,K):j.set(K.index,K),K=K.sibling;return j}function m(K,j){return K=An(K,j),K.index=0,K.sibling=null,K}function y(K,j,q){return K.index=q,i?(q=K.alternate,q!==null?(q=q.index,q<j?(K.flags|=33554434,j):q):(K.flags|=33554434,j)):(K.flags|=1048576,j)}function T(K){return i&&K.alternate===null&&(K.flags|=33554434),K}function w(K,j,q,ae){return j===null||j.tag!==6?(j=nc(q,K.mode,ae),j.return=K,j):(j=m(j,q),j.return=K,j)}function P(K,j,q,ae){var pe=q.type;return pe===d?ne(K,j,q.props.children,ae,q.key):j!==null&&(j.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===O&&Vh(pe)===j.type)?(j=m(j,q.props),Ir(j,q),j.return=K,j):(j=cl(q.type,q.key,q.props,null,K.mode,ae),Ir(j,q),j.return=K,j)}function G(K,j,q,ae){return j===null||j.tag!==4||j.stateNode.containerInfo!==q.containerInfo||j.stateNode.implementation!==q.implementation?(j=sc(q,K.mode,ae),j.return=K,j):(j=m(j,q.children||[]),j.return=K,j)}function ne(K,j,q,ae,pe){return j===null||j.tag!==7?(j=Jn(q,K.mode,ae,pe),j.return=K,j):(j=m(j,q),j.return=K,j)}function ce(K,j,q){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=nc(""+j,K.mode,q),j.return=K,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case u:return q=cl(j.type,j.key,j.props,null,K.mode,q),Ir(q,j),q.return=K,q;case c:return j=sc(j,K.mode,q),j.return=K,j;case O:var ae=j._init;return j=ae(j._payload),ce(K,j,q)}if(re(j)||F(j))return j=Jn(j,K.mode,q,null),j.return=K,j;if(typeof j.then=="function")return ce(K,za(j),q);if(j.$$typeof===x)return ce(K,ll(K,j),q);Ka(K,j)}return null}function J(K,j,q,ae){var pe=j!==null?j.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return pe!==null?null:w(K,j,""+q,ae);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case u:return q.key===pe?P(K,j,q,ae):null;case c:return q.key===pe?G(K,j,q,ae):null;case O:return pe=q._init,q=pe(q._payload),J(K,j,q,ae)}if(re(q)||F(q))return pe!==null?null:ne(K,j,q,ae,null);if(typeof q.then=="function")return J(K,j,za(q),ae);if(q.$$typeof===x)return J(K,j,ll(K,q),ae);Ka(K,q)}return null}function ie(K,j,q,ae,pe){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return K=K.get(q)||null,w(j,K,""+ae,pe);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case u:return K=K.get(ae.key===null?q:ae.key)||null,P(j,K,ae,pe);case c:return K=K.get(ae.key===null?q:ae.key)||null,G(j,K,ae,pe);case O:var Ce=ae._init;return ae=Ce(ae._payload),ie(K,j,q,ae,pe)}if(re(ae)||F(ae))return K=K.get(q)||null,ne(j,K,ae,pe,null);if(typeof ae.then=="function")return ie(K,j,q,za(ae),pe);if(ae.$$typeof===x)return ie(K,j,q,ll(j,ae),pe);Ka(j,ae)}return null}function ye(K,j,q,ae){for(var pe=null,Ce=null,ve=j,Ee=j=0,gt=null;ve!==null&&Ee<q.length;Ee++){ve.index>Ee?(gt=ve,ve=null):gt=ve.sibling;var Ue=J(K,ve,q[Ee],ae);if(Ue===null){ve===null&&(ve=gt);break}i&&ve&&Ue.alternate===null&&s(K,ve),j=y(Ue,j,Ee),Ce===null?pe=Ue:Ce.sibling=Ue,Ce=Ue,ve=gt}if(Ee===q.length)return o(K,ve),Pe&&Hn(K,Ee),pe;if(ve===null){for(;Ee<q.length;Ee++)ve=ce(K,q[Ee],ae),ve!==null&&(j=y(ve,j,Ee),Ce===null?pe=ve:Ce.sibling=ve,Ce=ve);return Pe&&Hn(K,Ee),pe}for(ve=f(ve);Ee<q.length;Ee++)gt=ie(ve,K,Ee,q[Ee],ae),gt!==null&&(i&&gt.alternate!==null&&ve.delete(gt.key===null?Ee:gt.key),j=y(gt,j,Ee),Ce===null?pe=gt:Ce.sibling=gt,Ce=gt);return i&&ve.forEach(function(On){return s(K,On)}),Pe&&Hn(K,Ee),pe}function Re(K,j,q,ae){if(q==null)throw Error(n(151));for(var pe=null,Ce=null,ve=j,Ee=j=0,gt=null,Ue=q.next();ve!==null&&!Ue.done;Ee++,Ue=q.next()){ve.index>Ee?(gt=ve,ve=null):gt=ve.sibling;var On=J(K,ve,Ue.value,ae);if(On===null){ve===null&&(ve=gt);break}i&&ve&&On.alternate===null&&s(K,ve),j=y(On,j,Ee),Ce===null?pe=On:Ce.sibling=On,Ce=On,ve=gt}if(Ue.done)return o(K,ve),Pe&&Hn(K,Ee),pe;if(ve===null){for(;!Ue.done;Ee++,Ue=q.next())Ue=ce(K,Ue.value,ae),Ue!==null&&(j=y(Ue,j,Ee),Ce===null?pe=Ue:Ce.sibling=Ue,Ce=Ue);return Pe&&Hn(K,Ee),pe}for(ve=f(ve);!Ue.done;Ee++,Ue=q.next())Ue=ie(ve,K,Ee,Ue.value,ae),Ue!==null&&(i&&Ue.alternate!==null&&ve.delete(Ue.key===null?Ee:Ue.key),j=y(Ue,j,Ee),Ce===null?pe=Ue:Ce.sibling=Ue,Ce=Ue);return i&&ve.forEach(function(dE){return s(K,dE)}),Pe&&Hn(K,Ee),pe}function tt(K,j,q,ae){if(typeof q=="object"&&q!==null&&q.type===d&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case u:e:{for(var pe=q.key;j!==null;){if(j.key===pe){if(pe=q.type,pe===d){if(j.tag===7){o(K,j.sibling),ae=m(j,q.props.children),ae.return=K,K=ae;break e}}else if(j.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===O&&Vh(pe)===j.type){o(K,j.sibling),ae=m(j,q.props),Ir(ae,q),ae.return=K,K=ae;break e}o(K,j);break}else s(K,j);j=j.sibling}q.type===d?(ae=Jn(q.props.children,K.mode,ae,q.key),ae.return=K,K=ae):(ae=cl(q.type,q.key,q.props,null,K.mode,ae),Ir(ae,q),ae.return=K,K=ae)}return T(K);case c:e:{for(pe=q.key;j!==null;){if(j.key===pe)if(j.tag===4&&j.stateNode.containerInfo===q.containerInfo&&j.stateNode.implementation===q.implementation){o(K,j.sibling),ae=m(j,q.children||[]),ae.return=K,K=ae;break e}else{o(K,j);break}else s(K,j);j=j.sibling}ae=sc(q,K.mode,ae),ae.return=K,K=ae}return T(K);case O:return pe=q._init,q=pe(q._payload),tt(K,j,q,ae)}if(re(q))return ye(K,j,q,ae);if(F(q)){if(pe=F(q),typeof pe!="function")throw Error(n(150));return q=pe.call(q),Re(K,j,q,ae)}if(typeof q.then=="function")return tt(K,j,za(q),ae);if(q.$$typeof===x)return tt(K,j,ll(K,q),ae);Ka(K,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,j!==null&&j.tag===6?(o(K,j.sibling),ae=m(j,q),ae.return=K,K=ae):(o(K,j),ae=nc(q,K.mode,ae),ae.return=K,K=ae),T(K)):o(K,j)}return function(K,j,q,ae){try{Or=0;var pe=tt(K,j,q,ae);return Cs=null,pe}catch(ve){if(ve===Cr)throw ve;var Ce=ni(29,ve,null,K.mode);return Ce.lanes=ae,Ce.return=K,Ce}finally{}}}var Vn=zh(!0),Kh=zh(!1),ws=me(null),Ya=me(0);function Yh(i,s){i=Qi,Oe(Ya,i),Oe(ws,s),Qi=i|s.baseLanes}function cu(){Oe(Ya,Qi),Oe(ws,ws.current)}function fu(){Qi=Ya.current,be(ws),be(Ya)}var ei=me(null),bi=null;function hn(i){var s=i.alternate;Oe(ut,ut.current&1),Oe(ei,i),bi===null&&(s===null||ws.current!==null||s.memoizedState!==null)&&(bi=i)}function qh(i){if(i.tag===22){if(Oe(ut,ut.current),Oe(ei,i),bi===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(bi=i)}}else mn()}function mn(){Oe(ut,ut.current),Oe(ei,ei.current)}function Gi(i){be(ei),bi===i&&(bi=null),be(ut)}var ut=me(0);function qa(i){for(var s=i;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Jx=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(o,f){i.push(f)}};this.abort=function(){s.aborted=!0,i.forEach(function(o){return o()})}},eS=r.unstable_scheduleCallback,tS=r.unstable_NormalPriority,ct={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function du(){return{controller:new Jx,data:new Map,refCount:0}}function kr(i){i.refCount--,i.refCount===0&&eS(tS,function(){i.controller.abort()})}var Mr=null,hu=0,Os=0,Is=null;function iS(i,s){if(Mr===null){var o=Mr=[];hu=0,Os=xc(),Is={status:"pending",value:void 0,then:function(f){o.push(f)}}}return hu++,s.then(Xh,Xh),s}function Xh(){if(--hu===0&&Mr!==null){Is!==null&&(Is.status="fulfilled");var i=Mr;Mr=null,Os=0,Is=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function nS(i,s){var o=[],f={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return i.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<o.length;m++)(0,o[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),f}var Wh=I.S;I.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&iS(i,s),Wh!==null&&Wh(i,s)};var zn=me(null);function mu(){var i=zn.current;return i!==null?i:Ve.pooledCache}function Xa(i,s){s===null?Oe(zn,zn.current):Oe(zn,s.pool)}function Qh(){var i=mu();return i===null?null:{parent:ct._currentValue,pool:i}}var gn=0,De=null,Ge=null,st=null,Wa=!1,ks=!1,Kn=!1,Qa=0,Nr=0,Ms=null,sS=0;function nt(){throw Error(n(321))}function gu(i,s){if(s===null)return!1;for(var o=0;o<s.length&&o<i.length;o++)if(!jt(i[o],s[o]))return!1;return!0}function pu(i,s,o,f,m,y){return gn=y,De=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,I.H=i===null||i.memoizedState===null?Yn:pn,Kn=!1,y=o(f,m),Kn=!1,ks&&(y=Jh(s,o,f,m)),Zh(i),y}function Zh(i){I.H=Ai;var s=Ge!==null&&Ge.next!==null;if(gn=0,st=Ge=De=null,Wa=!1,Nr=0,Ms=null,s)throw Error(n(300));i===null||ht||(i=i.dependencies,i!==null&&al(i)&&(ht=!0))}function Jh(i,s,o,f){De=i;var m=0;do{if(ks&&(Ms=null),Nr=0,ks=!1,25<=m)throw Error(n(301));if(m+=1,st=Ge=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}I.H=qn,y=s(o,f)}while(ks);return y}function rS(){var i=I.H,s=i.useState()[0];return s=typeof s.then=="function"?Pr(s):s,i=i.useState()[0],(Ge!==null?Ge.memoizedState:null)!==i&&(De.flags|=1024),s}function yu(){var i=Qa!==0;return Qa=0,i}function vu(i,s,o){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~o}function xu(i){if(Wa){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Wa=!1}gn=0,st=Ge=De=null,ks=!1,Nr=Qa=0,Ms=null}function Mt(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?De.memoizedState=st=i:st=st.next=i,st}function rt(){if(Ge===null){var i=De.alternate;i=i!==null?i.memoizedState:null}else i=Ge.next;var s=st===null?De.memoizedState:st.next;if(s!==null)st=s,Ge=i;else{if(i===null)throw De.alternate===null?Error(n(467)):Error(n(310));Ge=i,i={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},st===null?De.memoizedState=st=i:st=st.next=i}return st}var Za;Za=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Pr(i){var s=Nr;return Nr+=1,Ms===null&&(Ms=[]),i=Hh(Ms,i,s),s=De,(st===null?s.memoizedState:st.next)===null&&(s=s.alternate,I.H=s===null||s.memoizedState===null?Yn:pn),i}function Ja(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Pr(i);if(i.$$typeof===x)return Lt(i)}throw Error(n(438,String(i)))}function Su(i){var s=null,o=De.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var f=De.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Za(),De.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(i),f=0;f<i;f++)o[f]=k;return s.index++,o}function Hi(i,s){return typeof s=="function"?s(i):s}function el(i){var s=rt();return Eu(s,Ge,i)}function Eu(i,s,o){var f=i.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=o;var m=i.baseQueue,y=f.pending;if(y!==null){if(m!==null){var T=m.next;m.next=y.next,y.next=T}s.baseQueue=m=y,f.pending=null}if(y=i.baseState,m===null)i.memoizedState=y;else{s=m.next;var w=T=null,P=null,G=s,ne=!1;do{var ce=G.lane&-536870913;if(ce!==G.lane?(ke&ce)===ce:(gn&ce)===ce){var J=G.revertLane;if(J===0)P!==null&&(P=P.next={lane:0,revertLane:0,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null}),ce===Os&&(ne=!0);else if((gn&J)===J){G=G.next,J===Os&&(ne=!0);continue}else ce={lane:0,revertLane:G.revertLane,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},P===null?(w=P=ce,T=y):P=P.next=ce,De.lanes|=J,Rn|=J;ce=G.action,Kn&&o(y,ce),y=G.hasEagerState?G.eagerState:o(y,ce)}else J={lane:ce,revertLane:G.revertLane,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},P===null?(w=P=J,T=y):P=P.next=J,De.lanes|=ce,Rn|=ce;G=G.next}while(G!==null&&G!==s);if(P===null?T=y:P.next=w,!jt(y,i.memoizedState)&&(ht=!0,ne&&(o=Is,o!==null)))throw o;i.memoizedState=y,i.baseState=T,i.baseQueue=P,f.lastRenderedState=y}return m===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function Tu(i){var s=rt(),o=s.queue;if(o===null)throw Error(n(311));o.lastRenderedReducer=i;var f=o.dispatch,m=o.pending,y=s.memoizedState;if(m!==null){o.pending=null;var T=m=m.next;do y=i(y,T.action),T=T.next;while(T!==m);jt(y,s.memoizedState)||(ht=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,f]}function e0(i,s,o){var f=De,m=rt(),y=Pe;if(y){if(o===void 0)throw Error(n(407));o=o()}else o=s();var T=!jt((Ge||m).memoizedState,o);if(T&&(m.memoizedState=o,ht=!0),m=m.queue,Ru(n0.bind(null,f,m,i),[i]),m.getSnapshot!==s||T||st!==null&&st.memoizedState.tag&1){if(f.flags|=2048,Ns(9,i0.bind(null,f,m,o,s),{destroy:void 0},null),Ve===null)throw Error(n(349));y||gn&60||t0(f,s,o)}return o}function t0(i,s,o){i.flags|=16384,i={getSnapshot:s,value:o},s=De.updateQueue,s===null?(s=Za(),De.updateQueue=s,s.stores=[i]):(o=s.stores,o===null?s.stores=[i]:o.push(i))}function i0(i,s,o,f){s.value=o,s.getSnapshot=f,s0(s)&&r0(i)}function n0(i,s,o){return o(function(){s0(s)&&r0(i)})}function s0(i){var s=i.getSnapshot;i=i.value;try{var o=s();return!jt(i,o)}catch{return!0}}function r0(i){var s=dn(i,2);s!==null&&wt(s,i,2)}function bu(i){var s=Mt();if(typeof i=="function"){var o=i;if(i=o(),Kn){un(!0);try{o()}finally{un(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:i},s}function a0(i,s,o,f){return i.baseState=o,Eu(i,Ge,typeof f=="function"?f:Hi)}function aS(i,s,o,f,m){if(nl(i))throw Error(n(485));if(i=s.action,i!==null){var y={payload:m,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){y.listeners.push(T)}};I.T!==null?o(!0):y.isTransition=!1,f(y),o=s.pending,o===null?(y.next=s.pending=y,l0(s,y)):(y.next=o.next,s.pending=o.next=y)}}function l0(i,s){var o=s.action,f=s.payload,m=i.state;if(s.isTransition){var y=I.T,T={};I.T=T;try{var w=o(m,f),P=I.S;P!==null&&P(T,w),o0(i,s,w)}catch(G){Au(i,s,G)}finally{I.T=y}}else try{y=o(m,f),o0(i,s,y)}catch(G){Au(i,s,G)}}function o0(i,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(f){u0(i,s,f)},function(f){return Au(i,s,f)}):u0(i,s,o)}function u0(i,s,o){s.status="fulfilled",s.value=o,c0(s),i.state=o,s=i.pending,s!==null&&(o=s.next,o===s?i.pending=null:(o=o.next,s.next=o,l0(i,o)))}function Au(i,s,o){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=o,c0(s),s=s.next;while(s!==f)}i.action=null}function c0(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function f0(i,s){return s}function d0(i,s){if(Pe){var o=Ve.formState;if(o!==null){e:{var f=De;if(Pe){if(St){t:{for(var m=St,y=Ti;m.nodeType!==8;){if(!y){m=null;break t}if(m=gi(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){St=gi(m.nextSibling),f=m.data==="F!";break e}}$n(f)}f=!1}f&&(s=o[0])}}return o=Mt(),o.memoizedState=o.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f0,lastRenderedState:s},o.queue=f,o=w0.bind(null,De,f),f.dispatch=o,f=bu(!1),y=wu.bind(null,De,!1,f.queue),f=Mt(),m={state:s,dispatch:null,action:i,pending:null},f.queue=m,o=aS.bind(null,De,m,y,o),m.dispatch=o,f.memoizedState=i,[s,o,!1]}function h0(i){var s=rt();return m0(s,Ge,i)}function m0(i,s,o){s=Eu(i,s,f0)[0],i=el(Hi)[0],s=typeof s=="object"&&s!==null&&typeof s.then=="function"?Pr(s):s;var f=rt(),m=f.queue,y=m.dispatch;return o!==f.memoizedState&&(De.flags|=2048,Ns(9,lS.bind(null,m,o),{destroy:void 0},null)),[s,y,i]}function lS(i,s){i.action=s}function g0(i){var s=rt(),o=Ge;if(o!==null)return m0(s,o,i);rt(),s=s.memoizedState,o=rt();var f=o.queue.dispatch;return o.memoizedState=i,[s,f,!1]}function Ns(i,s,o,f){return i={tag:i,create:s,inst:o,deps:f,next:null},s=De.updateQueue,s===null&&(s=Za(),De.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=i.next=i:(f=o.next,o.next=i,i.next=f,s.lastEffect=i),i}function p0(){return rt().memoizedState}function tl(i,s,o,f){var m=Mt();De.flags|=i,m.memoizedState=Ns(1|s,o,{destroy:void 0},f===void 0?null:f)}function il(i,s,o,f){var m=rt();f=f===void 0?null:f;var y=m.memoizedState.inst;Ge!==null&&f!==null&&gu(f,Ge.memoizedState.deps)?m.memoizedState=Ns(s,o,y,f):(De.flags|=i,m.memoizedState=Ns(1|s,o,y,f))}function y0(i,s){tl(8390656,8,i,s)}function Ru(i,s){il(2048,8,i,s)}function v0(i,s){return il(4,2,i,s)}function x0(i,s){return il(4,4,i,s)}function S0(i,s){if(typeof s=="function"){i=i();var o=s(i);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function E0(i,s,o){o=o!=null?o.concat([i]):null,il(4,4,S0.bind(null,s,i),o)}function Lu(){}function T0(i,s){var o=rt();s=s===void 0?null:s;var f=o.memoizedState;return s!==null&&gu(s,f[1])?f[0]:(o.memoizedState=[i,s],i)}function b0(i,s){var o=rt();s=s===void 0?null:s;var f=o.memoizedState;if(s!==null&&gu(s,f[1]))return f[0];if(f=i(),Kn){un(!0);try{i()}finally{un(!1)}}return o.memoizedState=[f,s],f}function _u(i,s,o){return o===void 0||gn&1073741824?i.memoizedState=s:(i.memoizedState=o,i=Rm(),De.lanes|=i,Rn|=i,o)}function A0(i,s,o,f){return jt(o,s)?o:ws.current!==null?(i=_u(i,o,f),jt(i,s)||(ht=!0),i):gn&42?(i=Rm(),De.lanes|=i,Rn|=i,s):(ht=!0,i.memoizedState=o)}function R0(i,s,o,f,m){var y=se.p;se.p=y!==0&&8>y?y:8;var T=I.T,w={};I.T=w,wu(i,!1,s,o);try{var P=m(),G=I.S;if(G!==null&&G(w,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ne=nS(P,f);Ur(i,s,ne,Vt(i))}else Ur(i,s,f,Vt(i))}catch(ce){Ur(i,s,{then:function(){},status:"rejected",reason:ce},Vt())}finally{se.p=y,I.T=T}}function oS(){}function Du(i,s,o,f){if(i.tag!==5)throw Error(n(476));var m=L0(i).queue;R0(i,m,s,de,o===null?oS:function(){return _0(i),o(f)})}function L0(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:de,baseState:de,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:de},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:o},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function _0(i){var s=L0(i).next.queue;Ur(i,s,{},Vt())}function Cu(){return Lt(na)}function D0(){return rt().memoizedState}function C0(){return rt().memoizedState}function uS(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var o=Vt();i=xn(o);var f=Sn(s,i,o);f!==null&&(wt(f,s,o),jr(f,s,o)),s={cache:du()},i.payload=s;return}s=s.return}}function cS(i,s,o){var f=Vt();o={lane:f,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},nl(i)?O0(s,o):(o=ru(i,s,o,f),o!==null&&(wt(o,i,f),I0(o,s,f)))}function w0(i,s,o){var f=Vt();Ur(i,s,o,f)}function Ur(i,s,o,f){var m={lane:f,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(nl(i))O0(s,m);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var T=s.lastRenderedState,w=y(T,o);if(m.hasEagerState=!0,m.eagerState=w,jt(w,T))return ja(i,s,m,0),Ve===null&&Ba(),!1}catch{}finally{}if(o=ru(i,s,m,f),o!==null)return wt(o,i,f),I0(o,s,f),!0}return!1}function wu(i,s,o,f){if(f={lane:2,revertLane:xc(),action:f,hasEagerState:!1,eagerState:null,next:null},nl(i)){if(s)throw Error(n(479))}else s=ru(i,o,f,2),s!==null&&wt(s,i,2)}function nl(i){var s=i.alternate;return i===De||s!==null&&s===De}function O0(i,s){ks=Wa=!0;var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}function I0(i,s,o){if(o&4194176){var f=s.lanes;f&=i.pendingLanes,o|=f,s.lanes=o,$d(i,o)}}var Ai={readContext:Lt,use:Ja,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useLayoutEffect:nt,useInsertionEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useSyncExternalStore:nt,useId:nt};Ai.useCacheRefresh=nt,Ai.useMemoCache=nt,Ai.useHostTransitionStatus=nt,Ai.useFormState=nt,Ai.useActionState=nt,Ai.useOptimistic=nt;var Yn={readContext:Lt,use:Ja,useCallback:function(i,s){return Mt().memoizedState=[i,s===void 0?null:s],i},useContext:Lt,useEffect:y0,useImperativeHandle:function(i,s,o){o=o!=null?o.concat([i]):null,tl(4194308,4,S0.bind(null,s,i),o)},useLayoutEffect:function(i,s){return tl(4194308,4,i,s)},useInsertionEffect:function(i,s){tl(4,2,i,s)},useMemo:function(i,s){var o=Mt();s=s===void 0?null:s;var f=i();if(Kn){un(!0);try{i()}finally{un(!1)}}return o.memoizedState=[f,s],f},useReducer:function(i,s,o){var f=Mt();if(o!==void 0){var m=o(s);if(Kn){un(!0);try{o(s)}finally{un(!1)}}}else m=s;return f.memoizedState=f.baseState=m,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:m},f.queue=i,i=i.dispatch=cS.bind(null,De,i),[f.memoizedState,i]},useRef:function(i){var s=Mt();return i={current:i},s.memoizedState=i},useState:function(i){i=bu(i);var s=i.queue,o=w0.bind(null,De,s);return s.dispatch=o,[i.memoizedState,o]},useDebugValue:Lu,useDeferredValue:function(i,s){var o=Mt();return _u(o,i,s)},useTransition:function(){var i=bu(!1);return i=R0.bind(null,De,i.queue,!0,!1),Mt().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,o){var f=De,m=Mt();if(Pe){if(o===void 0)throw Error(n(407));o=o()}else{if(o=s(),Ve===null)throw Error(n(349));ke&60||t0(f,s,o)}m.memoizedState=o;var y={value:o,getSnapshot:s};return m.queue=y,y0(n0.bind(null,f,y,i),[i]),f.flags|=2048,Ns(9,i0.bind(null,f,y,o,s),{destroy:void 0},null),o},useId:function(){var i=Mt(),s=Ve.identifierPrefix;if(Pe){var o=ji,f=Bi;o=(f&~(1<<32-Bt(f)-1)).toString(32)+o,s=":"+s+"R"+o,o=Qa++,0<o&&(s+="H"+o.toString(32)),s+=":"}else o=sS++,s=":"+s+"r"+o.toString(32)+":";return i.memoizedState=s},useCacheRefresh:function(){return Mt().memoizedState=uS.bind(null,De)}};Yn.useMemoCache=Su,Yn.useHostTransitionStatus=Cu,Yn.useFormState=d0,Yn.useActionState=d0,Yn.useOptimistic=function(i){var s=Mt();s.memoizedState=s.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=wu.bind(null,De,!0,o),o.dispatch=s,[i,s]};var pn={readContext:Lt,use:Ja,useCallback:T0,useContext:Lt,useEffect:Ru,useImperativeHandle:E0,useInsertionEffect:v0,useLayoutEffect:x0,useMemo:b0,useReducer:el,useRef:p0,useState:function(){return el(Hi)},useDebugValue:Lu,useDeferredValue:function(i,s){var o=rt();return A0(o,Ge.memoizedState,i,s)},useTransition:function(){var i=el(Hi)[0],s=rt().memoizedState;return[typeof i=="boolean"?i:Pr(i),s]},useSyncExternalStore:e0,useId:D0};pn.useCacheRefresh=C0,pn.useMemoCache=Su,pn.useHostTransitionStatus=Cu,pn.useFormState=h0,pn.useActionState=h0,pn.useOptimistic=function(i,s){var o=rt();return a0(o,Ge,i,s)};var qn={readContext:Lt,use:Ja,useCallback:T0,useContext:Lt,useEffect:Ru,useImperativeHandle:E0,useInsertionEffect:v0,useLayoutEffect:x0,useMemo:b0,useReducer:Tu,useRef:p0,useState:function(){return Tu(Hi)},useDebugValue:Lu,useDeferredValue:function(i,s){var o=rt();return Ge===null?_u(o,i,s):A0(o,Ge.memoizedState,i,s)},useTransition:function(){var i=Tu(Hi)[0],s=rt().memoizedState;return[typeof i=="boolean"?i:Pr(i),s]},useSyncExternalStore:e0,useId:D0};qn.useCacheRefresh=C0,qn.useMemoCache=Su,qn.useHostTransitionStatus=Cu,qn.useFormState=g0,qn.useActionState=g0,qn.useOptimistic=function(i,s){var o=rt();return Ge!==null?a0(o,Ge,i,s):(o.baseState=i,[i,o.queue.dispatch])};function Ou(i,s,o,f){s=i.memoizedState,o=o(f,s),o=o==null?s:N({},s,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var Iu={isMounted:function(i){return(i=i._reactInternals)?le(i)===i:!1},enqueueSetState:function(i,s,o){i=i._reactInternals;var f=Vt(),m=xn(f);m.payload=s,o!=null&&(m.callback=o),s=Sn(i,m,f),s!==null&&(wt(s,i,f),jr(s,i,f))},enqueueReplaceState:function(i,s,o){i=i._reactInternals;var f=Vt(),m=xn(f);m.tag=1,m.payload=s,o!=null&&(m.callback=o),s=Sn(i,m,f),s!==null&&(wt(s,i,f),jr(s,i,f))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var o=Vt(),f=xn(o);f.tag=2,s!=null&&(f.callback=s),s=Sn(i,f,o),s!==null&&(wt(s,i,o),jr(s,i,o))}};function k0(i,s,o,f,m,y,T){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,y,T):s.prototype&&s.prototype.isPureReactComponent?!Ar(o,f)||!Ar(m,y):!0}function M0(i,s,o,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,f),s.state!==i&&Iu.enqueueReplaceState(s,s.state,null)}function Xn(i,s){var o=s;if("ref"in s){o={};for(var f in s)f!=="ref"&&(o[f]=s[f])}if(i=i.defaultProps){o===s&&(o=N({},o));for(var m in i)o[m]===void 0&&(o[m]=i[m])}return o}var sl=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function N0(i){sl(i)}function P0(i){console.error(i)}function U0(i){sl(i)}function rl(i,s){try{var o=i.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function F0(i,s,o){try{var f=i.onCaughtError;f(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function ku(i,s,o){return o=xn(o),o.tag=3,o.payload={element:null},o.callback=function(){rl(i,s)},o}function B0(i){return i=xn(i),i.tag=3,i}function j0(i,s,o,f){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var y=f.value;i.payload=function(){return m(y)},i.callback=function(){F0(s,o,f)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(i.callback=function(){F0(s,o,f),typeof m!="function"&&(Ln===null?Ln=new Set([this]):Ln.add(this));var w=f.stack;this.componentDidCatch(f.value,{componentStack:w!==null?w:""})})}function fS(i,s,o,f,m){if(o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=o.alternate,s!==null&&Br(s,o,m,!0),o=ei.current,o!==null){switch(o.tag){case 13:return bi===null?mc():o.alternate===null&&et===0&&(et=3),o.flags&=-257,o.flags|=65536,o.lanes=m,f===uu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([f]):s.add(f),pc(i,f,m)),!1;case 22:return o.flags|=65536,f===uu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([f]):o.add(f)),pc(i,f,m)),!1}throw Error(n(435,o.tag))}return pc(i,f,m),mc(),!1}if(Pe)return s=ei.current,s!==null?(!(s.flags&65536)&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==ou&&(i=Error(n(422),{cause:f}),Dr(Qt(i,o)))):(f!==ou&&(s=Error(n(423),{cause:f}),Dr(Qt(s,o))),i=i.current.alternate,i.flags|=65536,m&=-m,i.lanes|=m,f=Qt(f,o),m=ku(i.stateNode,f,m),qu(i,m),et!==4&&(et=2)),!1;var y=Error(n(520),{cause:f});if(y=Qt(y,o),qr===null?qr=[y]:qr.push(y),et!==4&&(et=2),s===null)return!0;f=Qt(f,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,i=m&-m,o.lanes|=i,i=ku(o.stateNode,f,i),qu(o,i),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ln===null||!Ln.has(y))))return o.flags|=65536,m&=-m,o.lanes|=m,m=B0(m),j0(m,i,o,f),qu(o,m),!1}o=o.return}while(o!==null);return!1}var G0=Error(n(461)),ht=!1;function Et(i,s,o,f){s.child=i===null?Kh(s,null,o,f):Vn(s,i.child,o,f)}function H0(i,s,o,f,m){o=o.render;var y=s.ref;if("ref"in f){var T={};for(var w in f)w!=="ref"&&(T[w]=f[w])}else T=f;return Qn(s),f=pu(i,s,o,T,y,m),w=yu(),i!==null&&!ht?(vu(i,s,m),$i(i,s,m)):(Pe&&w&&au(s),s.flags|=1,Et(i,s,f,m),s.child)}function $0(i,s,o,f,m){if(i===null){var y=o.type;return typeof y=="function"&&!ic(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,V0(i,s,y,f,m)):(i=cl(o.type,null,f,s,s.mode,m),i.ref=s.ref,i.return=s,s.child=i)}if(y=i.child,!Hu(i,m)){var T=y.memoizedProps;if(o=o.compare,o=o!==null?o:Ar,o(T,f)&&i.ref===s.ref)return $i(i,s,m)}return s.flags|=1,i=An(y,f),i.ref=s.ref,i.return=s,s.child=i}function V0(i,s,o,f,m){if(i!==null){var y=i.memoizedProps;if(Ar(y,f)&&i.ref===s.ref)if(ht=!1,s.pendingProps=f=y,Hu(i,m))i.flags&131072&&(ht=!0);else return s.lanes=i.lanes,$i(i,s,m)}return Mu(i,s,o,f,m)}function z0(i,s,o){var f=s.pendingProps,m=f.children,y=(s.stateNode._pendingVisibility&2)!==0,T=i!==null?i.memoizedState:null;if(Fr(i,s),f.mode==="hidden"||y){if(s.flags&128){if(f=T!==null?T.baseLanes|o:o,i!==null){for(m=s.child=i.child,y=0;m!==null;)y=y|m.lanes|m.childLanes,m=m.sibling;s.childLanes=y&~f}else s.childLanes=0,s.child=null;return K0(i,s,f,o)}if(o&536870912)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Xa(s,T!==null?T.cachePool:null),T!==null?Yh(s,T):cu(),qh(s);else return s.lanes=s.childLanes=536870912,K0(i,s,T!==null?T.baseLanes|o:o,o)}else T!==null?(Xa(s,T.cachePool),Yh(s,T),mn(),s.memoizedState=null):(i!==null&&Xa(s,null),cu(),mn());return Et(i,s,m,o),s.child}function K0(i,s,o,f){var m=mu();return m=m===null?null:{parent:ct._currentValue,pool:m},s.memoizedState={baseLanes:o,cachePool:m},i!==null&&Xa(s,null),cu(),qh(s),i!==null&&Br(i,s,f,!0),null}function Fr(i,s){var o=s.ref;if(o===null)i!==null&&i.ref!==null&&(s.flags|=2097664);else{if(typeof o!="function"&&typeof o!="object")throw Error(n(284));(i===null||i.ref!==o)&&(s.flags|=2097664)}}function Mu(i,s,o,f,m){return Qn(s),o=pu(i,s,o,f,void 0,m),f=yu(),i!==null&&!ht?(vu(i,s,m),$i(i,s,m)):(Pe&&f&&au(s),s.flags|=1,Et(i,s,o,m),s.child)}function Y0(i,s,o,f,m,y){return Qn(s),s.updateQueue=null,o=Jh(s,f,o,m),Zh(i),f=yu(),i!==null&&!ht?(vu(i,s,y),$i(i,s,y)):(Pe&&f&&au(s),s.flags|=1,Et(i,s,o,y),s.child)}function q0(i,s,o,f,m){if(Qn(s),s.stateNode===null){var y=Ls,T=o.contextType;typeof T=="object"&&T!==null&&(y=Lt(T)),y=new o(f,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Iu,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=f,y.state=s.memoizedState,y.refs={},Ku(s),T=o.contextType,y.context=typeof T=="object"&&T!==null?Lt(T):Ls,y.state=s.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(Ou(s,o,T,f),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(T=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),T!==y.state&&Iu.enqueueReplaceState(y,y.state,null),Hr(s,f,y,m),Gr(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(i===null){y=s.stateNode;var w=s.memoizedProps,P=Xn(o,w);y.props=P;var G=y.context,ne=o.contextType;T=Ls,typeof ne=="object"&&ne!==null&&(T=Lt(ne));var ce=o.getDerivedStateFromProps;ne=typeof ce=="function"||typeof y.getSnapshotBeforeUpdate=="function",w=s.pendingProps!==w,ne||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w||G!==T)&&M0(s,y,f,T),vn=!1;var J=s.memoizedState;y.state=J,Hr(s,f,y,m),Gr(),G=s.memoizedState,w||J!==G||vn?(typeof ce=="function"&&(Ou(s,o,ce,f),G=s.memoizedState),(P=vn||k0(s,o,P,f,J,G,T))?(ne||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=G),y.props=f,y.state=G,y.context=T,f=P):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{y=s.stateNode,Yu(i,s),T=s.memoizedProps,ne=Xn(o,T),y.props=ne,ce=s.pendingProps,J=y.context,G=o.contextType,P=Ls,typeof G=="object"&&G!==null&&(P=Lt(G)),w=o.getDerivedStateFromProps,(G=typeof w=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T!==ce||J!==P)&&M0(s,y,f,P),vn=!1,J=s.memoizedState,y.state=J,Hr(s,f,y,m),Gr();var ie=s.memoizedState;T!==ce||J!==ie||vn||i!==null&&i.dependencies!==null&&al(i.dependencies)?(typeof w=="function"&&(Ou(s,o,w,f),ie=s.memoizedState),(ne=vn||k0(s,o,ne,f,J,ie,P)||i!==null&&i.dependencies!==null&&al(i.dependencies))?(G||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,ie,P),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,ie,P)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||T===i.memoizedProps&&J===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&J===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=ie),y.props=f,y.state=ie,y.context=P,f=ne):(typeof y.componentDidUpdate!="function"||T===i.memoizedProps&&J===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&J===i.memoizedState||(s.flags|=1024),f=!1)}return y=f,Fr(i,s),f=(s.flags&128)!==0,y||f?(y=s.stateNode,o=f&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,i!==null&&f?(s.child=Vn(s,i.child,null,m),s.child=Vn(s,null,o,m)):Et(i,s,o,m),s.memoizedState=y.state,i=s.child):i=$i(i,s,m),i}function X0(i,s,o,f){return _r(),s.flags|=256,Et(i,s,o,f),s.child}var Nu={dehydrated:null,treeContext:null,retryLane:0};function Pu(i){return{baseLanes:i,cachePool:Qh()}}function Uu(i,s,o){return i=i!==null?i.childLanes&~o:0,s&&(i|=si),i}function W0(i,s,o){var f=s.pendingProps,m=!1,y=(s.flags&128)!==0,T;if((T=y)||(T=i!==null&&i.memoizedState===null?!1:(ut.current&2)!==0),T&&(m=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,i===null){if(Pe){if(m?hn(s):mn(),Pe){var w=St,P;if(P=w){e:{for(P=w,w=Ti;P.nodeType!==8;){if(!w){w=null;break e}if(P=gi(P.nextSibling),P===null){w=null;break e}}w=P}w!==null?(s.memoizedState={dehydrated:w,treeContext:Gn!==null?{id:Bi,overflow:ji}:null,retryLane:536870912},P=ni(18,null,null,0),P.stateNode=w,P.return=s,s.child=P,Ct=s,St=null,P=!0):P=!1}P||$n(s)}if(w=s.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return w.data==="$!"?s.lanes=16:s.lanes=536870912,null;Gi(s)}return w=f.children,f=f.fallback,m?(mn(),m=s.mode,w=Bu({mode:"hidden",children:w},m),f=Jn(f,m,o,null),w.return=s,f.return=s,w.sibling=f,s.child=w,m=s.child,m.memoizedState=Pu(o),m.childLanes=Uu(i,T,o),s.memoizedState=Nu,f):(hn(s),Fu(s,w))}if(P=i.memoizedState,P!==null&&(w=P.dehydrated,w!==null)){if(y)s.flags&256?(hn(s),s.flags&=-257,s=ju(i,s,o)):s.memoizedState!==null?(mn(),s.child=i.child,s.flags|=128,s=null):(mn(),m=f.fallback,w=s.mode,f=Bu({mode:"visible",children:f.children},w),m=Jn(m,w,o,null),m.flags|=2,f.return=s,m.return=s,f.sibling=m,s.child=f,Vn(s,i.child,null,o),f=s.child,f.memoizedState=Pu(o),f.childLanes=Uu(i,T,o),s.memoizedState=Nu,s=m);else if(hn(s),w.data==="$!"){if(T=w.nextSibling&&w.nextSibling.dataset,T)var G=T.dgst;T=G,f=Error(n(419)),f.stack="",f.digest=T,Dr({value:f,source:null,stack:null}),s=ju(i,s,o)}else if(ht||Br(i,s,o,!1),T=(o&i.childLanes)!==0,ht||T){if(T=Ve,T!==null){if(f=o&-o,f&42)f=1;else switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=64;break;case 268435456:f=134217728;break;default:f=0}if(f=f&(T.suspendedLanes|o)?0:f,f!==0&&f!==P.retryLane)throw P.retryLane=f,dn(i,f),wt(T,i,f),G0}w.data==="$?"||mc(),s=ju(i,s,o)}else w.data==="$?"?(s.flags|=128,s.child=i.child,s=LS.bind(null,i),w._reactRetry=s,s=null):(i=P.treeContext,St=gi(w.nextSibling),Ct=s,Pe=!0,hi=null,Ti=!1,i!==null&&(Zt[Jt++]=Bi,Zt[Jt++]=ji,Zt[Jt++]=Gn,Bi=i.id,ji=i.overflow,Gn=s),s=Fu(s,f.children),s.flags|=4096);return s}return m?(mn(),m=f.fallback,w=s.mode,P=i.child,G=P.sibling,f=An(P,{mode:"hidden",children:f.children}),f.subtreeFlags=P.subtreeFlags&31457280,G!==null?m=An(G,m):(m=Jn(m,w,o,null),m.flags|=2),m.return=s,f.return=s,f.sibling=m,s.child=f,f=m,m=s.child,w=i.child.memoizedState,w===null?w=Pu(o):(P=w.cachePool,P!==null?(G=ct._currentValue,P=P.parent!==G?{parent:G,pool:G}:P):P=Qh(),w={baseLanes:w.baseLanes|o,cachePool:P}),m.memoizedState=w,m.childLanes=Uu(i,T,o),s.memoizedState=Nu,f):(hn(s),o=i.child,i=o.sibling,o=An(o,{mode:"visible",children:f.children}),o.return=s,o.sibling=null,i!==null&&(T=s.deletions,T===null?(s.deletions=[i],s.flags|=16):T.push(i)),s.child=o,s.memoizedState=null,o)}function Fu(i,s){return s=Bu({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Bu(i,s){return Tm(i,s,0,null)}function ju(i,s,o){return Vn(s,i.child,null,o),i=Fu(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Q0(i,s,o){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),Vu(i.return,s,o)}function Gu(i,s,o,f,m){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:o,tailMode:m}:(y.isBackwards=s,y.rendering=null,y.renderingStartTime=0,y.last=f,y.tail=o,y.tailMode=m)}function Z0(i,s,o){var f=s.pendingProps,m=f.revealOrder,y=f.tail;if(Et(i,s,f.children,o),f=ut.current,f&2)f=f&1|2,s.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Q0(i,o,s);else if(i.tag===19)Q0(i,o,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}switch(Oe(ut,f),m){case"forwards":for(o=s.child,m=null;o!==null;)i=o.alternate,i!==null&&qa(i)===null&&(m=o),o=o.sibling;o=m,o===null?(m=s.child,s.child=null):(m=o.sibling,o.sibling=null),Gu(s,!1,m,o,y);break;case"backwards":for(o=null,m=s.child,s.child=null;m!==null;){if(i=m.alternate,i!==null&&qa(i)===null){s.child=m;break}i=m.sibling,m.sibling=o,o=m,m=i}Gu(s,!0,o,null,y);break;case"together":Gu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function $i(i,s,o){if(i!==null&&(s.dependencies=i.dependencies),Rn|=s.lanes,!(o&s.childLanes))if(i!==null){if(Br(i,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,o=An(i,i.pendingProps),s.child=o,o.return=s;i.sibling!==null;)i=i.sibling,o=o.sibling=An(i,i.pendingProps),o.return=s;o.sibling=null}return s.child}function Hu(i,s){return i.lanes&s?!0:(i=i.dependencies,!!(i!==null&&al(i)))}function dS(i,s,o){switch(s.tag){case 3:ot(s,s.stateNode.containerInfo),yn(s,ct,i.memoizedState.cache),_r();break;case 27:case 5:fi(s);break;case 4:ot(s,s.stateNode.containerInfo);break;case 10:yn(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(hn(s),s.flags|=128,null):o&s.child.childLanes?W0(i,s,o):(hn(s),i=$i(i,s,o),i!==null?i.sibling:null);hn(s);break;case 19:var m=(i.flags&128)!==0;if(f=(o&s.childLanes)!==0,f||(Br(i,s,o,!1),f=(o&s.childLanes)!==0),m){if(f)return Z0(i,s,o);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Oe(ut,ut.current),f)break;return null;case 22:case 23:return s.lanes=0,z0(i,s,o);case 24:yn(s,ct,i.memoizedState.cache)}return $i(i,s,o)}function J0(i,s,o){if(i!==null)if(i.memoizedProps!==s.pendingProps)ht=!0;else{if(!Hu(i,o)&&!(s.flags&128))return ht=!1,dS(i,s,o);ht=!!(i.flags&131072)}else ht=!1,Pe&&s.flags&1048576&&Uh(s,$a,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var f=s.elementType,m=f._init;if(f=m(f._payload),s.type=f,typeof f=="function")ic(f)?(i=Xn(f,i),s.tag=1,s=q0(null,s,f,i,o)):(s.tag=0,s=Mu(null,s,f,i,o));else{if(f!=null){if(m=f.$$typeof,m===S){s.tag=11,s=H0(null,s,f,i,o);break e}else if(m===A){s.tag=14,s=$0(null,s,f,i,o);break e}}throw s=M(f)||f,Error(n(306,s,""))}}return s;case 0:return Mu(i,s,s.type,s.pendingProps,o);case 1:return f=s.type,m=Xn(f,s.pendingProps),q0(i,s,f,m,o);case 3:e:{if(ot(s,s.stateNode.containerInfo),i===null)throw Error(n(387));var y=s.pendingProps;m=s.memoizedState,f=m.element,Yu(i,s),Hr(s,y,null,o);var T=s.memoizedState;if(y=T.cache,yn(s,ct,y),y!==m.cache&&zu(s,[ct],o,!0),Gr(),y=T.element,m.isDehydrated)if(m={element:y,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=m,s.memoizedState=m,s.flags&256){s=X0(i,s,y,o);break e}else if(y!==f){f=Qt(Error(n(424)),s),Dr(f),s=X0(i,s,y,o);break e}else for(St=gi(s.stateNode.containerInfo.firstChild),Ct=s,Pe=!0,hi=null,Ti=!0,o=Kh(s,null,y,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(_r(),y===f){s=$i(i,s,o);break e}Et(i,s,y,o)}s=s.child}return s;case 26:return Fr(i,s),i===null?(o=ig(s.type,null,s.pendingProps,null))?s.memoizedState=o:Pe||(o=s.type,i=s.pendingProps,f=Tl(xt.current).createElement(o),f[Rt]=s,f[It]=i,Tt(f,o,i),dt(f),s.stateNode=f):s.memoizedState=ig(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return fi(s),i===null&&Pe&&(f=s.stateNode=Jm(s.type,s.pendingProps,xt.current),Ct=s,Ti=!0,St=gi(f.firstChild)),f=s.pendingProps.children,i!==null||Pe?Et(i,s,f,o):s.child=Vn(s,null,f,o),Fr(i,s),s.child;case 5:return i===null&&Pe&&((m=f=St)&&(f=HS(f,s.type,s.pendingProps,Ti),f!==null?(s.stateNode=f,Ct=s,St=gi(f.firstChild),Ti=!1,m=!0):m=!1),m||$n(s)),fi(s),m=s.type,y=s.pendingProps,T=i!==null?i.memoizedProps:null,f=y.children,Dc(m,y)?f=null:T!==null&&Dc(m,T)&&(s.flags|=32),s.memoizedState!==null&&(m=pu(i,s,rS,null,null,o),na._currentValue=m),Fr(i,s),Et(i,s,f,o),s.child;case 6:return i===null&&Pe&&((i=o=St)&&(o=$S(o,s.pendingProps,Ti),o!==null?(s.stateNode=o,Ct=s,St=null,i=!0):i=!1),i||$n(s)),null;case 13:return W0(i,s,o);case 4:return ot(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=Vn(s,null,f,o):Et(i,s,f,o),s.child;case 11:return H0(i,s,s.type,s.pendingProps,o);case 7:return Et(i,s,s.pendingProps,o),s.child;case 8:return Et(i,s,s.pendingProps.children,o),s.child;case 12:return Et(i,s,s.pendingProps.children,o),s.child;case 10:return f=s.pendingProps,yn(s,s.type,f.value),Et(i,s,f.children,o),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,Qn(s),m=Lt(m),f=f(m),s.flags|=1,Et(i,s,f,o),s.child;case 14:return $0(i,s,s.type,s.pendingProps,o);case 15:return V0(i,s,s.type,s.pendingProps,o);case 19:return Z0(i,s,o);case 22:return z0(i,s,o);case 24:return Qn(s),f=Lt(ct),i===null?(m=mu(),m===null&&(m=Ve,y=du(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=o),m=y),s.memoizedState={parent:f,cache:m},Ku(s),yn(s,ct,m)):(i.lanes&o&&(Yu(i,s),Hr(s,null,null,o),Gr()),m=i.memoizedState,y=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),yn(s,ct,f)):(f=y.cache,yn(s,ct,f),f!==m.cache&&zu(s,[ct],o,!0))),Et(i,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}var $u=me(null),Wn=null,Vi=null;function yn(i,s,o){Oe($u,s._currentValue),s._currentValue=o}function zi(i){i._currentValue=$u.current,be($u)}function Vu(i,s,o){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===o)break;i=i.return}}function zu(i,s,o,f){var m=i.child;for(m!==null&&(m.return=i);m!==null;){var y=m.dependencies;if(y!==null){var T=m.child;y=y.firstContext;e:for(;y!==null;){var w=y;y=m;for(var P=0;P<s.length;P++)if(w.context===s[P]){y.lanes|=o,w=y.alternate,w!==null&&(w.lanes|=o),Vu(y.return,o,i),f||(T=null);break e}y=w.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(n(341));T.lanes|=o,y=T.alternate,y!==null&&(y.lanes|=o),Vu(T,o,i),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===i){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function Br(i,s,o,f){i=null;for(var m=s,y=!1;m!==null;){if(!y){if(m.flags&524288)y=!0;else if(m.flags&262144)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var w=m.type;jt(m.pendingProps.value,T.value)||(i!==null?i.push(w):i=[w])}}else if(m===qe.current){if(T=m.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(i!==null?i.push(na):i=[na])}m=m.return}i!==null&&zu(s,i,o,f),s.flags|=262144}function al(i){for(i=i.firstContext;i!==null;){if(!jt(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Qn(i){Wn=i,Vi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Lt(i){return em(Wn,i)}function ll(i,s){return Wn===null&&Qn(i),em(i,s)}function em(i,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Vi===null){if(i===null)throw Error(n(308));Vi=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Vi=Vi.next=s;return o}var vn=!1;function Ku(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yu(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function xn(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Sn(i,s,o){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,Qe&2){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=Ga(i),Nh(i,null,o),s}return ja(i,f,s,o),Ga(i)}function jr(i,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194176)!==0)){var f=s.lanes;f&=i.pendingLanes,o|=f,s.lanes=o,$d(i,o)}}function qu(i,s){var o=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,o===f)){var m=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?m=y=T:y=y.next=T,o=o.next}while(o!==null);y===null?m=y=s:y=y.next=s}else m=y=s;o={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=s:i.next=s,o.lastBaseUpdate=s}var Xu=!1;function Gr(){if(Xu){var i=Is;if(i!==null)throw i}}function Hr(i,s,o,f){Xu=!1;var m=i.updateQueue;vn=!1;var y=m.firstBaseUpdate,T=m.lastBaseUpdate,w=m.shared.pending;if(w!==null){m.shared.pending=null;var P=w,G=P.next;P.next=null,T===null?y=G:T.next=G,T=P;var ne=i.alternate;ne!==null&&(ne=ne.updateQueue,w=ne.lastBaseUpdate,w!==T&&(w===null?ne.firstBaseUpdate=G:w.next=G,ne.lastBaseUpdate=P))}if(y!==null){var ce=m.baseState;T=0,ne=G=P=null,w=y;do{var J=w.lane&-536870913,ie=J!==w.lane;if(ie?(ke&J)===J:(f&J)===J){J!==0&&J===Os&&(Xu=!0),ne!==null&&(ne=ne.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var ye=i,Re=w;J=s;var tt=o;switch(Re.tag){case 1:if(ye=Re.payload,typeof ye=="function"){ce=ye.call(tt,ce,J);break e}ce=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=Re.payload,J=typeof ye=="function"?ye.call(tt,ce,J):ye,J==null)break e;ce=N({},ce,J);break e;case 2:vn=!0}}J=w.callback,J!==null&&(i.flags|=64,ie&&(i.flags|=8192),ie=m.callbacks,ie===null?m.callbacks=[J]:ie.push(J))}else ie={lane:J,tag:w.tag,payload:w.payload,callback:w.callback,next:null},ne===null?(G=ne=ie,P=ce):ne=ne.next=ie,T|=J;if(w=w.next,w===null){if(w=m.shared.pending,w===null)break;ie=w,w=ie.next,ie.next=null,m.lastBaseUpdate=ie,m.shared.pending=null}}while(!0);ne===null&&(P=ce),m.baseState=P,m.firstBaseUpdate=G,m.lastBaseUpdate=ne,y===null&&(m.shared.lanes=0),Rn|=T,i.lanes=T,i.memoizedState=ce}}function tm(i,s){if(typeof i!="function")throw Error(n(191,i));i.call(s)}function im(i,s){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)tm(o[i],s)}function $r(i,s){try{var o=s.updateQueue,f=o!==null?o.lastEffect:null;if(f!==null){var m=f.next;o=m;do{if((o.tag&i)===i){f=void 0;var y=o.create,T=o.inst;f=y(),T.destroy=f}o=o.next}while(o!==m)}}catch(w){$e(s,s.return,w)}}function En(i,s,o){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var y=m.next;f=y;do{if((f.tag&i)===i){var T=f.inst,w=T.destroy;if(w!==void 0){T.destroy=void 0,m=s;var P=o;try{w()}catch(G){$e(m,P,G)}}}f=f.next}while(f!==y)}}catch(G){$e(s,s.return,G)}}function nm(i){var s=i.updateQueue;if(s!==null){var o=i.stateNode;try{im(s,o)}catch(f){$e(i,i.return,f)}}}function sm(i,s,o){o.props=Xn(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(f){$e(i,s,f)}}function Zn(i,s){try{var o=i.ref;if(o!==null){var f=i.stateNode;switch(i.tag){case 26:case 27:case 5:var m=f;break;default:m=f}typeof o=="function"?i.refCleanup=o(m):o.current=m}}catch(y){$e(i,s,y)}}function Gt(i,s){var o=i.ref,f=i.refCleanup;if(o!==null)if(typeof f=="function")try{f()}catch(m){$e(i,s,m)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){$e(i,s,m)}else o.current=null}function rm(i){var s=i.type,o=i.memoizedProps,f=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&f.focus();break e;case"img":o.src?f.src=o.src:o.srcSet&&(f.srcset=o.srcSet)}}catch(m){$e(i,i.return,m)}}function am(i,s,o){try{var f=i.stateNode;US(f,i.type,o,s),f[It]=s}catch(m){$e(i,i.return,m)}}function lm(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function Wu(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||lm(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Qu(i,s,o){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?o.nodeType===8?o.parentNode.insertBefore(i,s):o.insertBefore(i,s):(o.nodeType===8?(s=o.parentNode,s.insertBefore(i,o)):(s=o,s.appendChild(i)),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=El));else if(f!==4&&f!==27&&(i=i.child,i!==null))for(Qu(i,s,o),i=i.sibling;i!==null;)Qu(i,s,o),i=i.sibling}function ol(i,s,o){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?o.insertBefore(i,s):o.appendChild(i);else if(f!==4&&f!==27&&(i=i.child,i!==null))for(ol(i,s,o),i=i.sibling;i!==null;)ol(i,s,o),i=i.sibling}var Ki=!1,Je=!1,Zu=!1,om=typeof WeakSet=="function"?WeakSet:Set,mt=null,um=!1;function hS(i,s){if(i=i.containerInfo,Lc=Dl,i=Lh(i),eu(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var f=o.getSelection&&o.getSelection();if(f&&f.rangeCount!==0){o=f.anchorNode;var m=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var T=0,w=-1,P=-1,G=0,ne=0,ce=i,J=null;t:for(;;){for(var ie;ce!==o||m!==0&&ce.nodeType!==3||(w=T+m),ce!==y||f!==0&&ce.nodeType!==3||(P=T+f),ce.nodeType===3&&(T+=ce.nodeValue.length),(ie=ce.firstChild)!==null;)J=ce,ce=ie;for(;;){if(ce===i)break t;if(J===o&&++G===m&&(w=T),J===y&&++ne===f&&(P=T),(ie=ce.nextSibling)!==null)break;ce=J,J=ce.parentNode}ce=ie}o=w===-1||P===-1?null:{start:w,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(_c={focusedElem:i,selectionRange:o},Dl=!1,mt=s;mt!==null;)if(s=mt,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,mt=i;else for(;mt!==null;){switch(s=mt,y=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if(i&1024&&y!==null){i=void 0,o=s,m=y.memoizedProps,y=y.memoizedState,f=o.stateNode;try{var ye=Xn(o.type,m,o.elementType===o.type);i=f.getSnapshotBeforeUpdate(ye,y),f.__reactInternalSnapshotBeforeUpdate=i}catch(Re){$e(o,o.return,Re)}}break;case 3:if(i&1024){if(i=s.stateNode.containerInfo,o=i.nodeType,o===9)Oc(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Oc(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(i&1024)throw Error(n(163))}if(i=s.sibling,i!==null){i.return=s.return,mt=i;break}mt=s.return}return ye=um,um=!1,ye}function cm(i,s,o){var f=o.flags;switch(o.tag){case 0:case 11:case 15:qi(i,o),f&4&&$r(5,o);break;case 1:if(qi(i,o),f&4)if(i=o.stateNode,s===null)try{i.componentDidMount()}catch(w){$e(o,o.return,w)}else{var m=Xn(o.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(m,s,i.__reactInternalSnapshotBeforeUpdate)}catch(w){$e(o,o.return,w)}}f&64&&nm(o),f&512&&Zn(o,o.return);break;case 3:if(qi(i,o),f&64&&(f=o.updateQueue,f!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{im(f,i)}catch(w){$e(o,o.return,w)}}break;case 26:qi(i,o),f&512&&Zn(o,o.return);break;case 27:case 5:qi(i,o),s===null&&f&4&&rm(o),f&512&&Zn(o,o.return);break;case 12:qi(i,o);break;case 13:qi(i,o),f&4&&hm(i,o);break;case 22:if(m=o.memoizedState!==null||Ki,!m){s=s!==null&&s.memoizedState!==null||Je;var y=Ki,T=Je;Ki=m,(Je=s)&&!T?Tn(i,o,(o.subtreeFlags&8772)!==0):qi(i,o),Ki=y,Je=T}f&512&&(o.memoizedProps.mode==="manual"?Zn(o,o.return):Gt(o,o.return));break;default:qi(i,o)}}function fm(i){var s=i.alternate;s!==null&&(i.alternate=null,fm(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Fo(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var at=null,Ht=!1;function Yi(i,s,o){for(o=o.child;o!==null;)dm(i,s,o),o=o.sibling}function dm(i,s,o){if(Ft&&typeof Ft.onCommitFiberUnmount=="function")try{Ft.onCommitFiberUnmount(dr,o)}catch{}switch(o.tag){case 26:Je||Gt(o,s),Yi(i,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Je||Gt(o,s);var f=at,m=Ht;for(at=o.stateNode,Yi(i,s,o),o=o.stateNode,s=o.attributes;s.length;)o.removeAttributeNode(s[0]);Fo(o),at=f,Ht=m;break;case 5:Je||Gt(o,s);case 6:m=at;var y=Ht;if(at=null,Yi(i,s,o),at=m,Ht=y,at!==null)if(Ht)try{i=at,f=o.stateNode,i.nodeType===8?i.parentNode.removeChild(f):i.removeChild(f)}catch(T){$e(o,s,T)}else try{at.removeChild(o.stateNode)}catch(T){$e(o,s,T)}break;case 18:at!==null&&(Ht?(s=at,o=o.stateNode,s.nodeType===8?wc(s.parentNode,o):s.nodeType===1&&wc(s,o),la(s)):wc(at,o.stateNode));break;case 4:f=at,m=Ht,at=o.stateNode.containerInfo,Ht=!0,Yi(i,s,o),at=f,Ht=m;break;case 0:case 11:case 14:case 15:Je||En(2,o,s),Je||En(4,o,s),Yi(i,s,o);break;case 1:Je||(Gt(o,s),f=o.stateNode,typeof f.componentWillUnmount=="function"&&sm(o,s,f)),Yi(i,s,o);break;case 21:Yi(i,s,o);break;case 22:Je||Gt(o,s),Je=(f=Je)||o.memoizedState!==null,Yi(i,s,o),Je=f;break;default:Yi(i,s,o)}}function hm(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{la(i)}catch(o){$e(s,s.return,o)}}function mS(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new om),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new om),s;default:throw Error(n(435,i.tag))}}function Ju(i,s){var o=mS(i);s.forEach(function(f){var m=_S.bind(null,i,f);o.has(f)||(o.add(f),f.then(m,m))})}function ti(i,s){var o=s.deletions;if(o!==null)for(var f=0;f<o.length;f++){var m=o[f],y=i,T=s,w=T;e:for(;w!==null;){switch(w.tag){case 27:case 5:at=w.stateNode,Ht=!1;break e;case 3:at=w.stateNode.containerInfo,Ht=!0;break e;case 4:at=w.stateNode.containerInfo,Ht=!0;break e}w=w.return}if(at===null)throw Error(n(160));dm(y,T,m),at=null,Ht=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)mm(s,i),s=s.sibling}var mi=null;function mm(i,s){var o=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ti(s,i),ii(i),f&4&&(En(3,i,i.return),$r(3,i),En(5,i,i.return));break;case 1:ti(s,i),ii(i),f&512&&(Je||o===null||Gt(o,o.return)),f&64&&Ki&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?f:o.concat(f))));break;case 26:var m=mi;if(ti(s,i),ii(i),f&512&&(Je||o===null||Gt(o,o.return)),f&4){var y=o!==null?o.memoizedState:null;if(f=i.memoizedState,o===null)if(f===null)if(i.stateNode===null){e:{f=i.type,o=i.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":y=m.getElementsByTagName("title")[0],(!y||y[gr]||y[Rt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(f),m.head.insertBefore(y,m.querySelector("head > title"))),Tt(y,f,o),y[Rt]=i,dt(y),f=y;break e;case"link":var T=rg("link","href",m).get(f+(o.href||""));if(T){for(var w=0;w<T.length;w++)if(y=T[w],y.getAttribute("href")===(o.href==null?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(w,1);break t}}y=m.createElement(f),Tt(y,f,o),m.head.appendChild(y);break;case"meta":if(T=rg("meta","content",m).get(f+(o.content||""))){for(w=0;w<T.length;w++)if(y=T[w],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(w,1);break t}}y=m.createElement(f),Tt(y,f,o),m.head.appendChild(y);break;default:throw Error(n(468,f))}y[Rt]=i,dt(y),f=y}i.stateNode=f}else ag(m,i.type,i.stateNode);else i.stateNode=sg(m,f,i.memoizedProps);else y!==f?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,f===null?ag(m,i.type,i.stateNode):sg(m,f,i.memoizedProps)):f===null&&i.stateNode!==null&&am(i,i.memoizedProps,o.memoizedProps)}break;case 27:if(f&4&&i.alternate===null){m=i.stateNode,y=i.memoizedProps;try{for(var P=m.firstChild;P;){var G=P.nextSibling,ne=P.nodeName;P[gr]||ne==="HEAD"||ne==="BODY"||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&P.rel.toLowerCase()==="stylesheet"||m.removeChild(P),P=G}for(var ce=i.type,J=m.attributes;J.length;)m.removeAttributeNode(J[0]);Tt(m,ce,y),m[Rt]=i,m[It]=y}catch(ye){$e(i,i.return,ye)}}case 5:if(ti(s,i),ii(i),f&512&&(Je||o===null||Gt(o,o.return)),i.flags&32){m=i.stateNode;try{xs(m,"")}catch(ye){$e(i,i.return,ye)}}f&4&&i.stateNode!=null&&(m=i.memoizedProps,am(i,m,o!==null?o.memoizedProps:m)),f&1024&&(Zu=!0);break;case 6:if(ti(s,i),ii(i),f&4){if(i.stateNode===null)throw Error(n(162));f=i.memoizedProps,o=i.stateNode;try{o.nodeValue=f}catch(ye){$e(i,i.return,ye)}}break;case 3:if(Rl=null,m=mi,mi=bl(s.containerInfo),ti(s,i),mi=m,ii(i),f&4&&o!==null&&o.memoizedState.isDehydrated)try{la(s.containerInfo)}catch(ye){$e(i,i.return,ye)}Zu&&(Zu=!1,gm(i));break;case 4:f=mi,mi=bl(i.stateNode.containerInfo),ti(s,i),ii(i),mi=f;break;case 12:ti(s,i),ii(i);break;case 13:ti(s,i),ii(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(oc=Yt()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Ju(i,f)));break;case 22:if(f&512&&(Je||o===null||Gt(o,o.return)),P=i.memoizedState!==null,G=o!==null&&o.memoizedState!==null,ne=Ki,ce=Je,Ki=ne||P,Je=ce||G,ti(s,i),Je=ce,Ki=ne,ii(i),s=i.stateNode,s._current=i,s._visibility&=-3,s._visibility|=s._pendingVisibility&2,f&8192&&(s._visibility=P?s._visibility&-2:s._visibility|1,P&&(s=Ki||Je,o===null||G||s||Ps(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))e:for(o=null,s=i;;){if(s.tag===5||s.tag===26||s.tag===27){if(o===null){G=o=s;try{if(m=G.stateNode,P)y=m.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{T=G.stateNode,w=G.memoizedProps.style;var ie=w!=null&&w.hasOwnProperty("display")?w.display:null;T.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(ye){$e(G,G.return,ye)}}}else if(s.tag===6){if(o===null){G=s;try{G.stateNode.nodeValue=P?"":G.memoizedProps}catch(ye){$e(G,G.return,ye)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=i.updateQueue,f!==null&&(o=f.retryQueue,o!==null&&(f.retryQueue=null,Ju(i,o))));break;case 19:ti(s,i),ii(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Ju(i,f)));break;case 21:break;default:ti(s,i),ii(i)}}function ii(i){var s=i.flags;if(s&2){try{if(i.tag!==27){e:{for(var o=i.return;o!==null;){if(lm(o)){var f=o;break e}o=o.return}throw Error(n(160))}switch(f.tag){case 27:var m=f.stateNode,y=Wu(i);ol(i,y,m);break;case 5:var T=f.stateNode;f.flags&32&&(xs(T,""),f.flags&=-33);var w=Wu(i);ol(i,w,T);break;case 3:case 4:var P=f.stateNode.containerInfo,G=Wu(i);Qu(i,G,P);break;default:throw Error(n(161))}}}catch(ne){$e(i,i.return,ne)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function gm(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;gm(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function qi(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)cm(i,s.alternate,s),s=s.sibling}function Ps(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:En(4,s,s.return),Ps(s);break;case 1:Gt(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&sm(s,s.return,o),Ps(s);break;case 26:case 27:case 5:Gt(s,s.return),Ps(s);break;case 22:Gt(s,s.return),s.memoizedState===null&&Ps(s);break;default:Ps(s)}i=i.sibling}}function Tn(i,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=i,y=s,T=y.flags;switch(y.tag){case 0:case 11:case 15:Tn(m,y,o),$r(4,y);break;case 1:if(Tn(m,y,o),f=y,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(G){$e(f,f.return,G)}if(f=y,m=f.updateQueue,m!==null){var w=f.stateNode;try{var P=m.shared.hiddenCallbacks;if(P!==null)for(m.shared.hiddenCallbacks=null,m=0;m<P.length;m++)tm(P[m],w)}catch(G){$e(f,f.return,G)}}o&&T&64&&nm(y),Zn(y,y.return);break;case 26:case 27:case 5:Tn(m,y,o),o&&f===null&&T&4&&rm(y),Zn(y,y.return);break;case 12:Tn(m,y,o);break;case 13:Tn(m,y,o),o&&T&4&&hm(m,y);break;case 22:y.memoizedState===null&&Tn(m,y,o),Zn(y,y.return);break;default:Tn(m,y,o)}s=s.sibling}}function ec(i,s){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&kr(o))}function tc(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&kr(i))}function bn(i,s,o,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)pm(i,s,o,f),s=s.sibling}function pm(i,s,o,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:bn(i,s,o,f),m&2048&&$r(9,s);break;case 3:bn(i,s,o,f),m&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&kr(i)));break;case 12:if(m&2048){bn(i,s,o,f),i=s.stateNode;try{var y=s.memoizedProps,T=y.id,w=y.onPostCommit;typeof w=="function"&&w(T,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(P){$e(s,s.return,P)}}else bn(i,s,o,f);break;case 23:break;case 22:y=s.stateNode,s.memoizedState!==null?y._visibility&4?bn(i,s,o,f):Vr(i,s):y._visibility&4?bn(i,s,o,f):(y._visibility|=4,Us(i,s,o,f,(s.subtreeFlags&10256)!==0)),m&2048&&ec(s.alternate,s);break;case 24:bn(i,s,o,f),m&2048&&tc(s.alternate,s);break;default:bn(i,s,o,f)}}function Us(i,s,o,f,m){for(m=m&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var y=i,T=s,w=o,P=f,G=T.flags;switch(T.tag){case 0:case 11:case 15:Us(y,T,w,P,m),$r(8,T);break;case 23:break;case 22:var ne=T.stateNode;T.memoizedState!==null?ne._visibility&4?Us(y,T,w,P,m):Vr(y,T):(ne._visibility|=4,Us(y,T,w,P,m)),m&&G&2048&&ec(T.alternate,T);break;case 24:Us(y,T,w,P,m),m&&G&2048&&tc(T.alternate,T);break;default:Us(y,T,w,P,m)}s=s.sibling}}function Vr(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=i,f=s,m=f.flags;switch(f.tag){case 22:Vr(o,f),m&2048&&ec(f.alternate,f);break;case 24:Vr(o,f),m&2048&&tc(f.alternate,f);break;default:Vr(o,f)}s=s.sibling}}var zr=8192;function Fs(i){if(i.subtreeFlags&zr)for(i=i.child;i!==null;)ym(i),i=i.sibling}function ym(i){switch(i.tag){case 26:Fs(i),i.flags&zr&&i.memoizedState!==null&&iE(mi,i.memoizedState,i.memoizedProps);break;case 5:Fs(i);break;case 3:case 4:var s=mi;mi=bl(i.stateNode.containerInfo),Fs(i),mi=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=zr,zr=16777216,Fs(i),zr=s):Fs(i));break;default:Fs(i)}}function vm(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Kr(i){var s=i.deletions;if(i.flags&16){if(s!==null)for(var o=0;o<s.length;o++){var f=s[o];mt=f,Sm(f,i)}vm(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)xm(i),i=i.sibling}function xm(i){switch(i.tag){case 0:case 11:case 15:Kr(i),i.flags&2048&&En(9,i,i.return);break;case 3:Kr(i);break;case 12:Kr(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&4&&(i.return===null||i.return.tag!==13)?(s._visibility&=-5,ul(i)):Kr(i);break;default:Kr(i)}}function ul(i){var s=i.deletions;if(i.flags&16){if(s!==null)for(var o=0;o<s.length;o++){var f=s[o];mt=f,Sm(f,i)}vm(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:En(8,s,s.return),ul(s);break;case 22:o=s.stateNode,o._visibility&4&&(o._visibility&=-5,ul(s));break;default:ul(s)}i=i.sibling}}function Sm(i,s){for(;mt!==null;){var o=mt;switch(o.tag){case 0:case 11:case 15:En(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var f=o.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:kr(o.memoizedState.cache)}if(f=o.child,f!==null)f.return=o,mt=f;else e:for(o=i;mt!==null;){f=mt;var m=f.sibling,y=f.return;if(fm(f),f===o){mt=null;break e}if(m!==null){m.return=y,mt=m;break e}mt=y}}}function gS(i,s,o,f){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ni(i,s,o,f){return new gS(i,s,o,f)}function ic(i){return i=i.prototype,!(!i||!i.isReactComponent)}function An(i,s){var o=i.alternate;return o===null?(o=ni(i.tag,s,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=s,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&31457280,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,s=i.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function Em(i,s){i.flags&=31457282;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,s=o.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function cl(i,s,o,f,m,y){var T=0;if(f=i,typeof i=="function")ic(i)&&(T=1);else if(typeof i=="string")T=eE(i,o,it.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case d:return Jn(o.children,m,y,s);case h:T=8,m|=24;break;case g:return i=ni(12,o,s,m|2),i.elementType=g,i.lanes=y,i;case E:return i=ni(13,o,s,m),i.elementType=E,i.lanes=y,i;case b:return i=ni(19,o,s,m),i.elementType=b,i.lanes=y,i;case _:return Tm(o,m,y,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case p:case x:T=10;break e;case v:T=9;break e;case S:T=11;break e;case A:T=14;break e;case O:T=16,f=null;break e}T=29,o=Error(n(130,i===null?"null":typeof i,"")),f=null}return s=ni(T,o,s,m),s.elementType=i,s.type=f,s.lanes=y,s}function Jn(i,s,o,f){return i=ni(7,i,f,s),i.lanes=o,i}function Tm(i,s,o,f){i=ni(22,i,f,s),i.elementType=_,i.lanes=o;var m={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var y=m._current;if(y===null)throw Error(n(456));if(!(m._pendingVisibility&2)){var T=dn(y,2);T!==null&&(m._pendingVisibility|=2,wt(T,y,2))}},attach:function(){var y=m._current;if(y===null)throw Error(n(456));if(m._pendingVisibility&2){var T=dn(y,2);T!==null&&(m._pendingVisibility&=-3,wt(T,y,2))}}};return i.stateNode=m,i}function nc(i,s,o){return i=ni(6,i,null,s),i.lanes=o,i}function sc(i,s,o){return s=ni(4,i.children!==null?i.children:[],i.key,s),s.lanes=o,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function Xi(i){i.flags|=4}function bm(i,s){if(s.type!=="stylesheet"||s.state.loading&4)i.flags&=-16777217;else if(i.flags|=16777216,!lg(s)){if(s=ei.current,s!==null&&((ke&4194176)===ke?bi!==null:(ke&62914560)!==ke&&!(ke&536870912)||s!==bi))throw wr=uu,jh;i.flags|=8192}}function fl(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Gd():536870912,i.lanes|=s,js|=s)}function Yr(i,s){if(!Pe)switch(i.tailMode){case"hidden":s=i.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function We(i){var s=i.alternate!==null&&i.alternate.child===i.child,o=0,f=0;if(s)for(var m=i.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags&31457280,f|=m.flags&31457280,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=f,i.childLanes=o,s}function pS(i,s,o){var f=s.pendingProps;switch(lu(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return We(s),null;case 1:return We(s),null;case 3:return o=s.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),zi(ct),Ye(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Lr(s)?Xi(s):i===null||i.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,hi!==null&&(dc(hi),hi=null))),We(s),null;case 26:return o=s.memoizedState,i===null?(Xi(s),o!==null?(We(s),bm(s,o)):(We(s),s.flags&=-16777217)):o?o!==i.memoizedState?(Xi(s),We(s),bm(s,o)):(We(s),s.flags&=-16777217):(i.memoizedProps!==f&&Xi(s),We(s),s.flags&=-16777217),null;case 27:Ei(s),o=xt.current;var m=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Xi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return We(s),null}i=it.current,Lr(s)?Fh(s):(i=Jm(m,f,o),s.stateNode=i,Xi(s))}return We(s),null;case 5:if(Ei(s),o=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Xi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return We(s),null}if(i=it.current,Lr(s))Fh(s);else{switch(m=Tl(xt.current),i){case 1:i=m.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:i=m.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":i=m.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":i=m.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":i=m.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?i.multiple=!0:f.size&&(i.size=f.size);break;default:i=typeof f.is=="string"?m.createElement(o,{is:f.is}):m.createElement(o)}}i[Rt]=s,i[It]=f;e:for(m=s.child;m!==null;){if(m.tag===5||m.tag===6)i.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===s)break e;for(;m.sibling===null;){if(m.return===null||m.return===s)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}s.stateNode=i;e:switch(Tt(i,o,f),o){case"button":case"input":case"select":case"textarea":i=!!f.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Xi(s)}}return We(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==f&&Xi(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(i=xt.current,Lr(s)){if(i=s.stateNode,o=s.memoizedProps,f=null,m=Ct,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}i[Rt]=s,i=!!(i.nodeValue===o||f!==null&&f.suppressHydrationWarning===!0||Ym(i.nodeValue,o)),i||$n(s)}else i=Tl(i).createTextNode(f),i[Rt]=s,s.stateNode=i}return We(s),null;case 13:if(f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(m=Lr(s),f!==null&&f.dehydrated!==null){if(i===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[Rt]=s}else _r(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;We(s),m=!1}else hi!==null&&(dc(hi),hi=null),m=!0;if(!m)return s.flags&256?(Gi(s),s):(Gi(s),null)}if(Gi(s),s.flags&128)return s.lanes=o,s;if(o=f!==null,i=i!==null&&i.memoizedState!==null,o){f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var y=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==m&&(f.flags|=2048)}return o!==i&&o&&(s.child.flags|=8192),fl(s,s.updateQueue),We(s),null;case 4:return Ye(),i===null&&bc(s.stateNode.containerInfo),We(s),null;case 10:return zi(s.type),We(s),null;case 19:if(be(ut),m=s.memoizedState,m===null)return We(s),null;if(f=(s.flags&128)!==0,y=m.rendering,y===null)if(f)Yr(m,!1);else{if(et!==0||i!==null&&i.flags&128)for(i=s.child;i!==null;){if(y=qa(i),y!==null){for(s.flags|=128,Yr(m,!1),i=y.updateQueue,s.updateQueue=i,fl(s,i),s.subtreeFlags=0,i=o,o=s.child;o!==null;)Em(o,i),o=o.sibling;return Oe(ut,ut.current&1|2),s.child}i=i.sibling}m.tail!==null&&Yt()>dl&&(s.flags|=128,f=!0,Yr(m,!1),s.lanes=4194304)}else{if(!f)if(i=qa(y),i!==null){if(s.flags|=128,f=!0,i=i.updateQueue,s.updateQueue=i,fl(s,i),Yr(m,!0),m.tail===null&&m.tailMode==="hidden"&&!y.alternate&&!Pe)return We(s),null}else 2*Yt()-m.renderingStartTime>dl&&o!==536870912&&(s.flags|=128,f=!0,Yr(m,!1),s.lanes=4194304);m.isBackwards?(y.sibling=s.child,s.child=y):(i=m.last,i!==null?i.sibling=y:s.child=y,m.last=y)}return m.tail!==null?(s=m.tail,m.rendering=s,m.tail=s.sibling,m.renderingStartTime=Yt(),s.sibling=null,i=ut.current,Oe(ut,f?i&1|2:i&1),s):(We(s),null);case 22:case 23:return Gi(s),fu(),f=s.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?o&536870912&&!(s.flags&128)&&(We(s),s.subtreeFlags&6&&(s.flags|=8192)):We(s),o=s.updateQueue,o!==null&&fl(s,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==o&&(s.flags|=2048),i!==null&&be(zn),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),zi(ct),We(s),null;case 25:return null}throw Error(n(156,s.tag))}function yS(i,s){switch(lu(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return zi(ct),Ye(),i=s.flags,i&65536&&!(i&128)?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Ei(s),null;case 13:if(Gi(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));_r()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return be(ut),null;case 4:return Ye(),null;case 10:return zi(s.type),null;case 22:case 23:return Gi(s),fu(),i!==null&&be(zn),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return zi(ct),null;case 25:return null;default:return null}}function Am(i,s){switch(lu(s),s.tag){case 3:zi(ct),Ye();break;case 26:case 27:case 5:Ei(s);break;case 4:Ye();break;case 13:Gi(s);break;case 19:be(ut);break;case 10:zi(s.type);break;case 22:case 23:Gi(s),fu(),i!==null&&be(zn);break;case 24:zi(ct)}}var vS={getCacheForType:function(i){var s=Lt(ct),o=s.data.get(i);return o===void 0&&(o=i(),s.data.set(i,o)),o}},xS=typeof WeakMap=="function"?WeakMap:Map,Qe=0,Ve=null,we=null,ke=0,ze=0,$t=null,Wi=!1,Bs=!1,rc=!1,Qi=0,et=0,Rn=0,es=0,ac=0,si=0,js=0,qr=null,Ri=null,lc=!1,oc=0,dl=1/0,hl=null,Ln=null,ml=!1,ts=null,Xr=0,uc=0,cc=null,Wr=0,fc=null;function Vt(){if(Qe&2&&ke!==0)return ke&-ke;if(I.T!==null){var i=Os;return i!==0?i:xc()}return zd()}function Rm(){si===0&&(si=!(ke&536870912)||Pe?jd():536870912);var i=ei.current;return i!==null&&(i.flags|=32),si}function wt(i,s,o){(i===Ve&&ze===2||i.cancelPendingCommit!==null)&&(Gs(i,0),Zi(i,ke,si,!1)),mr(i,o),(!(Qe&2)||i!==Ve)&&(i===Ve&&(!(Qe&2)&&(es|=o),et===4&&Zi(i,ke,si,!1)),Li(i))}function Lm(i,s,o){if(Qe&6)throw Error(n(327));var f=!o&&(s&60)===0&&(s&i.expiredLanes)===0||hr(i,s),m=f?TS(i,s):gc(i,s,!0),y=f;do{if(m===0){Bs&&!f&&Zi(i,s,0,!1);break}else if(m===6)Zi(i,s,0,!Wi);else{if(o=i.current.alternate,y&&!SS(o)){m=gc(i,s,!1),y=!1;continue}if(m===2){if(y=s,i.errorRecoveryDisabledLanes&y)var T=0;else T=i.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;e:{var w=i;m=qr;var P=w.current.memoizedState.isDehydrated;if(P&&(Gs(w,T).flags|=256),T=gc(w,T,!1),T!==2){if(rc&&!P){w.errorRecoveryDisabledLanes|=y,es|=y,m=4;break e}y=Ri,Ri=m,y!==null&&dc(y)}m=T}if(y=!1,m!==2)continue}}if(m===1){Gs(i,0),Zi(i,s,0,!0);break}e:{switch(f=i,m){case 0:case 1:throw Error(n(345));case 4:if((s&4194176)===s){Zi(f,s,si,!Wi);break e}break;case 2:Ri=null;break;case 3:case 5:break;default:throw Error(n(329))}if(f.finishedWork=o,f.finishedLanes=s,(s&62914560)===s&&(y=oc+300-Yt(),10<y)){if(Zi(f,s,si,!Wi),_a(f,0)!==0)break e;f.timeoutHandle=Wm(_m.bind(null,f,o,Ri,hl,lc,s,si,es,js,Wi,2,-0,0),y);break e}_m(f,o,Ri,hl,lc,s,si,es,js,Wi,0,-0,0)}}break}while(!0);Li(i)}function dc(i){Ri===null?Ri=i:Ri.push.apply(Ri,i)}function _m(i,s,o,f,m,y,T,w,P,G,ne,ce,J){var ie=s.subtreeFlags;if((ie&8192||(ie&16785408)===16785408)&&(ia={stylesheets:null,count:0,unsuspend:tE},ym(s),s=nE(),s!==null)){i.cancelPendingCommit=s(Mm.bind(null,i,o,f,m,T,w,P,1,ce,J)),Zi(i,y,T,!G);return}Mm(i,o,f,m,T,w,P,ne,ce,J)}function SS(i){for(var s=i;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var f=0;f<o.length;f++){var m=o[f],y=m.getSnapshot;m=m.value;try{if(!jt(y(),m))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Zi(i,s,o,f){s&=~ac,s&=~es,i.suspendedLanes|=s,i.pingedLanes&=~s,f&&(i.warmLanes|=s),f=i.expirationTimes;for(var m=s;0<m;){var y=31-Bt(m),T=1<<y;f[y]=-1,m&=~T}o!==0&&Hd(i,o,s)}function gl(){return Qe&6?!0:(Qr(0),!1)}function hc(){if(we!==null){if(ze===0)var i=we.return;else i=we,Vi=Wn=null,xu(i),Cs=null,Or=0,i=we;for(;i!==null;)Am(i.alternate,i),i=i.return;we=null}}function Gs(i,s){i.finishedWork=null,i.finishedLanes=0;var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,BS(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),hc(),Ve=i,we=o=An(i.current,null),ke=s,ze=0,$t=null,Wi=!1,Bs=hr(i,s),rc=!1,js=si=ac=es=Rn=et=0,Ri=qr=null,lc=!1,s&8&&(s|=s&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=s;0<f;){var m=31-Bt(f),y=1<<m;s|=i[m],f&=~y}return Qi=s,Ba(),o}function Dm(i,s){De=null,I.H=Ai,s===Cr?(s=$h(),ze=3):s===jh?(s=$h(),ze=4):ze=s===G0?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,$t=s,we===null&&(et=1,rl(i,Qt(s,i.current)))}function Cm(){var i=I.H;return I.H=Ai,i===null?Ai:i}function wm(){var i=I.A;return I.A=vS,i}function mc(){et=4,Wi||(ke&4194176)!==ke&&ei.current!==null||(Bs=!0),!(Rn&134217727)&&!(es&134217727)||Ve===null||Zi(Ve,ke,si,!1)}function gc(i,s,o){var f=Qe;Qe|=2;var m=Cm(),y=wm();(Ve!==i||ke!==s)&&(hl=null,Gs(i,s)),s=!1;var T=et;e:do try{if(ze!==0&&we!==null){var w=we,P=$t;switch(ze){case 8:hc(),T=6;break e;case 3:case 2:case 6:ei.current===null&&(s=!0);var G=ze;if(ze=0,$t=null,Hs(i,w,P,G),o&&Bs){T=0;break e}break;default:G=ze,ze=0,$t=null,Hs(i,w,P,G)}}ES(),T=et;break}catch(ne){Dm(i,ne)}while(!0);return s&&i.shellSuspendCounter++,Vi=Wn=null,Qe=f,I.H=m,I.A=y,we===null&&(Ve=null,ke=0,Ba()),T}function ES(){for(;we!==null;)Om(we)}function TS(i,s){var o=Qe;Qe|=2;var f=Cm(),m=wm();Ve!==i||ke!==s?(hl=null,dl=Yt()+500,Gs(i,s)):Bs=hr(i,s);e:do try{if(ze!==0&&we!==null){s=we;var y=$t;t:switch(ze){case 1:ze=0,$t=null,Hs(i,s,y,1);break;case 2:if(Gh(y)){ze=0,$t=null,Im(s);break}s=function(){ze===2&&Ve===i&&(ze=7),Li(i)},y.then(s,s);break e;case 3:ze=7;break e;case 4:ze=5;break e;case 7:Gh(y)?(ze=0,$t=null,Im(s)):(ze=0,$t=null,Hs(i,s,y,7));break;case 5:var T=null;switch(we.tag){case 26:T=we.memoizedState;case 5:case 27:var w=we;if(!T||lg(T)){ze=0,$t=null;var P=w.sibling;if(P!==null)we=P;else{var G=w.return;G!==null?(we=G,pl(G)):we=null}break t}}ze=0,$t=null,Hs(i,s,y,5);break;case 6:ze=0,$t=null,Hs(i,s,y,6);break;case 8:hc(),et=6;break e;default:throw Error(n(462))}}bS();break}catch(ne){Dm(i,ne)}while(!0);return Vi=Wn=null,I.H=f,I.A=m,Qe=o,we!==null?0:(Ve=null,ke=0,Ba(),et)}function bS(){for(;we!==null&&!Pi();)Om(we)}function Om(i){var s=J0(i.alternate,i,Qi);i.memoizedProps=i.pendingProps,s===null?pl(i):we=s}function Im(i){var s=i,o=s.alternate;switch(s.tag){case 15:case 0:s=Y0(o,s,s.pendingProps,s.type,void 0,ke);break;case 11:s=Y0(o,s,s.pendingProps,s.type.render,s.ref,ke);break;case 5:xu(s);default:Am(o,s),s=we=Em(s,Qi),s=J0(o,s,Qi)}i.memoizedProps=i.pendingProps,s===null?pl(i):we=s}function Hs(i,s,o,f){Vi=Wn=null,xu(s),Cs=null,Or=0;var m=s.return;try{if(fS(i,m,s,o,ke)){et=1,rl(i,Qt(o,i.current)),we=null;return}}catch(y){if(m!==null)throw we=m,y;et=1,rl(i,Qt(o,i.current)),we=null;return}s.flags&32768?(Pe||f===1?i=!0:Bs||ke&536870912?i=!1:(Wi=i=!0,(f===2||f===3||f===6)&&(f=ei.current,f!==null&&f.tag===13&&(f.flags|=16384))),km(s,i)):pl(s)}function pl(i){var s=i;do{if(s.flags&32768){km(s,Wi);return}i=s.return;var o=pS(s.alternate,s,Qi);if(o!==null){we=o;return}if(s=s.sibling,s!==null){we=s;return}we=s=i}while(s!==null);et===0&&(et=5)}function km(i,s){do{var o=yS(i.alternate,i);if(o!==null){o.flags&=32767,we=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(i=i.sibling,i!==null)){we=i;return}we=i=o}while(i!==null);et=6,we=null}function Mm(i,s,o,f,m,y,T,w,P,G){var ne=I.T,ce=se.p;try{se.p=2,I.T=null,AS(i,s,o,f,ce,m,y,T,w,P,G)}finally{I.T=ne,se.p=ce}}function AS(i,s,o,f,m,y,T,w){do $s();while(ts!==null);if(Qe&6)throw Error(n(327));var P=i.finishedWork;if(f=i.finishedLanes,P===null)return null;if(i.finishedWork=null,i.finishedLanes=0,P===i.current)throw Error(n(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var G=P.lanes|P.childLanes;if(G|=su,ix(i,f,G,y,T,w),i===Ve&&(we=Ve=null,ke=0),!(P.subtreeFlags&10256)&&!(P.flags&10256)||ml||(ml=!0,uc=G,cc=o,DS(Aa,function(){return $s(),null})),o=(P.flags&15990)!==0,P.subtreeFlags&15990||o?(o=I.T,I.T=null,y=se.p,se.p=2,T=Qe,Qe|=4,hS(i,P),mm(P,i),qx(_c,i.containerInfo),Dl=!!Lc,_c=Lc=null,i.current=P,cm(i,P.alternate,P),ba(),Qe=T,se.p=y,I.T=o):i.current=P,ml?(ml=!1,ts=i,Xr=f):Nm(i,G),G=i.pendingLanes,G===0&&(Ln=null),Qv(P.stateNode),Li(i),s!==null)for(m=i.onRecoverableError,P=0;P<s.length;P++)G=s[P],m(G.value,{componentStack:G.stack});return Xr&3&&$s(),G=i.pendingLanes,f&4194218&&G&42?i===fc?Wr++:(Wr=0,fc=i):Wr=0,Qr(0),null}function Nm(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,kr(s)))}function $s(){if(ts!==null){var i=ts,s=uc;uc=0;var o=Vd(Xr),f=I.T,m=se.p;try{if(se.p=32>o?32:o,I.T=null,ts===null)var y=!1;else{o=cc,cc=null;var T=ts,w=Xr;if(ts=null,Xr=0,Qe&6)throw Error(n(331));var P=Qe;if(Qe|=4,xm(T.current),pm(T,T.current,w,o),Qe=P,Qr(0,!1),Ft&&typeof Ft.onPostCommitFiberRoot=="function")try{Ft.onPostCommitFiberRoot(dr,T)}catch{}y=!0}return y}finally{se.p=m,I.T=f,Nm(i,s)}}return!1}function Pm(i,s,o){s=Qt(o,s),s=ku(i.stateNode,s,2),i=Sn(i,s,2),i!==null&&(mr(i,2),Li(i))}function $e(i,s,o){if(i.tag===3)Pm(i,i,o);else for(;s!==null;){if(s.tag===3){Pm(s,i,o);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ln===null||!Ln.has(f))){i=Qt(o,i),o=B0(2),f=Sn(s,o,2),f!==null&&(j0(o,f,s,i),mr(f,2),Li(f));break}}s=s.return}}function pc(i,s,o){var f=i.pingCache;if(f===null){f=i.pingCache=new xS;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(o)||(rc=!0,m.add(o),i=RS.bind(null,i,s,o),s.then(i,i))}function RS(i,s,o){var f=i.pingCache;f!==null&&f.delete(s),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,Ve===i&&(ke&o)===o&&(et===4||et===3&&(ke&62914560)===ke&&300>Yt()-oc?!(Qe&2)&&Gs(i,0):ac|=o,js===ke&&(js=0)),Li(i)}function Um(i,s){s===0&&(s=Gd()),i=dn(i,s),i!==null&&(mr(i,s),Li(i))}function LS(i){var s=i.memoizedState,o=0;s!==null&&(o=s.retryLane),Um(i,o)}function _S(i,s){var o=0;switch(i.tag){case 13:var f=i.stateNode,m=i.memoizedState;m!==null&&(o=m.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),Um(i,o)}function DS(i,s){return Fe(i,s)}var yl=null,Vs=null,yc=!1,vl=!1,vc=!1,is=0;function Li(i){i!==Vs&&i.next===null&&(Vs===null?yl=Vs=i:Vs=Vs.next=i),vl=!0,yc||(yc=!0,wS(CS))}function Qr(i,s){if(!vc&&vl){vc=!0;do for(var o=!1,f=yl;f!==null;){if(i!==0){var m=f.pendingLanes;if(m===0)var y=0;else{var T=f.suspendedLanes,w=f.pingedLanes;y=(1<<31-Bt(42|i)+1)-1,y&=m&~(T&~w),y=y&201326677?y&201326677|1:y?y|2:0}y!==0&&(o=!0,jm(f,y))}else y=ke,y=_a(f,f===Ve?y:0),!(y&3)||hr(f,y)||(o=!0,jm(f,y));f=f.next}while(o);vc=!1}}function CS(){vl=yc=!1;var i=0;is!==0&&(FS()&&(i=is),is=0);for(var s=Yt(),o=null,f=yl;f!==null;){var m=f.next,y=Fm(f,s);y===0?(f.next=null,o===null?yl=m:o.next=m,m===null&&(Vs=o)):(o=f,(i!==0||y&3)&&(vl=!0)),f=m}Qr(i)}function Fm(i,s){for(var o=i.suspendedLanes,f=i.pingedLanes,m=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var T=31-Bt(y),w=1<<T,P=m[T];P===-1?(!(w&o)||w&f)&&(m[T]=tx(w,s)):P<=s&&(i.expiredLanes|=w),y&=~w}if(s=Ve,o=ke,o=_a(i,i===s?o:0),f=i.callbackNode,o===0||i===s&&ze===2||i.cancelPendingCommit!==null)return f!==null&&f!==null&&Xe(f),i.callbackNode=null,i.callbackPriority=0;if(!(o&3)||hr(i,o)){if(s=o&-o,s===i.callbackPriority)return s;switch(f!==null&&Xe(f),Vd(o)){case 2:case 8:o=Fd;break;case 32:o=Aa;break;case 268435456:o=Bd;break;default:o=Aa}return f=Bm.bind(null,i),o=Fe(o,f),i.callbackPriority=s,i.callbackNode=o,s}return f!==null&&f!==null&&Xe(f),i.callbackPriority=2,i.callbackNode=null,2}function Bm(i,s){var o=i.callbackNode;if($s()&&i.callbackNode!==o)return null;var f=ke;return f=_a(i,i===Ve?f:0),f===0?null:(Lm(i,f,s),Fm(i,Yt()),i.callbackNode!=null&&i.callbackNode===o?Bm.bind(null,i):null)}function jm(i,s){if($s())return null;Lm(i,s,!0)}function wS(i){jS(function(){Qe&6?Fe(Ud,i):i()})}function xc(){return is===0&&(is=jd()),is}function Gm(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Ia(""+i)}function Hm(i,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,i.id&&o.setAttribute("form",i.id),s.parentNode.insertBefore(o,s),i=new FormData(i),o.parentNode.removeChild(o),i}function OS(i,s,o,f,m){if(s==="submit"&&o&&o.stateNode===m){var y=Gm((m[It]||null).action),T=f.submitter;T&&(s=(s=T[It]||null)?Gm(s.formAction):T.getAttribute("formAction"),s!==null&&(y=s,T=null));var w=new Pa("action","action",null,f,m);i.push({event:w,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(is!==0){var P=T?Hm(m,T):new FormData(m);Du(o,{pending:!0,data:P,method:m.method,action:y},null,P)}}else typeof y=="function"&&(w.preventDefault(),P=T?Hm(m,T):new FormData(m),Du(o,{pending:!0,data:P,method:m.method,action:y},y,P))},currentTarget:m}]})}}for(var Sc=0;Sc<Mh.length;Sc++){var Ec=Mh[Sc],IS=Ec.toLowerCase(),kS=Ec[0].toUpperCase()+Ec.slice(1);di(IS,"on"+kS)}di(Ch,"onAnimationEnd"),di(wh,"onAnimationIteration"),di(Oh,"onAnimationStart"),di("dblclick","onDoubleClick"),di("focusin","onFocus"),di("focusout","onBlur"),di(Wx,"onTransitionRun"),di(Qx,"onTransitionStart"),di(Zx,"onTransitionCancel"),di(Ih,"onTransitionEnd"),ys("onMouseEnter",["mouseout","mouseover"]),ys("onMouseLeave",["mouseout","mouseover"]),ys("onPointerEnter",["pointerout","pointerover"]),ys("onPointerLeave",["pointerout","pointerover"]),Un("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Un("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Un("onBeforeInput",["compositionend","keypress","textInput","paste"]),Un("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Un("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Un("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Zr));function $m(i,s){s=(s&4)!==0;for(var o=0;o<i.length;o++){var f=i[o],m=f.event;f=f.listeners;e:{var y=void 0;if(s)for(var T=f.length-1;0<=T;T--){var w=f[T],P=w.instance,G=w.currentTarget;if(w=w.listener,P!==y&&m.isPropagationStopped())break e;y=w,m.currentTarget=G;try{y(m)}catch(ne){sl(ne)}m.currentTarget=null,y=P}else for(T=0;T<f.length;T++){if(w=f[T],P=w.instance,G=w.currentTarget,w=w.listener,P!==y&&m.isPropagationStopped())break e;y=w,m.currentTarget=G;try{y(m)}catch(ne){sl(ne)}m.currentTarget=null,y=P}}}}function Ie(i,s){var o=s[Uo];o===void 0&&(o=s[Uo]=new Set);var f=i+"__bubble";o.has(f)||(Vm(s,i,2,!1),o.add(f))}function Tc(i,s,o){var f=0;s&&(f|=4),Vm(o,i,f,s)}var xl="_reactListening"+Math.random().toString(36).slice(2);function bc(i){if(!i[xl]){i[xl]=!0,Yd.forEach(function(o){o!=="selectionchange"&&(MS.has(o)||Tc(o,!1,i),Tc(o,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[xl]||(s[xl]=!0,Tc("selectionchange",!1,s))}}function Vm(i,s,o,f){switch(hg(s)){case 2:var m=aE;break;case 8:m=lE;break;default:m=Pc}o=m.bind(null,s,o,i),m=void 0,!zo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?i.addEventListener(s,o,{capture:!0,passive:m}):i.addEventListener(s,o,!0):m!==void 0?i.addEventListener(s,o,{passive:m}):i.addEventListener(s,o,!1)}function Ac(i,s,o,f,m){var y=f;if(!(s&1)&&!(s&2)&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var w=f.stateNode.containerInfo;if(w===m||w.nodeType===8&&w.parentNode===m)break;if(T===4)for(T=f.return;T!==null;){var P=T.tag;if((P===3||P===4)&&(P=T.stateNode.containerInfo,P===m||P.nodeType===8&&P.parentNode===m))return;T=T.return}for(;w!==null;){if(T=Pn(w),T===null)return;if(P=T.tag,P===5||P===6||P===26||P===27){f=y=T;continue e}w=w.parentNode}}f=f.return}rh(function(){var G=y,ne=$o(o),ce=[];e:{var J=kh.get(i);if(J!==void 0){var ie=Pa,ye=i;switch(i){case"keypress":if(Ma(o)===0)break e;case"keydown":case"keyup":ie=_x;break;case"focusin":ye="focus",ie=Xo;break;case"focusout":ye="blur",ie=Xo;break;case"beforeblur":case"afterblur":ie=Xo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=oh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=gx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=wx;break;case Ch:case wh:case Oh:ie=vx;break;case Ih:ie=Ix;break;case"scroll":case"scrollend":ie=hx;break;case"wheel":ie=Mx;break;case"copy":case"cut":case"paste":ie=Sx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=ch;break;case"toggle":case"beforetoggle":ie=Px}var Re=(s&4)!==0,tt=!Re&&(i==="scroll"||i==="scrollend"),K=Re?J!==null?J+"Capture":null:J;Re=[];for(var j=G,q;j!==null;){var ae=j;if(q=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||q===null||K===null||(ae=yr(j,K),ae!=null&&Re.push(Jr(j,ae,q))),tt)break;j=j.return}0<Re.length&&(J=new ie(J,ye,null,o,ne),ce.push({event:J,listeners:Re}))}}if(!(s&7)){e:{if(J=i==="mouseover"||i==="pointerover",ie=i==="mouseout"||i==="pointerout",J&&o!==Ho&&(ye=o.relatedTarget||o.fromElement)&&(Pn(ye)||ye[ms]))break e;if((ie||J)&&(J=ne.window===ne?ne:(J=ne.ownerDocument)?J.defaultView||J.parentWindow:window,ie?(ye=o.relatedTarget||o.toElement,ie=G,ye=ye?Pn(ye):null,ye!==null&&(tt=le(ye),Re=ye.tag,ye!==tt||Re!==5&&Re!==27&&Re!==6)&&(ye=null)):(ie=null,ye=G),ie!==ye)){if(Re=oh,ae="onMouseLeave",K="onMouseEnter",j="mouse",(i==="pointerout"||i==="pointerover")&&(Re=ch,ae="onPointerLeave",K="onPointerEnter",j="pointer"),tt=ie==null?J:pr(ie),q=ye==null?J:pr(ye),J=new Re(ae,j+"leave",ie,o,ne),J.target=tt,J.relatedTarget=q,ae=null,Pn(ne)===G&&(Re=new Re(K,j+"enter",ye,o,ne),Re.target=q,Re.relatedTarget=tt,ae=Re),tt=ae,ie&&ye)t:{for(Re=ie,K=ye,j=0,q=Re;q;q=zs(q))j++;for(q=0,ae=K;ae;ae=zs(ae))q++;for(;0<j-q;)Re=zs(Re),j--;for(;0<q-j;)K=zs(K),q--;for(;j--;){if(Re===K||K!==null&&Re===K.alternate)break t;Re=zs(Re),K=zs(K)}Re=null}else Re=null;ie!==null&&zm(ce,J,ie,Re,!1),ye!==null&&tt!==null&&zm(ce,tt,ye,Re,!0)}}e:{if(J=G?pr(G):window,ie=J.nodeName&&J.nodeName.toLowerCase(),ie==="select"||ie==="input"&&J.type==="file")var pe=vh;else if(ph(J))if(xh)pe=Kx;else{pe=Vx;var Ce=$x}else ie=J.nodeName,!ie||ie.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?G&&Go(G.elementType)&&(pe=vh):pe=zx;if(pe&&(pe=pe(i,G))){yh(ce,pe,o,ne);break e}Ce&&Ce(i,J,G),i==="focusout"&&G&&J.type==="number"&&G.memoizedProps.value!=null&&jo(J,"number",J.value)}switch(Ce=G?pr(G):window,i){case"focusin":(ph(Ce)||Ce.contentEditable==="true")&&(bs=Ce,tu=G,Rr=null);break;case"focusout":Rr=tu=bs=null;break;case"mousedown":iu=!0;break;case"contextmenu":case"mouseup":case"dragend":iu=!1,_h(ce,o,ne);break;case"selectionchange":if(Xx)break;case"keydown":case"keyup":_h(ce,o,ne)}var ve;if(Qo)e:{switch(i){case"compositionstart":var Ee="onCompositionStart";break e;case"compositionend":Ee="onCompositionEnd";break e;case"compositionupdate":Ee="onCompositionUpdate";break e}Ee=void 0}else Ts?mh(i,o)&&(Ee="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(Ee="onCompositionStart");Ee&&(fh&&o.locale!=="ko"&&(Ts||Ee!=="onCompositionStart"?Ee==="onCompositionEnd"&&Ts&&(ve=ah()):(fn=ne,Ko="value"in fn?fn.value:fn.textContent,Ts=!0)),Ce=Sl(G,Ee),0<Ce.length&&(Ee=new uh(Ee,i,null,o,ne),ce.push({event:Ee,listeners:Ce}),ve?Ee.data=ve:(ve=gh(o),ve!==null&&(Ee.data=ve)))),(ve=Fx?Bx(i,o):jx(i,o))&&(Ee=Sl(G,"onBeforeInput"),0<Ee.length&&(Ce=new uh("onBeforeInput","beforeinput",null,o,ne),ce.push({event:Ce,listeners:Ee}),Ce.data=ve)),OS(ce,i,G,o,ne)}$m(ce,s)})}function Jr(i,s,o){return{instance:i,listener:s,currentTarget:o}}function Sl(i,s){for(var o=s+"Capture",f=[];i!==null;){var m=i,y=m.stateNode;m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=yr(i,o),m!=null&&f.unshift(Jr(i,m,y)),m=yr(i,s),m!=null&&f.push(Jr(i,m,y))),i=i.return}return f}function zs(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function zm(i,s,o,f,m){for(var y=s._reactName,T=[];o!==null&&o!==f;){var w=o,P=w.alternate,G=w.stateNode;if(w=w.tag,P!==null&&P===f)break;w!==5&&w!==26&&w!==27||G===null||(P=G,m?(G=yr(o,y),G!=null&&T.unshift(Jr(o,G,P))):m||(G=yr(o,y),G!=null&&T.push(Jr(o,G,P)))),o=o.return}T.length!==0&&i.push({event:s,listeners:T})}var NS=/\r\n?/g,PS=/\u0000|\uFFFD/g;function Km(i){return(typeof i=="string"?i:""+i).replace(NS,`
`).replace(PS,"")}function Ym(i,s){return s=Km(s),Km(i)===s}function El(){}function He(i,s,o,f,m,y){switch(o){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||xs(i,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&xs(i,""+f);break;case"className":Ca(i,"class",f);break;case"tabIndex":Ca(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Ca(i,o,f);break;case"style":nh(i,f,y);break;case"data":if(s!=="object"){Ca(i,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||o!=="href")){i.removeAttribute(o);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(o);break}f=Ia(""+f),i.setAttribute(o,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&He(i,s,"name",m.name,m,null),He(i,s,"formEncType",m.formEncType,m,null),He(i,s,"formMethod",m.formMethod,m,null),He(i,s,"formTarget",m.formTarget,m,null)):(He(i,s,"encType",m.encType,m,null),He(i,s,"method",m.method,m,null),He(i,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(o);break}f=Ia(""+f),i.setAttribute(o,f);break;case"onClick":f!=null&&(i.onclick=El);break;case"onScroll":f!=null&&Ie("scroll",i);break;case"onScrollEnd":f!=null&&Ie("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(n(60));i.innerHTML=o}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}o=Ia(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(o,""+f):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":f===!0?i.setAttribute(o,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(o,f):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(o,f):i.removeAttribute(o);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(o):i.setAttribute(o,f);break;case"popover":Ie("beforetoggle",i),Ie("toggle",i),Da(i,"popover",f);break;case"xlinkActuate":Fi(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Fi(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Fi(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Fi(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Fi(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Fi(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Fi(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Fi(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Fi(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Da(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=fx.get(o)||o,Da(i,o,f))}}function Rc(i,s,o,f,m,y){switch(o){case"style":nh(i,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(n(60));i.innerHTML=o}}break;case"children":typeof f=="string"?xs(i,f):(typeof f=="number"||typeof f=="bigint")&&xs(i,""+f);break;case"onScroll":f!=null&&Ie("scroll",i);break;case"onScrollEnd":f!=null&&Ie("scrollend",i);break;case"onClick":f!=null&&(i.onclick=El);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qd.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),s=o.slice(2,m?o.length-7:void 0),y=i[It]||null,y=y!=null?y[o]:null,typeof y=="function"&&i.removeEventListener(s,y,m),typeof f=="function")){typeof y!="function"&&y!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(s,f,m);break e}o in i?i[o]=f:f===!0?i.setAttribute(o,""):Da(i,o,f)}}}function Tt(i,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ie("error",i),Ie("load",i);var f=!1,m=!1,y;for(y in o)if(o.hasOwnProperty(y)){var T=o[y];if(T!=null)switch(y){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:He(i,s,y,T,o,null)}}m&&He(i,s,"srcSet",o.srcSet,o,null),f&&He(i,s,"src",o.src,o,null);return;case"input":Ie("invalid",i);var w=y=T=m=null,P=null,G=null;for(f in o)if(o.hasOwnProperty(f)){var ne=o[f];if(ne!=null)switch(f){case"name":m=ne;break;case"type":T=ne;break;case"checked":P=ne;break;case"defaultChecked":G=ne;break;case"value":y=ne;break;case"defaultValue":w=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(n(137,s));break;default:He(i,s,f,ne,o,null)}}Jd(i,y,w,P,G,T,m,!1),wa(i);return;case"select":Ie("invalid",i),f=T=y=null;for(m in o)if(o.hasOwnProperty(m)&&(w=o[m],w!=null))switch(m){case"value":y=w;break;case"defaultValue":T=w;break;case"multiple":f=w;default:He(i,s,m,w,o,null)}s=y,o=T,i.multiple=!!f,s!=null?vs(i,!!f,s,!1):o!=null&&vs(i,!!f,o,!0);return;case"textarea":Ie("invalid",i),y=m=f=null;for(T in o)if(o.hasOwnProperty(T)&&(w=o[T],w!=null))switch(T){case"value":f=w;break;case"defaultValue":m=w;break;case"children":y=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:He(i,s,T,w,o,null)}th(i,f,m,y),wa(i);return;case"option":for(P in o)if(o.hasOwnProperty(P)&&(f=o[P],f!=null))switch(P){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:He(i,s,P,f,o,null)}return;case"dialog":Ie("cancel",i),Ie("close",i);break;case"iframe":case"object":Ie("load",i);break;case"video":case"audio":for(f=0;f<Zr.length;f++)Ie(Zr[f],i);break;case"image":Ie("error",i),Ie("load",i);break;case"details":Ie("toggle",i);break;case"embed":case"source":case"link":Ie("error",i),Ie("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(G in o)if(o.hasOwnProperty(G)&&(f=o[G],f!=null))switch(G){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:He(i,s,G,f,o,null)}return;default:if(Go(s)){for(ne in o)o.hasOwnProperty(ne)&&(f=o[ne],f!==void 0&&Rc(i,s,ne,f,o,void 0));return}}for(w in o)o.hasOwnProperty(w)&&(f=o[w],f!=null&&He(i,s,w,f,o,null))}function US(i,s,o,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,T=null,w=null,P=null,G=null,ne=null;for(ie in o){var ce=o[ie];if(o.hasOwnProperty(ie)&&ce!=null)switch(ie){case"checked":break;case"value":break;case"defaultValue":P=ce;default:f.hasOwnProperty(ie)||He(i,s,ie,null,f,ce)}}for(var J in f){var ie=f[J];if(ce=o[J],f.hasOwnProperty(J)&&(ie!=null||ce!=null))switch(J){case"type":y=ie;break;case"name":m=ie;break;case"checked":G=ie;break;case"defaultChecked":ne=ie;break;case"value":T=ie;break;case"defaultValue":w=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(n(137,s));break;default:ie!==ce&&He(i,s,J,ie,f,ce)}}Bo(i,T,w,P,G,ne,y,m);return;case"select":ie=T=w=J=null;for(y in o)if(P=o[y],o.hasOwnProperty(y)&&P!=null)switch(y){case"value":break;case"multiple":ie=P;default:f.hasOwnProperty(y)||He(i,s,y,null,f,P)}for(m in f)if(y=f[m],P=o[m],f.hasOwnProperty(m)&&(y!=null||P!=null))switch(m){case"value":J=y;break;case"defaultValue":w=y;break;case"multiple":T=y;default:y!==P&&He(i,s,m,y,f,P)}s=w,o=T,f=ie,J!=null?vs(i,!!o,J,!1):!!f!=!!o&&(s!=null?vs(i,!!o,s,!0):vs(i,!!o,o?[]:"",!1));return;case"textarea":ie=J=null;for(w in o)if(m=o[w],o.hasOwnProperty(w)&&m!=null&&!f.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:He(i,s,w,null,f,m)}for(T in f)if(m=f[T],y=o[T],f.hasOwnProperty(T)&&(m!=null||y!=null))switch(T){case"value":J=m;break;case"defaultValue":ie=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==y&&He(i,s,T,m,f,y)}eh(i,J,ie);return;case"option":for(var ye in o)if(J=o[ye],o.hasOwnProperty(ye)&&J!=null&&!f.hasOwnProperty(ye))switch(ye){case"selected":i.selected=!1;break;default:He(i,s,ye,null,f,J)}for(P in f)if(J=f[P],ie=o[P],f.hasOwnProperty(P)&&J!==ie&&(J!=null||ie!=null))switch(P){case"selected":i.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:He(i,s,P,J,f,ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in o)J=o[Re],o.hasOwnProperty(Re)&&J!=null&&!f.hasOwnProperty(Re)&&He(i,s,Re,null,f,J);for(G in f)if(J=f[G],ie=o[G],f.hasOwnProperty(G)&&J!==ie&&(J!=null||ie!=null))switch(G){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(n(137,s));break;default:He(i,s,G,J,f,ie)}return;default:if(Go(s)){for(var tt in o)J=o[tt],o.hasOwnProperty(tt)&&J!==void 0&&!f.hasOwnProperty(tt)&&Rc(i,s,tt,void 0,f,J);for(ne in f)J=f[ne],ie=o[ne],!f.hasOwnProperty(ne)||J===ie||J===void 0&&ie===void 0||Rc(i,s,ne,J,f,ie);return}}for(var K in o)J=o[K],o.hasOwnProperty(K)&&J!=null&&!f.hasOwnProperty(K)&&He(i,s,K,null,f,J);for(ce in f)J=f[ce],ie=o[ce],!f.hasOwnProperty(ce)||J===ie||J==null&&ie==null||He(i,s,ce,J,f,ie)}var Lc=null,_c=null;function Tl(i){return i.nodeType===9?i:i.ownerDocument}function qm(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xm(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Dc(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Cc=null;function FS(){var i=window.event;return i&&i.type==="popstate"?i===Cc?!1:(Cc=i,!0):(Cc=null,!1)}var Wm=typeof setTimeout=="function"?setTimeout:void 0,BS=typeof clearTimeout=="function"?clearTimeout:void 0,Qm=typeof Promise=="function"?Promise:void 0,jS=typeof queueMicrotask=="function"?queueMicrotask:typeof Qm<"u"?function(i){return Qm.resolve(null).then(i).catch(GS)}:Wm;function GS(i){setTimeout(function(){throw i})}function wc(i,s){var o=s,f=0;do{var m=o.nextSibling;if(i.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"){if(f===0){i.removeChild(m),la(s);return}f--}else o!=="$"&&o!=="$?"&&o!=="$!"||f++;o=m}while(o);la(s)}function Oc(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Oc(o),Fo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function HS(i,s,o,f){for(;i.nodeType===1;){var m=o;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[gr])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==m.rel||i.getAttribute("href")!==(m.href==null?null:m.href)||i.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||i.getAttribute("title")!==(m.title==null?null:m.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(m.src==null?null:m.src)||i.getAttribute("type")!==(m.type==null?null:m.type)||i.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=gi(i.nextSibling),i===null)break}return null}function $S(i,s,o){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=gi(i.nextSibling),i===null))return null;return i}function gi(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}function Zm(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return i;s--}else o==="/$"&&s++}i=i.previousSibling}return null}function Jm(i,s,o){switch(s=Tl(o),i){case"html":if(i=s.documentElement,!i)throw Error(n(452));return i;case"head":if(i=s.head,!i)throw Error(n(453));return i;case"body":if(i=s.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}var ri=new Map,eg=new Set;function bl(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var Ji=se.d;se.d={f:VS,r:zS,D:KS,C:YS,L:qS,m:XS,X:QS,S:WS,M:ZS};function VS(){var i=Ji.f(),s=gl();return i||s}function zS(i){var s=gs(i);s!==null&&s.tag===5&&s.type==="form"?_0(s):Ji.r(i)}var Ks=typeof document>"u"?null:document;function tg(i,s,o){var f=Ks;if(f&&typeof s=="string"&&s){var m=Xt(s);m='link[rel="'+i+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),eg.has(m)||(eg.add(m),i={rel:i,crossOrigin:o,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),Tt(s,"link",i),dt(s),f.head.appendChild(s)))}}function KS(i){Ji.D(i),tg("dns-prefetch",i,null)}function YS(i,s){Ji.C(i,s),tg("preconnect",i,s)}function qS(i,s,o){Ji.L(i,s,o);var f=Ks;if(f&&i&&s){var m='link[rel="preload"][as="'+Xt(s)+'"]';s==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Xt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Xt(o.imageSizes)+'"]')):m+='[href="'+Xt(i)+'"]';var y=m;switch(s){case"style":y=Ys(i);break;case"script":y=qs(i)}ri.has(y)||(i=N({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:i,as:s},o),ri.set(y,i),f.querySelector(m)!==null||s==="style"&&f.querySelector(ea(y))||s==="script"&&f.querySelector(ta(y))||(s=f.createElement("link"),Tt(s,"link",i),dt(s),f.head.appendChild(s)))}}function XS(i,s){Ji.m(i,s);var o=Ks;if(o&&i){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+Xt(f)+'"][href="'+Xt(i)+'"]',y=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=qs(i)}if(!ri.has(y)&&(i=N({rel:"modulepreload",href:i},s),ri.set(y,i),o.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(ta(y)))return}f=o.createElement("link"),Tt(f,"link",i),dt(f),o.head.appendChild(f)}}}function WS(i,s,o){Ji.S(i,s,o);var f=Ks;if(f&&i){var m=ps(f).hoistableStyles,y=Ys(i);s=s||"default";var T=m.get(y);if(!T){var w={loading:0,preload:null};if(T=f.querySelector(ea(y)))w.loading=5;else{i=N({rel:"stylesheet",href:i,"data-precedence":s},o),(o=ri.get(y))&&Ic(i,o);var P=T=f.createElement("link");dt(P),Tt(P,"link",i),P._p=new Promise(function(G,ne){P.onload=G,P.onerror=ne}),P.addEventListener("load",function(){w.loading|=1}),P.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Al(T,s,f)}T={type:"stylesheet",instance:T,count:1,state:w},m.set(y,T)}}}function QS(i,s){Ji.X(i,s);var o=Ks;if(o&&i){var f=ps(o).hoistableScripts,m=qs(i),y=f.get(m);y||(y=o.querySelector(ta(m)),y||(i=N({src:i,async:!0},s),(s=ri.get(m))&&kc(i,s),y=o.createElement("script"),dt(y),Tt(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(m,y))}}function ZS(i,s){Ji.M(i,s);var o=Ks;if(o&&i){var f=ps(o).hoistableScripts,m=qs(i),y=f.get(m);y||(y=o.querySelector(ta(m)),y||(i=N({src:i,async:!0,type:"module"},s),(s=ri.get(m))&&kc(i,s),y=o.createElement("script"),dt(y),Tt(y,"link",i),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(m,y))}}function ig(i,s,o,f){var m=(m=xt.current)?bl(m):null;if(!m)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Ys(o.href),o=ps(m).hoistableStyles,f=o.get(s),f||(f={type:"style",instance:null,count:0,state:null},o.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=Ys(o.href);var y=ps(m).hoistableStyles,T=y.get(i);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,T),(y=m.querySelector(ea(i)))&&!y._p&&(T.instance=y,T.state.loading=5),ri.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ri.set(i,o),y||JS(m,i,o,T.state))),s&&f===null)throw Error(n(528,""));return T}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=qs(o),o=ps(m).hoistableScripts,f=o.get(s),f||(f={type:"script",instance:null,count:0,state:null},o.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Ys(i){return'href="'+Xt(i)+'"'}function ea(i){return'link[rel="stylesheet"]['+i+"]"}function ng(i){return N({},i,{"data-precedence":i.precedence,precedence:null})}function JS(i,s,o,f){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=i.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Tt(s,"link",o),dt(s),i.head.appendChild(s))}function qs(i){return'[src="'+Xt(i)+'"]'}function ta(i){return"script[async]"+i}function sg(i,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var f=i.querySelector('style[data-href~="'+Xt(o.href)+'"]');if(f)return s.instance=f,dt(f),f;var m=N({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),dt(f),Tt(f,"style",m),Al(f,o.precedence,i),s.instance=f;case"stylesheet":m=Ys(o.href);var y=i.querySelector(ea(m));if(y)return s.state.loading|=4,s.instance=y,dt(y),y;f=ng(o),(m=ri.get(m))&&Ic(f,m),y=(i.ownerDocument||i).createElement("link"),dt(y);var T=y;return T._p=new Promise(function(w,P){T.onload=w,T.onerror=P}),Tt(y,"link",f),s.state.loading|=4,Al(y,o.precedence,i),s.instance=y;case"script":return y=qs(o.src),(m=i.querySelector(ta(y)))?(s.instance=m,dt(m),m):(f=o,(m=ri.get(y))&&(f=N({},o),kc(f,m)),i=i.ownerDocument||i,m=i.createElement("script"),dt(m),Tt(m,"link",f),i.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&!(s.state.loading&4)&&(f=s.instance,s.state.loading|=4,Al(f,o.precedence,i));return s.instance}function Al(i,s,o){for(var f=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,y=m,T=0;T<f.length;T++){var w=f[T];if(w.dataset.precedence===s)y=w;else if(y!==m)break}y?y.parentNode.insertBefore(i,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(i,s.firstChild))}function Ic(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function kc(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Rl=null;function rg(i,s,o){if(Rl===null){var f=new Map,m=Rl=new Map;m.set(o,f)}else m=Rl,f=m.get(o),f||(f=new Map,m.set(o,f));if(f.has(i))return f;for(f.set(i,null),o=o.getElementsByTagName(i),m=0;m<o.length;m++){var y=o[m];if(!(y[gr]||y[Rt]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var T=y.getAttribute(s)||"";T=i+T;var w=f.get(T);w?w.push(y):f.set(T,[y])}}return f}function ag(i,s,o){i=i.ownerDocument||i,i.head.insertBefore(o,s==="title"?i.querySelector("head > title"):null)}function eE(i,s,o){if(o===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function lg(i){return!(i.type==="stylesheet"&&!(i.state.loading&3))}var ia=null;function tE(){}function iE(i,s,o){if(ia===null)throw Error(n(475));var f=ia;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&!(s.state.loading&4)){if(s.instance===null){var m=Ys(o.href),y=i.querySelector(ea(m));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(f.count++,f=Ll.bind(f),i.then(f,f)),s.state.loading|=4,s.instance=y,dt(y);return}y=i.ownerDocument||i,o=ng(o),(m=ri.get(m))&&Ic(o,m),y=y.createElement("link"),dt(y);var T=y;T._p=new Promise(function(w,P){T.onload=w,T.onerror=P}),Tt(y,"link",o),s.instance=y}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,i),(i=s.state.preload)&&!(s.state.loading&3)&&(f.count++,s=Ll.bind(f),i.addEventListener("load",s),i.addEventListener("error",s))}}function nE(){if(ia===null)throw Error(n(475));var i=ia;return i.stylesheets&&i.count===0&&Mc(i,i.stylesheets),0<i.count?function(s){var o=setTimeout(function(){if(i.stylesheets&&Mc(i,i.stylesheets),i.unsuspend){var f=i.unsuspend;i.unsuspend=null,f()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(o)}}:null}function Ll(){if(this.count--,this.count===0){if(this.stylesheets)Mc(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var _l=null;function Mc(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,_l=new Map,s.forEach(sE,i),_l=null,Ll.call(i))}function sE(i,s){if(!(s.state.loading&4)){var o=_l.get(i);if(o)var f=o.get(null);else{o=new Map,_l.set(i,o);for(var m=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var T=m[y];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),f=T)}f&&o.set(null,f)}m=s.instance,T=m.getAttribute("data-precedence"),y=o.get(T)||f,y===f&&o.set(null,m),o.set(T,m),this.count++,f=Ll.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),y?y.parentNode.insertBefore(m,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(m,i.firstChild)),s.state.loading|=4}}var na={$$typeof:x,Provider:null,Consumer:null,_currentValue:de,_currentValue2:de,_threadCount:0};function rE(i,s,o,f,m,y,T,w){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Po(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Po(0),this.hiddenUpdates=Po(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function og(i,s,o,f,m,y,T,w,P,G,ne,ce){return i=new rE(i,s,o,T,w,P,G,ce),s=1,y===!0&&(s|=24),y=ni(3,null,null,s),i.current=y,y.stateNode=i,s=du(),s.refCount++,i.pooledCache=s,s.refCount++,y.memoizedState={element:f,isDehydrated:o,cache:s},Ku(y),i}function ug(i){return i?(i=Ls,i):Ls}function cg(i,s,o,f,m,y){m=ug(m),f.context===null?f.context=m:f.pendingContext=m,f=xn(s),f.payload={element:o},y=y===void 0?null:y,y!==null&&(f.callback=y),o=Sn(i,f,s),o!==null&&(wt(o,i,s),jr(o,i,s))}function fg(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<s?o:s}}function Nc(i,s){fg(i,s),(i=i.alternate)&&fg(i,s)}function dg(i){if(i.tag===13){var s=dn(i,67108864);s!==null&&wt(s,i,67108864),Nc(i,67108864)}}var Dl=!0;function aE(i,s,o,f){var m=I.T;I.T=null;var y=se.p;try{se.p=2,Pc(i,s,o,f)}finally{se.p=y,I.T=m}}function lE(i,s,o,f){var m=I.T;I.T=null;var y=se.p;try{se.p=8,Pc(i,s,o,f)}finally{se.p=y,I.T=m}}function Pc(i,s,o,f){if(Dl){var m=Uc(f);if(m===null)Ac(i,s,f,Cl,o),mg(i,f);else if(uE(m,i,s,o,f))f.stopPropagation();else if(mg(i,f),s&4&&-1<oE.indexOf(i)){for(;m!==null;){var y=gs(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var T=Nn(y.pendingLanes);if(T!==0){var w=y;for(w.pendingLanes|=2,w.entangledLanes|=2;T;){var P=1<<31-Bt(T);w.entanglements[1]|=P,T&=~P}Li(y),!(Qe&6)&&(dl=Yt()+500,Qr(0))}}break;case 13:w=dn(y,2),w!==null&&wt(w,y,2),gl(),Nc(y,2)}if(y=Uc(f),y===null&&Ac(i,s,f,Cl,o),y===m)break;m=y}m!==null&&f.stopPropagation()}else Ac(i,s,f,null,o)}}function Uc(i){return i=$o(i),Fc(i)}var Cl=null;function Fc(i){if(Cl=null,i=Pn(i),i!==null){var s=le(i);if(s===null)i=null;else{var o=s.tag;if(o===13){if(i=z(s),i!==null)return i;i=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Cl=i,null}function hg(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(No()){case Ud:return 2;case Fd:return 8;case Aa:case qv:return 32;case Bd:return 268435456;default:return 32}default:return 32}}var Bc=!1,_n=null,Dn=null,Cn=null,sa=new Map,ra=new Map,wn=[],oE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mg(i,s){switch(i){case"focusin":case"focusout":_n=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":Cn=null;break;case"pointerover":case"pointerout":sa.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ra.delete(s.pointerId)}}function aa(i,s,o,f,m,y){return i===null||i.nativeEvent!==y?(i={blockedOn:s,domEventName:o,eventSystemFlags:f,nativeEvent:y,targetContainers:[m]},s!==null&&(s=gs(s),s!==null&&dg(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),i)}function uE(i,s,o,f,m){switch(s){case"focusin":return _n=aa(_n,i,s,o,f,m),!0;case"dragenter":return Dn=aa(Dn,i,s,o,f,m),!0;case"mouseover":return Cn=aa(Cn,i,s,o,f,m),!0;case"pointerover":var y=m.pointerId;return sa.set(y,aa(sa.get(y)||null,i,s,o,f,m)),!0;case"gotpointercapture":return y=m.pointerId,ra.set(y,aa(ra.get(y)||null,i,s,o,f,m)),!0}return!1}function gg(i){var s=Pn(i.target);if(s!==null){var o=le(s);if(o!==null){if(s=o.tag,s===13){if(s=z(o),s!==null){i.blockedOn=s,nx(i.priority,function(){if(o.tag===13){var f=Vt(),m=dn(o,f);m!==null&&wt(m,o,f),Nc(o,f)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function wl(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var o=Uc(i.nativeEvent);if(o===null){o=i.nativeEvent;var f=new o.constructor(o.type,o);Ho=f,o.target.dispatchEvent(f),Ho=null}else return s=gs(o),s!==null&&dg(s),i.blockedOn=o,!1;s.shift()}return!0}function pg(i,s,o){wl(i)&&o.delete(s)}function cE(){Bc=!1,_n!==null&&wl(_n)&&(_n=null),Dn!==null&&wl(Dn)&&(Dn=null),Cn!==null&&wl(Cn)&&(Cn=null),sa.forEach(pg),ra.forEach(pg)}function Ol(i,s){i.blockedOn===s&&(i.blockedOn=null,Bc||(Bc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,cE)))}var Il=null;function yg(i){Il!==i&&(Il=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Il===i&&(Il=null);for(var s=0;s<i.length;s+=3){var o=i[s],f=i[s+1],m=i[s+2];if(typeof f!="function"){if(Fc(f||o)===null)continue;break}var y=gs(o);y!==null&&(i.splice(s,3),s-=3,Du(y,{pending:!0,data:m,method:o.method,action:f},f,m))}}))}function la(i){function s(P){return Ol(P,i)}_n!==null&&Ol(_n,i),Dn!==null&&Ol(Dn,i),Cn!==null&&Ol(Cn,i),sa.forEach(s),ra.forEach(s);for(var o=0;o<wn.length;o++){var f=wn[o];f.blockedOn===i&&(f.blockedOn=null)}for(;0<wn.length&&(o=wn[0],o.blockedOn===null);)gg(o),o.blockedOn===null&&wn.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(f=0;f<o.length;f+=3){var m=o[f],y=o[f+1],T=m[It]||null;if(typeof y=="function")T||yg(o);else if(T){var w=null;if(y&&y.hasAttribute("formAction")){if(m=y,T=y[It]||null)w=T.formAction;else if(Fc(m)!==null)continue}else w=T.action;typeof w=="function"?o[f+1]=w:(o.splice(f,3),f-=3),yg(o)}}}function jc(i){this._internalRoot=i}kl.prototype.render=jc.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));var o=s.current,f=Vt();cg(o,f,i,s,null,null)},kl.prototype.unmount=jc.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;i.tag===0&&$s(),cg(i.current,2,null,i,null,null),gl(),s[ms]=null}};function kl(i){this._internalRoot=i}kl.prototype.unstable_scheduleHydration=function(i){if(i){var s=zd();i={blockedOn:null,target:i,priority:s};for(var o=0;o<wn.length&&s!==0&&s<wn[o].priority;o++);wn.splice(o,0,i),o===0&&gg(i)}};var vg=e.version;if(vg!=="19.0.0")throw Error(n(527,vg,"19.0.0"));se.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=H(s),i=i!==null?ee(i):null,i=i===null?null:i.stateNode,i};var fE={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:I,findFiberByHostInstance:Pn,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ml.isDisabled&&Ml.supportsFiber)try{dr=Ml.inject(fE),Ft=Ml}catch{}}return ua.createRoot=function(i,s){if(!a(i))throw Error(n(299));var o=!1,f="",m=N0,y=P0,T=U0,w=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(w=s.unstable_transitionCallbacks)),s=og(i,1,!1,null,null,o,f,m,y,T,w,null),i[ms]=s.current,bc(i.nodeType===8?i.parentNode:i),new jc(s)},ua.hydrateRoot=function(i,s,o){if(!a(i))throw Error(n(299));var f=!1,m="",y=N0,T=P0,w=U0,P=null,G=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(P=o.unstable_transitionCallbacks),o.formState!==void 0&&(G=o.formState)),s=og(i,1,!0,s,o??null,f,m,y,T,w,P,G),s.context=ug(null),o=s.current,f=Vt(),m=xn(f),m.callback=null,Sn(o,m,f),s.current.lanes=f,mr(s,f),Li(s),i[ms]=s.current,bc(i),new kl(s)},ua.version="19.0.0",ua}var Dg;function EE(){if(Dg)return Vc.exports;Dg=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Vc.exports=SE(),Vc.exports}var TE=EE(),bE="Invariant failed";function xi(r,e){if(!r)throw new Error(bE)}function nr(r){const e=r.resolvedLocation,t=r.location,n=(e==null?void 0:e.pathname)!==t.pathname,a=(e==null?void 0:e.href)!==t.href,l=(e==null?void 0:e.hash)!==t.hash;return{fromLocation:e,toLocation:t,pathChanged:n,hrefChanged:a,hashChanged:l}}const AE="Error preloading route! ☝️";function ha(r){return r[r.length-1]}function RE(r){return typeof r=="function"}function ls(r,e){return RE(r)?r(e):r}function Vf(r,e){return e.reduce((t,n)=>(t[n]=r[n],t),{})}function li(r,e){if(r===e)return r;const t=e,n=wg(r)&&wg(t);if(n||oo(r)&&oo(t)){const a=n?r:Object.keys(r),l=a.length,u=n?t:Object.keys(t),c=u.length,d=n?[]:{};let h=0;for(let g=0;g<c;g++){const p=n?g:u[g];(!n&&a.includes(p)||n)&&r[p]===void 0&&t[p]===void 0?(d[p]=void 0,h++):(d[p]=li(r[p],t[p]),d[p]===r[p]&&r[p]!==void 0&&h++)}return l===c&&h===l?r:d}return t}function oo(r){if(!Cg(r))return!1;const e=r.constructor;if(typeof e>"u")return!0;const t=e.prototype;return!(!Cg(t)||!t.hasOwnProperty("isPrototypeOf"))}function Cg(r){return Object.prototype.toString.call(r)==="[object Object]"}function wg(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Og(r,e){let t=Object.keys(r);return e&&(t=t.filter(n=>r[n]!==void 0)),t}function sr(r,e,t){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(oo(r)&&oo(e)){const n=(t==null?void 0:t.ignoreUndefined)??!0,a=Og(r,n),l=Og(e,n);return!(t!=null&&t.partial)&&a.length!==l.length?!1:l.every(u=>sr(r[u],e[u],t))}return Array.isArray(r)&&Array.isArray(e)?r.length!==e.length?!1:!r.some((n,a)=>!sr(n,e[a],t)):!1}function Js(r){let e,t;const n=new Promise((a,l)=>{e=a,t=l});return n.status="pending",n.resolve=a=>{n.status="resolved",n.value=a,e(a),r==null||r(a)},n.reject=a=>{n.status="rejected",t(a)},n}function LE(r){return/%[0-9A-Fa-f]{2}/.test(r)}function rn(r){return wo(r.filter(e=>e!==void 0).join("/"))}function wo(r){return r.replace(/\/{2,}/g,"/")}function hd(r){return r==="/"?r:r.replace(/^\/{1,}/,"")}function os(r){return r==="/"?r:r.replace(/\/{1,}$/,"")}function _E(r){return os(hd(r))}function uo(r,e){return r!=null&&r.endsWith("/")&&r!=="/"&&r!==`${e}/`?r.slice(0,-1):r}function DE(r,e,t){return uo(r,t)===uo(e,t)}function CE({basepath:r,base:e,to:t,trailingSlash:n="never",caseSensitive:a}){var l,u;e=co(r,e,a),t=co(r,t,a);let c=or(e);const d=or(t);c.length>1&&((l=ha(c))==null?void 0:l.value)==="/"&&c.pop(),d.forEach((g,p)=>{g.value==="/"?p?p===d.length-1&&c.push(g):c=[g]:g.value===".."?c.pop():g.value==="."||c.push(g)}),c.length>1&&(((u=ha(c))==null?void 0:u.value)==="/"?n==="never"&&c.pop():n==="always"&&c.push({type:"pathname",value:"/"}));const h=rn([r,...c.map(g=>g.value)]);return wo(h)}function or(r){if(!r)return[];r=wo(r);const e=[];if(r.slice(0,1)==="/"&&(r=r.substring(1),e.push({type:"pathname",value:"/"})),!r)return e;const t=r.split("/").filter(Boolean);return e.push(...t.map(n=>n==="$"||n==="*"?{type:"wildcard",value:n}:n.charAt(0)==="$"?{type:"param",value:n}:{type:"pathname",value:decodeURI(n)})),r.slice(-1)==="/"&&(r=r.substring(1),e.push({type:"pathname",value:"/"})),e}function Nl({path:r,params:e,leaveWildcards:t,leaveParams:n,decodeCharMap:a}){const l=or(r);function u(h){const g=e[h],p=typeof g=="string";return["*","_splat"].includes(h)?p?encodeURI(g):g:p?wE(g,a):g}const c={},d=rn(l.map(h=>{if(h.type==="wildcard"){c._splat=e._splat;const g=u("_splat");return t?`${h.value}${g??""}`:g}if(h.type==="param"){const g=h.value.substring(1);if(c[g]=e[g],n){const p=u(h.value);return`${h.value}${p??""}`}return u(g)??"undefined"}return h.value}));return{usedParams:c,interpolatedPath:d}}function wE(r,e){let t=encodeURIComponent(r);if(e)for(const[n,a]of e)t=t.replaceAll(n,a);return t}function Pl(r,e,t){const n=OE(r,e,t);if(!(t.to&&!n))return n??{}}function co(r,e,t=!1){const n=t?r:r.toLowerCase(),a=t?e:e.toLowerCase();switch(!0){case n==="/":return e;case a===n:return"";case e.length<r.length:return e;case a[n.length]!=="/":return e;case a.startsWith(n):return e.slice(r.length);default:return e}}function OE(r,e,t){if(r!=="/"&&!e.startsWith(r))return;e=co(r,e,t.caseSensitive);const n=co(r,`${t.to??"$"}`,t.caseSensitive),a=or(e),l=or(n);e.startsWith("/")||a.unshift({type:"pathname",value:"/"}),n.startsWith("/")||l.unshift({type:"pathname",value:"/"});const u={};return(()=>{for(let d=0;d<Math.max(a.length,l.length);d++){const h=a[d],g=l[d],p=d>=a.length-1,v=d>=l.length-1;if(g){if(g.type==="wildcard"){const x=decodeURI(rn(a.slice(d).map(S=>S.value)));return u["*"]=x,u._splat=x,!0}if(g.type==="pathname"){if(g.value==="/"&&!(h!=null&&h.value))return!0;if(h){if(t.caseSensitive){if(g.value!==h.value)return!1}else if(g.value.toLowerCase()!==h.value.toLowerCase())return!1}}if(!h)return!1;if(g.type==="param"){if(h.value==="/")return!1;h.value.charAt(0)!=="$"&&(u[g.value.substring(1)]=decodeURIComponent(h.value))}}if(!p&&v)return u["**"]=rn(a.slice(d+1).map(x=>x.value)),!!t.fuzzy&&(g==null?void 0:g.value)!=="/"}return!0})()?u:void 0}function IE(r,e){let t,n,a,l="";for(t in r)if((a=r[t])!==void 0)if(Array.isArray(a))for(n=0;n<a.length;n++)l&&(l+="&"),l+=encodeURIComponent(t)+"="+encodeURIComponent(a[n]);else l&&(l+="&"),l+=encodeURIComponent(t)+"="+encodeURIComponent(a);return""+l}function Ig(r){if(!r)return"";const e=LE(r)?decodeURIComponent(r):decodeURIComponent(encodeURIComponent(r));return e==="false"?!1:e==="true"?!0:+e*0===0&&+e+""===e?+e:e}function kE(r,e){let t,n;const a={},l=r.split("&");for(;t=l.shift();){const u=t.indexOf("=");if(u!==-1){n=t.slice(0,u),n=decodeURIComponent(n);const c=t.slice(u+1);a[n]!==void 0?a[n]=[].concat(a[n],Ig(c)):a[n]=Ig(c)}else n=t,n=decodeURIComponent(n),a[n]=""}return a}const Pt="__root__",ME=PE(JSON.parse),NE=UE(JSON.stringify,JSON.parse);function PE(r){return e=>{e.substring(0,1)==="?"&&(e=e.substring(1));const t=kE(e);for(const n in t){const a=t[n];if(typeof a=="string")try{t[n]=r(a)}catch{}}return t}}function UE(r,e){function t(n){if(typeof n=="object"&&n!==null)try{return r(n)}catch{}else if(typeof n=="string"&&typeof e=="function")try{return e(n),r(n)}catch{}return n}return n=>{n={...n},Object.keys(n).forEach(l=>{const u=n[l];typeof u>"u"||u===void 0?delete n[l]:n[l]=t(u)});const a=IE(n).toString();return a?`?${a}`:""}}const Mn="__TSR_index",kg="popstate",Mg="beforeunload";function cy(r){let e=r.getLocation();const t=new Set,n=u=>{e=r.getLocation(),t.forEach(c=>c({location:e,action:u}))},a=u=>{r.notifyOnIndexChange??!0?n(u):e=r.getLocation()},l=async({task:u,navigateOpts:c,...d})=>{var h,g;if((c==null?void 0:c.ignoreBlocker)??!1){u();return}const v=((h=r.getBlockers)==null?void 0:h.call(r))??[],x=d.type==="PUSH"||d.type==="REPLACE";if(typeof document<"u"&&v.length&&x)for(const S of v){const E=pa(d.path,d.state);if(await S.blockerFn({currentLocation:e,nextLocation:E,action:d.type})){(g=r.onBlocked)==null||g.call(r);return}}u()};return{get location(){return e},get length(){return r.getLength()},subscribers:t,subscribe:u=>(t.add(u),()=>{t.delete(u)}),push:(u,c,d)=>{const h=e.state[Mn];c=zf(h+1,c),l({task:()=>{r.pushState(u,c),n({type:"PUSH"})},navigateOpts:d,type:"PUSH",path:u,state:c})},replace:(u,c,d)=>{const h=e.state[Mn];c=zf(h,c),l({task:()=>{r.replaceState(u,c),n({type:"REPLACE"})},navigateOpts:d,type:"REPLACE",path:u,state:c})},go:(u,c)=>{l({task:()=>{r.go(u),a({type:"GO",index:u})},navigateOpts:c,type:"GO"})},back:u=>{l({task:()=>{r.back((u==null?void 0:u.ignoreBlocker)??!1),a({type:"BACK"})},navigateOpts:u,type:"BACK"})},forward:u=>{l({task:()=>{r.forward((u==null?void 0:u.ignoreBlocker)??!1),a({type:"FORWARD"})},navigateOpts:u,type:"FORWARD"})},canGoBack:()=>e.state[Mn]!==0,createHref:u=>r.createHref(u),block:u=>{var c;if(!r.setBlockers)return()=>{};const d=((c=r.getBlockers)==null?void 0:c.call(r))??[];return r.setBlockers([...d,u]),()=>{var h,g;const p=((h=r.getBlockers)==null?void 0:h.call(r))??[];(g=r.setBlockers)==null||g.call(r,p.filter(v=>v!==u))}},flush:()=>{var u;return(u=r.flush)==null?void 0:u.call(r)},destroy:()=>{var u;return(u=r.destroy)==null?void 0:u.call(r)},notify:n}}function zf(r,e){return e||(e={}),{...e,key:md(),[Mn]:r}}function FE(r){var e;const t=typeof document<"u"?window:void 0,n=t.history.pushState,a=t.history.replaceState;let l=[];const u=()=>l,c=I=>l=I,d=I=>I,h=()=>pa(`${t.location.pathname}${t.location.search}${t.location.hash}`,t.history.state);(e=t.history.state)!=null&&e.key||t.history.replaceState({[Mn]:0,key:md()},"");let g=h(),p,v=!1,x=!1,S=!1,E=!1;const b=()=>g;let A,O;const _=()=>{A&&(M._ignoreSubscribers=!0,(A.isPush?t.history.pushState:t.history.replaceState)(A.state,"",A.href),M._ignoreSubscribers=!1,A=void 0,O=void 0,p=void 0)},k=(I,N,U)=>{const Q=d(N);O||(p=g),g=pa(N,U),A={href:Q,state:U,isPush:(A==null?void 0:A.isPush)||I==="push"},O||(O=Promise.resolve().then(()=>_()))},D=I=>{g=h(),M.notify({type:I})},F=async()=>{if(x){x=!1;return}const I=h(),N=I.state[Mn]-g.state[Mn],U=N===1,Q=N===-1,Z=!U&&!Q||v;v=!1;const V=Z?"GO":Q?"BACK":"FORWARD",X=Z?{type:"GO",index:N}:{type:Q?"BACK":"FORWARD"};if(S)S=!1;else{const $=u();if(typeof document<"u"&&$.length){for(const oe of $)if(await oe.blockerFn({currentLocation:g,nextLocation:I,action:V})){x=!0,t.history.go(1),M.notify(X);return}}}g=h(),M.notify(X)},B=I=>{if(E){E=!1;return}let N=!1;const U=u();if(typeof document<"u"&&U.length)for(const Q of U){const Z=Q.enableBeforeUnload??!0;if(Z===!0){N=!0;break}if(typeof Z=="function"&&Z()===!0){N=!0;break}}if(N)return I.preventDefault(),I.returnValue=""},M=cy({getLocation:b,getLength:()=>t.history.length,pushState:(I,N)=>k("push",I,N),replaceState:(I,N)=>k("replace",I,N),back:I=>(I&&(S=!0),E=!0,t.history.back()),forward:I=>{I&&(S=!0),E=!0,t.history.forward()},go:I=>{v=!0,t.history.go(I)},createHref:I=>d(I),flush:_,destroy:()=>{t.history.pushState=n,t.history.replaceState=a,t.removeEventListener(Mg,B,{capture:!0}),t.removeEventListener(kg,F)},onBlocked:()=>{p&&g!==p&&(g=p)},getBlockers:u,setBlockers:c,notifyOnIndexChange:!1});return t.addEventListener(Mg,B,{capture:!0}),t.addEventListener(kg,F),t.history.pushState=function(...I){const N=n.apply(t.history,I);return M._ignoreSubscribers||D("PUSH"),N},t.history.replaceState=function(...I){const N=a.apply(t.history,I);return M._ignoreSubscribers||D("REPLACE"),N},M}function BE(r={initialEntries:["/"]}){const e=r.initialEntries;let t=r.initialIndex?Math.min(Math.max(r.initialIndex,0),e.length-1):e.length-1;const n=e.map((l,u)=>zf(u,void 0));return cy({getLocation:()=>pa(e[t],n[t]),getLength:()=>e.length,pushState:(l,u)=>{t<e.length-1&&(e.splice(t+1),n.splice(t+1)),n.push(u),e.push(l),t=Math.max(e.length-1,0)},replaceState:(l,u)=>{n[t]=u,e[t]=l},back:()=>{t=Math.max(t-1,0)},forward:()=>{t=Math.min(t+1,e.length-1)},go:l=>{t=Math.min(Math.max(t+l,0),e.length-1)},createHref:l=>l})}function pa(r,e){const t=r.indexOf("#"),n=r.indexOf("?");return{href:r,pathname:r.substring(0,t>0?n>0?Math.min(t,n):t:n>0?n:r.length),hash:t>-1?r.substring(t):"",search:n>-1?r.slice(n,t===-1?void 0:t):"",state:e||{[Mn]:0,key:md()}}}function md(){return(Math.random()+1).toString(36).substring(7)}function gd(r){const e=r.errorComponent??Oo;return L.jsx(jE,{getResetKey:r.getResetKey,onCatch:r.onCatch,children:({error:t,reset:n})=>t?he.createElement(e,{error:t,reset:n}):r.children})}class jE extends he.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(e){return{resetKey:e.getResetKey()}}static getDerivedStateFromError(e){return{error:e}}reset(){this.setState({error:null})}componentDidUpdate(e,t){t.error&&t.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(e,t){this.props.onCatch&&this.props.onCatch(e,t)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function Oo({error:r}){const[e,t]=he.useState(!1);return L.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[L.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[L.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),L.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>t(n=>!n),children:e?"Hide Error":"Show Error"})]}),L.jsx("div",{style:{height:".25rem"}}),e?L.jsx("div",{children:L.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:r.message?L.jsx("code",{children:r.message}):null})}):null]})}var qc={exports:{}},Xc={},Wc={exports:{}},Qc={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ng;function GE(){if(Ng)return Qc;Ng=1;var r=ln();function e(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var t=typeof Object.is=="function"?Object.is:e,n=r.useState,a=r.useEffect,l=r.useLayoutEffect,u=r.useDebugValue;function c(p,v){var x=v(),S=n({inst:{value:x,getSnapshot:v}}),E=S[0].inst,b=S[1];return l(function(){E.value=x,E.getSnapshot=v,d(E)&&b({inst:E})},[p,x,v]),a(function(){return d(E)&&b({inst:E}),p(function(){d(E)&&b({inst:E})})},[p]),u(x),x}function d(p){var v=p.getSnapshot;p=p.value;try{var x=v();return!t(p,x)}catch{return!0}}function h(p,v){return v()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return Qc.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:g,Qc}var Pg;function HE(){return Pg||(Pg=1,Wc.exports=GE()),Wc.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ug;function $E(){if(Ug)return Xc;Ug=1;var r=ln(),e=HE();function t(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var n=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,l=r.useRef,u=r.useEffect,c=r.useMemo,d=r.useDebugValue;return Xc.useSyncExternalStoreWithSelector=function(h,g,p,v,x){var S=l(null);if(S.current===null){var E={hasValue:!1,value:null};S.current=E}else E=S.current;S=c(function(){function A(F){if(!O){if(O=!0,_=F,F=v(F),x!==void 0&&E.hasValue){var B=E.value;if(x(B,F))return k=B}return k=F}if(B=k,n(_,F))return B;var M=v(F);return x!==void 0&&x(B,M)?(_=F,B):(_=F,k=M)}var O=!1,_,k,D=p===void 0?null:p;return[function(){return A(g())},D===null?void 0:function(){return A(D())}]},[g,p,v,x]);var b=a(h,S[0],S[1]);return u(function(){E.hasValue=!0,E.value=b},[b]),d(b),b},Xc}var Fg;function VE(){return Fg||(Fg=1,qc.exports=$E()),qc.exports}var zE=VE();const rr=new WeakMap,Ql=new WeakMap,fo={current:[]};let Zc=!1,ma=0;const fa=new Set,Ul=new Map;function fy(r){const e=Array.from(r).sort((t,n)=>t instanceof ar&&t.options.deps.includes(n)?1:n instanceof ar&&n.options.deps.includes(t)?-1:0);for(const t of e){if(fo.current.includes(t))continue;fo.current.push(t),t.recompute();const n=Ql.get(t);if(n)for(const a of n){const l=rr.get(a);l&&fy(l)}}}function KE(r){r.listeners.forEach(e=>e({prevVal:r.prevState,currentVal:r.state}))}function YE(r){r.listeners.forEach(e=>e({prevVal:r.prevState,currentVal:r.state}))}function dy(r){if(ma>0&&!Ul.has(r)&&Ul.set(r,r.prevState),fa.add(r),!(ma>0)&&!Zc)try{for(Zc=!0;fa.size>0;){const e=Array.from(fa);fa.clear();for(const t of e){const n=Ul.get(t)??t.prevState;t.prevState=n,KE(t)}for(const t of e){const n=rr.get(t);n&&(fo.current.push(t),fy(n))}for(const t of e){const n=rr.get(t);if(n)for(const a of n)YE(a)}}}finally{Zc=!1,fo.current=[],Ul.clear()}}function Jc(r){ma++;try{r()}finally{if(ma--,ma===0){const e=Array.from(fa)[0];e&&dy(e)}}}class Kf{constructor(e,t){this.listeners=new Set,this.subscribe=n=>{var a,l;this.listeners.add(n);const u=(l=(a=this.options)==null?void 0:a.onSubscribe)==null?void 0:l.call(a,n,this);return()=>{this.listeners.delete(n),u==null||u()}},this.setState=n=>{var a,l,u;this.prevState=this.state,this.state=(a=this.options)!=null&&a.updateFn?this.options.updateFn(this.prevState)(n):n(this.prevState),(u=(l=this.options)==null?void 0:l.onUpdate)==null||u.call(l),dy(this)},this.prevState=e,this.state=e,this.options=t}}class ar{constructor(e){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const t=[],n=[];for(const a of this.options.deps)t.push(a.prevState),n.push(a.state);return this.lastSeenDepValues=n,{prevDepVals:t,currDepVals:n,prevVal:this.prevState??void 0}},this.recompute=()=>{var t,n;this.prevState=this.state;const{prevDepVals:a,currDepVals:l,prevVal:u}=this.getDepVals();this.state=this.options.fn({prevDepVals:a,currDepVals:l,prevVal:u}),(n=(t=this.options).onUpdate)==null||n.call(t)},this.checkIfRecalculationNeededDeeply=()=>{for(const l of this.options.deps)l instanceof ar&&l.checkIfRecalculationNeededDeeply();let t=!1;const n=this.lastSeenDepValues,{currDepVals:a}=this.getDepVals();for(let l=0;l<a.length;l++)if(a[l]!==n[l]){t=!0;break}t&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const t of this._subscriptions)t()}),this.subscribe=t=>{var n,a;this.listeners.add(t);const l=(a=(n=this.options).onSubscribe)==null?void 0:a.call(n,t,this);return()=>{this.listeners.delete(t),l==null||l()}},this.options=e,this.state=e.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(e=this.options.deps){for(const t of e)if(t instanceof ar)t.registerOnGraph(),this.registerOnGraph(t.options.deps);else if(t instanceof Kf){let n=rr.get(t);n||(n=new Set,rr.set(t,n)),n.add(this);let a=Ql.get(this);a||(a=new Set,Ql.set(this,a)),a.add(t)}}unregisterFromGraph(e=this.options.deps){for(const t of e)if(t instanceof ar)this.unregisterFromGraph(t.options.deps);else if(t instanceof Kf){const n=rr.get(t);n&&n.delete(this);const a=Ql.get(this);a&&a.delete(t)}}}function qE(r,e=t=>t){return zE.useSyncExternalStoreWithSelector(r.subscribe,()=>r.state,()=>r.state,e,XE)}function XE(r,e){if(Object.is(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(r instanceof Map&&e instanceof Map){if(r.size!==e.size)return!1;for(const[n,a]of r)if(!e.has(n)||!Object.is(a,e.get(n)))return!1;return!0}if(r instanceof Set&&e instanceof Set){if(r.size!==e.size)return!1;for(const n of r)if(!e.has(n))return!1;return!0}const t=Object.keys(r);if(t.length!==Object.keys(e).length)return!1;for(let n=0;n<t.length;n++)if(!Object.prototype.hasOwnProperty.call(e,t[n])||!Object.is(r[t[n]],e[t[n]]))return!1;return!0}const ef=he.createContext(null);function hy(){return typeof document>"u"?ef:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=ef,ef)}function Mi(r){const e=he.useContext(hy());return r==null||r.warn,e}function Ot(r){const e=Mi({warn:(r==null?void 0:r.router)===void 0}),t=(r==null?void 0:r.router)||e,n=he.useRef(void 0);return qE(t.__store,a=>{if(r!=null&&r.select){if(r.structuralSharing??t.options.defaultStructuralSharing){const l=li(n.current,r.select(a));return n.current=l,l}return r.select(a)}return a})}const Io=he.createContext(void 0),WE=he.createContext(void 0);function an(r){const e=he.useContext(r.from?WE:Io);return Ot({select:n=>{const a=n.matches.find(l=>r.from?r.from===l.routeId:l.id===e);if(xi(!((r.shouldThrow??!0)&&!a),`Could not find ${r.from?`an active match from "${r.from}"`:"a nearest match!"}`),a!==void 0)return r.select?r.select(a):a},structuralSharing:r.structuralSharing})}function my(r){return an({from:r.from,strict:r.strict,structuralSharing:r.structuralSharing,select:e=>r.select?r.select(e.loaderData):e.loaderData})}function gy(r){const{select:e,...t}=r;return an({...t,select:n=>e?e(n.loaderDeps):n.loaderDeps})}function py(r){return an({from:r.from,strict:r.strict,shouldThrow:r.shouldThrow,structuralSharing:r.structuralSharing,select:e=>r.select?r.select(e.params):e.params})}function yy(r){return an({from:r.from,strict:r.strict,shouldThrow:r.shouldThrow,structuralSharing:r.structuralSharing,select:e=>r.select?r.select(e.search):e.search})}function oi(r){return!!(r!=null&&r.isNotFound)}function QE(r){const e=Ot({select:t=>`not-found-${t.location.pathname}-${t.status}`});return L.jsx(gd,{getResetKey:()=>e,onCatch:(t,n)=>{var a;if(oi(t))(a=r.onCatch)==null||a.call(r,t,n);else throw t},errorComponent:({error:t})=>{var n;if(oi(t))return(n=r.fallback)==null?void 0:n.call(r,t);throw t},children:r.children})}function ZE(){return L.jsx("p",{children:"Not Found"})}function pd(r){const{navigate:e}=Mi();return he.useCallback(t=>e({...t}),[e])}let vy=class{constructor(e){this.init=t=>{var n,a;this.originalIndex=t.originalIndex;const l=this.options,u=!(l!=null&&l.path)&&!(l!=null&&l.id);this.parentRoute=(a=(n=this.options).getParentRoute)==null?void 0:a.call(n),u?this._path=Pt:xi(this.parentRoute);let c=u?Pt:l.path;c&&c!=="/"&&(c=hd(c));const d=(l==null?void 0:l.id)||c;let h=u?Pt:rn([this.parentRoute.id===Pt?"":this.parentRoute.id,d]);c===Pt&&(c="/"),h!==Pt&&(h=rn(["/",h]));const g=h===Pt?"/":rn([this.parentRoute.fullPath,c]);this._path=c,this._id=h,this._fullPath=g,this._to=g,this._ssr=(l==null?void 0:l.ssr)??t.defaultSsr??!0},this.updateLoader=t=>(Object.assign(this.options,t),this),this.update=t=>(Object.assign(this.options,t),this),this.lazy=t=>(this.lazyFn=t,this),this.useMatch=t=>an({select:t==null?void 0:t.select,from:this.id,structuralSharing:t==null?void 0:t.structuralSharing}),this.useRouteContext=t=>an({...t,from:this.id,select:n=>t!=null&&t.select?t.select(n.context):n.context}),this.useSearch=t=>yy({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.id}),this.useParams=t=>py({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.id}),this.useLoaderDeps=t=>gy({...t,from:this.id}),this.useLoaderData=t=>my({...t,from:this.id}),this.useNavigate=()=>pd({from:this.id}),this.options=e||{},this.isRoot=!(e!=null&&e.getParentRoute),xi(!(e!=null&&e.id&&(e!=null&&e.path))),this.$$typeof=Symbol.for("react.memo")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}get ssr(){return this._ssr}addChildren(e){return this._addFileChildren(e)}_addFileChildren(e){return Array.isArray(e)&&(this.children=e),typeof e=="object"&&e!==null&&(this.children=Object.values(e)),this}};function JE(r){return new vy(r)}class eT extends vy{constructor(e){super(e)}addChildren(e){return super.addChildren(e),this}_addFileChildren(e){return super._addFileChildren(e),this}_addFileTypes(){return this}}function tT(r){return new eT(r)}function Ni(r){return new iT(r,{silent:!0}).createRoute}class iT{constructor(e,t){this.path=e,this.createRoute=n=>{this.silent;const a=JE(n);return a.isRoot=!1,a},this.silent=t==null?void 0:t.silent}}class nT{constructor(e){this.useMatch=t=>an({select:t==null?void 0:t.select,from:this.options.id,structuralSharing:t==null?void 0:t.structuralSharing}),this.useRouteContext=t=>an({from:this.options.id,select:n=>t!=null&&t.select?t.select(n.context):n.context}),this.useSearch=t=>yy({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.options.id}),this.useParams=t=>py({select:t==null?void 0:t.select,structuralSharing:t==null?void 0:t.structuralSharing,from:this.options.id}),this.useLoaderDeps=t=>gy({...t,from:this.options.id}),this.useLoaderData=t=>my({...t,from:this.options.id}),this.useNavigate=()=>pd({from:this.options.id}),this.options=e,this.$$typeof=Symbol.for("react.memo")}}function U_(r){return e=>new nT({id:r,...e})}function Bg(r){if(r.isRedirect=!0,r.statusCode=r.statusCode||r.code||307,r.headers=r.headers||{},!r.reloadDocument){r.reloadDocument=!1;try{new URL(`${r.href}`),r.reloadDocument=!0}catch{}}if(r.throw)throw r;return r}function ss(r){return!!(r!=null&&r.isRedirect)}function tf(r){return!!(r!=null&&r.isRedirect)&&r.href}function Zl(r){return L.jsx(L.Fragment,{children:r.children})}function xy(r,e,t){return e.options.notFoundComponent?L.jsx(e.options.notFoundComponent,{data:t}):r.options.defaultNotFoundComponent?L.jsx(r.options.defaultNotFoundComponent,{data:t}):L.jsx(ZE,{})}var nf,jg;function sT(){if(jg)return nf;jg=1;const r={},e=r.hasOwnProperty,t=(M,I)=>{for(const N in M)e.call(M,N)&&I(N,M[N])},n=(M,I)=>(I&&t(I,(N,U)=>{M[N]=U}),M),a=(M,I)=>{const N=M.length;let U=-1;for(;++U<N;)I(M[U])},l=M=>"\\u"+("0000"+M).slice(-4),u=(M,I)=>{let N=M.toString(16);return I?N:N.toUpperCase()},c=r.toString,d=Array.isArray,h=M=>typeof Buffer=="function"&&Buffer.isBuffer(M),g=M=>c.call(M)=="[object Object]",p=M=>typeof M=="string"||c.call(M)=="[object String]",v=M=>typeof M=="number"||c.call(M)=="[object Number]",x=M=>typeof M=="bigint",S=M=>typeof M=="function",E=M=>c.call(M)=="[object Map]",b=M=>c.call(M)=="[object Set]",A={"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},O=/[\\\b\f\n\r\t]/,_=/[0-9]/,k=/[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,D=/([\uD800-\uDBFF][\uDC00-\uDFFF])|([\uD800-\uDFFF])|(['"`])|[^]/g,F=/([\uD800-\uDBFF][\uDC00-\uDFFF])|([\uD800-\uDFFF])|(['"`])|[^ !#-&\(-\[\]-_a-~]/g,B=(M,I)=>{const N=()=>{oe=$,++I.indentLevel,$=I.indent.repeat(I.indentLevel)},U={escapeEverything:!1,minimal:!1,isScriptContext:!1,quotes:"single",wrap:!1,es6:!1,json:!1,compact:!0,lowercaseHex:!1,numbers:"decimal",indent:"	",indentLevel:0,__inline1__:!1,__inline2__:!1},Q=I&&I.json;Q&&(U.quotes="double",U.wrap=!0),I=n(U,I),I.quotes!="single"&&I.quotes!="double"&&I.quotes!="backtick"&&(I.quotes="single");const Z=I.quotes=="double"?'"':I.quotes=="backtick"?"`":"'",V=I.compact,X=I.lowercaseHex;let $=I.indent.repeat(I.indentLevel),oe="";const le=I.__inline1__,z=I.__inline2__,C=V?"":`
`;let H,ee=!0;const re=I.numbers=="binary",se=I.numbers=="octal",de=I.numbers=="decimal",fe=I.numbers=="hexadecimal";if(Q&&M&&S(M.toJSON)&&(M=M.toJSON()),!p(M)){if(E(M))return M.size==0?"new Map()":(V||(I.__inline1__=!0,I.__inline2__=!1),"new Map("+B(Array.from(M),I)+")");if(b(M))return M.size==0?"new Set()":"new Set("+B(Array.from(M),I)+")";if(h(M))return M.length==0?"Buffer.from([])":"Buffer.from("+B(Array.from(M),I)+")";if(d(M))return H=[],I.wrap=!0,le&&(I.__inline1__=!1,I.__inline2__=!0),z||N(),a(M,me=>{ee=!1,z&&(I.__inline2__=!1),H.push((V||z?"":$)+B(me,I))}),ee?"[]":z?"["+H.join(", ")+"]":"["+C+H.join(","+C)+C+(V?"":oe)+"]";if(v(M)||x(M)){if(Q)return JSON.stringify(Number(M));let me;if(de)me=String(M);else if(fe){let be=M.toString(16);X||(be=be.toUpperCase()),me="0x"+be}else re?me="0b"+M.toString(2):se&&(me="0o"+M.toString(8));return x(M)?me+"n":me}else return x(M)?Q?JSON.stringify(Number(M)):M+"n":g(M)?(H=[],I.wrap=!0,N(),t(M,(me,be)=>{ee=!1,H.push((V?"":$)+B(me,I)+":"+(V?"":" ")+B(be,I))}),ee?"{}":"{"+C+H.join(","+C)+C+(V?"":oe)+"}"):Q?JSON.stringify(M)||"null":String(M)}const Ae=I.escapeEverything?D:F;return H=M.replace(Ae,(me,be,Oe,it,Kt,xt)=>{if(be){if(I.minimal)return be;const ot=be.charCodeAt(0),Ye=be.charCodeAt(1);if(I.es6){const fi=(ot-55296)*1024+Ye-56320+65536;return"\\u{"+u(fi,X)+"}"}return l(u(ot,X))+l(u(Ye,X))}if(Oe)return l(u(Oe.charCodeAt(0),X));if(me=="\0"&&!Q&&!_.test(xt.charAt(Kt+1)))return"\\0";if(it)return it==Z||I.escapeEverything?"\\"+it:it;if(O.test(me))return A[me];if(I.minimal&&!k.test(me))return me;const qe=u(me.charCodeAt(0),X);return Q||qe.length>2?l(qe):"\\x"+("00"+qe).slice(-2)}),Z=="`"&&(H=H.replace(/\$\{/g,"\\${")),I.isScriptContext&&(H=H.replace(/<\/(script|style)/gi,"<\\/$1").replace(/<!--/g,Q?"\\u003C!--":"\\x3C!--")),I.wrap&&(H=Z+H+Z),H};return B.version="3.0.2",nf=B,nf}sT();function rT({children:r,log:e}){return typeof document<"u"?null:L.jsx("script",{className:"tsr-once",dangerouslySetInnerHTML:{__html:[r,"",'if (typeof __TSR_SSR__ !== "undefined") __TSR_SSR__.cleanScripts()'].filter(Boolean).join(`
`)}})}const ho="tsr-scroll-restoration-v1_3",aT=typeof window<"u"&&window.sessionStorage,lT=(r,e)=>{let t;return(...n)=>{t||(t=setTimeout(()=>{r(...n),t=null},e))}},er=aT?{state:JSON.parse(window.sessionStorage.getItem(ho)||"null")||{},set:e=>(er.state=ls(e,er.state)||er.state,window.sessionStorage.setItem(ho,JSON.stringify(er.state)))}:void 0,Yf=r=>r.state.key||r.href;function oT(r){const e=[];let t;for(;t=r.parentNode;)e.unshift(`${r.tagName}:nth-child(${[].indexOf.call(t.children,r)+1})`),r=t;return`${e.join(" > ")}`.toLowerCase()}let mo=!1;function Sy(r,e,t,n,a){var l;let u;try{u=JSON.parse(sessionStorage.getItem(r)||"{}")}catch(h){console.error(h);return}const c=e||((l=window.history.state)==null?void 0:l.key),d=u[c];mo=!0,(()=>{if(n&&d){for(const g in d){const p=d[g];if(g==="window")window.scrollTo({top:p.scrollY,left:p.scrollX,behavior:t});else if(g){const v=document.querySelector(g);v&&(v.scrollLeft=p.scrollX,v.scrollTop=p.scrollY)}}return}const h=window.location.hash.split("#")[1];if(h){const g=(window.history.state||{}).__hashScrollIntoViewOptions??!0;if(g){const p=document.getElementById(h);p&&p.scrollIntoView(g)}return}["window",...(a==null?void 0:a.filter(g=>g!=="window"))??[]].forEach(g=>{const p=g==="window"?window:document.querySelector(g);p&&p.scrollTo({top:0,left:0,behavior:t})})})(),mo=!1}function uT(r,e){if((r.options.scrollRestoration??!1)&&(r.isScrollRestoring=!0),typeof document>"u"||r.isScrollRestorationSetup)return;r.isScrollRestorationSetup=!0,mo=!1;const n=r.options.getScrollRestorationKey||Yf;window.history.scrollRestoration="manual";const a=l=>{if(mo||!r.isScrollRestoring)return;let u="";if(l.target===document||l.target===window)u="window";else{const d=l.target.getAttribute("data-scroll-restoration-id");d?u=`[data-scroll-restoration-id="${d}"]`:u=oT(l.target)}const c=n(r.state.location);er.set(d=>{const h=d[c]=d[c]||{},g=h[u]=h[u]||{};if(u==="window")g.scrollX=window.scrollX||0,g.scrollY=window.scrollY||0;else if(u){const p=document.querySelector(u);p&&(g.scrollX=p.scrollLeft||0,g.scrollY=p.scrollTop||0)}return d})};typeof document<"u"&&document.addEventListener("scroll",lT(a,100),!0),r.subscribe("onRendered",l=>{const u=n(l.toLocation);if(!r.resetNextScroll){r.resetNextScroll=!0;return}Sy(ho,u,r.options.scrollRestorationBehavior,r.isScrollRestoring,r.options.scrollToTopSelectors),r.isScrollRestoring&&er.set(c=>(c[u]=c[u]||{},c))})}function cT(){const r=Mi(),t=(r.options.getScrollRestorationKey||Yf)(r.latestLocation),n=t!==Yf(r.latestLocation)?t:null;return!r.isScrollRestoring||!r.isServer?null:L.jsx(rT,{children:`(${Sy.toString()})(${JSON.stringify(ho)},${JSON.stringify(n)}, undefined, true)`,log:!1})}const Ey=he.memo(function({matchId:e}){var t,n;const a=Mi(),l=Ot({select:A=>{var O;return(O=A.matches.find(_=>_.id===e))==null?void 0:O.routeId}});xi(l);const u=a.routesById[l],c=u.options.pendingComponent??a.options.defaultPendingComponent,d=c?L.jsx(c,{}):null,h=u.options.errorComponent??a.options.defaultErrorComponent,g=u.options.onCatch??a.options.defaultOnCatch,p=u.isRoot?u.options.notFoundComponent??((t=a.options.notFoundRoute)==null?void 0:t.options.component):u.options.notFoundComponent,v=(!u.isRoot||u.options.wrapInSuspense)&&(u.options.wrapInSuspense??c??((n=u.options.errorComponent)==null?void 0:n.preload))?he.Suspense:Zl,x=h?gd:Zl,S=p?QE:Zl,E=Ot({select:A=>A.loadedAt}),b=Ot({select:A=>{var O;const _=A.matches.findIndex(k=>k.id===e);return(O=A.matches[_-1])==null?void 0:O.routeId}});return L.jsxs(L.Fragment,{children:[L.jsx(Io.Provider,{value:e,children:L.jsx(v,{fallback:d,children:L.jsx(x,{getResetKey:()=>E,errorComponent:h||Oo,onCatch:(A,O)=>{if(oi(A))throw A;g==null||g(A,O)},children:L.jsx(S,{fallback:A=>{if(!p||A.routeId&&A.routeId!==l||!A.routeId&&!u.isRoot)throw A;return he.createElement(p,A)},children:L.jsx(dT,{matchId:e})})})})}),b===Pt&&a.options.scrollRestoration?L.jsxs(L.Fragment,{children:[L.jsx(fT,{}),L.jsx(cT,{})]}):null]})});function fT(){var r;const e=Mi(),t=he.useRef(void 0);return L.jsx("script",{suppressHydrationWarning:!0,ref:n=>{n?e.emit({type:"onRendered",...nr(e.state)}):t.current=e.state.resolvedLocation}},(r=e.state.resolvedLocation)==null?void 0:r.state.key)}const dT=he.memo(function({matchId:e}){var t,n,a;const l=Mi(),{match:u,key:c,routeId:d}=Ot({select:v=>{const x=v.matches.findIndex(_=>_.id===e),S=v.matches[x],E=S.routeId,b=l.routesById[E].options.remountDeps??l.options.defaultRemountDeps,A=b==null?void 0:b({routeId:E,loaderDeps:S.loaderDeps,params:S._strictParams,search:S._strictSearch});return{key:A?JSON.stringify(A):void 0,routeId:E,match:Vf(S,["id","status","error"])}},structuralSharing:!0}),h=l.routesById[d],g=he.useMemo(()=>{const v=h.options.component??l.options.defaultComponent;return v?L.jsx(v,{},c):L.jsx(Ty,{})},[c,h.options.component,l.options.defaultComponent]),p=(h.options.errorComponent??l.options.defaultErrorComponent)||Oo;if(u.status==="notFound")return xi(oi(u.error)),xy(l,h,u.error);if(u.status==="redirected")throw xi(ss(u.error)),(t=l.getMatch(u.id))==null?void 0:t.loadPromise;if(u.status==="error"){if(l.isServer)return L.jsx(p,{error:u.error,reset:void 0,info:{componentStack:""}});throw u.error}if(u.status==="pending"){const v=h.options.pendingMinMs??l.options.defaultPendingMinMs;if(v&&!((n=l.getMatch(u.id))!=null&&n.minPendingPromise)&&!l.isServer){const x=Js();Promise.resolve().then(()=>{l.updateMatch(u.id,S=>({...S,minPendingPromise:x}))}),setTimeout(()=>{x.resolve(),l.updateMatch(u.id,S=>({...S,minPendingPromise:void 0}))},v)}throw(a=l.getMatch(u.id))==null?void 0:a.loadPromise}return g}),Ty=he.memo(function(){const e=Mi(),t=he.useContext(Io),n=Ot({select:h=>{var g;return(g=h.matches.find(p=>p.id===t))==null?void 0:g.routeId}}),a=e.routesById[n],l=Ot({select:h=>{const p=h.matches.find(v=>v.id===t);return xi(p),p.globalNotFound}}),u=Ot({select:h=>{var g;const p=h.matches,v=p.findIndex(x=>x.id===t);return(g=p[v+1])==null?void 0:g.id}});if(l)return xy(e,a,void 0);if(!u)return null;const c=L.jsx(Ey,{matchId:u}),d=e.options.defaultPendingComponent?L.jsx(e.options.defaultPendingComponent,{}):null;return t===Pt?L.jsx(he.Suspense,{fallback:d,children:c}):c});var hT=uy();const da=typeof window<"u"?he.useLayoutEffect:he.useEffect;function sf(r){const e=he.useRef({value:r,prev:null}),t=e.current.value;return r!==t&&(e.current={value:r,prev:t}),e.current.prev}function mT(r,e,t={},n={}){const a=he.useRef(typeof IntersectionObserver=="function"),l=he.useRef(null);return he.useEffect(()=>{if(!(!r.current||!a.current||n.disabled))return l.current=new IntersectionObserver(([u])=>{e(u)},t),l.current.observe(r.current),()=>{var u;(u=l.current)==null||u.disconnect()}},[e,t,n.disabled,r]),l.current}function gT(r){const e=he.useRef(null);return he.useImperativeHandle(r,()=>e.current,[]),e}function pT(r,e){const t=Mi(),[n,a]=he.useState(!1),l=he.useRef(!1),u=gT(e),{activeProps:c=()=>({className:"active"}),inactiveProps:d=()=>({}),activeOptions:h,to:g,preload:p,preloadDelay:v,hashScrollIntoView:x,replace:S,startTransition:E,resetScroll:b,viewTransition:A,children:O,target:_,disabled:k,style:D,className:F,onClick:B,onFocus:M,onMouseEnter:I,onMouseLeave:N,onTouchStart:U,ignoreBlocker:Q,...Z}=r,{params:V,search:X,hash:$,state:oe,mask:le,reloadDocument:z,...C}=Z,H=he.useMemo(()=>{try{return new URL(`${g}`),"external"}catch{}return"internal"},[g]),ee=Ot({select:Fe=>Fe.location.search,structuralSharing:!0});r={from:an({strict:!1,select:Fe=>Fe.pathname}),...r};const se=he.useMemo(()=>t.buildLocation(r),[t,r,ee]),de=he.useMemo(()=>r.reloadDocument?!1:p??t.options.defaultPreload,[t.options.defaultPreload,p,r.reloadDocument]),fe=v??t.options.defaultPreloadDelay??0,Ae=Ot({select:Fe=>{if(h!=null&&h.exact){if(!DE(Fe.location.pathname,se.pathname,t.basepath))return!1}else{const Xe=uo(Fe.location.pathname,t.basepath).split("/");if(!uo(se.pathname,t.basepath).split("/").every((Yt,No)=>Yt===Xe[No]))return!1}return((h==null?void 0:h.includeSearch)??!0)&&!sr(Fe.location.search,se.search,{partial:!(h!=null&&h.exact),ignoreUndefined:!(h!=null&&h.explicitUndefined)})?!1:h!=null&&h.includeHash?Fe.location.hash===se.hash:!0}}),me=he.useCallback(()=>{t.preloadRoute(r).catch(Fe=>{console.warn(Fe),console.warn(AE)})},[r,t]),be=he.useCallback(Fe=>{Fe!=null&&Fe.isIntersecting&&me()},[me]);if(mT(u,be,{rootMargin:"100px"},{disabled:!!k||de!=="viewport"}),da(()=>{l.current||!k&&de==="render"&&(me(),l.current=!0)},[k,me,de]),H==="external")return{...C,ref:u,type:H,href:g,...O&&{children:O},..._&&{target:_},...k&&{disabled:k},...D&&{style:D},...F&&{className:F},...B&&{onClick:B},...M&&{onFocus:M},...I&&{onMouseEnter:I},...N&&{onMouseLeave:N},...U&&{onTouchStart:U}};const Oe=Fe=>{if(!k&&!yT(Fe)&&!Fe.defaultPrevented&&(!_||_==="_self")&&Fe.button===0){Fe.preventDefault(),hT.flushSync(()=>{a(!0)});const Xe=t.subscribe("onResolved",()=>{Xe(),a(!1)});return t.navigate({...r,replace:S,resetScroll:b,hashScrollIntoView:x,startTransition:E,viewTransition:A,ignoreBlocker:Q})}},it=Fe=>{k||de&&me()},Kt=it,xt=Fe=>{if(k)return;const Xe=Fe.target||{};if(de){if(Xe.preloadTimeout)return;Xe.preloadTimeout=setTimeout(()=>{Xe.preloadTimeout=null,me()},fe)}},qe=Fe=>{if(k)return;const Xe=Fe.target||{};Xe.preloadTimeout&&(clearTimeout(Xe.preloadTimeout),Xe.preloadTimeout=null)},ot=Fe=>Xe=>{var Pi;(Pi=Xe.persist)==null||Pi.call(Xe),Fe.filter(Boolean).forEach(ba=>{Xe.defaultPrevented||ba(Xe)})},Ye=Ae?ls(c,{})??{}:{},fi=Ae?{}:ls(d,{}),Ei=[F,Ye.className,fi.className].filter(Boolean).join(" "),on={...D,...Ye.style,...fi.style};return{...C,...Ye,...fi,href:k?void 0:se.maskedLocation?t.history.createHref(se.maskedLocation.href):t.history.createHref(se.href),ref:u,onClick:ot([B,Oe]),onFocus:ot([M,it]),onMouseEnter:ot([I,xt]),onMouseLeave:ot([N,qe]),onTouchStart:ot([U,Kt]),disabled:!!k,target:_,...Object.keys(on).length&&{style:on},...Ei&&{className:Ei},...k&&{role:"link","aria-disabled":!0},...Ae&&{"data-status":"active","aria-current":"page"},...n&&{"data-transitioning":"transitioning"}}}const tr=he.forwardRef((r,e)=>{const{_asChild:t,...n}=r,{type:a,ref:l,...u}=pT(n,e),c=typeof n.children=="function"?n.children({isActive:u["data-status"]==="active"}):n.children;return typeof t>"u"&&delete u.disabled,he.createElement(t||"a",{...u,ref:l},c)});function yT(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function vT(){const r=Mi(),e=he.useRef({router:r,mounted:!1}),t=Ot({select:({isLoading:p})=>p}),[n,a]=he.useState(!1),l=Ot({select:p=>p.matches.some(v=>v.status==="pending"),structuralSharing:!0}),u=sf(t),c=t||n||l,d=sf(c),h=t||l,g=sf(h);return r.isServer||(r.startReactTransition=p=>{a(!0),he.startTransition(()=>{p(),a(!1)})}),he.useEffect(()=>{const p=r.history.subscribe(r.load),v=r.buildLocation({to:r.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return os(r.latestLocation.href)!==os(v.href)&&r.commitLocation({...v,replace:!0}),()=>{p()}},[r,r.history]),da(()=>{if(typeof window<"u"&&r.clientSsr||e.current.router===r&&e.current.mounted)return;e.current={router:r,mounted:!0},(async()=>{try{await r.load()}catch(v){console.error(v)}})()},[r]),da(()=>{u&&!t&&r.emit({type:"onLoad",...nr(r.state)})},[u,r,t]),da(()=>{g&&!h&&r.emit({type:"onBeforeRouteMount",...nr(r.state)})},[h,g,r]),da(()=>{d&&!c&&(r.emit({type:"onResolved",...nr(r.state)}),r.__store.setState(p=>({...p,status:"idle",resolvedLocation:p.location})))},[c,d,r]),null}function xT(){const r=Mi(),e=r.options.defaultPendingComponent?L.jsx(r.options.defaultPendingComponent,{}):null,t=r.isServer||typeof document<"u"&&r.clientSsr?Zl:he.Suspense,n=L.jsxs(t,{fallback:e,children:[L.jsx(vT,{}),L.jsx(ST,{})]});return r.options.InnerWrap?L.jsx(r.options.InnerWrap,{children:n}):n}function ST(){const r=Ot({select:t=>{var n;return(n=t.matches[0])==null?void 0:n.id}}),e=Ot({select:t=>t.loadedAt});return L.jsx(Io.Provider,{value:r,children:L.jsx(gd,{getResetKey:()=>e,errorComponent:Oo,onCatch:t=>{t.message||t.toString()},children:r?L.jsx(Ey,{matchId:r}):null})})}const by=["component","errorComponent","pendingComponent","notFoundComponent"];function ET(r){var e;for(const t of by)if((e=r.options[t])!=null&&e.preload)return!0;return!1}function rf(r,e){if(r==null)return{};if("~standard"in r){const t=r["~standard"].validate(e);if(t instanceof Promise)throw new go("Async validation not supported");if(t.issues)throw new go(JSON.stringify(t.issues,void 0,2),{cause:t});return t.value}return"parse"in r?r.parse(e):typeof r=="function"?r(e):{}}function TT(r){return new bT(r)}class bT{constructor(e){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startReactTransition=t=>t(),this.update=t=>{var n;t.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const a=this.options;this.options={...this.options,...t},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(l=>[encodeURIComponent(l),l])):void 0,(!this.basepath||t.basepath&&t.basepath!==a.basepath)&&(t.basepath===void 0||t.basepath===""||t.basepath==="/"?this.basepath="/":this.basepath=`/${_E(t.basepath)}`),(!this.history||this.options.history&&this.options.history!==this.history)&&(this.history=this.options.history??(this.isServer?BE({initialEntries:[this.basepath||"/"]}):FE()),this.latestLocation=this.parseLocation()),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),this.__store||(this.__store=new Kf(RT(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(l=>!["redirected"].includes(l.status))}}}),uT(this)),typeof window<"u"&&"CSS"in window&&typeof((n=window.CSS)==null?void 0:n.supports)=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.buildRouteTree=()=>{this.routesById={},this.routesByPath={};const t=this.options.notFoundRoute;t&&(t.init({originalIndex:99999999999,defaultSsr:this.options.defaultSsr}),this.routesById[t.id]=t);const n=u=>{u.forEach((c,d)=>{c.init({originalIndex:d,defaultSsr:this.options.defaultSsr});const h=this.routesById[c.id];if(xi(!h,`Duplicate routes found with id: ${String(c.id)}`),this.routesById[c.id]=c,!c.isRoot&&c.path){const p=os(c.fullPath);(!this.routesByPath[p]||c.fullPath.endsWith("/"))&&(this.routesByPath[p]=c)}const g=c.children;g!=null&&g.length&&n(g)})};n([this.routeTree]);const a=[];Object.values(this.routesById).forEach((u,c)=>{var d;if(u.isRoot||!u.path)return;const h=hd(u.fullPath),g=or(h);for(;g.length>1&&((d=g[0])==null?void 0:d.value)==="/";)g.shift();const p=g.map(v=>v.value==="/"?.75:v.type==="param"?.5:v.type==="wildcard"?.25:1);a.push({child:u,trimmed:h,parsed:g,index:c,scores:p})}),this.flatRoutes=a.sort((u,c)=>{const d=Math.min(u.scores.length,c.scores.length);for(let h=0;h<d;h++)if(u.scores[h]!==c.scores[h])return c.scores[h]-u.scores[h];if(u.scores.length!==c.scores.length)return c.scores.length-u.scores.length;for(let h=0;h<d;h++)if(u.parsed[h].value!==c.parsed[h].value)return u.parsed[h].value>c.parsed[h].value?1:-1;return u.index-c.index}).map((u,c)=>(u.child.rank=c,u.child))},this.subscribe=(t,n)=>{const a={eventType:t,fn:n};return this.subscribers.add(a),()=>{this.subscribers.delete(a)}},this.emit=t=>{this.subscribers.forEach(n=>{n.eventType===t.type&&n.fn(t)})},this.parseLocation=(t,n)=>{const a=({pathname:d,search:h,hash:g,state:p})=>{const v=this.options.parseSearch(h),x=this.options.stringifySearch(v);return{pathname:d,searchStr:x,search:li(t==null?void 0:t.search,v),hash:g.split("#").reverse()[0]??"",href:`${d}${x}${g}`,state:li(t==null?void 0:t.state,p)}},l=a(n??this.history.location),{__tempLocation:u,__tempKey:c}=l.state;if(u&&(!c||c===this.tempLocationKey)){const d=a(u);return d.state.key=l.state.key,delete d.state.__tempLocation,{...d,maskedLocation:l}}return l},this.resolvePathWithBase=(t,n)=>CE({basepath:this.basepath,base:t,to:wo(n),trailingSlash:this.options.trailingSlash,caseSensitive:this.options.caseSensitive}),this.getMatchedRoutes=(t,n)=>{let a={};const l=os(t.pathname),u=g=>Pl(this.basepath,l,{to:g.fullPath,caseSensitive:g.options.caseSensitive??this.options.caseSensitive,fuzzy:!0});let c=(n==null?void 0:n.to)!==void 0?this.routesByPath[n.to]:void 0;c?a=u(c):c=this.flatRoutes.find(g=>{const p=u(g);return p?(a=p,!0):!1});let d=c||this.routesById[Pt];const h=[d];for(;d.parentRoute;)d=d.parentRoute,h.unshift(d);return{matchedRoutes:h,routeParams:a,foundRoute:c}},this.cancelMatch=t=>{const n=this.getMatch(t);n&&(n.abortController.abort(),clearTimeout(n.pendingTimeout))},this.cancelMatches=()=>{var t;(t=this.state.pendingMatches)==null||t.forEach(n=>{this.cancelMatch(n.id)})},this.buildLocation=t=>{const n=(l={},u)=>{var c,d,h,g,p,v;const x=l._fromLocation?this.matchRoutes(l._fromLocation,{_buildLocation:!0}):this.state.matches,S=l.from!=null?x.find(U=>Pl(this.basepath,os(U.pathname),{to:l.from,caseSensitive:!1,fuzzy:!1})):void 0,E=(S==null?void 0:S.pathname)||this.latestLocation.pathname;xi(l.from==null||S!=null,"Could not find match for from: "+l.from);const b=(c=this.state.pendingMatches)!=null&&c.length?(d=ha(this.state.pendingMatches))==null?void 0:d.search:((h=ha(x))==null?void 0:h.search)||this.latestLocation.search,A=u==null?void 0:u.matchedRoutes.filter(U=>x.find(Q=>Q.routeId===U.id));let O;if(l.to){const U=(S==null?void 0:S.fullPath)||this.latestLocation.pathname;O=this.resolvePathWithBase(U,`${l.to}`)}else{const U=this.routesById[(g=A==null?void 0:A.find(Q=>{const Z=Nl({path:Q.fullPath,params:(u==null?void 0:u.routeParams)??{},decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath;return rn([this.basepath,Z])===E}))==null?void 0:g.id];O=this.resolvePathWithBase(E,(U==null?void 0:U.to)??E)}const _={...(p=ha(x))==null?void 0:p.params};let k=(l.params??!0)===!0?_:{..._,...ls(l.params,_)};Object.keys(k).length>0&&(u==null||u.matchedRoutes.map(U=>{var Q;return((Q=U.options.params)==null?void 0:Q.stringify)??U.options.stringifyParams}).filter(Boolean).forEach(U=>{k={...k,...U(k)}})),O=Nl({path:O,params:k??{},leaveWildcards:!1,leaveParams:t.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath;let D=b;if(t._includeValidateSearch&&((v=this.options.search)!=null&&v.strict)){let U={};u==null||u.matchedRoutes.forEach(Q=>{try{Q.options.validateSearch&&(U={...U,...rf(Q.options.validateSearch,{...U,...D})??{}})}catch{}}),D=U}D=(U=>{const Q=(u==null?void 0:u.matchedRoutes.reduce((X,$)=>{var oe;const le=[];if("search"in $.options)(oe=$.options.search)!=null&&oe.middlewares&&le.push(...$.options.search.middlewares);else if($.options.preSearchFilters||$.options.postSearchFilters){const z=({search:C,next:H})=>{let ee=C;"preSearchFilters"in $.options&&$.options.preSearchFilters&&(ee=$.options.preSearchFilters.reduce((se,de)=>de(se),C));const re=H(ee);return"postSearchFilters"in $.options&&$.options.postSearchFilters?$.options.postSearchFilters.reduce((se,de)=>de(se),re):re};le.push(z)}if(t._includeValidateSearch&&$.options.validateSearch){const z=({search:C,next:H})=>{const ee=H(C);try{return{...ee,...rf($.options.validateSearch,ee)??{}}}catch{return ee}};le.push(z)}return X.concat(le)},[]))??[],Z=({search:X})=>l.search?l.search===!0?X:ls(l.search,X):{};Q.push(Z);const V=(X,$)=>{if(X>=Q.length)return $;const oe=Q[X];return oe({search:$,next:z=>V(X+1,z)})};return V(0,U)})(D),D=li(b,D);const B=this.options.stringifySearch(D),M=l.hash===!0?this.latestLocation.hash:l.hash?ls(l.hash,this.latestLocation.hash):void 0,I=M?`#${M}`:"";let N=l.state===!0?this.latestLocation.state:l.state?ls(l.state,this.latestLocation.state):{};return N=li(this.latestLocation.state,N),{pathname:O,search:D,searchStr:B,state:N,hash:M??"",href:`${O}${B}${I}`,unmaskOnReload:l.unmaskOnReload}},a=(l={},u)=>{var c;const d=n(l);let h=u?n(u):void 0;if(!h){let v={};const x=(c=this.options.routeMasks)==null?void 0:c.find(S=>{const E=Pl(this.basepath,d.pathname,{to:S.from,caseSensitive:!1,fuzzy:!1});return E?(v=E,!0):!1});if(x){const{from:S,...E}=x;u={...Vf(t,["from"]),...E,params:v},h=n(u)}}const g=this.getMatchedRoutes(d,l),p=n(l,g);if(h){const v=this.getMatchedRoutes(h,u),x=n(u,v);p.maskedLocation=x}return p};return t.mask?a(t,{...Vf(t,["from"]),...t.mask}):a(t)},this.commitLocation=({viewTransition:t,ignoreBlocker:n,...a})=>{const l=()=>{const d=["key","__TSR_index","__hashScrollIntoViewOptions"];d.forEach(g=>{a.state[g]=this.latestLocation.state[g]});const h=sr(a.state,this.latestLocation.state);return d.forEach(g=>{delete a.state[g]}),h},u=this.latestLocation.href===a.href,c=this.commitLocationPromise;if(this.commitLocationPromise=Js(()=>{c==null||c.resolve()}),u&&l())this.load();else{let{maskedLocation:d,hashScrollIntoView:h,...g}=a;d&&(g={...d,state:{...d.state,__tempKey:void 0,__tempLocation:{...g,search:g.searchStr,state:{...g.state,__tempKey:void 0,__tempLocation:void 0,key:void 0}}}},(g.unmaskOnReload??this.options.unmaskOnReload??!1)&&(g.state.__tempKey=this.tempLocationKey)),g.state.__hashScrollIntoViewOptions=h??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=t,this.history[a.replace?"replace":"push"](g.href,g.state,{ignoreBlocker:n})}return this.resetNextScroll=a.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:t,resetScroll:n,hashScrollIntoView:a,viewTransition:l,ignoreBlocker:u,href:c,...d}={})=>{if(c){const g=this.history.location.state.__TSR_index,p=pa(c,{__TSR_index:t?g:g+1});d.to=p.pathname,d.search=this.options.parseSearch(p.search),d.hash=p.hash.slice(1)}const h=this.buildLocation({...d,_includeValidateSearch:!0});return this.commitLocation({...h,viewTransition:l,replace:t,resetScroll:n,hashScrollIntoView:a,ignoreBlocker:u})},this.navigate=({to:t,reloadDocument:n,href:a,...l})=>{if(n){if(!a){const u=this.buildLocation({to:t,...l});a=this.history.createHref(u.href)}l.replace?window.location.replace(a):window.location.href=a;return}return this.buildAndCommitLocation({...l,href:a,to:t})},this.load=async t=>{this.latestLocation=this.parseLocation(this.latestLocation);let n,a,l;for(l=new Promise(u=>{this.startReactTransition(async()=>{var c;try{const d=this.latestLocation,h=this.state.resolvedLocation;this.cancelMatches();let g;Jc(()=>{g=this.matchRoutes(d),this.__store.setState(p=>({...p,status:"pending",isLoading:!0,location:d,pendingMatches:g,cachedMatches:p.cachedMatches.filter(v=>!g.find(x=>x.id===v.id))}))}),this.state.redirect||this.emit({type:"onBeforeNavigate",...nr({resolvedLocation:h,location:d})}),this.emit({type:"onBeforeLoad",...nr({resolvedLocation:h,location:d})}),await this.loadMatches({sync:t==null?void 0:t.sync,matches:g,location:d,onReady:async()=>{this.startViewTransition(async()=>{let p,v,x;Jc(()=>{this.__store.setState(S=>{const E=S.matches,b=S.pendingMatches||S.matches;return p=E.filter(A=>!b.find(O=>O.id===A.id)),v=b.filter(A=>!E.find(O=>O.id===A.id)),x=E.filter(A=>b.find(O=>O.id===A.id)),{...S,isLoading:!1,loadedAt:Date.now(),matches:b,pendingMatches:void 0,cachedMatches:[...S.cachedMatches,...p.filter(A=>A.status!=="error")]}}),this.clearExpiredCache()}),[[p,"onLeave"],[v,"onEnter"],[x,"onStay"]].forEach(([S,E])=>{S.forEach(b=>{var A,O;(O=(A=this.looseRoutesById[b.routeId].options)[E])==null||O.call(A,b)})})})}})}catch(d){tf(d)?(n=d,this.isServer||this.navigate({...n,replace:!0,ignoreBlocker:!0})):oi(d)&&(a=d),this.__store.setState(h=>({...h,statusCode:n?n.statusCode:a?404:h.matches.some(g=>g.status==="error")?500:200,redirect:n}))}this.latestLoadPromise===l&&((c=this.commitLocationPromise)==null||c.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),u()})}),this.latestLoadPromise=l,await l;this.latestLoadPromise&&l!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(u=>({...u,statusCode:404}))},this.startViewTransition=t=>{const n=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,n&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let a;typeof n=="object"&&this.isViewTransitionTypesSupported?a={update:t,types:n.types}:a=t,document.startViewTransition(a)}else t()},this.updateMatch=(t,n)=>{var a;let l;const u=(a=this.state.pendingMatches)==null?void 0:a.find(g=>g.id===t),c=this.state.matches.find(g=>g.id===t),d=this.state.cachedMatches.find(g=>g.id===t),h=u?"pendingMatches":c?"matches":d?"cachedMatches":"";return h&&this.__store.setState(g=>{var p;return{...g,[h]:(p=g[h])==null?void 0:p.map(v=>v.id===t?l=n(v):v)}}),l},this.getMatch=t=>[...this.state.cachedMatches,...this.state.pendingMatches??[],...this.state.matches].find(n=>n.id===t),this.loadMatches=async({location:t,matches:n,preload:a,onReady:l,updateMatch:u=this.updateMatch,sync:c})=>{let d,h=!1;const g=async()=>{h||(h=!0,await(l==null?void 0:l()))},p=x=>!!(a&&!this.state.matches.find(S=>S.id===x));!this.isServer&&!this.state.matches.length&&g();const v=(x,S)=>{var E,b,A,O;if(tf(S)&&!S.reloadDocument)throw S;if(ss(S)||oi(S)){if(u(x.id,_=>({..._,status:ss(S)?"redirected":oi(S)?"notFound":"error",isFetching:!1,error:S,beforeLoadPromise:void 0,loaderPromise:void 0})),S.routeId||(S.routeId=x.routeId),(E=x.beforeLoadPromise)==null||E.resolve(),(b=x.loaderPromise)==null||b.resolve(),(A=x.loadPromise)==null||A.resolve(),ss(S))throw h=!0,S=this.resolveRedirect({...S,_fromLocation:t}),S;if(oi(S))throw this._handleNotFound(n,S,{updateMatch:u}),(O=this.serverSsr)==null||O.onMatchSettled({router:this,match:this.getMatch(x.id)}),S}};try{await new Promise((x,S)=>{(async()=>{var E,b,A;try{const O=(D,F,B)=>{var M,I;const{id:N,routeId:U}=n[D],Q=this.looseRoutesById[U];if(F instanceof Promise)throw F;F.routerCode=B,d=d??D,v(this.getMatch(N),F);try{(I=(M=Q.options).onError)==null||I.call(M,F)}catch(Z){F=Z,v(this.getMatch(N),F)}u(N,Z=>{var V,X;return(V=Z.beforeLoadPromise)==null||V.resolve(),(X=Z.loadPromise)==null||X.resolve(),{...Z,error:F,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController,beforeLoadPromise:void 0}})};for(const[D,{id:F,routeId:B}]of n.entries()){const M=this.getMatch(F),I=(E=n[D-1])==null?void 0:E.id,N=this.looseRoutesById[B],U=N.options.pendingMs??this.options.defaultPendingMs,Q=!!(l&&!this.isServer&&!p(F)&&(N.options.loader||N.options.beforeLoad)&&typeof U=="number"&&U!==1/0&&(N.options.pendingComponent??this.options.defaultPendingComponent));let Z=!0;if((M.beforeLoadPromise||M.loaderPromise)&&(Q&&setTimeout(()=>{try{g()}catch{}},U),await M.beforeLoadPromise,Z=this.getMatch(F).status!=="success"),Z){try{u(F,fe=>({...fe,loadPromise:Js(()=>{var Ae;(Ae=fe.loadPromise)==null||Ae.resolve()}),beforeLoadPromise:Js()}));const V=new AbortController;let X;Q&&(X=setTimeout(()=>{try{g()}catch{}},U));const{paramsError:$,searchError:oe}=this.getMatch(F);$&&O(D,$,"PARSE_PARAMS"),oe&&O(D,oe,"VALIDATE_SEARCH");const le=()=>I?this.getMatch(I).context:this.options.context??{};u(F,fe=>({...fe,isFetching:"beforeLoad",fetchCount:fe.fetchCount+1,abortController:V,pendingTimeout:X,context:{...le(),...fe.__routeContext}}));const{search:z,params:C,context:H,cause:ee}=this.getMatch(F),re=p(F),se={search:z,abortController:V,params:C,preload:re,context:H,location:t,navigate:fe=>this.navigate({...fe,_fromLocation:t}),buildLocation:this.buildLocation,cause:re?"preload":ee,matches:n},de=await((A=(b=N.options).beforeLoad)==null?void 0:A.call(b,se))??{};(ss(de)||oi(de))&&O(D,de,"BEFORE_LOAD"),u(F,fe=>({...fe,__beforeLoadContext:de,context:{...le(),...fe.__routeContext,...de},abortController:V}))}catch(V){O(D,V,"BEFORE_LOAD")}u(F,V=>{var X;return(X=V.beforeLoadPromise)==null||X.resolve(),{...V,beforeLoadPromise:void 0,isFetching:!1}})}}const _=n.slice(0,d),k=[];_.forEach(({id:D,routeId:F},B)=>{k.push((async()=>{const{loaderPromise:M}=this.getMatch(D);let I=!1,N=!1;if(M){await M;const U=this.getMatch(D);U.error&&v(U,U.error)}else{const U=k[B-1],Q=this.looseRoutesById[F],Z=()=>{const{params:ee,loaderDeps:re,abortController:se,context:de,cause:fe}=this.getMatch(D),Ae=p(D);return{params:ee,deps:re,preload:!!Ae,parentMatchPromise:U,abortController:se,context:de,location:t,navigate:me=>this.navigate({...me,_fromLocation:t}),cause:Ae?"preload":fe,route:Q}},V=Date.now()-this.getMatch(D).updatedAt,X=p(D),$=X?Q.options.preloadStaleTime??this.options.defaultPreloadStaleTime??3e4:Q.options.staleTime??this.options.defaultStaleTime??0,oe=Q.options.shouldReload,le=typeof oe=="function"?oe(Z()):oe;u(D,ee=>({...ee,loaderPromise:Js(),preload:!!X&&!this.state.matches.find(re=>re.id===D)}));const z=async()=>{var ee,re,se,de,fe,Ae,me,be,Oe,it,Kt;try{const xt=async()=>{const qe=this.getMatch(D);qe.minPendingPromise&&await qe.minPendingPromise};try{this.loadRouteChunk(Q),u(D,Pi=>({...Pi,isFetching:"loader"}));const qe=await((re=(ee=Q.options).loader)==null?void 0:re.call(ee,Z()));v(this.getMatch(D),qe),await Q._lazyPromise,await xt();const ot={matches:n,match:this.getMatch(D),params:this.getMatch(D).params,loaderData:qe},Ye=(de=(se=Q.options).head)==null?void 0:de.call(se,ot),fi=Ye==null?void 0:Ye.meta,Ei=Ye==null?void 0:Ye.links,on=Ye==null?void 0:Ye.scripts,Fe=(Ae=(fe=Q.options).scripts)==null?void 0:Ae.call(fe,ot),Xe=(be=(me=Q.options).headers)==null?void 0:be.call(me,{loaderData:qe});u(D,Pi=>({...Pi,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),loaderData:qe,meta:fi,links:Ei,headScripts:on,headers:Xe,scripts:Fe}))}catch(qe){let ot=qe;await xt(),v(this.getMatch(D),qe);try{(it=(Oe=Q.options).onError)==null||it.call(Oe,qe)}catch(Ye){ot=Ye,v(this.getMatch(D),Ye)}u(D,Ye=>({...Ye,error:ot,status:"error",isFetching:!1}))}(Kt=this.serverSsr)==null||Kt.onMatchSettled({router:this,match:this.getMatch(D)}),await Q._componentsPromise}catch(xt){u(D,qe=>({...qe,loaderPromise:void 0})),v(this.getMatch(D),xt)}},{status:C,invalid:H}=this.getMatch(D);I=C==="success"&&(H||(le??V>$)),X&&Q.options.preload===!1||(I&&!c?(N=!0,(async()=>{try{await z();const{loaderPromise:ee,loadPromise:re}=this.getMatch(D);ee==null||ee.resolve(),re==null||re.resolve(),u(D,se=>({...se,loaderPromise:void 0}))}catch(ee){tf(ee)&&await this.navigate(ee)}})()):(C!=="success"||I&&c)&&await z())}if(!N){const{loaderPromise:U,loadPromise:Q}=this.getMatch(D);U==null||U.resolve(),Q==null||Q.resolve()}return u(D,U=>({...U,isFetching:N?U.isFetching:!1,loaderPromise:N?U.loaderPromise:void 0,invalid:!1})),this.getMatch(D)})())}),await Promise.all(k),x()}catch(O){S(O)}})()}),await g()}catch(x){if(ss(x)||oi(x))throw oi(x)&&!a&&await g(),x}return n},this.invalidate=t=>{const n=a=>{var l;return((l=t==null?void 0:t.filter)==null?void 0:l.call(t,a))??!0?{...a,invalid:!0,...a.status==="error"?{status:"pending",error:void 0}:{}}:a};return this.__store.setState(a=>{var l;return{...a,matches:a.matches.map(n),cachedMatches:a.cachedMatches.map(n),pendingMatches:(l=a.pendingMatches)==null?void 0:l.map(n)}}),this.load({sync:t==null?void 0:t.sync})},this.resolveRedirect=t=>{const n=t;return n.href||(n.href=this.buildLocation(n).href),n},this.clearCache=t=>{const n=t==null?void 0:t.filter;n!==void 0?this.__store.setState(a=>({...a,cachedMatches:a.cachedMatches.filter(l=>!n(l))})):this.__store.setState(a=>({...a,cachedMatches:[]}))},this.clearExpiredCache=()=>{const t=n=>{const a=this.looseRoutesById[n.routeId];if(!a.options.loader)return!0;const l=(n.preload?a.options.preloadGcTime??this.options.defaultPreloadGcTime:a.options.gcTime??this.options.defaultGcTime)??5*60*1e3;return!(n.status!=="error"&&Date.now()-n.updatedAt<l)};this.clearCache({filter:t})},this.loadRouteChunk=t=>(t._lazyPromise===void 0&&(t.lazyFn?t._lazyPromise=t.lazyFn().then(n=>{const{id:a,...l}=n.options;Object.assign(t.options,l)}):t._lazyPromise=Promise.resolve()),t._componentsPromise===void 0&&(t._componentsPromise=t._lazyPromise.then(()=>Promise.all(by.map(async n=>{const a=t.options[n];a!=null&&a.preload&&await a.preload()})))),t._componentsPromise),this.preloadRoute=async t=>{const n=this.buildLocation(t);let a=this.matchRoutes(n,{throwOnError:!0,preload:!0,dest:t});const l=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(c=>c.id)),u=new Set([...l,...this.state.cachedMatches.map(c=>c.id)]);Jc(()=>{a.forEach(c=>{u.has(c.id)||this.__store.setState(d=>({...d,cachedMatches:[...d.cachedMatches,c]}))})});try{return a=await this.loadMatches({matches:a,location:n,preload:!0,updateMatch:(c,d)=>{l.has(c)?a=a.map(h=>h.id===c?d(h):h):this.updateMatch(c,d)}}),a}catch(c){if(ss(c))return c.reloadDocument?void 0:await this.preloadRoute({...c,_fromLocation:n});oi(c)||console.error(c);return}},this.matchRoute=(t,n)=>{const a={...t,to:t.to?this.resolvePathWithBase(t.from||"",t.to):void 0,params:t.params||{},leaveParams:!0},l=this.buildLocation(a);if(n!=null&&n.pending&&this.state.status!=="pending")return!1;const c=((n==null?void 0:n.pending)===void 0?!this.state.isLoading:n.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,d=Pl(this.basepath,c.pathname,{...n,to:l.pathname});return!d||t.params&&!sr(d,t.params,{partial:!0})?!1:d&&((n==null?void 0:n.includeSearch)??!0)?sr(c.search,l.search,{partial:!0})?d:!1:d},this._handleNotFound=(t,n,{updateMatch:a=this.updateMatch}={})=>{const l=Object.fromEntries(t.map(d=>[d.routeId,d]));let u=(n.global?this.looseRoutesById[Pt]:this.looseRoutesById[n.routeId])||this.looseRoutesById[Pt];for(;!u.options.notFoundComponent&&!this.options.defaultNotFoundComponent&&u.id!==Pt;)u=u.parentRoute,xi(u);const c=l[u.id];xi(c,"Could not find match for route: "+u.id),a(c.id,d=>({...d,status:"notFound",error:n,isFetching:!1})),n.routerCode==="BEFORE_LOAD"&&u.parentRoute&&(n.routeId=u.parentRoute.id,this._handleNotFound(t,n,{updateMatch:a}))},this.hasNotFoundMatch=()=>this.__store.state.matches.some(t=>t.status==="notFound"||t.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...e,caseSensitive:e.caseSensitive??!1,notFoundMode:e.notFoundMode??"fuzzy",stringifySearch:e.stringifySearch??NE,parseSearch:e.parseSearch??ME}),typeof document<"u"&&(window.__TSR_ROUTER__=this)}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutes(e,t,n){return typeof e=="string"?this.matchRoutesInternal({pathname:e,search:t},n):this.matchRoutesInternal(e,t)}matchRoutesInternal(e,t){const{foundRoute:n,matchedRoutes:a,routeParams:l}=this.getMatchedRoutes(e,t==null?void 0:t.dest);let u=!1;(n?n.path!=="/"&&l["**"]:os(e.pathname))&&(this.options.notFoundRoute?a.push(this.options.notFoundRoute):u=!0);const c=(()=>{if(u){if(this.options.notFoundMode!=="root")for(let p=a.length-1;p>=0;p--){const v=a[p];if(v.children)return v.id}return Pt}})(),d=a.map(p=>{var v;let x;const S=((v=p.options.params)==null?void 0:v.parse)??p.options.parseParams;if(S)try{const E=S(l);Object.assign(l,E)}catch(E){if(x=new AT(E.message,{cause:E}),t!=null&&t.throwOnError)throw x;return x}}),h=[],g=p=>(p==null?void 0:p.id)?p.context??this.options.context??{}:this.options.context??{};return a.forEach((p,v)=>{var x,S;const E=h[v-1],[b,A,O]=(()=>{const Z=(E==null?void 0:E.search)??e.search,V=(E==null?void 0:E._strictSearch)??{};try{const X=rf(p.options.validateSearch,{...Z})??{};return[{...Z,...X},{...V,...X},void 0]}catch(X){let $=X;if(X instanceof go||($=new go(X.message,{cause:X})),t!=null&&t.throwOnError)throw $;return[Z,{},$]}})(),_=((S=(x=p.options).loaderDeps)==null?void 0:S.call(x,{search:b}))??"",k=_?JSON.stringify(_):"",{usedParams:D,interpolatedPath:F}=Nl({path:p.fullPath,params:l,decodeCharMap:this.pathParamsDecodeCharMap}),B=Nl({path:p.id,params:l,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap}).interpolatedPath+k,M=this.getMatch(B),I=this.state.matches.find(Z=>Z.routeId===p.id),N=I?"stay":"enter";let U;if(M)U={...M,cause:N,params:I?li(I.params,l):l,_strictParams:D,search:li(I?I.search:M.search,b),_strictSearch:A};else{const Z=p.options.loader||p.options.beforeLoad||p.lazyFn||ET(p)?"pending":"success";U={id:B,index:v,routeId:p.id,params:I?li(I.params,l):l,_strictParams:D,pathname:rn([this.basepath,F]),updatedAt:Date.now(),search:I?li(I.search,b):b,_strictSearch:A,searchError:void 0,status:Z,isFetching:!1,error:void 0,paramsError:d[v],__routeContext:{},__beforeLoadContext:{},context:{},abortController:new AbortController,fetchCount:0,cause:N,loaderDeps:I?li(I.loaderDeps,_):_,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:p.options.staticData||{},loadPromise:Js(),fullPath:p.fullPath}}t!=null&&t.preload||(U.globalNotFound=c===p.id),U.searchError=O;const Q=g(E);U.context={...Q,...U.__routeContext,...U.__beforeLoadContext},h.push(U)}),h.forEach((p,v)=>{var x,S,E,b,A,O,_,k;const D=this.looseRoutesById[p.routeId];if(!this.getMatch(p.id)&&(t==null?void 0:t._buildLocation)!==!0){const B=h[v-1],M=g(B),I={deps:p.loaderDeps,params:p.params,context:M,location:e,navigate:N=>this.navigate({...N,_fromLocation:e}),buildLocation:this.buildLocation,cause:p.cause,abortController:p.abortController,preload:!!p.preload,matches:h};p.__routeContext=((S=(x=D.options).context)==null?void 0:S.call(x,I))??{},p.context={...M,...p.__routeContext,...p.__beforeLoadContext}}if(p.status==="success"){p.headers=(b=(E=D.options).headers)==null?void 0:b.call(E,{loaderData:p.loaderData});const B={matches:h,match:p,params:p.params,loaderData:p.loaderData},M=(O=(A=D.options).head)==null?void 0:O.call(A,B);p.links=M==null?void 0:M.links,p.headScripts=M==null?void 0:M.scripts,p.meta=M==null?void 0:M.meta,p.scripts=(k=(_=D.options).scripts)==null?void 0:k.call(_,B)}}),h}}class go extends Error{}class AT extends Error{}function RT(r){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:r,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function LT({router:r,children:e,...t}){r.update({...r.options,...t,context:{...r.options.context,...t.context}});const n=hy(),a=L.jsx(n.Provider,{value:r,children:e});return r.options.Wrap?L.jsx(r.options.Wrap,{children:a}):a}function _T({router:r,...e}){return L.jsx(LT,{router:r,...e,children:L.jsx(xT,{})})}const DT="modulepreload",CT=function(r){return"/"+r},Gg={},bt=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));a=Promise.allSettled(t.map(d=>{if(d=CT(d),d in Gg)return;Gg[d]=!0;const h=d.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":DT,h||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),h)return new Promise((v,x)=>{p.addEventListener("load",v),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return a.then(u=>{for(const c of u||[])c.status==="rejected"&&l(c.reason);return e().catch(l)})};var Ay={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Hg=cs.createContext&&cs.createContext(Ay),wT=["attr","size","title"];function OT(r,e){if(r==null)return{};var t=IT(r,e),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);for(a=0;a<l.length;a++)n=l[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function IT(r,e){if(r==null)return{};var t={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}function po(){return po=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},po.apply(this,arguments)}function $g(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,n)}return t}function yo(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$g(Object(t),!0).forEach(function(n){kT(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):$g(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function kT(r,e,t){return e=MT(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function MT(r){var e=NT(r,"string");return typeof e=="symbol"?e:e+""}function NT(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Ry(r){return r&&r.map((e,t)=>cs.createElement(e.tag,yo({key:t},e.attr),Ry(e.child)))}function Ne(r){return e=>cs.createElement(PT,po({attr:yo({},r.attr)},e),Ry(r.child))}function PT(r){var e=t=>{var{attr:n,size:a,title:l}=r,u=OT(r,wT),c=a||t.size||"1em",d;return t.className&&(d=t.className),r.className&&(d=(d?d+" ":"")+r.className),cs.createElement("svg",po({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,u,{className:d,style:yo(yo({color:r.color||t.color},t.style),r.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),l&&cs.createElement("title",null,l),r.children)};return Hg!==void 0?cs.createElement(Hg.Consumer,null,t=>e(t)):e(Ay)}function UT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(r)}function FT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(r)}function BT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(r)}function Ly(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(r)}function _y(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(r)}function jT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(r)}function GT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(r)}function Dy(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(r)}function HT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(r)}function Vg(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(r)}function yd(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"},child:[]},{tag:"line",attr:{x1:"7",y1:"2",x2:"7",y2:"22"},child:[]},{tag:"line",attr:{x1:"17",y1:"2",x2:"17",y2:"22"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"2",y1:"7",x2:"7",y2:"7"},child:[]},{tag:"line",attr:{x1:"2",y1:"17",x2:"7",y2:"17"},child:[]},{tag:"line",attr:{x1:"17",y1:"17",x2:"22",y2:"17"},child:[]},{tag:"line",attr:{x1:"17",y1:"7",x2:"22",y2:"7"},child:[]}]})(r)}function $T(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"},child:[]}]})(r)}function VT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},child:[]}]})(r)}function zT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(r)}function F_(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(r)}function KT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(r)}function Cy(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"},child:[]},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"},child:[]}]})(r)}function B_(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(r)}function YT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(r)}function qT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(r)}function XT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(r)}function WT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"19",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"5",cy:"12",r:"1"},child:[]}]})(r)}function QT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 18V5l12-2v13"},child:[]},{tag:"circle",attr:{cx:"6",cy:"18",r:"3"},child:[]},{tag:"circle",attr:{cx:"18",cy:"16",r:"3"},child:[]}]})(r)}function vo(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"},child:[]}]})(r)}function ZT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(r)}function JT(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(r)}function eb(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(r)}function tb(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"15",rx:"2",ry:"2"},child:[]},{tag:"polyline",attr:{points:"17 2 12 7 7 2"},child:[]}]})(r)}function ib(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"},child:[]},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"},child:[]}]})(r)}function j_(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(r)}function G_(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(r)}function vd(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(r)}function nb(r){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"},child:[]},{tag:"polygon",attr:{points:"9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"},child:[]}]})(r)}function sb({text:r="Loading..."}){return L.jsx("main",{className:"fixed inset-0 bg-gradient-to-br from-sky-950 via-blue-900 to-indigo-950 flex flex-col items-center justify-center",children:L.jsxs("div",{className:"flex flex-col items-center gap-6 p-8 bg-white/10 backdrop-blur-sm rounded-lg",children:[L.jsx(Cy,{className:"w-12 h-12 text-blue-200 animate-spin","aria-hidden":"true"}),L.jsx("h1",{className:"text-2xl font-medium text-white",children:r}),L.jsx("div",{className:"w-48 h-1 bg-blue-950/50 rounded overflow-hidden",children:L.jsx("div",{className:"h-full bg-blue-400/50 animate-progress rounded"})})]})})}const wy=he.createContext(null);function rb({children:r}){const[e,t]=he.useState(null),[n,a]=he.useState(!0);he.useEffect(()=>{(async()=>{try{if(localStorage.getItem("hasSession")==="true"){const d=await fetch("/api/v1/auth/me",{credentials:"include"});if(d.ok){const h=await d.json();t(h.user)}else localStorage.removeItem("hasSession")}}catch(c){console.error("Auth check failed:",c),localStorage.removeItem("hasSession")}finally{a(!1)}})()},[]),he.useEffect(()=>{e?localStorage.setItem("hasSession","true"):localStorage.removeItem("hasSession")},[e]);const l={user:e,setUser:t};return L.jsx(wy.Provider,{value:l,children:n?L.jsx(sb,{}):r})}const ab="/assets/logo-alt-Y1ljnyPE.png";function lb(){const r=he.useContext(wy);if(!r)throw new Error("useAuth must be used within an AuthProvider");return{user:r.user,isAuthenticated:!!r.user,setUser:r.setUser}}const zg=[{to:"/",icon:zT,label:"Home"},{to:"/movies",icon:yd,label:"Movies"},{to:"/tvshows",icon:tb,label:"TV Shows"},{to:"/music",icon:QT,label:"Music"},{to:"/others",icon:$T,label:"Others"}];function ob(){const[r,e]=he.useState(!1),t=he.useRef(null),n=he.useRef(null),{user:a,setUser:l}=lb(),u=pd();he.useEffect(()=>{const h=g=>{r&&t.current&&!t.current.contains(g.target)&&n.current&&!n.current.contains(g.target)&&e(!1)};return document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[r]);const c=()=>e(!r),d=async()=>{try{(await fetch("/api/v1/auth/logout",{method:"POST"})).ok&&(l(null),u({to:"/login",replace:!0}))}catch(h){console.error("Logout failed:",h)}};return L.jsxs(L.Fragment,{children:[L.jsx("div",{className:`fixed inset-0 bg-gradient-to-b from-slate-950/80 to-blue-950/80 backdrop-blur-sm transition-all duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>e(!1),"aria-hidden":"true"}),L.jsxs("nav",{className:"fixed top-0 left-0 right-0 bg-slate-900/95 shadow-lg shadow-blue-900/20 backdrop-blur-sm z-50",children:[L.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:L.jsxs("div",{className:"flex items-center justify-between h-16",children:[L.jsxs("div",{className:"flex items-center gap-8",children:[L.jsxs(tr,{to:"/",className:"flex items-center gap-2 text-white hover:text-blue-300 transition-colors",preload:"intent",children:[L.jsx("img",{src:ab,alt:"Igloo",className:"h-8 w-auto"}),L.jsx("span",{className:"text-xl font-semibold bg-gradient-to-r from-blue-200 to-blue-100 text-transparent bg-clip-text",children:"Igloo"})]}),a&&L.jsx("div",{className:"hidden md:flex items-center gap-1",children:zg.map(({to:h,icon:g,label:p})=>L.jsxs(tr,{to:h,preload:"intent",className:"px-3 py-2 rounded-md text-sm font-medium text-blue-200 hover:text-white hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out flex items-center gap-2 relative group",children:[L.jsx(g,{className:"w-4 h-4","aria-hidden":"true"}),p,L.jsx("span",{className:"absolute inset-x-0 -bottom-px h-px bg-gradient-to-r from-transparent via-blue-500 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"})]},h))})]}),L.jsx("div",{className:"flex items-center gap-2",children:a&&L.jsxs(L.Fragment,{children:[L.jsxs(tr,{to:"/settings",className:"text-blue-200 hover:text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out flex items-center gap-2",children:[L.jsx(ZT,{})," Settings"]}),L.jsxs("button",{onClick:d,className:"text-blue-200 hover:text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out flex items-center gap-2",children:[L.jsx(YT,{})," Sign Out"]}),L.jsx("button",{ref:n,type:"button",className:"md:hidden p-2 rounded-md text-blue-200 hover:text-white hover:bg-blue-500/10 transition-opacity duration-300 ease-in-out",onClick:c,"aria-expanded":r,"aria-label":"Toggle mobile menu",children:r?L.jsx(vd,{className:"w-6 h-6","aria-hidden":"true"}):L.jsx(XT,{className:"w-6 h-6","aria-hidden":"true"})})]})})]})}),a&&L.jsx("div",{ref:t,className:`md:hidden transition-all duration-300 ease-in-out ${r?"max-h-96 opacity-100":"max-h-0 opacity-0 pointer-events-none"}`,children:L.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-slate-900/95 backdrop-blur-sm border-t border-blue-900/20",children:zg.map(({to:h,icon:g,label:p})=>L.jsxs(tr,{to:h,preload:"intent",className:"px-3 py-2 rounded-md text-base font-medium text-blue-200 hover:text-white hover:bg-blue-500/10 transition-colors flex items-center gap-3",onClick:()=>e(!1),children:[L.jsx(g,{className:"w-5 h-5","aria-hidden":"true"}),p]},h))})})]})]})}const Si=tT({component:()=>L.jsxs(rb,{children:[L.jsx(ob,{}),L.jsx(Ty,{})]}),beforeLoad:({location:r})=>{const e=["/login"].includes(r.pathname),t=localStorage.getItem("hasSession")==="true";if(!t&&!e)throw Bg({to:"/login",search:{redirect:r.pathname}});if(t&&e)throw Bg({to:"/"})}});function ya(r){return r?r.startsWith("http")?r:`/api/v1${r}`:""}function Oy({movie:r,showPlayButton:e=!0}){const t=ya(r.thumb);return L.jsxs(tr,{to:"/movies/$movieID",params:{movieID:r.id.toString()},className:"block w-full transition-transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-sky-500 rounded-xl",children:[L.jsxs("div",{className:"relative aspect-[2/3] rounded-xl overflow-hidden bg-slate-800",children:[L.jsx("img",{src:t,alt:`${r.title} poster`,className:"w-full h-full object-cover",loading:"lazy"}),L.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/80 to-transparent",children:[L.jsx("h3",{className:"text-sm font-medium text-white truncate",children:r.title}),L.jsx("p",{className:"text-xs text-sky-200",children:r.year})]})]}),L.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent opacity-50"}),L.jsxs("div",{className:"p-4 space-y-4",children:[L.jsx("div",{children:L.jsxs("h3",{className:"text-lg font-semibold text-white line-clamp-1 group/title relative",title:r.title,children:[L.jsx("span",{className:"absolute invisible group-hover/title:visible opacity-0 group-hover/title:opacity-100 bottom-full mb-2 left-1/2 -translate-x-1/2 px-2 py-1 bg-slate-800 rounded text-sm whitespace-nowrap transition-all duration-200 z-10 shadow-lg shadow-black/20",children:r.title}),r.title]})}),e&&L.jsxs("button",{className:"w-full flex items-center justify-center gap-2 py-2 px-4 bg-blue-600/20 hover:bg-blue-600 text-blue-200 hover:text-white rounded-lg transition-colors duration-300",type:"button",children:[L.jsx(vo,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{children:"Play Movie"})]})]})]})}function ub({error:r,isVisible:e}){return L.jsx("div",{className:"h-10 flex items-center justify-center",role:"alert","aria-live":"polite",children:L.jsxs("div",{className:`flex items-center gap-2 text-red-500 text-sm font-medium bg-red-500/10 px-3 py-2 rounded-md transition-all duration-300 ${e?"opacity-100 transform scale-100":"opacity-0 transform scale-95"} ${r?"":"hidden"}`,children:[L.jsx(UT,{className:"h-4 w-4 flex-shrink-0","aria-hidden":"true"}),L.jsx("span",{children:r})]})})}function cb({size:r="md",className:e=""}){const t={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return L.jsx(Cy,{className:`text-blue-400 animate-spin ${t[r]} ${e}`,"aria-hidden":"true"})}function fb(){const[r,e]=he.useState([]),[t,n]=he.useState(!0),[a,l]=he.useState(""),[u,c]=he.useState(!1);return he.useEffect(()=>{(async()=>{try{const h=await fetch("/api/v1/movies/latest",{credentials:"include"});if(!h.ok)throw new Error("Failed to fetch latest movies");const g=await h.json();e(g.movies),l("")}catch(h){l(h instanceof Error?h.message:"An error occurred"),c(!0)}finally{n(!1)}})()},[]),L.jsx("section",{className:"py-8",children:L.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[L.jsxs("div",{className:"flex items-center justify-between h-10 mb-6",children:[L.jsx("h2",{className:"text-2xl font-bold text-white",children:"Latest Movies"}),L.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:t&&L.jsx(cb,{})})]}),L.jsx("div",{className:"h-10",children:L.jsx(ub,{error:a,isVisible:u})}),L.jsxs("div",{className:"min-h-[200px]",children:[!t&&r.length===0&&L.jsx("div",{className:"h-full flex items-center justify-center",children:L.jsx("p",{className:"text-blue-200",children:"No movies available"})}),L.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 sm:gap-6",children:t?Array.from({length:12}).map((d,h)=>L.jsx("div",{className:"aspect-[2/3] rounded-xl bg-slate-800/50 animate-pulse"},`placeholder-${h}`)):r.map(d=>L.jsx(Oy,{movie:d},d.id))})]})]})})}const db=Ni("/")({component:hb});function hb(){return L.jsxs("main",{className:"min-h-screen",children:[L.jsxs("section",{className:"relative h-[60vh] flex items-center justify-center overflow-hidden",children:[L.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900/90 via-slate-900/80 to-slate-900"}),L.jsx("div",{className:"relative z-10 text-center px-4 sm:px-6 lg:px-8",children:L.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[L.jsx(yd,{className:"w-16 h-16 mx-auto text-blue-400","aria-hidden":"true"}),L.jsx("h1",{className:"text-4xl sm:text-5xl font-bold text-white",children:"Welcome to Igloo"}),L.jsx("p",{className:"text-xl text-blue-200",children:"Your personal media server for movies, TV shows, and more"}),L.jsx("div",{className:"flex justify-center gap-4",children:L.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:[L.jsx(vo,{className:"w-5 h-5","aria-hidden":"true"}),L.jsx("span",{children:"Start Watching"})]})})]})})]}),L.jsx("div",{className:"bg-slate-900",children:L.jsx(fb,{})})]})}const mb=Ni("/tvshows/")({component:gb});function gb(){return L.jsx("div",{children:'Hello "/tvshows/"!'})}const pb=Ni("/music/")({component:yb});function yb(){return L.jsx("div",{children:'Hello "/music/"!'})}function Iy({currentPage:r,totalPages:e,onPageChange:t}){const n=()=>{const a=[];let u=Math.max(1,r-Math.floor(2.5));const c=Math.min(e,u+5-1);c-u+1<5&&(u=Math.max(1,c-5+1));for(let d=u;d<=c;d++)a.push(d);return a};return L.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[L.jsx("button",{onClick:()=>t(r-1),disabled:r===1,className:"p-2 text-sky-200 hover:text-white hover:bg-sky-500/10 rounded-lg disabled:opacity-50 disabled:hover:bg-transparent disabled:cursor-not-allowed transition-colors","aria-label":"Previous page",children:L.jsx(jT,{className:"w-5 h-5"})}),n()[0]>1&&L.jsxs(L.Fragment,{children:[L.jsx("button",{onClick:()=>t(1),className:`px-3 py-1 rounded-lg transition-colors ${r===1?"bg-sky-500 text-white":"text-sky-200 hover:text-white hover:bg-sky-500/10"}`,children:"1"}),n()[0]>2&&L.jsx("span",{className:"text-sky-200",children:"..."})]}),n().map(a=>L.jsx("button",{onClick:()=>t(a),className:`px-3 py-1 rounded-lg transition-colors ${r===a?"bg-sky-500 text-white":"text-sky-200 hover:text-white hover:bg-sky-500/10"}`,children:a},a)),n()[n().length-1]<e&&L.jsxs(L.Fragment,{children:[n()[n().length-1]<e-1&&L.jsx("span",{className:"text-sky-200",children:"..."}),L.jsx("button",{onClick:()=>t(e),className:`px-3 py-1 rounded-lg transition-colors ${r===e?"bg-sky-500 text-white":"text-sky-200 hover:text-white hover:bg-sky-500/10"}`,children:e})]}),L.jsx("button",{onClick:()=>t(r+1),disabled:r===e,className:"p-2 text-sky-200 hover:text-white hover:bg-sky-500/10 rounded-lg disabled:opacity-50 disabled:hover:bg-transparent disabled:cursor-not-allowed transition-colors","aria-label":"Next page",children:L.jsx(GT,{className:"w-5 h-5"})})]})}const qf=Ni("/movies/")({validateSearch:r=>({page:Number((r==null?void 0:r.page)??1),limit:Number((r==null?void 0:r.limit)??24)}),loaderDeps:({search:r})=>r,loader:async({deps:r})=>{const e=await fetch(`/api/v1/movies?page=${r.page}&limit=${r.limit}`,{credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch movies: ${e.statusText}`);return e.json()},component:vb});function vb(){const{movies:r,total_movies:e,current_page:t,total_pages:n}=qf.useLoaderData(),a=qf.useNavigate();return L.jsx("main",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900","aria-label":"Movie gallery page",children:L.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[L.jsxs("header",{className:"mb-8",children:[L.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Movies"}),L.jsxs("p",{className:"text-sky-200",role:"status","aria-live":"polite",children:[e," ",e===1?"movie":"movies"," available"]})]}),L.jsx("section",{className:"min-h-[200px]","aria-label":"Movie gallery",children:r.length===0?L.jsx("p",{className:"flex items-center justify-center h-64 text-sky-200",role:"status",children:"No movies available"}):L.jsx("ul",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 sm:gap-6",role:"list",children:r.map(l=>L.jsx("li",{children:L.jsx(Oy,{movie:l})},l.id))})}),n>1&&L.jsx("nav",{className:"mt-8","aria-label":"Movie gallery pagination",children:L.jsx(Iy,{currentPage:t,totalPages:n,onPageChange:l=>{window.scrollTo({top:0,behavior:"smooth"}),a({search:u=>({...u,page:l})})}})})]})})}function xb({users:r}){return L.jsxs("table",{className:"w-full",role:"grid",children:[L.jsx("caption",{className:"sr-only",children:"List of system users with their details"}),L.jsx("thead",{children:L.jsxs("tr",{className:"text-left border-b border-sky-200/10",children:[L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Name"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Username"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Email"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Status"}),L.jsx("th",{scope:"col",className:"pb-3 text-sm font-medium text-sky-200",children:"Role"})]})}),L.jsx("tbody",{className:"divide-y divide-sky-200/10",children:r.map(e=>L.jsxs("tr",{className:"hover:bg-sky-500/5 transition-colors",children:[L.jsx("th",{scope:"row",className:"py-4 text-white font-normal",children:e.name}),L.jsx("td",{className:"py-4 text-sky-200",children:e.username}),L.jsx("td",{className:"py-4 text-sky-200",children:L.jsxs("div",{className:"flex items-center gap-2",children:[L.jsx(qT,{className:"w-4 h-4","aria-hidden":"true"}),e.email]})}),L.jsx("td",{className:"py-4",children:e.is_active?L.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400",children:[L.jsx(Ly,{className:"w-3 h-3","aria-hidden":"true"})," Active"]}):L.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-rose-500/10 text-rose-400",children:[L.jsx(vd,{className:"w-3 h-3","aria-hidden":"true"})," Inactive"]})}),L.jsx("td",{className:"py-4",children:e.is_admin?L.jsxs("span",{className:"inline-flex items-center gap-1 text-amber-300",children:[L.jsx(JT,{className:"w-4 h-4","aria-hidden":"true"})," Admin"]}):L.jsx("span",{className:"text-sky-200",children:"User"})})]},e.id))})]})}const Jl=Ni("/settings/users/")({component:Sb,validateSearch:r=>({page:Number((r==null?void 0:r.page)??1),limit:Number((r==null?void 0:r.limit)??10)}),loaderDeps:({search:r})=>r,loader:async({deps:r})=>{const e=await fetch(`/api/v1/users?page=${r.page}&limit=${r.limit}`);if(!e.ok)throw new Error(`${e.status} - ${e.statusText}`);return await e.json()}});function Sb(){const{users:r,total_pages:e,total_users:t}=Jl.useLoaderData(),{page:n,limit:a}=Jl.useSearch(),l=Jl.useNavigate(),u=c=>{l({search:{page:c,limit:a}})};return L.jsx("main",{className:"container mx-auto px-4 py-8",children:L.jsxs("section",{className:"min-h-[400px] bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 shadow-lg","aria-label":"Users list",children:[L.jsxs("header",{className:"mb-6 flex items-center justify-between",children:[L.jsxs("div",{className:"flex items-center gap-4",children:[L.jsx("h2",{className:"text-2xl font-bold text-white",children:"Users"}),L.jsxs(tr,{to:"/settings/users/create",search:{page:1,limit:10},className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-sky-500/10 rounded-lg hover:bg-sky-500/20 transition-colors",children:[L.jsx(ib,{className:"w-4 h-4","aria-hidden":"true"}),"New User"]})]}),L.jsxs("p",{className:"text-sm text-sky-200",children:["Total users:"," ",L.jsx("span",{className:"text-white font-medium",children:t})]})]}),r.length===0?L.jsx("p",{className:"h-40 flex items-center justify-center text-sky-200",role:"status",children:"No users found"}):L.jsxs(L.Fragment,{children:[L.jsx("div",{className:"overflow-x-auto mb-6",children:L.jsx(xb,{users:r})}),L.jsx(Iy,{currentPage:n,totalPages:e,onPageChange:u})]})]})})}function Eb(r){const e=["January","February","March","April","May","June","July","August","September","October","November","December"],t=new Date(r).getDate(),n=new Date(r).getFullYear();return`${e[new Date(r).getMonth()]} ${t}, ${n}`}function Tb(r){const e=Math.floor(r/60),t=r%60;return`${e}h ${t}m`}function Kg(r){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}function bb({cast:r}){const[e,t]=he.useState(!1),n=e?r:r.slice(0,6);return L.jsxs("div",{className:"mb-12",children:[L.jsx("h3",{className:"text-lg font-medium text-sky-200 mb-4",children:"Cast"}),L.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:n.map(a=>L.jsxs("div",{className:"text-center",children:[L.jsx("div",{className:"aspect-[2/3] mb-2 rounded-lg bg-slate-800/50 overflow-hidden",children:a.thumb?L.jsx("img",{src:ya(a.thumb),alt:a.name,className:"w-full h-full object-cover",loading:"lazy"}):L.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-800/50",children:L.jsx("span",{className:"text-sky-200/50",children:"No Image"})})}),L.jsx("div",{className:"text-sm font-medium text-white",children:a.name}),L.jsx("div",{className:"text-xs text-sky-200",children:a.character})]},a.id))}),r.length>6&&L.jsx("div",{className:"flex justify-center mt-6",children:L.jsx("button",{type:"button",onClick:()=>t(!e),className:`inline-flex items-center gap-2 px-4 py-2 bg-slate-800/50 hover:bg-slate-800 
                     text-sky-200 hover:text-sky-100 rounded-lg transition-colors text-sm font-medium`,children:e?L.jsxs(L.Fragment,{children:["Show Less ",L.jsx(Dy,{className:"w-4 h-4","aria-hidden":"true"})]}):L.jsxs(L.Fragment,{children:["Show All Cast (",r.length,")"," ",L.jsx(_y,{className:"w-4 h-4","aria-hidden":"true"})]})})})]})}function Ab({crew:r}){const[e,t]=he.useState(!1),n=e?r:r.slice(0,6);return L.jsxs("div",{children:[L.jsx("h3",{className:"text-lg font-medium text-sky-200 mb-4",children:"Crew"}),L.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:n.map(a=>L.jsxs("div",{className:"text-center",children:[L.jsx("div",{className:"aspect-[2/3] mb-2 rounded-lg bg-slate-800/50 overflow-hidden",children:a.thumb?L.jsx("img",{src:ya(a.thumb),alt:a.name,className:"w-full h-full object-cover",loading:"lazy"}):L.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-800/50",children:L.jsx("span",{className:"text-sky-200/50",children:"No Image"})})}),L.jsx("div",{className:"text-sm font-medium text-white",children:a.name}),L.jsx("div",{className:"text-xs text-sky-200",children:a.job})]},a.id))}),r.length>6&&L.jsx("div",{className:"flex justify-center mt-6",children:L.jsx("button",{type:"button",onClick:()=>t(!e),className:`inline-flex items-center gap-2 px-4 py-2 bg-slate-800/50 hover:bg-slate-800 
                     text-sky-200 hover:text-sky-100 rounded-lg transition-colors text-sm font-medium`,children:e?L.jsxs(L.Fragment,{children:["Show Less ",L.jsx(Dy,{className:"w-4 h-4","aria-hidden":"true"})]}):L.jsxs(L.Fragment,{children:["Show All Crew (",r.length,")"," ",L.jsx(_y,{className:"w-4 h-4","aria-hidden":"true"})]})})})]})}function Rb({genres:r}){return L.jsx("div",{className:"flex flex-wrap gap-4 text-sm text-sky-200 mb-6 drop-shadow-lg bg-slate-900/20 backdrop-blur-sm rounded-lg px-4 py-2",children:r.map(e=>L.jsx("span",{className:"px-2 py-0.5 bg-sky-500/10 rounded",children:e.tag},e.id))})}var af,Yg;function ky(){if(Yg)return af;Yg=1;var r=function(O){return e(O)&&!t(O)};function e(A){return!!A&&typeof A=="object"}function t(A){var O=Object.prototype.toString.call(A);return O==="[object RegExp]"||O==="[object Date]"||l(A)}var n=typeof Symbol=="function"&&Symbol.for,a=n?Symbol.for("react.element"):60103;function l(A){return A.$$typeof===a}function u(A){return Array.isArray(A)?[]:{}}function c(A,O){return O.clone!==!1&&O.isMergeableObject(A)?E(u(A),A,O):A}function d(A,O,_){return A.concat(O).map(function(k){return c(k,_)})}function h(A,O){if(!O.customMerge)return E;var _=O.customMerge(A);return typeof _=="function"?_:E}function g(A){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(A).filter(function(O){return Object.propertyIsEnumerable.call(A,O)}):[]}function p(A){return Object.keys(A).concat(g(A))}function v(A,O){try{return O in A}catch{return!1}}function x(A,O){return v(A,O)&&!(Object.hasOwnProperty.call(A,O)&&Object.propertyIsEnumerable.call(A,O))}function S(A,O,_){var k={};return _.isMergeableObject(A)&&p(A).forEach(function(D){k[D]=c(A[D],_)}),p(O).forEach(function(D){x(A,D)||(v(A,D)&&_.isMergeableObject(O[D])?k[D]=h(D,_)(A[D],O[D],_):k[D]=c(O[D],_))}),k}function E(A,O,_){_=_||{},_.arrayMerge=_.arrayMerge||d,_.isMergeableObject=_.isMergeableObject||r,_.cloneUnlessOtherwiseSpecified=c;var k=Array.isArray(O),D=Array.isArray(A),F=k===D;return F?k?_.arrayMerge(A,O,_):S(A,O,_):c(O,_)}E.all=function(O,_){if(!Array.isArray(O))throw new Error("first argument should be an array");return O.reduce(function(k,D){return E(k,D,_)},{})};var b=E;return af=b,af}var qg=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function Lb(r,e){return!!(r===e||qg(r)&&qg(e))}function _b(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!Lb(r[t],e[t]))return!1;return!0}function Db(r,e){e===void 0&&(e=_b);var t,n=[],a,l=!1;function u(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return l&&t===this&&e(c,n)||(a=r.apply(this,c),l=!0,t=this,n=c),a}return u}const Cb=Object.freeze(Object.defineProperty({__proto__:null,default:Db},Symbol.toStringTag,{value:"Module"})),wb=hE(Cb);var lf,Xg;function My(){if(Xg)return lf;Xg=1;var r=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",n=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function a(l,u){if(l===u)return!0;if(l&&u&&typeof l=="object"&&typeof u=="object"){if(l.constructor!==u.constructor)return!1;var c,d,h;if(Array.isArray(l)){if(c=l.length,c!=u.length)return!1;for(d=c;d--!==0;)if(!a(l[d],u[d]))return!1;return!0}var g;if(e&&l instanceof Map&&u instanceof Map){if(l.size!==u.size)return!1;for(g=l.entries();!(d=g.next()).done;)if(!u.has(d.value[0]))return!1;for(g=l.entries();!(d=g.next()).done;)if(!a(d.value[1],u.get(d.value[0])))return!1;return!0}if(t&&l instanceof Set&&u instanceof Set){if(l.size!==u.size)return!1;for(g=l.entries();!(d=g.next()).done;)if(!u.has(d.value[0]))return!1;return!0}if(n&&ArrayBuffer.isView(l)&&ArrayBuffer.isView(u)){if(c=l.length,c!=u.length)return!1;for(d=c;d--!==0;)if(l[d]!==u[d])return!1;return!0}if(l.constructor===RegExp)return l.source===u.source&&l.flags===u.flags;if(l.valueOf!==Object.prototype.valueOf&&typeof l.valueOf=="function"&&typeof u.valueOf=="function")return l.valueOf()===u.valueOf();if(l.toString!==Object.prototype.toString&&typeof l.toString=="function"&&typeof u.toString=="function")return l.toString()===u.toString();if(h=Object.keys(l),c=h.length,c!==Object.keys(u).length)return!1;for(d=c;d--!==0;)if(!Object.prototype.hasOwnProperty.call(u,h[d]))return!1;if(r&&l instanceof Element)return!1;for(d=c;d--!==0;)if(!((h[d]==="_owner"||h[d]==="__v"||h[d]==="__o")&&l.$$typeof)&&!a(l[h[d]],u[h[d]]))return!1;return!0}return l!==l&&u!==u}return lf=function(u,c){try{return a(u,c)}catch(d){if((d.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw d}},lf}var of={exports:{}},uf,Wg;function Ob(){if(Wg)return uf;Wg=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return uf=r,uf}var cf,Qg;function Ib(){if(Qg)return cf;Qg=1;var r=Ob();function e(){}function t(){}return t.resetWarningCache=e,cf=function(){function n(u,c,d,h,g,p){if(p!==r){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}n.isRequired=n;function a(){return n}var l={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:e};return l.PropTypes=l,l},cf}var Zg;function kb(){return Zg||(Zg=1,of.exports=Ib()()),of.exports}var ff,Jg;function Ny(){if(Jg)return ff;Jg=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=(M,I)=>{for(var N in I)e(M,N,{get:I[N],enumerable:!0})},c=(M,I,N,U)=>{if(I&&typeof I=="object"||typeof I=="function")for(let Q of n(I))!l.call(M,Q)&&Q!==N&&e(M,Q,{get:()=>I[Q],enumerable:!(U=t(I,Q))||U.enumerable});return M},d=(M,I,N)=>(N=M!=null?r(a(M)):{},c(!M||!M.__esModule?e(N,"default",{value:M,enumerable:!0}):N,M)),h=M=>c(e({},"__esModule",{value:!0}),M),g={};u(g,{defaultProps:()=>B,propTypes:()=>D}),ff=h(g);var p=d(kb());const{string:v,bool:x,number:S,array:E,oneOfType:b,shape:A,object:O,func:_,node:k}=p.default,D={url:b([v,E,O]),playing:x,loop:x,controls:x,volume:S,muted:x,playbackRate:S,width:b([v,S]),height:b([v,S]),style:O,progressInterval:S,playsinline:x,pip:x,stopOnUnmount:x,light:b([x,v,O]),playIcon:k,previewTabIndex:S,previewAriaLabel:v,fallback:k,oEmbedUrl:v,wrapper:b([v,_,A({render:_.isRequired})]),config:A({soundcloud:A({options:O}),youtube:A({playerVars:O,embedOptions:O,onUnstarted:_}),facebook:A({appId:v,version:v,playerId:v,attributes:O}),dailymotion:A({params:O}),vimeo:A({playerOptions:O,title:v}),mux:A({attributes:O,version:v}),file:A({attributes:O,tracks:E,forceVideo:x,forceAudio:x,forceHLS:x,forceSafariHLS:x,forceDisableHls:x,forceDASH:x,forceFLV:x,hlsOptions:O,hlsVersion:v,dashVersion:v,flvVersion:v}),wistia:A({options:O,playerId:v,customControls:E}),mixcloud:A({options:O}),twitch:A({options:O,playerId:v}),vidyard:A({options:O})}),onReady:_,onStart:_,onPlay:_,onPause:_,onBuffer:_,onBufferEnd:_,onEnded:_,onError:_,onDuration:_,onSeek:_,onPlaybackRateChange:_,onPlaybackQualityChange:_,onProgress:_,onClickPreview:_,onEnablePIP:_,onDisablePIP:_},F=()=>{},B={playing:!1,loop:!1,controls:!1,volume:null,muted:!1,playbackRate:1,width:"640px",height:"360px",style:{},progressInterval:1e3,playsinline:!1,pip:!1,stopOnUnmount:!0,light:!1,fallback:null,wrapper:"div",previewTabIndex:0,previewAriaLabel:"",oEmbedUrl:"https://noembed.com/embed?url={url}",config:{soundcloud:{options:{visual:!0,buying:!1,liking:!1,download:!1,sharing:!1,show_comments:!1,show_playcount:!1}},youtube:{playerVars:{playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1},embedOptions:{},onUnstarted:F},facebook:{appId:"1309697205772819",version:"v3.3",playerId:null,attributes:{}},dailymotion:{params:{api:1,"endscreen-enable":!1}},vimeo:{playerOptions:{autopause:!1,byline:!1,portrait:!1,title:!1},title:null},mux:{attributes:{},version:"2"},file:{attributes:{},tracks:[],forceVideo:!1,forceAudio:!1,forceHLS:!1,forceDASH:!1,forceFLV:!1,hlsOptions:{},hlsVersion:"1.1.4",dashVersion:"3.1.3",flvVersion:"1.5.0",forceDisableHls:!1},wistia:{options:{},playerId:null,customControls:null},mixcloud:{options:{hide_cover:1}},twitch:{options:{},playerId:null},vidyard:{options:{}}},onReady:F,onStart:F,onPlay:F,onPause:F,onBuffer:F,onBufferEnd:F,onEnded:F,onError:F,onDuration:F,onSeek:F,onPlaybackRateChange:F,onPlaybackQualityChange:F,onProgress:F,onClickPreview:F,onEnablePIP:F,onDisablePIP:F};return ff}var df,ep;function Mb(){if(ep)return df;ep=1,df=function(a,l,u){var c=document.head||document.getElementsByTagName("head")[0],d=document.createElement("script");typeof l=="function"&&(u=l,l={}),l=l||{},u=u||function(){},d.type=l.type||"text/javascript",d.charset=l.charset||"utf8",d.async="async"in l?!!l.async:!0,d.src=a,l.attrs&&r(d,l.attrs),l.text&&(d.text=""+l.text);var h="onload"in d?e:t;h(d,u),d.onload||e(d,u),c.appendChild(d)};function r(n,a){for(var l in a)n.setAttribute(l,a[l])}function e(n,a){n.onload=function(){this.onerror=this.onload=null,a(null,n)},n.onerror=function(){this.onerror=this.onload=null,a(new Error("Failed to load "+this.src),n)}}function t(n,a){n.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,a(null,n))}}return df}var hf,tp;function Ta(){if(tp)return hf;tp=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=(z,C)=>{for(var H in C)e(z,H,{get:C[H],enumerable:!0})},c=(z,C,H,ee)=>{if(C&&typeof C=="object"||typeof C=="function")for(let re of n(C))!l.call(z,re)&&re!==H&&e(z,re,{get:()=>C[re],enumerable:!(ee=t(C,re))||ee.enumerable});return z},d=(z,C,H)=>(H=z!=null?r(a(z)):{},c(!z||!z.__esModule?e(H,"default",{value:z,enumerable:!0}):H,z)),h=z=>c(e({},"__esModule",{value:!0}),z),g={};u(g,{callPlayer:()=>V,getConfig:()=>Q,getSDK:()=>U,isBlobUrl:()=>$,isMediaStream:()=>X,lazy:()=>S,omit:()=>Z,parseEndTime:()=>F,parseStartTime:()=>D,queryString:()=>M,randomString:()=>B,supportsWebKitPresentationMode:()=>oe}),hf=h(g);var p=d(ln()),v=d(Mb()),x=d(ky());const S=z=>p.default.lazy(async()=>{const C=await z();return typeof C.default=="function"?C:C.default}),E=/[?&#](?:start|t)=([0-9hms]+)/,b=/[?&#]end=([0-9hms]+)/,A=/(\d+)(h|m|s)/g,O=/^\d+$/;function _(z,C){if(z instanceof Array)return;const H=z.match(C);if(H){const ee=H[1];if(ee.match(A))return k(ee);if(O.test(ee))return parseInt(ee)}}function k(z){let C=0,H=A.exec(z);for(;H!==null;){const[,ee,re]=H;re==="h"&&(C+=parseInt(ee,10)*60*60),re==="m"&&(C+=parseInt(ee,10)*60),re==="s"&&(C+=parseInt(ee,10)),H=A.exec(z)}return C}function D(z){return _(z,E)}function F(z){return _(z,b)}function B(){return Math.random().toString(36).substr(2,5)}function M(z){return Object.keys(z).map(C=>`${C}=${z[C]}`).join("&")}function I(z){return window[z]?window[z]:window.exports&&window.exports[z]?window.exports[z]:window.module&&window.module.exports&&window.module.exports[z]?window.module.exports[z]:null}const N={},U=function(C,H,ee=null,re=()=>!0,se=v.default){const de=I(H);return de&&re(de)?Promise.resolve(de):new Promise((fe,Ae)=>{if(N[C]){N[C].push({resolve:fe,reject:Ae});return}N[C]=[{resolve:fe,reject:Ae}];const me=be=>{N[C].forEach(Oe=>Oe.resolve(be))};if(ee){const be=window[ee];window[ee]=function(){be&&be(),me(I(H))}}se(C,be=>{be?(N[C].forEach(Oe=>Oe.reject(be)),N[C]=null):ee||me(I(H))})})};function Q(z,C){return(0,x.default)(C.config,z.config)}function Z(z,...C){const H=[].concat(...C),ee={},re=Object.keys(z);for(const se of re)H.indexOf(se)===-1&&(ee[se]=z[se]);return ee}function V(z,...C){if(!this.player||!this.player[z]){let H=`ReactPlayer: ${this.constructor.displayName} player could not call %c${z}%c – `;return this.player?this.player[z]||(H+="The method was not available"):H+="The player was not available",console.warn(H,"font-weight: bold",""),null}return this.player[z](...C)}function X(z){return typeof window<"u"&&typeof window.MediaStream<"u"&&z instanceof window.MediaStream}function $(z){return/^blob:/.test(z)}function oe(z=document.createElement("video")){const C=/iPhone|iPod/.test(navigator.userAgent)===!1;return z.webkitSupportsPresentationMode&&typeof z.webkitSetPresentationMode=="function"&&C}function le(z){return z}return hf}var mf,ip;function Nb(){if(ip)return mf;ip=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=(_,k,D)=>k in _?e(_,k,{enumerable:!0,configurable:!0,writable:!0,value:D}):_[k]=D,c=(_,k)=>{for(var D in k)e(_,D,{get:k[D],enumerable:!0})},d=(_,k,D,F)=>{if(k&&typeof k=="object"||typeof k=="function")for(let B of n(k))!l.call(_,B)&&B!==D&&e(_,B,{get:()=>k[B],enumerable:!(F=t(k,B))||F.enumerable});return _},h=(_,k,D)=>(D=_!=null?r(a(_)):{},d(!_||!_.__esModule?e(D,"default",{value:_,enumerable:!0}):D,_)),g=_=>d(e({},"__esModule",{value:!0}),_),p=(_,k,D)=>(u(_,typeof k!="symbol"?k+"":k,D),D),v={};c(v,{default:()=>O}),mf=g(v);var x=h(ln()),S=h(My()),E=Ny(),b=Ta();const A=5e3;class O extends x.Component{constructor(){super(...arguments),p(this,"mounted",!1),p(this,"isReady",!1),p(this,"isPlaying",!1),p(this,"isLoading",!0),p(this,"loadOnReady",null),p(this,"startOnPlay",!0),p(this,"seekOnPlay",null),p(this,"onDurationCalled",!1),p(this,"handlePlayerMount",k=>{if(this.player){this.progress();return}this.player=k,this.player.load(this.props.url),this.progress()}),p(this,"getInternalPlayer",k=>this.player?this.player[k]:null),p(this,"progress",()=>{if(this.props.url&&this.player&&this.isReady){const k=this.getCurrentTime()||0,D=this.getSecondsLoaded(),F=this.getDuration();if(F){const B={playedSeconds:k,played:k/F};D!==null&&(B.loadedSeconds=D,B.loaded=D/F),(B.playedSeconds!==this.prevPlayed||B.loadedSeconds!==this.prevLoaded)&&this.props.onProgress(B),this.prevPlayed=B.playedSeconds,this.prevLoaded=B.loadedSeconds}}this.progressTimeout=setTimeout(this.progress,this.props.progressFrequency||this.props.progressInterval)}),p(this,"handleReady",()=>{if(!this.mounted)return;this.isReady=!0,this.isLoading=!1;const{onReady:k,playing:D,volume:F,muted:B}=this.props;k(),!B&&F!==null&&this.player.setVolume(F),this.loadOnReady?(this.player.load(this.loadOnReady,!0),this.loadOnReady=null):D&&this.player.play(),this.handleDurationCheck()}),p(this,"handlePlay",()=>{this.isPlaying=!0,this.isLoading=!1;const{onStart:k,onPlay:D,playbackRate:F}=this.props;this.startOnPlay&&(this.player.setPlaybackRate&&F!==1&&this.player.setPlaybackRate(F),k(),this.startOnPlay=!1),D(),this.seekOnPlay&&(this.seekTo(this.seekOnPlay),this.seekOnPlay=null),this.handleDurationCheck()}),p(this,"handlePause",k=>{this.isPlaying=!1,this.isLoading||this.props.onPause(k)}),p(this,"handleEnded",()=>{const{activePlayer:k,loop:D,onEnded:F}=this.props;k.loopOnEnded&&D&&this.seekTo(0),D||(this.isPlaying=!1,F())}),p(this,"handleError",(...k)=>{this.isLoading=!1,this.props.onError(...k)}),p(this,"handleDurationCheck",()=>{clearTimeout(this.durationCheckTimeout);const k=this.getDuration();k?this.onDurationCalled||(this.props.onDuration(k),this.onDurationCalled=!0):this.durationCheckTimeout=setTimeout(this.handleDurationCheck,100)}),p(this,"handleLoaded",()=>{this.isLoading=!1})}componentDidMount(){this.mounted=!0}componentWillUnmount(){clearTimeout(this.progressTimeout),clearTimeout(this.durationCheckTimeout),this.isReady&&this.props.stopOnUnmount&&(this.player.stop(),this.player.disablePIP&&this.player.disablePIP()),this.mounted=!1}componentDidUpdate(k){if(!this.player)return;const{url:D,playing:F,volume:B,muted:M,playbackRate:I,pip:N,loop:U,activePlayer:Q,disableDeferredLoading:Z}=this.props;if(!(0,S.default)(k.url,D)){if(this.isLoading&&!Q.forceLoad&&!Z&&!(0,b.isMediaStream)(D)){console.warn(`ReactPlayer: the attempt to load ${D} is being deferred until the player has loaded`),this.loadOnReady=D;return}this.isLoading=!0,this.startOnPlay=!0,this.onDurationCalled=!1,this.player.load(D,this.isReady)}!k.playing&&F&&!this.isPlaying&&this.player.play(),k.playing&&!F&&this.isPlaying&&this.player.pause(),!k.pip&&N&&this.player.enablePIP&&this.player.enablePIP(),k.pip&&!N&&this.player.disablePIP&&this.player.disablePIP(),k.volume!==B&&B!==null&&this.player.setVolume(B),k.muted!==M&&(M?this.player.mute():(this.player.unmute(),B!==null&&setTimeout(()=>this.player.setVolume(B)))),k.playbackRate!==I&&this.player.setPlaybackRate&&this.player.setPlaybackRate(I),k.loop!==U&&this.player.setLoop&&this.player.setLoop(U)}getDuration(){return this.isReady?this.player.getDuration():null}getCurrentTime(){return this.isReady?this.player.getCurrentTime():null}getSecondsLoaded(){return this.isReady?this.player.getSecondsLoaded():null}seekTo(k,D,F){if(!this.isReady){k!==0&&(this.seekOnPlay=k,setTimeout(()=>{this.seekOnPlay=null},A));return}if(D?D==="fraction":k>0&&k<1){const M=this.player.getDuration();if(!M){console.warn("ReactPlayer: could not seek using fraction – duration not yet available");return}this.player.seekTo(M*k,F);return}this.player.seekTo(k,F)}render(){const k=this.props.activePlayer;return k?x.default.createElement(k,{...this.props,onMount:this.handlePlayerMount,onReady:this.handleReady,onPlay:this.handlePlay,onPause:this.handlePause,onEnded:this.handleEnded,onLoaded:this.handleLoaded,onError:this.handleError}):null}}return p(O,"displayName","Player"),p(O,"propTypes",E.propTypes),p(O,"defaultProps",E.defaultProps),mf}var gf,np;function Py(){if(np)return gf;np=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=(U,Q,Z)=>Q in U?e(U,Q,{enumerable:!0,configurable:!0,writable:!0,value:Z}):U[Q]=Z,c=(U,Q)=>{for(var Z in Q)e(U,Z,{get:Q[Z],enumerable:!0})},d=(U,Q,Z,V)=>{if(Q&&typeof Q=="object"||typeof Q=="function")for(let X of n(Q))!l.call(U,X)&&X!==Z&&e(U,X,{get:()=>Q[X],enumerable:!(V=t(Q,X))||V.enumerable});return U},h=(U,Q,Z)=>(Z=U!=null?r(a(U)):{},d(!U||!U.__esModule?e(Z,"default",{value:U,enumerable:!0}):Z,U)),g=U=>d(e({},"__esModule",{value:!0}),U),p=(U,Q,Z)=>(u(U,typeof Q!="symbol"?Q+"":Q,Z),Z),v={};c(v,{createReactPlayer:()=>N}),gf=g(v);var x=h(ln()),S=h(ky()),E=h(wb),b=h(My()),A=Ny(),O=Ta(),_=h(Nb());const k=(0,O.lazy)(()=>bt(()=>import("./Preview-DMpG-zuj.js").then(U=>U.P),[])),D=typeof window<"u"&&window.document&&typeof document<"u",F=typeof Gc<"u"&&Gc.window&&Gc.window.document,B=Object.keys(A.propTypes),M=D||F?x.Suspense:()=>null,I=[],N=(U,Q)=>{var Z;return Z=class extends x.Component{constructor(){super(...arguments),p(this,"state",{showPreview:!!this.props.light}),p(this,"references",{wrapper:V=>{this.wrapper=V},player:V=>{this.player=V}}),p(this,"handleClickPreview",V=>{this.setState({showPreview:!1}),this.props.onClickPreview(V)}),p(this,"showPreview",()=>{this.setState({showPreview:!0})}),p(this,"getDuration",()=>this.player?this.player.getDuration():null),p(this,"getCurrentTime",()=>this.player?this.player.getCurrentTime():null),p(this,"getSecondsLoaded",()=>this.player?this.player.getSecondsLoaded():null),p(this,"getInternalPlayer",(V="player")=>this.player?this.player.getInternalPlayer(V):null),p(this,"seekTo",(V,X,$)=>{if(!this.player)return null;this.player.seekTo(V,X,$)}),p(this,"handleReady",()=>{this.props.onReady(this)}),p(this,"getActivePlayer",(0,E.default)(V=>{for(const X of[...I,...U])if(X.canPlay(V))return X;return Q||null})),p(this,"getConfig",(0,E.default)((V,X)=>{const{config:$}=this.props;return S.default.all([A.defaultProps.config,A.defaultProps.config[X]||{},$,$[X]||{}])})),p(this,"getAttributes",(0,E.default)(V=>(0,O.omit)(this.props,B))),p(this,"renderActivePlayer",V=>{if(!V)return null;const X=this.getActivePlayer(V);if(!X)return null;const $=this.getConfig(V,X.key);return x.default.createElement(_.default,{...this.props,key:X.key,ref:this.references.player,config:$,activePlayer:X.lazyPlayer||X,onReady:this.handleReady})})}shouldComponentUpdate(V,X){return!(0,b.default)(this.props,V)||!(0,b.default)(this.state,X)}componentDidUpdate(V){const{light:X}=this.props;!V.light&&X&&this.setState({showPreview:!0}),V.light&&!X&&this.setState({showPreview:!1})}renderPreview(V){if(!V)return null;const{light:X,playIcon:$,previewTabIndex:oe,oEmbedUrl:le,previewAriaLabel:z}=this.props;return x.default.createElement(k,{url:V,light:X,playIcon:$,previewTabIndex:oe,previewAriaLabel:z,oEmbedUrl:le,onClick:this.handleClickPreview})}render(){const{url:V,style:X,width:$,height:oe,fallback:le,wrapper:z}=this.props,{showPreview:C}=this.state,H=this.getAttributes(V),ee=typeof z=="string"?this.references.wrapper:void 0;return x.default.createElement(z,{ref:ee,style:{...X,width:$,height:oe},...H},x.default.createElement(M,{fallback:le},C?this.renderPreview(V):this.renderActivePlayer(V)))}},p(Z,"displayName","ReactPlayer"),p(Z,"propTypes",A.propTypes),p(Z,"defaultProps",A.defaultProps),p(Z,"addCustomPlayer",V=>{I.push(V)}),p(Z,"removeCustomPlayers",()=>{I.length=0}),p(Z,"canPlay",V=>{for(const X of[...I,...U])if(X.canPlay(V))return!0;return!1}),p(Z,"canEnablePIP",V=>{for(const X of[...I,...U])if(X.canEnablePIP&&X.canEnablePIP(V))return!0;return!1}),Z};return gf}var pf,sp;function Uy(){if(sp)return pf;sp=1;var r=Object.defineProperty,e=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,a=(V,X)=>{for(var $ in X)r(V,$,{get:X[$],enumerable:!0})},l=(V,X,$,oe)=>{if(X&&typeof X=="object"||typeof X=="function")for(let le of t(X))!n.call(V,le)&&le!==$&&r(V,le,{get:()=>X[le],enumerable:!(oe=e(X,le))||oe.enumerable});return V},u=V=>l(r({},"__esModule",{value:!0}),V),c={};a(c,{AUDIO_EXTENSIONS:()=>B,DASH_EXTENSIONS:()=>N,FLV_EXTENSIONS:()=>U,HLS_EXTENSIONS:()=>I,MATCH_URL_DAILYMOTION:()=>_,MATCH_URL_FACEBOOK:()=>x,MATCH_URL_FACEBOOK_WATCH:()=>S,MATCH_URL_KALTURA:()=>F,MATCH_URL_MIXCLOUD:()=>k,MATCH_URL_MUX:()=>v,MATCH_URL_SOUNDCLOUD:()=>g,MATCH_URL_STREAMABLE:()=>E,MATCH_URL_TWITCH_CHANNEL:()=>O,MATCH_URL_TWITCH_VIDEO:()=>A,MATCH_URL_VIDYARD:()=>D,MATCH_URL_VIMEO:()=>p,MATCH_URL_WISTIA:()=>b,MATCH_URL_YOUTUBE:()=>h,VIDEO_EXTENSIONS:()=>M,canPlay:()=>Z}),pf=u(c);var d=Ta();const h=/(?:youtu\.be\/|youtube(?:-nocookie|education)?\.com\/(?:embed\/|v\/|watch\/|watch\?v=|watch\?.+&v=|shorts\/|live\/))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//,g=/(?:soundcloud\.com|snd\.sc)\/[^.]+$/,p=/vimeo\.com\/(?!progressive_redirect).+/,v=/stream\.mux\.com\/(?!\w+\.m3u8)(\w+)/,x=/^https?:\/\/(www\.)?facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/,S=/^https?:\/\/fb\.watch\/.+$/,E=/streamable\.com\/([a-z0-9]+)$/,b=/(?:wistia\.(?:com|net)|wi\.st)\/(?:medias|embed)\/(?:iframe\/)?([^?]+)/,A=/(?:www\.|go\.)?twitch\.tv\/videos\/(\d+)($|\?)/,O=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,_=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?(?:[\w.#_-]+)?/,k=/mixcloud\.com\/([^/]+\/[^/]+)/,D=/vidyard.com\/(?:watch\/)?([a-zA-Z0-9-_]+)/,F=/^https?:\/\/[a-zA-Z]+\.kaltura.(com|org)\/p\/([0-9]+)\/sp\/([0-9]+)00\/embedIframeJs\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+)(.*)entry_id.([a-zA-Z0-9-_].*)$/,B=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,M=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,I=/\.(m3u8)($|\?)/i,N=/\.(mpd)($|\?)/i,U=/\.(flv)($|\?)/i,Q=V=>{if(V instanceof Array){for(const X of V)if(typeof X=="string"&&Q(X)||Q(X.src))return!0;return!1}return(0,d.isMediaStream)(V)||(0,d.isBlobUrl)(V)?!0:B.test(V)||M.test(V)||I.test(V)||N.test(V)||U.test(V)},Z={youtube:V=>V instanceof Array?V.every(X=>h.test(X)):h.test(V),soundcloud:V=>g.test(V)&&!B.test(V),vimeo:V=>p.test(V)&&!M.test(V)&&!I.test(V),mux:V=>v.test(V),facebook:V=>x.test(V)||S.test(V),streamable:V=>E.test(V),wistia:V=>b.test(V),twitch:V=>A.test(V)||O.test(V),dailymotion:V=>_.test(V),mixcloud:V=>k.test(V),vidyard:V=>D.test(V),kaltura:V=>F.test(V),file:Q};return pf}var yf,rp;function Pb(){if(rp)return yf;rp=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=(M,I,N)=>I in M?e(M,I,{enumerable:!0,configurable:!0,writable:!0,value:N}):M[I]=N,c=(M,I)=>{for(var N in I)e(M,N,{get:I[N],enumerable:!0})},d=(M,I,N,U)=>{if(I&&typeof I=="object"||typeof I=="function")for(let Q of n(I))!l.call(M,Q)&&Q!==N&&e(M,Q,{get:()=>I[Q],enumerable:!(U=t(I,Q))||U.enumerable});return M},h=(M,I,N)=>(N=M!=null?r(a(M)):{},d(!M||!M.__esModule?e(N,"default",{value:M,enumerable:!0}):N,M)),g=M=>d(e({},"__esModule",{value:!0}),M),p=(M,I,N)=>(u(M,typeof I!="symbol"?I+"":I,N),N),v={};c(v,{default:()=>B}),yf=g(v);var x=h(ln()),S=Ta(),E=Uy();const b="https://www.youtube.com/iframe_api",A="YT",O="onYouTubeIframeAPIReady",_=/[?&](?:list|channel)=([a-zA-Z0-9_-]+)/,k=/user\/([a-zA-Z0-9_-]+)\/?/,D=/youtube-nocookie\.com/,F="https://www.youtube-nocookie.com";class B extends x.Component{constructor(){super(...arguments),p(this,"callPlayer",S.callPlayer),p(this,"parsePlaylist",I=>{if(I instanceof Array)return{listType:"playlist",playlist:I.map(this.getID).join(",")};if(_.test(I)){const[,N]=I.match(_);return{listType:"playlist",list:N.replace(/^UC/,"UU")}}if(k.test(I)){const[,N]=I.match(k);return{listType:"user_uploads",list:N}}return{}}),p(this,"onStateChange",I=>{const{data:N}=I,{onPlay:U,onPause:Q,onBuffer:Z,onBufferEnd:V,onEnded:X,onReady:$,loop:oe,config:{playerVars:le,onUnstarted:z}}=this.props,{UNSTARTED:C,PLAYING:H,PAUSED:ee,BUFFERING:re,ENDED:se,CUED:de}=window[A].PlayerState;if(N===C&&z(),N===H&&(U(),V()),N===ee&&Q(),N===re&&Z(),N===se){const fe=!!this.callPlayer("getPlaylist");oe&&!fe&&(le.start?this.seekTo(le.start):this.play()),X()}N===de&&$()}),p(this,"mute",()=>{this.callPlayer("mute")}),p(this,"unmute",()=>{this.callPlayer("unMute")}),p(this,"ref",I=>{this.container=I})}componentDidMount(){this.props.onMount&&this.props.onMount(this)}getID(I){return!I||I instanceof Array||_.test(I)?null:I.match(E.MATCH_URL_YOUTUBE)[1]}load(I,N){const{playing:U,muted:Q,playsinline:Z,controls:V,loop:X,config:$,onError:oe}=this.props,{playerVars:le,embedOptions:z}=$,C=this.getID(I);if(N){if(_.test(I)||k.test(I)||I instanceof Array){this.player.loadPlaylist(this.parsePlaylist(I));return}this.player.cueVideoById({videoId:C,startSeconds:(0,S.parseStartTime)(I)||le.start,endSeconds:(0,S.parseEndTime)(I)||le.end});return}(0,S.getSDK)(b,A,O,H=>H.loaded).then(H=>{this.container&&(this.player=new H.Player(this.container,{width:"100%",height:"100%",videoId:C,playerVars:{autoplay:U?1:0,mute:Q?1:0,controls:V?1:0,start:(0,S.parseStartTime)(I),end:(0,S.parseEndTime)(I),origin:window.location.origin,playsinline:Z?1:0,...this.parsePlaylist(I),...le},events:{onReady:()=>{X&&this.player.setLoop(!0),this.props.onReady()},onPlaybackRateChange:ee=>this.props.onPlaybackRateChange(ee.data),onPlaybackQualityChange:ee=>this.props.onPlaybackQualityChange(ee),onStateChange:this.onStateChange,onError:ee=>oe(ee.data)},host:D.test(I)?F:void 0,...z}))},oe),z.events&&console.warn("Using `embedOptions.events` will likely break things. Use ReactPlayer’s callback props instead, eg onReady, onPlay, onPause")}play(){this.callPlayer("playVideo")}pause(){this.callPlayer("pauseVideo")}stop(){document.body.contains(this.callPlayer("getIframe"))&&this.callPlayer("stopVideo")}seekTo(I,N=!1){this.callPlayer("seekTo",I),!N&&!this.props.playing&&this.pause()}setVolume(I){this.callPlayer("setVolume",I*100)}setPlaybackRate(I){this.callPlayer("setPlaybackRate",I)}setLoop(I){this.callPlayer("setLoop",I)}getDuration(){return this.callPlayer("getDuration")}getCurrentTime(){return this.callPlayer("getCurrentTime")}getSecondsLoaded(){return this.callPlayer("getVideoLoadedFraction")*this.getDuration()}render(){const{display:I}=this.props,N={width:"100%",height:"100%",display:I};return x.default.createElement("div",{style:N},x.default.createElement("div",{ref:this.ref}))}}return p(B,"displayName","YouTube"),p(B,"canPlay",E.canPlay.youtube),yf}var vf,ap;function Ub(){if(ap)return vf;ap=1;var r=Py().createReactPlayer,e=Pb().default;return vf=r([{key:"youtube",canPlay:e.canPlay,lazyPlayer:e}]),vf}var Fb=Ub();const Bb=dd(Fb);function jb({url:r,playing:e=!1,onPlay:t,onPause:n,onEnded:a,onError:l}){return L.jsx("div",{className:"w-full bg-black",children:L.jsxs("div",{className:"relative w-full pt-[56.25%]",children:[" ",L.jsx("div",{className:"absolute inset-0",children:L.jsx(Bb,{url:r||"",playing:e,controls:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0},config:{playerVars:{autoplay:1,modestbranding:1,rel:0,origin:window.location.origin,enablejsapi:1,playsinline:1}},onPlay:t,onPause:n,onEnded:a,onError:l})})]})})}function Gb({isOpen:r,onClose:e,videoUrl:t}){const n=he.useRef(null);he.useEffect(()=>{const l=n.current;if(l)return r?(l.showModal(),document.body.style.overflow="hidden"):(l.close(),document.body.style.overflow="unset"),()=>{document.body.style.overflow="unset"}},[r]);const a=l=>{const u=n.current;u&&l.target===u&&e()};return L.jsx("dialog",{ref:n,className:`fixed m-auto inset-0 p-4 max-h-[90vh] max-w-[90vw] w-full md:w-[800px] bg-transparent 
                 backdrop:bg-slate-900/90 backdrop:backdrop-blur-sm`,onClick:a,onClose:e,children:L.jsx("div",{className:"bg-slate-900 rounded-lg shadow-xl shadow-black/20 overflow-hidden",children:L.jsx(jb,{url:t,playing:r,onEnded:e})})})}function Hb({studios:r}){return r.length===0?null:L.jsxs("div",{children:[L.jsxs("div",{className:"flex items-center gap-1 text-sky-400 mb-1",children:[L.jsx(yd,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{className:"text-sm font-medium",children:"Studios"})]}),L.jsx("div",{className:"text-white",children:r.map((e,t)=>L.jsxs("span",{children:[e.name,t<r.length-1&&", "]},e.id))})]})}function $b({extras:r,onSelectVideo:e}){const t=a=>{const l=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,u=a.match(l);return u&&u[2].length===11?u[2]:null},n=(a,l)=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),e(l))};return L.jsxs("section",{className:"container mx-auto px-4 py-12 border-t border-sky-200/10",children:[L.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Extras"}),L.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(a=>{const l=t(a.url),u=l?`https://img.youtube.com/vi/${l}/maxresdefault.jpg`:"";return L.jsxs("button",{onClick:()=>e(a.url),onKeyDown:c=>n(c,a.url),className:`group relative aspect-video w-full rounded-xl overflow-hidden focus:outline-none 
                       focus:ring-2 focus:ring-sky-500/40 focus:ring-offset-2 focus:ring-offset-slate-800`,"aria-label":`Play ${a.title}`,children:[L.jsx("img",{src:u,alt:a.title,className:`w-full h-full object-cover transition-transform duration-300 
                         group-hover:scale-105`,loading:"lazy"}),L.jsx("div",{className:`absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent 
                          opacity-80 group-hover:opacity-90 transition-opacity`}),L.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:L.jsx("div",{className:`rounded-full bg-sky-500/90 p-4 transform transition-all duration-300 
                            group-hover:bg-sky-400 group-hover:scale-110`,children:L.jsx(nb,{className:"w-8 h-8 text-white","aria-hidden":"true"})})}),L.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[L.jsx("h3",{className:`text-base font-medium text-white line-clamp-2 mb-1 group-hover:text-sky-200 
                           transition-colors`,children:a.title}),L.jsx("p",{className:"text-sm text-sky-200/80 capitalize",children:a.kind})]})]},a.id)})})]})}const Fy=he.forwardRef(({trigger:r,items:e,align:t="right",label:n},a)=>{const[l,u]=he.useState(!1),[c,d]=he.useState(-1),h=he.useRef([]),g=he.useRef(null),p=a||g;he.useEffect(()=>{const x=S=>{const E=p.current;E&&!E.contains(S.target)&&(u(!1),d(-1))};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[p]),he.useEffect(()=>{var x;l&&c>=0&&((x=h.current[c])==null||x.focus())},[l,c]);const v=x=>{if(!l){(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),u(!0),d(0));return}switch(x.key){case"ArrowDown":x.preventDefault(),d(S=>S<e.length-1?S+1:0);break;case"ArrowUp":x.preventDefault(),d(S=>S>0?S-1:e.length-1);break;case"Home":x.preventDefault(),d(0);break;case"End":x.preventDefault(),d(e.length-1);break;case"Escape":x.preventDefault(),u(!1),d(-1);break;case"Tab":u(!1),d(-1);break}};return L.jsxs("div",{className:"relative",ref:a,onKeyDown:v,children:[L.jsx("div",{role:"button","aria-haspopup":"true","aria-expanded":l,"aria-label":n,onClick:()=>{u(!l),l||d(0)},tabIndex:0,children:r}),l&&L.jsx("div",{className:`absolute z-50 ${t==="right"?"right-0":"left-0"} mt-2 w-48 rounded-lg bg-slate-800 shadow-lg ring-1 ring-black ring-opacity-5`,role:"menu","aria-orientation":"vertical","aria-label":`${n} options`,children:L.jsx("div",{className:"py-1",children:e.map((x,S)=>L.jsxs("button",{ref:E=>{h.current[S]=E},onClick:()=>{x.onClick(),u(!1),d(-1)},className:`flex w-full items-center px-4 py-2 text-sm text-sky-200 
                           hover:bg-slate-700 hover:text-sky-100 transition-colors
                           ${c===S?"bg-slate-700 text-sky-100":""}`,role:"menuitem","aria-label":x.label,tabIndex:l?0:-1,children:[x.icon&&L.jsx("span",{className:"mr-3","aria-hidden":"true",children:x.icon}),x.label]},S))})})]})});Fy.displayName="Dropdown";function Vb({isOpen:r,onClose:e,audioOpts:t,subtitleOpts:n}){const a=he.useRef(null),l=he.useRef(null);he.useEffect(()=>{const c=a.current;c&&(r?c.showModal():c.close())},[r]);const u=()=>{var c;(c=l.current)==null||c.reset(),e()};return L.jsx("dialog",{ref:a,className:"fixed inset-0 bg-transparent p-0 m-0 h-full w-full outline-none",onClick:c=>{c.target===a.current&&e()},children:L.jsxs("div",{className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 
                    w-[600px] max-w-[90vw] bg-slate-900 rounded-xl shadow-2xl`,children:[L.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-sky-200/10",children:[L.jsx("h2",{className:"text-xl font-medium text-white",children:"Playback Settings"}),L.jsx("button",{type:"button",onClick:u,className:"text-sky-200 hover:text-sky-100 transition-colors",children:L.jsx(vd,{className:"w-6 h-6","aria-hidden":"true"})})]}),L.jsx("div",{className:"p-6",children:L.jsxs("form",{ref:l,className:"space-y-6",children:[L.jsxs("div",{children:[L.jsx("label",{htmlFor:"audioTrack",className:"block text-base font-medium text-sky-200 mb-2",children:"Audio Track"}),L.jsx("select",{id:"audioTrack",name:"audioTrack",className:`w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white 
                         focus:outline-none focus:ring-2 focus:ring-sky-500/40`,defaultValue:"english",children:t.map(c=>L.jsx("option",{value:c.value,children:c.label}))})]}),L.jsxs("div",{children:[L.jsx("label",{htmlFor:"subtitles",className:"block text-base font-medium text-sky-200 mb-2",children:"Subtitles"}),L.jsxs("select",{id:"subtitles",name:"subtitles",className:`w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white 
                         focus:outline-none focus:ring-2 focus:ring-sky-500/40`,defaultValue:"none",children:[L.jsx("option",{value:"none",children:"None"}),n.map(c=>L.jsx("option",{value:c.value,children:c.label}))]})]}),L.jsxs("div",{children:[L.jsx("label",{htmlFor:"resolution",className:"block text-base font-medium text-sky-200 mb-2",children:"Resolution"}),L.jsxs("select",{id:"resolution",name:"resolution",className:`w-full bg-slate-800 border border-sky-200/10 rounded-lg px-4 py-3 text-base text-white 
                         focus:outline-none focus:ring-2 focus:ring-sky-500/40`,defaultValue:"1080p",children:[L.jsx("option",{value:"2160p",children:"4K (2160p)"}),L.jsx("option",{value:"1080p",children:"Full HD (1080p)"}),L.jsx("option",{value:"720p",children:"HD (720p)"}),L.jsx("option",{value:"480p",children:"SD (480p)"})]})]}),L.jsxs("div",{className:"pt-4 flex gap-4",children:[L.jsx("button",{type:"submit",className:`flex-1 px-6 py-3 bg-sky-500 hover:bg-sky-400 text-white text-base font-medium 
                         rounded-lg transition-colors`,children:"Apply Settings"}),L.jsx("button",{type:"button",onClick:u,className:`flex-1 px-6 py-3 bg-slate-800 hover:bg-slate-700 text-sky-200 hover:text-sky-100 
                         text-base font-medium rounded-lg transition-colors`,children:"Cancel"})]})]})})]})})}const Xf=Ni("/movies/$movieID/")({component:zb,loader:async({params:r})=>{const e=await fetch(`/api/v1/movies/${r.movieID}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch movie details");return e.json()}});function zb(){const{movie:r}=Xf.useLoaderData(),e=r.audio_streams.length>0?r.audio_streams.map(h=>({value:h.index,label:`${h.title} ${h.language}`})):[],t=r.subtitles.length>0?r.subtitles.map(h=>({value:h.index,label:`${h.title} ${h.language}`})):[],[n,a]=he.useState(null),[l,u]=he.useState(!1),c=Xf.useNavigate(),d=async()=>{const h={title:r.title,audio_codec:"aac",audio_bit_rate:320,audio_channels:6,audio_stream_index:r.audio_streams[0].index,video_stream_index:r.video_streams[0].index,video_codec:"copy"},p=await(await fetch(`/api/v1/ffmpeg/movie/create-hls/${r.id}`,{method:"post",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).json();if(p.error){alert(p.error);return}c({to:"/movies/$movieID/play",params:{movieID:r.id.toString()},search:{pid:p.pid,title:r.title}})};return L.jsxs("main",{className:"min-h-screen pt-16",children:[L.jsxs("div",{className:"relative min-h-[90vh] w-full",children:[L.jsxs("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${ya(r.art)})`},children:[L.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-900/80 via-slate-900/50 to-transparent"}),L.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/40 to-transparent"})]}),L.jsx("div",{className:"relative h-full container mx-auto px-4 py-12 flex flex-col justify-end",children:L.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-end md:items-end",children:[L.jsx("div",{className:"relative z-10 md:translate-y-16",children:L.jsx("div",{className:"w-48 md:w-72 aspect-[2/3] rounded-lg overflow-hidden ring-1 ring-white/10 shadow-xl shadow-black/50",children:L.jsx("img",{src:ya(r.thumb),alt:`${r.title} Poster`,className:"w-full h-full object-cover"})})}),L.jsxs("div",{className:"flex-1 max-w-3xl relative z-10",children:[L.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-xl",children:r.title}),r.tag_line&&L.jsx("p",{className:"text-xl text-sky-200 mb-4 italic drop-shadow-xl",children:r.tag_line}),L.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-sky-200 mb-6 drop-shadow-lg bg-slate-900/20 backdrop-blur-sm rounded-lg px-4 py-2",children:[L.jsxs("div",{className:"flex items-center gap-1",children:[L.jsx(BT,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{children:Eb(r.release_date)})]}),L.jsxs("div",{className:"flex items-center gap-1",children:[L.jsx(HT,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{children:Tb(r.run_time)})]}),r.content_rating&&L.jsx("span",{className:"px-2 py-0.5 bg-sky-500/20 rounded",children:r.content_rating}),L.jsx(Rb,{genres:r.genres})]}),L.jsxs("div",{className:"flex gap-6 mb-6",children:[r.audience_rating>0&&L.jsxs("div",{className:"flex items-center gap-2",children:[L.jsx(eb,{className:"w-5 h-5 text-sky-400","aria-hidden":"true"}),L.jsxs("div",{children:[L.jsx("div",{className:"text-lg font-medium text-white",children:r.audience_rating.toFixed(1)}),L.jsx("div",{className:"text-xs text-sky-200",children:"Audience Rating"})]})]}),r.critic_rating>0&&L.jsxs("div",{className:"flex items-center gap-2",children:[L.jsx(FT,{className:"w-5 h-5 text-sky-400","aria-hidden":"true"}),L.jsxs("div",{children:[L.jsx("div",{className:"text-lg font-medium text-white",children:r.critic_rating.toFixed(1)}),L.jsx("div",{className:"text-xs text-sky-200",children:"Critic Rating"})]})]})]}),L.jsx("p",{className:"text-sky-200 leading-relaxed mb-8",children:r.summary}),L.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-8",children:[L.jsxs("button",{type:"button",onClick:d,className:`inline-flex items-center gap-2 px-6 py-3 bg-sky-500 hover:bg-sky-400 
                           text-white font-medium rounded-lg transition-colors`,children:[L.jsx(vo,{className:"w-5 h-5","aria-hidden":"true"}),"Play"]}),L.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 px-4 py-3 bg-rose-500/20 hover:bg-rose-500/30 
                           text-rose-300 hover:text-rose-200 font-medium rounded-lg transition-colors`,children:[L.jsx(VT,{className:"w-5 h-5","aria-hidden":"true"}),"Like"]}),L.jsxs("button",{type:"button",className:`inline-flex items-center gap-2 px-4 py-3 bg-emerald-500/20 hover:bg-emerald-500/30 
                           text-emerald-300 hover:text-emerald-200 font-medium rounded-lg transition-colors`,children:[L.jsx(Ly,{className:"w-5 h-5","aria-hidden":"true"}),"Mark as Watched"]}),L.jsx(Fy,{trigger:L.jsx("button",{type:"button",className:`inline-flex items-center justify-center w-12 h-12 bg-slate-800/50 hover:bg-slate-800 
                               text-sky-200 hover:text-sky-100 rounded-lg transition-colors`,children:L.jsx(WT,{className:"w-5 h-5","aria-hidden":"true"})}),label:`More options for ${r.title}`,items:[{label:"Playback Settings",icon:L.jsx(vo,{className:"w-4 h-4"}),onClick:()=>u(!0)},{label:"Movie Details",icon:L.jsx(KT,{className:"w-4 h-4"}),onClick:()=>{console.log("Show details")}}]})]}),L.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[r.budget>0&&L.jsxs("div",{children:[L.jsxs("div",{className:"flex items-center gap-1 text-sky-400 mb-1",children:[L.jsx(Vg,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{className:"text-sm font-medium",children:"Budget"})]}),L.jsx("div",{className:"text-white",children:Kg(r.budget)})]}),r.revenue>0&&L.jsxs("div",{children:[L.jsxs("div",{className:"flex items-center gap-1 text-sky-400 mb-1",children:[L.jsx(Vg,{className:"w-4 h-4","aria-hidden":"true"}),L.jsx("span",{className:"text-sm font-medium",children:"Revenue"})]}),L.jsx("div",{className:"text-white",children:Kg(r.revenue)})]}),L.jsx(Hb,{studios:r.studios})]})]})]})})]}),L.jsxs("section",{className:"container mx-auto px-4 py-12",children:[L.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Cast & Crew"}),r.cast.length>0&&L.jsx(bb,{cast:r.cast}),r.crew.length>0&&L.jsx(Ab,{crew:r.crew})]}),L.jsx($b,{extras:r.extras,onSelectVideo:h=>a(h)}),L.jsx(Gb,{isOpen:!!n,onClose:()=>a(null),videoUrl:n}),L.jsx(Vb,{isOpen:l,onClose:()=>u(!1),audioOpts:e,subtitleOpts:t})]})}function Kb(){const r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),e=/iPad|iPhone|iPod/.test(navigator.userAgent);if(!r&&!e)return!1;const t=document.createElement("video"),n=t.canPlayType("application/vnd.apple.mpegurl")!=="",a=t.canPlayType('video/mp4; codecs="mp4a.40.2,avc1.64001F"')!=="";return n&&a}var xf,lp;function Yb(){if(lp)return xf;lp=1;var r=Object.defineProperty,e=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,a=(p,v)=>{for(var x in v)r(p,x,{get:v[x],enumerable:!0})},l=(p,v,x,S)=>{if(v&&typeof v=="object"||typeof v=="function")for(let E of t(v))!n.call(p,E)&&E!==x&&r(p,E,{get:()=>v[E],enumerable:!(S=e(v,E))||S.enumerable});return p},u=p=>l(r({},"__esModule",{value:!0}),p),c={};a(c,{default:()=>g}),xf=u(c);var d=Ta(),h=Uy(),g=[{key:"youtube",name:"YouTube",canPlay:h.canPlay.youtube,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./YouTube-CRKdcQP3.js").then(p=>p.Y),[]))},{key:"soundcloud",name:"SoundCloud",canPlay:h.canPlay.soundcloud,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./SoundCloud-DmlRoDLY.js").then(p=>p.S),[]))},{key:"vimeo",name:"Vimeo",canPlay:h.canPlay.vimeo,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Vimeo-C5Z4bUnE.js").then(p=>p.V),[]))},{key:"mux",name:"Mux",canPlay:h.canPlay.mux,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Mux-BlB87v8U.js").then(p=>p.M),[]))},{key:"facebook",name:"Facebook",canPlay:h.canPlay.facebook,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Facebook-B2iqxLK0.js").then(p=>p.F),[]))},{key:"streamable",name:"Streamable",canPlay:h.canPlay.streamable,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Streamable-DVrlKfmu.js").then(p=>p.S),[]))},{key:"wistia",name:"Wistia",canPlay:h.canPlay.wistia,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Wistia-DblRI5de.js").then(p=>p.W),[]))},{key:"twitch",name:"Twitch",canPlay:h.canPlay.twitch,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Twitch-2fr6748D.js").then(p=>p.T),[]))},{key:"dailymotion",name:"DailyMotion",canPlay:h.canPlay.dailymotion,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./DailyMotion-CohJOpL8.js").then(p=>p.D),[]))},{key:"mixcloud",name:"Mixcloud",canPlay:h.canPlay.mixcloud,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Mixcloud-D7o3PILF.js").then(p=>p.M),[]))},{key:"vidyard",name:"Vidyard",canPlay:h.canPlay.vidyard,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Vidyard-BUxZ7HNf.js").then(p=>p.V),[]))},{key:"kaltura",name:"Kaltura",canPlay:h.canPlay.kaltura,lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./Kaltura-CmP_ZPOR.js").then(p=>p.K),[]))},{key:"file",name:"FilePlayer",canPlay:h.canPlay.file,canEnablePIP:p=>h.canPlay.file(p)&&(document.pictureInPictureEnabled||(0,d.supportsWebKitPresentationMode)())&&!h.AUDIO_EXTENSIONS.test(p),lazyPlayer:(0,d.lazy)(()=>bt(()=>import("./FilePlayer-t6Cz3QT3.js").then(p=>p.F),[]))}];return xf}var Sf,op;function qb(){if(op)return Sf;op=1;var r=Object.create,e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=(E,b)=>{for(var A in b)e(E,A,{get:b[A],enumerable:!0})},c=(E,b,A,O)=>{if(b&&typeof b=="object"||typeof b=="function")for(let _ of n(b))!l.call(E,_)&&_!==A&&e(E,_,{get:()=>b[_],enumerable:!(O=t(b,_))||O.enumerable});return E},d=(E,b,A)=>(A=E!=null?r(a(E)):{},c(!E||!E.__esModule?e(A,"default",{value:E,enumerable:!0}):A,E)),h=E=>c(e({},"__esModule",{value:!0}),E),g={};u(g,{default:()=>S}),Sf=h(g);var p=d(Yb()),v=Py();const x=p.default[p.default.length-1];var S=(0,v.createReactPlayer)(p.default,x);return Sf}var Xb=qb();const Wb=dd(Xb);function Qb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var By={exports:{}};(function(r,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,a=/^(?=([^\/?#]*))\1([^]*)$/,l=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(d,h,g){if(g=g||{},d=d.trim(),h=h.trim(),!h){if(!g.alwaysNormalize)return d;var p=c.parseURL(d);if(!p)throw new Error("Error trying to parse base URL.");return p.path=c.normalizePath(p.path),c.buildURLFromParts(p)}var v=c.parseURL(h);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return g.alwaysNormalize?(v.path=c.normalizePath(v.path),c.buildURLFromParts(v)):h;var x=c.parseURL(d);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&x.path[0]!=="/"){var S=a.exec(x.path);x.netLoc=S[1],x.path=S[2]}x.netLoc&&!x.path&&(x.path="/");var E={scheme:x.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(E.netLoc=x.netLoc,v.path[0]!=="/"))if(!v.path)E.path=x.path,v.params||(E.params=x.params,v.query||(E.query=x.query));else{var b=x.path,A=b.substring(0,b.lastIndexOf("/")+1)+v.path;E.path=c.normalizePath(A)}return E.path===null&&(E.path=g.alwaysNormalize?c.normalizePath(v.path):v.path),c.buildURLFromParts(E)},parseURL:function(d){var h=n.exec(d);return h?{scheme:h[1]||"",netLoc:h[2]||"",path:h[3]||"",params:h[4]||"",query:h[5]||"",fragment:h[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(l,"");d.length!==(d=d.replace(u,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};r.exports=c})()})(By);var xd=By.exports;function up(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,n)}return t}function vt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?up(Object(t),!0).forEach(function(n){e1(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):up(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Zb(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Jb(r){var e=Zb(r,"string");return typeof e=="symbol"?e:String(e)}function e1(r,e,t){return e=Jb(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function lt(){return lt=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},lt.apply(this,arguments)}const ge=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},t1=Number.isSafeInteger||function(r){return typeof r=="number"&&Math.abs(r)<=i1},i1=Number.MAX_SAFE_INTEGER||9007199254740991;let R=function(r){return r.MEDIA_ATTACHING="hlsMediaAttaching",r.MEDIA_ATTACHED="hlsMediaAttached",r.MEDIA_DETACHING="hlsMediaDetaching",r.MEDIA_DETACHED="hlsMediaDetached",r.BUFFER_RESET="hlsBufferReset",r.BUFFER_CODECS="hlsBufferCodecs",r.BUFFER_CREATED="hlsBufferCreated",r.BUFFER_APPENDING="hlsBufferAppending",r.BUFFER_APPENDED="hlsBufferAppended",r.BUFFER_EOS="hlsBufferEos",r.BUFFER_FLUSHING="hlsBufferFlushing",r.BUFFER_FLUSHED="hlsBufferFlushed",r.MANIFEST_LOADING="hlsManifestLoading",r.MANIFEST_LOADED="hlsManifestLoaded",r.MANIFEST_PARSED="hlsManifestParsed",r.LEVEL_SWITCHING="hlsLevelSwitching",r.LEVEL_SWITCHED="hlsLevelSwitched",r.LEVEL_LOADING="hlsLevelLoading",r.LEVEL_LOADED="hlsLevelLoaded",r.LEVEL_UPDATED="hlsLevelUpdated",r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",r.LEVELS_UPDATED="hlsLevelsUpdated",r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",r.CUES_PARSED="hlsCuesParsed",r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",r.INIT_PTS_FOUND="hlsInitPtsFound",r.FRAG_LOADING="hlsFragLoading",r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",r.FRAG_LOADED="hlsFragLoaded",r.FRAG_DECRYPTED="hlsFragDecrypted",r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",r.FRAG_PARSED="hlsFragParsed",r.FRAG_BUFFERED="hlsFragBuffered",r.FRAG_CHANGED="hlsFragChanged",r.FPS_DROP="hlsFpsDrop",r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",r.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",r.ERROR="hlsError",r.DESTROYING="hlsDestroying",r.KEY_LOADING="hlsKeyLoading",r.KEY_LOADED="hlsKeyLoaded",r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",r.BACK_BUFFER_REACHED="hlsBackBufferReached",r.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",r}({}),Te=function(r){return r.NETWORK_ERROR="networkError",r.MEDIA_ERROR="mediaError",r.KEY_SYSTEM_ERROR="keySystemError",r.MUX_ERROR="muxError",r.OTHER_ERROR="otherError",r}({}),te=function(r){return r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",r.MANIFEST_LOAD_ERROR="manifestLoadError",r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",r.MANIFEST_PARSING_ERROR="manifestParsingError",r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",r.LEVEL_EMPTY_ERROR="levelEmptyError",r.LEVEL_LOAD_ERROR="levelLoadError",r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",r.LEVEL_PARSING_ERROR="levelParsingError",r.LEVEL_SWITCH_ERROR="levelSwitchError",r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",r.FRAG_LOAD_ERROR="fragLoadError",r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",r.FRAG_DECRYPT_ERROR="fragDecryptError",r.FRAG_PARSING_ERROR="fragParsingError",r.FRAG_GAP="fragGap",r.REMUX_ALLOC_ERROR="remuxAllocError",r.KEY_LOAD_ERROR="keyLoadError",r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",r.BUFFER_APPEND_ERROR="bufferAppendError",r.BUFFER_APPENDING_ERROR="bufferAppendingError",r.BUFFER_STALLED_ERROR="bufferStalledError",r.BUFFER_FULL_ERROR="bufferFullError",r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",r.INTERNAL_EXCEPTION="internalException",r.INTERNAL_ABORTED="aborted",r.UNKNOWN="unknown",r}({});const rs=function(){},Wf={trace:rs,debug:rs,log:rs,warn:rs,info:rs,error:rs};let ga=Wf;function n1(r){const e=self.console[r];return e?e.bind(self.console,`[${r}] >`):rs}function s1(r,...e){e.forEach(function(t){ga[t]=r[t]?r[t].bind(r):n1(t)})}function r1(r,e){if(typeof console=="object"&&r===!0||typeof r=="object"){s1(r,"debug","log","info","warn","error");try{ga.log(`Debug logs enabled for "${e}" in hls.js version 1.5.20`)}catch{ga=Wf}}else ga=Wf}const Y=ga,a1=/^(\d+)x(\d+)$/,cp=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Ze{constructor(e){typeof e=="string"&&(e=Ze.parseAttrList(e)),lt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let a=0;a<t.length/2;a++)n[a]=parseInt(t.slice(a*2,a*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=a1.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},a='"';for(cp.lastIndex=0;(t=cp.exec(e))!==null;){let l=t[2];l.indexOf(a)===0&&l.lastIndexOf(a)===l.length-1&&(l=l.slice(1,-1));const u=t[1].trim();n[u]=l}return n}}function l1(r){return r!=="ID"&&r!=="CLASS"&&r!=="START-DATE"&&r!=="DURATION"&&r!=="END-DATE"&&r!=="END-ON-NEXT"}function o1(r){return r==="SCTE35-OUT"||r==="SCTE35-IN"}class jy{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const a in n)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==n[a]){Y.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=lt(new Ze({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);ge(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(ge(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&ge(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class ko{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var je={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Gy{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[je.AUDIO]:null,[je.VIDEO]:null,[je.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let a;n.length===1?a=(t==null?void 0:t.byteRangeEndOffset)||0:a=parseInt(n[1]),this._byteRange=[a,parseInt(n[0])+a]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=xd.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Ef extends Gy{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new ko,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!ge(this.programDateTime))return null;const e=ge(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,a,l,u=!1){const{elementaryStreams:c}=this,d=c[e];if(!d){c[e]={startPTS:t,endPTS:n,startDTS:a,endDTS:l,partial:u};return}d.startPTS=Math.min(d.startPTS,t),d.endPTS=Math.max(d.endPTS,n),d.startDTS=Math.min(d.startDTS,a),d.endDTS=Math.max(d.endDTS,l)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[je.AUDIO]=null,e[je.VIDEO]=null,e[je.AUDIOVIDEO]=null}}class u1 extends Gy{constructor(e,t,n,a,l){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new ko,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=a;const u=e.enumeratedString("BYTERANGE");u&&this.setByteRange(u,l),l&&(this.fragOffset=l.fragOffset+l.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const c1=10;class f1{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?ge(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||c1}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Sd(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0))}function d1(r){const e=Qf(r).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function h1(r){const e=function(n,a,l){const u=n[a];n[a]=n[l],n[l]=u};e(r,0,3),e(r,1,2),e(r,4,5),e(r,6,7)}function m1(r){const e=r.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),a=n[n.length-1].split(",");if(a.length===2){const l=a[0]==="base64",u=a[1];l?(n.splice(-1,1),t=Sd(u)):t=d1(u)}}return t}function Qf(r){return Uint8Array.from(unescape(encodeURIComponent(r)),e=>e.charCodeAt(0))}const ur=typeof self<"u"?self:void 0;var Be={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ut={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Tf(r){switch(r){case Ut.FAIRPLAY:return Be.FAIRPLAY;case Ut.PLAYREADY:return Be.PLAYREADY;case Ut.WIDEVINE:return Be.WIDEVINE;case Ut.CLEARKEY:return Be.CLEARKEY}}var Fl={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function bf(r){if(r===Fl.WIDEVINE)return Be.WIDEVINE;if(r===Fl.PLAYREADY)return Be.PLAYREADY;if(r===Fl.CENC||r===Fl.CLEARKEY)return Be.CLEARKEY}function Af(r){switch(r){case Be.FAIRPLAY:return Ut.FAIRPLAY;case Be.PLAYREADY:return Ut.PLAYREADY;case Be.WIDEVINE:return Ut.WIDEVINE;case Be.CLEARKEY:return Ut.CLEARKEY}}function Bl(r){const{drmSystems:e,widevineLicenseUrl:t}=r,n=e?[Be.FAIRPLAY,Be.WIDEVINE,Be.PLAYREADY,Be.CLEARKEY].filter(a=>!!e[a]):[];return!n[Be.WIDEVINE]&&t&&n.push(Be.WIDEVINE),n}const Hy=function(r){return ur!=null&&(r=ur.navigator)!=null&&r.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function g1(r,e,t,n){let a;switch(r){case Be.FAIRPLAY:a=["cenc","sinf"];break;case Be.WIDEVINE:case Be.PLAYREADY:a=["cenc"];break;case Be.CLEARKEY:a=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${r}`)}return p1(a,e,t,n)}function p1(r,e,t,n){return[{initDataTypes:r,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(l=>({contentType:`audio/mp4; codecs="${l}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(l=>({contentType:`video/mp4; codecs="${l}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function $y(r){const e=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),u=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(u){const c=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(c){const d=Sd(c).subarray(0,16);return h1(d),d}}return null}function fs(r,e,t){return Uint8Array.prototype.slice?r.slice(e,t):new Uint8Array(Array.prototype.slice.call(r,e,t))}const Ed=(r,e)=>e+10<=r.length&&r[e]===73&&r[e+1]===68&&r[e+2]===51&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,Vy=(r,e)=>e+10<=r.length&&r[e]===51&&r[e+1]===68&&r[e+2]===73&&r[e+3]<255&&r[e+4]<255&&r[e+6]<128&&r[e+7]<128&&r[e+8]<128&&r[e+9]<128,va=(r,e)=>{const t=e;let n=0;for(;Ed(r,e);){n+=10;const a=Mo(r,e+6);n+=a,Vy(r,e+10)&&(n+=10),e+=n}if(n>0)return r.subarray(t,t+n)},Mo=(r,e)=>{let t=0;return t=(r[e]&127)<<21,t|=(r[e+1]&127)<<14,t|=(r[e+2]&127)<<7,t|=r[e+3]&127,t},y1=(r,e)=>Ed(r,e)&&Mo(r,e+6)+10<=r.length-e,Td=r=>{const e=Ky(r);for(let t=0;t<e.length;t++){const n=e[t];if(zy(n))return b1(n)}},zy=r=>r&&r.key==="PRIV"&&r.info==="com.apple.streaming.transportStreamTimestamp",v1=r=>{const e=String.fromCharCode(r[0],r[1],r[2],r[3]),t=Mo(r,4),n=10;return{type:e,size:t,data:r.subarray(n,n+t)}},Ky=r=>{let e=0;const t=[];for(;Ed(r,e);){const n=Mo(r,e+6);e+=10;const a=e+n;for(;e+8<a;){const l=v1(r.subarray(e)),u=x1(l);u&&t.push(u),e+=l.size+10}Vy(r,e)&&(e+=10)}return t},x1=r=>r.type==="PRIV"?S1(r):r.type[0]==="W"?T1(r):E1(r),S1=r=>{if(r.size<2)return;const e=Ii(r.data,!0),t=new Uint8Array(r.data.subarray(e.length+1));return{key:r.type,info:e,data:t.buffer}},E1=r=>{if(r.size<2)return;if(r.type==="TXXX"){let t=1;const n=Ii(r.data.subarray(t),!0);t+=n.length+1;const a=Ii(r.data.subarray(t));return{key:r.type,info:n,data:a}}const e=Ii(r.data.subarray(1));return{key:r.type,data:e}},T1=r=>{if(r.type==="WXXX"){if(r.size<2)return;let t=1;const n=Ii(r.data.subarray(t),!0);t+=n.length+1;const a=Ii(r.data.subarray(t));return{key:r.type,info:n,data:a}}const e=Ii(r.data);return{key:r.type,data:e}},b1=r=>{if(r.data.byteLength===8){const e=new Uint8Array(r.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},Ii=(r,e=!1)=>{const t=A1();if(t){const h=t.decode(r);if(e){const g=h.indexOf("\0");return g!==-1?h.substring(0,g):h}return h.replace(/\0/g,"")}const n=r.length;let a,l,u,c="",d=0;for(;d<n;){if(a=r[d++],a===0&&e)return c;if(a===0||a===3)continue;switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(a);break;case 12:case 13:l=r[d++],c+=String.fromCharCode((a&31)<<6|l&63);break;case 14:l=r[d++],u=r[d++],c+=String.fromCharCode((a&15)<<12|(l&63)<<6|(u&63)<<0);break}}return c};let Rf;function A1(){if(!navigator.userAgent.includes("PlayStation 4"))return!Rf&&typeof self.TextDecoder<"u"&&(Rf=new self.TextDecoder("utf-8")),Rf}const Di={hexDump:function(r){let e="";for(let t=0;t<r.length;t++){let n=r[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},xo=Math.pow(2,32)-1,R1=[].push,Yy={video:1,audio:2,id3:3,text:4};function ft(r){return String.fromCharCode.apply(null,r)}function qy(r,e){const t=r[e]<<8|r[e+1];return t<0?65536+t:t}function xe(r,e){const t=Xy(r,e);return t<0?4294967296+t:t}function fp(r,e){let t=xe(r,e);return t*=Math.pow(2,32),t+=xe(r,e+4),t}function Xy(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}function Lf(r,e,t){r[e]=t>>24,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t&255}function L1(r){const e=r.byteLength;for(let t=0;t<e;){const n=xe(r,t);if(n>8&&r[t+4]===109&&r[t+5]===111&&r[t+6]===111&&r[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Le(r,e){const t=[];if(!e.length)return t;const n=r.byteLength;for(let a=0;a<n;){const l=xe(r,a),u=ft(r.subarray(a+4,a+8)),c=l>1?a+l:n;if(u===e[0])if(e.length===1)t.push(r.subarray(a+8,c));else{const d=Le(r.subarray(a+8,c),e.slice(1));d.length&&R1.apply(t,d)}a=c}return t}function _1(r){const e=[],t=r[0];let n=8;const a=xe(r,n);n+=4;let l=0,u=0;t===0?(l=xe(r,n),u=xe(r,n+4),n+=8):(l=fp(r,n),u=fp(r,n+8),n+=16),n+=2;let c=r.length+u;const d=qy(r,n);n+=2;for(let h=0;h<d;h++){let g=n;const p=xe(r,g);g+=4;const v=p&2147483647;if((p&2147483648)>>>31===1)return Y.warn("SIDX has hierarchical references (not supported)"),null;const S=xe(r,g);g+=4,e.push({referenceSize:v,subsegmentDuration:S,info:{duration:S/a,start:c,end:c+v-1}}),c+=v,g+=4,n=g}return{earliestPresentationTime:l,timescale:a,version:t,referencesCount:d,references:e}}function Wy(r){const e=[],t=Le(r,["moov","trak"]);for(let a=0;a<t.length;a++){const l=t[a],u=Le(l,["tkhd"])[0];if(u){let c=u[0];const d=xe(u,c===0?12:20),h=Le(l,["mdia","mdhd"])[0];if(h){c=h[0];const g=xe(h,c===0?12:20),p=Le(l,["mdia","hdlr"])[0];if(p){const v=ft(p.subarray(8,12)),x={soun:je.AUDIO,vide:je.VIDEO}[v];if(x){const S=Le(l,["mdia","minf","stbl","stsd"])[0],E=D1(S);e[d]={timescale:g,type:x},e[x]=vt({timescale:g,id:d},E)}}}}}return Le(r,["moov","mvex","trex"]).forEach(a=>{const l=xe(a,4),u=e[l];u&&(u.default={duration:xe(a,12),flags:xe(a,20)})}),e}function D1(r){const e=r.subarray(8),t=e.subarray(86),n=ft(e.subarray(4,8));let a=n;const l=n==="enca"||n==="encv";if(l){const c=Le(e,[n])[0].subarray(n==="enca"?28:78);Le(c,["sinf"]).forEach(h=>{const g=Le(h,["schm"])[0];if(g){const p=ft(g.subarray(4,8));if(p==="cbcs"||p==="cenc"){const v=Le(h,["frma"])[0];v&&(a=ft(v))}}})}switch(a){case"avc1":case"avc2":case"avc3":case"avc4":{const u=Le(t,["avcC"])[0];a+="."+jl(u[1])+jl(u[2])+jl(u[3]);break}case"mp4a":{const u=Le(e,[n])[0],c=Le(u.subarray(28),["esds"])[0];if(c&&c.length>12){let d=4;if(c[d++]!==3)break;d=_f(c,d),d+=2;const h=c[d++];if(h&128&&(d+=2),h&64&&(d+=c[d++]),c[d++]!==4)break;d=_f(c,d);const g=c[d++];if(g===64)a+="."+jl(g);else break;if(d+=12,c[d++]!==5)break;d=_f(c,d);const p=c[d++];let v=(p&248)>>3;v===31&&(v+=1+((p&7)<<3)+((c[d]&224)>>5)),a+="."+v}break}case"hvc1":case"hev1":{const u=Le(t,["hvcC"])[0],c=u[1],d=["","A","B","C"][c>>6],h=c&31,g=xe(u,2),p=(c&32)>>5?"H":"L",v=u[12],x=u.subarray(6,12);a+="."+d+h,a+="."+g.toString(16).toUpperCase(),a+="."+p+v;let S="";for(let E=x.length;E--;){const b=x[E];(b||S)&&(S="."+b.toString(16).toUpperCase()+S)}a+=S;break}case"dvh1":case"dvhe":{const u=Le(t,["dvcC"])[0],c=u[2]>>1&127,d=u[2]<<5&32|u[3]>>3&31;a+="."+_i(c)+"."+_i(d);break}case"vp09":{const u=Le(t,["vpcC"])[0],c=u[4],d=u[5],h=u[6]>>4&15;a+="."+_i(c)+"."+_i(d)+"."+_i(h);break}case"av01":{const u=Le(t,["av1C"])[0],c=u[1]>>>5,d=u[1]&31,h=u[2]>>>7?"H":"M",g=(u[2]&64)>>6,p=(u[2]&32)>>5,v=c===2&&g?p?12:10:g?10:8,x=(u[2]&16)>>4,S=(u[2]&8)>>3,E=(u[2]&4)>>2,b=u[2]&3;a+="."+c+"."+_i(d)+h+"."+_i(v)+"."+x+"."+S+E+b+"."+_i(1)+"."+_i(1)+"."+_i(1)+"."+0;break}}return{codec:a,encrypted:l}}function _f(r,e){const t=e+5;for(;r[e++]&128&&e<t;);return e}function jl(r){return("0"+r.toString(16).toUpperCase()).slice(-2)}function _i(r){return(r<10?"0":"")+r}function C1(r,e){if(!r||!e)return r;const t=e.keyId;return t&&e.isCommonEncryption&&Le(r,["moov","trak"]).forEach(a=>{const u=Le(a,["mdia","minf","stbl","stsd"])[0].subarray(8);let c=Le(u,["enca"]);const d=c.length>0;d||(c=Le(u,["encv"])),c.forEach(h=>{const g=d?h.subarray(28):h.subarray(78);Le(g,["sinf"]).forEach(v=>{const x=Qy(v);if(x){const S=x.subarray(8,24);S.some(E=>E!==0)||(Y.log(`[eme] Patching keyId in 'enc${d?"a":"v"}>sinf>>tenc' box: ${Di.hexDump(S)} -> ${Di.hexDump(t)}`),x.set(t,8))}})})}),r}function Qy(r){const e=Le(r,["schm"])[0];if(e){const t=ft(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Le(r,["schi","tenc"])[0]}return null}function w1(r,e){return Le(e,["moof","traf"]).reduce((t,n)=>{const a=Le(n,["tfdt"])[0],l=a[0],u=Le(n,["tfhd"]).reduce((c,d)=>{const h=xe(d,4),g=r[h];if(g){let p=xe(a,4);if(l===1){if(p===xo)return Y.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),c;p*=xo+1,p+=xe(a,8)}const v=g.timescale||9e4,x=p/v;if(ge(x)&&(c===null||x<c))return x}return c},null);return u!==null&&ge(u)&&(t===null||u<t)?u:t},null)}function O1(r,e){let t=0,n=0,a=0;const l=Le(r,["moof","traf"]);for(let u=0;u<l.length;u++){const c=l[u],d=Le(c,["tfhd"])[0],h=xe(d,4),g=e[h];if(!g)continue;const p=g.default,v=xe(d,0)|(p==null?void 0:p.flags);let x=p==null?void 0:p.duration;v&8&&(v&2?x=xe(d,12):x=xe(d,8));const S=g.timescale||9e4,E=Le(c,["trun"]);for(let b=0;b<E.length;b++){if(t=I1(E[b]),!t&&x){const A=xe(E[b],4);t=x*A}g.type===je.VIDEO?n+=t/S:g.type===je.AUDIO&&(a+=t/S)}}if(n===0&&a===0){let u=1/0,c=0,d=0;const h=Le(r,["sidx"]);for(let g=0;g<h.length;g++){const p=_1(h[g]);if(p!=null&&p.references){u=Math.min(u,p.earliestPresentationTime/p.timescale);const v=p.references.reduce((x,S)=>x+S.info.duration||0,0);c=Math.max(c,v+p.earliestPresentationTime/p.timescale),d=c-u}}if(d&&ge(d))return d}return n||a}function I1(r){const e=xe(r,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const a=xe(r,4);for(let l=0;l<a;l++){if(e&256){const u=xe(r,t);n+=u,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function k1(r,e,t){Le(e,["moof","traf"]).forEach(n=>{Le(n,["tfhd"]).forEach(a=>{const l=xe(a,4),u=r[l];if(!u)return;const c=u.timescale||9e4;Le(n,["tfdt"]).forEach(d=>{const h=d[0],g=t*c;if(g){let p=xe(d,4);if(h===0)p-=g,p=Math.max(p,0),Lf(d,4,p);else{p*=Math.pow(2,32),p+=xe(d,8),p-=g,p=Math.max(p,0);const v=Math.floor(p/(xo+1)),x=Math.floor(p%(xo+1));Lf(d,4,v),Lf(d,8,x)}}})})})}function M1(r){const e={valid:null,remainder:null},t=Le(r,["moof"]);if(t.length<2)return e.remainder=r,e;const n=t[t.length-1];return e.valid=fs(r,0,n.byteOffset-8),e.remainder=fs(r,n.byteOffset-8),e}function ci(r,e){const t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function dp(r,e){const t=[],n=e.samples,a=e.timescale,l=e.id;let u=!1;return Le(n,["moof"]).map(d=>{const h=d.byteOffset-8;Le(d,["traf"]).map(p=>{const v=Le(p,["tfdt"]).map(x=>{const S=x[0];let E=xe(x,4);return S===1&&(E*=Math.pow(2,32),E+=xe(x,8)),E/a})[0];return v!==void 0&&(r=v),Le(p,["tfhd"]).map(x=>{const S=xe(x,4),E=xe(x,0)&16777215,b=(E&1)!==0,A=(E&2)!==0,O=(E&8)!==0;let _=0;const k=(E&16)!==0;let D=0;const F=(E&32)!==0;let B=8;S===l&&(b&&(B+=8),A&&(B+=4),O&&(_=xe(x,B),B+=4),k&&(D=xe(x,B),B+=4),F&&(B+=4),e.type==="video"&&(u=N1(e.codec)),Le(p,["trun"]).map(M=>{const I=M[0],N=xe(M,0)&16777215,U=(N&1)!==0;let Q=0;const Z=(N&4)!==0,V=(N&256)!==0;let X=0;const $=(N&512)!==0;let oe=0;const le=(N&1024)!==0,z=(N&2048)!==0;let C=0;const H=xe(M,4);let ee=8;U&&(Q=xe(M,ee),ee+=4),Z&&(ee+=4);let re=Q+h;for(let se=0;se<H;se++){if(V?(X=xe(M,ee),ee+=4):X=_,$?(oe=xe(M,ee),ee+=4):oe=D,le&&(ee+=4),z&&(I===0?C=xe(M,ee):C=Xy(M,ee),ee+=4),e.type===je.VIDEO){let de=0;for(;de<oe;){const fe=xe(n,re);if(re+=4,P1(u,n[re])){const Ae=n.subarray(re,re+fe);Zy(Ae,u?2:1,r+C/a,t)}re+=fe,de+=fe+4}}r+=X/a}}))})})}),t}function N1(r){if(!r)return!1;const e=r.indexOf("."),t=e<0?r:r.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function P1(r,e){if(r){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Zy(r,e,t,n){const a=Jy(r);let l=0;l+=e;let u=0,c=0,d=0;for(;l<a.length;){u=0;do{if(l>=a.length)break;d=a[l++],u+=d}while(d===255);c=0;do{if(l>=a.length)break;d=a[l++],c+=d}while(d===255);const h=a.length-l;let g=l;if(c<h)l+=c;else if(c>h){Y.error(`Malformed SEI payload. ${c} is too small, only ${h} bytes left to parse.`);break}if(u===4){if(a[g++]===181){const v=qy(a,g);if(g+=2,v===49){const x=xe(a,g);if(g+=4,x===1195456820){const S=a[g++];if(S===3){const E=a[g++],b=31&E,A=64&E,O=A?2+b*3:0,_=new Uint8Array(O);if(A){_[0]=E;for(let k=1;k<O;k++)_[k]=a[g++]}n.push({type:S,payloadType:u,pts:t,bytes:_})}}}}}else if(u===5&&c>16){const p=[];for(let S=0;S<16;S++){const E=a[g++].toString(16);p.push(E.length==1?"0"+E:E),(S===3||S===5||S===7||S===9)&&p.push("-")}const v=c-16,x=new Uint8Array(v);for(let S=0;S<v;S++)x[S]=a[g++];n.push({payloadType:u,pts:t,uuid:p.join(""),userData:Ii(x),userDataBytes:x})}}}function Jy(r){const e=r.byteLength,t=[];let n=1;for(;n<e-2;)r[n]===0&&r[n+1]===0&&r[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return r;const a=e-t.length,l=new Uint8Array(a);let u=0;for(n=0;n<a;u++,n++)u===t[0]&&(u++,t.shift()),l[n]=r[u];return l}function U1(r){const e=r[0];let t="",n="",a=0,l=0,u=0,c=0,d=0,h=0;if(e===0){for(;ft(r.subarray(h,h+1))!=="\0";)t+=ft(r.subarray(h,h+1)),h+=1;for(t+=ft(r.subarray(h,h+1)),h+=1;ft(r.subarray(h,h+1))!=="\0";)n+=ft(r.subarray(h,h+1)),h+=1;n+=ft(r.subarray(h,h+1)),h+=1,a=xe(r,12),l=xe(r,16),c=xe(r,20),d=xe(r,24),h=28}else if(e===1){h+=4,a=xe(r,h),h+=4;const p=xe(r,h);h+=4;const v=xe(r,h);for(h+=4,u=2**32*p+v,t1(u)||(u=Number.MAX_SAFE_INTEGER,Y.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=xe(r,h),h+=4,d=xe(r,h),h+=4;ft(r.subarray(h,h+1))!=="\0";)t+=ft(r.subarray(h,h+1)),h+=1;for(t+=ft(r.subarray(h,h+1)),h+=1;ft(r.subarray(h,h+1))!=="\0";)n+=ft(r.subarray(h,h+1)),h+=1;n+=ft(r.subarray(h,h+1)),h+=1}const g=r.subarray(h,r.byteLength);return{schemeIdUri:t,value:n,timeScale:a,presentationTime:u,presentationTimeDelta:l,eventDuration:c,id:d,payload:g}}function F1(r,...e){const t=e.length;let n=8,a=t;for(;a--;)n+=e[a].byteLength;const l=new Uint8Array(n);for(l[0]=n>>24&255,l[1]=n>>16&255,l[2]=n>>8&255,l[3]=n&255,l.set(r,4),a=0,n=8;a<t;a++)l.set(e[a],n),n+=e[a].byteLength;return l}function B1(r,e,t){if(r.byteLength!==16)throw new RangeError("Invalid system id");let n,a;n=0,a=new Uint8Array;let l;n>0?(l=new Uint8Array(4),e.length>0&&new DataView(l.buffer).setUint32(0,e.length,!1)):l=new Uint8Array;const u=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(u.buffer).setUint32(0,t.byteLength,!1),F1([112,115,115,104],new Uint8Array([n,0,0,0]),r,l,a,u,t||new Uint8Array)}function j1(r){const e=[];if(r instanceof ArrayBuffer){const t=r.byteLength;let n=0;for(;n+32<t;){const a=new DataView(r,n),l=G1(a);e.push(l),n+=l.size}}return e}function G1(r){const e=r.getUint32(0),t=r.byteOffset,n=r.byteLength;if(n<e)return{offset:t,size:n};if(r.getUint32(4)!==1886614376)return{offset:t,size:e};const l=r.getUint32(8)>>>24;if(l!==0&&l!==1)return{offset:t,size:e};const u=r.buffer,c=Di.hexDump(new Uint8Array(u,t+12,16)),d=r.getUint32(28);let h=null,g=null;if(l===0){if(e-32<d||d<22)return{offset:t,size:e};g=new Uint8Array(u,t+32,d)}else if(l===1){if(!d||n<t+32+d*16+16)return{offset:t,size:e};h=[];for(let p=0;p<d;p++)h.push(new Uint8Array(u,t+32+p*16,16))}return{version:l,systemId:c,kids:h,data:g,offset:t,size:e}}let Gl={};class xa{static clearKeyUriToKeyIdMap(){Gl={}}constructor(e,t,n,a=[1],l=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=a,this.iv=l,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Ut.FAIRPLAY:case Ut.WIDEVINE:case Ut.PLAYREADY:case Ut.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&Y.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=H1(e);return new xa(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=m1(this.uri);if(t)switch(this.keyFormat){case Ut.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Ut.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=B1(n,null,t),this.keyId=$y(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const a=new Uint8Array(16);a.set(n,16-n.length),n=a}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=Gl[this.uri];if(!n){const a=Object.keys(Gl).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,a),Gl[this.uri]=n}this.keyId=n}return this}}function H1(r){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=r>>8*(15-t)&255;return e}const ev=/\{\$([a-zA-Z0-9-_]+)\}/g;function hp(r){return ev.test(r)}function Nt(r,e,t){if(r.variableList!==null||r.hasVariableRefs)for(let n=t.length;n--;){const a=t[n],l=e[a];l&&(e[a]=Zf(r,l))}}function Zf(r,e){if(r.variableList!==null||r.hasVariableRefs){const t=r.variableList;return e.replace(ev,n=>{const a=n.substring(2,n.length-1),l=t==null?void 0:t[a];return l===void 0?(r.playlistParsingError||(r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${a}"`)),n):l})}return e}function mp(r,e,t){let n=r.variableList;n||(r.variableList=n={});let a,l;if("QUERYPARAM"in e){a=e.QUERYPARAM;try{const u=new self.URL(t).searchParams;if(u.has(a))l=u.get(a);else throw new Error(`"${a}" does not match any query parameter in URI: "${t}"`)}catch(u){r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${u.message}`))}}else a=e.NAME,l=e.VALUE;a in n?r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${a}"`)):n[a]=l||""}function $1(r,e,t){const n=e.IMPORT;if(t&&n in t){let a=r.variableList;a||(r.variableList=a={}),a[n]=t[n]}else r.playlistParsingError||(r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function hs(r=!0){return typeof self>"u"?void 0:(r||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function V1(r){return typeof self<"u"&&r===self.ManagedMediaSource}const So={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function z1(r,e){const t=So[e];return!!t&&!!t[r.slice(0,4)]}function Df(r,e,t=!0){return!r.split(",").some(n=>!tv(n,e,t))}function tv(r,e,t=!0){var n;const a=hs(t);return(n=a==null?void 0:a.isTypeSupported(Sa(r,e)))!=null?n:!1}function Sa(r,e){return`${e}/mp4;codecs="${r}"`}function gp(r){if(r){const e=r.substring(0,4);return So.video[e]}return 2}function Eo(r){return r.split(",").reduce((e,t)=>{const n=So.video[t];return n?(n*2+e)/(e?3:2):(So.audio[t]+e)/(e?2:1)},0)}const Cf={};function K1(r,e=!0){if(Cf[r])return Cf[r];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[r];for(let n=0;n<t.length;n++)if(tv(t[n],"audio",e))return Cf[r]=t[n],t[n];return r}const Y1=/flac|opus/i;function To(r,e=!0){return r.replace(Y1,t=>K1(t.toLowerCase(),e))}function pp(r,e){return r&&r!=="mp4a"?r:e&&e.split(",")[0]}function q1(r){const e=r.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let a=n.shift()+".";a+=parseInt(n.shift()).toString(16),a+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=a}}return e.join(",")}const yp=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,vp=/#EXT-X-MEDIA:(.*)/g,X1=/^#EXT(?:INF|-X-TARGETDURATION):/m,xp=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),W1=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class wi{static findGroup(e,t){for(let n=0;n<e.length;n++){const a=e[n];if(a.id===t)return a}}static resolve(e,t){return xd.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return X1.test(e)}static parseMasterPlaylist(e,t){const n=hp(e),a={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},l=[];yp.lastIndex=0;let u;for(;(u=yp.exec(e))!=null;)if(u[1]){var c;const h=new Ze(u[1]);Nt(a,h,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const g=Zf(a,u[2]),p={attrs:h,bitrate:h.decimalInteger("BANDWIDTH")||h.decimalInteger("AVERAGE-BANDWIDTH"),name:h.NAME,url:wi.resolve(g,t)},v=h.decimalResolution("RESOLUTION");v&&(p.width=v.width,p.height=v.height),Q1(h.CODECS,p),(c=p.unknownCodecs)!=null&&c.length||l.push(p),a.levels.push(p)}else if(u[3]){const h=u[3],g=u[4];switch(h){case"SESSION-DATA":{const p=new Ze(g);Nt(a,p,["DATA-ID","LANGUAGE","VALUE","URI"]);const v=p["DATA-ID"];v&&(a.sessionData===null&&(a.sessionData={}),a.sessionData[v]=p);break}case"SESSION-KEY":{const p=Sp(g,t,a);p.encrypted&&p.isSupported()?(a.sessionKeys===null&&(a.sessionKeys=[]),a.sessionKeys.push(p)):Y.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${g}"`);break}case"DEFINE":{{const p=new Ze(g);Nt(a,p,["NAME","VALUE","QUERYPARAM"]),mp(a,p,t)}break}case"CONTENT-STEERING":{const p=new Ze(g);Nt(a,p,["SERVER-URI","PATHWAY-ID"]),a.contentSteering={uri:wi.resolve(p["SERVER-URI"],t),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{a.startTimeOffset=Ep(g);break}}}const d=l.length>0&&l.length<a.levels.length;return a.levels=d?l:a.levels,a.levels.length===0&&(a.playlistParsingError=new Error("no levels found in manifest")),a}static parseMasterPlaylistMedia(e,t,n){let a;const l={},u=n.levels,c={AUDIO:u.map(h=>({id:h.attrs.AUDIO,audioCodec:h.audioCodec})),SUBTITLES:u.map(h=>({id:h.attrs.SUBTITLES,textCodec:h.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(vp.lastIndex=0;(a=vp.exec(e))!==null;){const h=new Ze(a[1]),g=h.TYPE;if(g){const p=c[g],v=l[g]||[];l[g]=v,Nt(n,h,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const x=h.LANGUAGE,S=h["ASSOC-LANGUAGE"],E=h.CHANNELS,b=h.CHARACTERISTICS,A=h["INSTREAM-ID"],O={attrs:h,bitrate:0,id:d++,groupId:h["GROUP-ID"]||"",name:h.NAME||x||"",type:g,default:h.bool("DEFAULT"),autoselect:h.bool("AUTOSELECT"),forced:h.bool("FORCED"),lang:x,url:h.URI?wi.resolve(h.URI,t):""};if(S&&(O.assocLang=S),E&&(O.channels=E),b&&(O.characteristics=b),A&&(O.instreamId=A),p!=null&&p.length){const _=wi.findGroup(p,O.groupId)||p[0];Tp(O,_,"audioCodec"),Tp(O,_,"textCodec")}v.push(O)}}return l}static parseLevelPlaylist(e,t,n,a,l,u){const c=new f1(t),d=c.fragments;let h=null,g=0,p=0,v=0,x=0,S=null,E=new Ef(a,t),b,A,O,_=-1,k=!1,D=null;for(xp.lastIndex=0,c.m3u8=e,c.hasVariableRefs=hp(e);(b=xp.exec(e))!==null;){k&&(k=!1,E=new Ef(a,t),E.start=v,E.sn=g,E.cc=x,E.level=n,h&&(E.initSegment=h,E.rawProgramDateTime=h.rawProgramDateTime,h.rawProgramDateTime=null,D&&(E.setByteRange(D),D=null)));const I=b[1];if(I){E.duration=parseFloat(I);const N=(" "+b[2]).slice(1);E.title=N||null,E.tagList.push(N?["INF",I,N]:["INF",I])}else if(b[3]){if(ge(E.duration)){E.start=v,O&&Rp(E,O,c),E.sn=g,E.level=n,E.cc=x,d.push(E);const N=(" "+b[3]).slice(1);E.relurl=Zf(c,N),bp(E,S),S=E,v+=E.duration,g++,p=0,k=!0}}else if(b[4]){const N=(" "+b[4]).slice(1);S?E.setByteRange(N,S):E.setByteRange(N)}else if(b[5])E.rawProgramDateTime=(" "+b[5]).slice(1),E.tagList.push(["PROGRAM-DATE-TIME",E.rawProgramDateTime]),_===-1&&(_=d.length);else{if(b=b[0].match(W1),!b){Y.warn("No matches on slow regex match for level playlist!");continue}for(A=1;A<b.length&&!(typeof b[A]<"u");A++);const N=(" "+b[A]).slice(1),U=(" "+b[A+1]).slice(1),Q=b[A+2]?(" "+b[A+2]).slice(1):"";switch(N){case"PLAYLIST-TYPE":c.type=U.toUpperCase();break;case"MEDIA-SEQUENCE":g=c.startSN=parseInt(U);break;case"SKIP":{const Z=new Ze(U);Nt(c,Z,["RECENTLY-REMOVED-DATERANGES"]);const V=Z.decimalInteger("SKIPPED-SEGMENTS");if(ge(V)){c.skippedSegments=V;for(let $=V;$--;)d.unshift(null);g+=V}const X=Z.enumeratedString("RECENTLY-REMOVED-DATERANGES");X&&(c.recentlyRemovedDateranges=X.split("	"));break}case"TARGETDURATION":c.targetduration=Math.max(parseInt(U),1);break;case"VERSION":c.version=parseInt(U);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(U||Q)&&E.tagList.push(Q?[U,Q]:[U]);break;case"DISCONTINUITY":x++,E.tagList.push(["DIS"]);break;case"GAP":E.gap=!0,E.tagList.push([N]);break;case"BITRATE":E.tagList.push([N,U]);break;case"DATERANGE":{const Z=new Ze(U);Nt(c,Z,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Nt(c,Z,Z.clientAttrs);const V=new jy(Z,c.dateRanges[Z.ID]);V.isValid||c.skippedSegments?c.dateRanges[V.id]=V:Y.warn(`Ignoring invalid DATERANGE tag: "${U}"`),E.tagList.push(["EXT-X-DATERANGE",U]);break}case"DEFINE":{{const Z=new Ze(U);Nt(c,Z,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in Z?$1(c,Z,u):mp(c,Z,t)}break}case"DISCONTINUITY-SEQUENCE":x=parseInt(U);break;case"KEY":{const Z=Sp(U,t,c);if(Z.isSupported()){if(Z.method==="NONE"){O=void 0;break}O||(O={}),O[Z.keyFormat]&&(O=lt({},O)),O[Z.keyFormat]=Z}else Y.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${U}"`);break}case"START":c.startTimeOffset=Ep(U);break;case"MAP":{const Z=new Ze(U);if(Nt(c,Z,["BYTERANGE","URI"]),E.duration){const V=new Ef(a,t);Ap(V,Z,n,O),h=V,E.initSegment=h,h.rawProgramDateTime&&!E.rawProgramDateTime&&(E.rawProgramDateTime=h.rawProgramDateTime)}else{const V=E.byteRangeEndOffset;if(V){const X=E.byteRangeStartOffset;D=`${V-X}@${X}`}else D=null;Ap(E,Z,n,O),h=E,k=!0}break}case"SERVER-CONTROL":{const Z=new Ze(U);c.canBlockReload=Z.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=Z.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&Z.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=Z.optionalFloat("PART-HOLD-BACK",0),c.holdBack=Z.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const Z=new Ze(U);c.partTarget=Z.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Z=c.partList;Z||(Z=c.partList=[]);const V=p>0?Z[Z.length-1]:void 0,X=p++,$=new Ze(U);Nt(c,$,["BYTERANGE","URI"]);const oe=new u1($,E,t,X,V);Z.push(oe),E.duration+=oe.duration;break}case"PRELOAD-HINT":{const Z=new Ze(U);Nt(c,Z,["URI"]),c.preloadHint=Z;break}case"RENDITION-REPORT":{const Z=new Ze(U);Nt(c,Z,["URI"]),c.renditionReports=c.renditionReports||[],c.renditionReports.push(Z);break}default:Y.warn(`line parsed but not handled: ${b}`);break}}}S&&!S.relurl?(d.pop(),v-=S.duration,c.partList&&(c.fragmentHint=S)):c.partList&&(bp(E,S),E.cc=x,c.fragmentHint=E,O&&Rp(E,O,c));const F=d.length,B=d[0],M=d[F-1];if(v+=c.skippedSegments*c.targetduration,v>0&&F&&M){c.averagetargetduration=v/F;const I=M.sn;c.endSN=I!=="initSegment"?I:0,c.live||(M.endList=!0),B&&(c.startCC=B.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(v+=c.fragmentHint.duration),c.totalduration=v,c.endCC=x,_>0&&Z1(d,_),c}}function Sp(r,e,t){var n,a;const l=new Ze(r);Nt(t,l,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const u=(n=l.METHOD)!=null?n:"",c=l.URI,d=l.hexadecimalInteger("IV"),h=l.KEYFORMATVERSIONS,g=(a=l.KEYFORMAT)!=null?a:"identity";c&&l.IV&&!d&&Y.error(`Invalid IV: ${l.IV}`);const p=c?wi.resolve(c,e):"",v=(h||"1").split("/").map(Number).filter(Number.isFinite);return new xa(u,p,g,v,d)}function Ep(r){const t=new Ze(r).decimalFloatingPoint("TIME-OFFSET");return ge(t)?t:null}function Q1(r,e){let t=(r||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const a=t.filter(l=>z1(l,n));a.length&&(e[`${n}Codec`]=a.join(","),t=t.filter(l=>a.indexOf(l)===-1))}),e.unknownCodecs=t}function Tp(r,e,t){const n=e[t];n&&(r[t]=n)}function Z1(r,e){let t=r[e];for(let n=e;n--;){const a=r[n];if(!a)return;a.programDateTime=t.programDateTime-a.duration*1e3,t=a}}function bp(r,e){r.rawProgramDateTime?r.programDateTime=Date.parse(r.rawProgramDateTime):e!=null&&e.programDateTime&&(r.programDateTime=e.endProgramDateTime),ge(r.programDateTime)||(r.programDateTime=null,r.rawProgramDateTime=null)}function Ap(r,e,t,n){r.relurl=e.URI,e.BYTERANGE&&r.setByteRange(e.BYTERANGE),r.level=t,r.sn="initSegment",n&&(r.levelkeys=n),r.initSegment=null}function Rp(r,e,t){r.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(a=>e[a].isCommonEncryption)&&n.push(r)}var Me={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Se={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Lp(r){const{type:e}=r;switch(e){case Me.AUDIO_TRACK:return Se.AUDIO;case Me.SUBTITLE_TRACK:return Se.SUBTITLE;default:return Se.MAIN}}function wf(r,e){let t=r.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class J1{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,a=t.loader,l=n||a,u=new l(t);return this.loaders[e.type]=u,u}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Me.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:a,pathwayId:l,url:u,deliveryDirectives:c}=t;this.load({id:n,level:a,pathwayId:l,responseType:"text",type:Me.LEVEL,url:u,deliveryDirectives:c})}onAudioTrackLoading(e,t){const{id:n,groupId:a,url:l,deliveryDirectives:u}=t;this.load({id:n,groupId:a,level:null,responseType:"text",type:Me.AUDIO_TRACK,url:l,deliveryDirectives:u})}onSubtitleTrackLoading(e,t){const{id:n,groupId:a,url:l,deliveryDirectives:u}=t;this.load({id:n,groupId:a,level:null,responseType:"text",type:Me.SUBTITLE_TRACK,url:l,deliveryDirectives:u})}load(e){var t;const n=this.hls.config;let a=this.getInternalLoader(e);if(a){const h=a.context;if(h&&h.url===e.url&&h.level===e.level){Y.trace("[playlist-loader]: playlist request ongoing");return}Y.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),a.abort()}let l;if(e.type===Me.MANIFEST?l=n.manifestLoadPolicy.default:l=lt({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),a=this.createInternalLoader(e),ge((t=e.deliveryDirectives)==null?void 0:t.part)){let h;if(e.type===Me.LEVEL&&e.level!==null?h=this.hls.levels[e.level].details:e.type===Me.AUDIO_TRACK&&e.id!==null?h=this.hls.audioTracks[e.id].details:e.type===Me.SUBTITLE_TRACK&&e.id!==null&&(h=this.hls.subtitleTracks[e.id].details),h){const g=h.partTarget,p=h.targetduration;if(g&&p){const v=Math.max(g*3,p*.8)*1e3;l=lt({},l,{maxTimeToFirstByteMs:Math.min(v,l.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(v,l.maxTimeToFirstByteMs)})}}}const u=l.errorRetry||l.timeoutRetry||{},c={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},d={onSuccess:(h,g,p,v)=>{const x=this.getInternalLoader(p);this.resetInternalLoader(p.type);const S=h.data;if(S.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(h,p,new Error("no EXTM3U delimiter"),v||null,g);return}g.parsing.start=performance.now(),wi.isMediaPlaylist(S)?this.handleTrackOrLevelPlaylist(h,g,p,v||null,x):this.handleMasterPlaylist(h,g,p,v)},onError:(h,g,p,v)=>{this.handleNetworkError(g,p,!1,h,v)},onTimeout:(h,g,p)=>{this.handleNetworkError(g,p,!0,void 0,h)}};a.load(e,c,d)}handleMasterPlaylist(e,t,n,a){const l=this.hls,u=e.data,c=wf(e,n),d=wi.parseMasterPlaylist(u,c);if(d.playlistParsingError){this.handleManifestParsingError(e,n,d.playlistParsingError,a,t);return}const{contentSteering:h,levels:g,sessionData:p,sessionKeys:v,startTimeOffset:x,variableList:S}=d;this.variableList=S;const{AUDIO:E=[],SUBTITLES:b,"CLOSED-CAPTIONS":A}=wi.parseMasterPlaylistMedia(u,c,d);E.length&&!E.some(_=>!_.url)&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(Y.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),E.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ze({}),bitrate:0,url:""})),l.trigger(R.MANIFEST_LOADED,{levels:g,audioTracks:E,subtitles:b,captions:A,contentSteering:h,url:c,stats:t,networkDetails:a,sessionData:p,sessionKeys:v,startTimeOffset:x,variableList:S})}handleTrackOrLevelPlaylist(e,t,n,a,l){const u=this.hls,{id:c,level:d,type:h}=n,g=wf(e,n),p=0,v=ge(d)?d:ge(c)?c:0,x=Lp(n),S=wi.parseLevelPlaylist(e.data,g,v,x,p,this.variableList);if(h===Me.MANIFEST){const E={attrs:new Ze({}),bitrate:0,details:S,name:"",url:g};u.trigger(R.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:g,stats:t,networkDetails:a,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=S,this.handlePlaylistLoaded(S,e,t,n,a,l)}handleManifestParsingError(e,t,n,a,l){this.hls.trigger(R.ERROR,{type:Te.NETWORK_ERROR,details:te.MANIFEST_PARSING_ERROR,fatal:t.type===Me.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:a,stats:l})}handleNetworkError(e,t,n=!1,a,l){let u=`A network ${n?"timeout":"error"+(a?" (status "+a.code+")":"")} occurred while loading ${e.type}`;e.type===Me.LEVEL?u+=`: ${e.level} id: ${e.id}`:(e.type===Me.AUDIO_TRACK||e.type===Me.SUBTITLE_TRACK)&&(u+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(u);Y.warn(`[playlist-loader]: ${u}`);let d=te.UNKNOWN,h=!1;const g=this.getInternalLoader(e);switch(e.type){case Me.MANIFEST:d=n?te.MANIFEST_LOAD_TIMEOUT:te.MANIFEST_LOAD_ERROR,h=!0;break;case Me.LEVEL:d=n?te.LEVEL_LOAD_TIMEOUT:te.LEVEL_LOAD_ERROR,h=!1;break;case Me.AUDIO_TRACK:d=n?te.AUDIO_TRACK_LOAD_TIMEOUT:te.AUDIO_TRACK_LOAD_ERROR,h=!1;break;case Me.SUBTITLE_TRACK:d=n?te.SUBTITLE_TRACK_LOAD_TIMEOUT:te.SUBTITLE_LOAD_ERROR,h=!1;break}g&&this.resetInternalLoader(e.type);const p={type:Te.NETWORK_ERROR,details:d,fatal:h,url:e.url,loader:g,context:e,error:c,networkDetails:t,stats:l};if(a){const v=(t==null?void 0:t.url)||e.url;p.response=vt({url:v,data:void 0},a)}this.hls.trigger(R.ERROR,p)}handlePlaylistLoaded(e,t,n,a,l,u){const c=this.hls,{type:d,level:h,id:g,groupId:p,deliveryDirectives:v}=a,x=wf(t,a),S=Lp(a),E=typeof a.level=="number"&&S===Se.MAIN?h:void 0;if(!e.fragments.length){const A=new Error("No Segments found in Playlist");c.trigger(R.ERROR,{type:Te.NETWORK_ERROR,details:te.LEVEL_EMPTY_ERROR,fatal:!1,url:x,error:A,reason:A.message,response:t,context:a,level:E,parent:S,networkDetails:l,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const b=e.playlistParsingError;if(b){c.trigger(R.ERROR,{type:Te.NETWORK_ERROR,details:te.LEVEL_PARSING_ERROR,fatal:!1,url:x,error:b,reason:b.message,response:t,context:a,level:E,parent:S,networkDetails:l,stats:n});return}switch(e.live&&u&&(u.getCacheAge&&(e.ageHeader=u.getCacheAge()||0),(!u.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case Me.MANIFEST:case Me.LEVEL:c.trigger(R.LEVEL_LOADED,{details:e,level:E||0,id:g||0,stats:n,networkDetails:l,deliveryDirectives:v});break;case Me.AUDIO_TRACK:c.trigger(R.AUDIO_TRACK_LOADED,{details:e,id:g||0,groupId:p||"",stats:n,networkDetails:l,deliveryDirectives:v});break;case Me.SUBTITLE_TRACK:c.trigger(R.SUBTITLE_TRACK_LOADED,{details:e,id:g||0,groupId:p||"",stats:n,networkDetails:l,deliveryDirectives:v});break}}}function iv(r,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=r,e.dispatchEvent(t)}function nv(r,e){const t=r.mode;if(t==="disabled"&&(r.mode="hidden"),r.cues&&!r.cues.getCueById(e.id))try{if(r.addCue(e),!r.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){Y.debug(`[texttrack-utils]: ${n}`);try{const a=new self.TextTrackCue(e.startTime,e.endTime,e.text);a.id=e.id,r.addCue(a)}catch(a){Y.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${a}`)}}t==="disabled"&&(r.mode=t)}function ir(r){const e=r.mode;if(e==="disabled"&&(r.mode="hidden"),r.cues)for(let t=r.cues.length;t--;)r.removeCue(r.cues[t]);e==="disabled"&&(r.mode=e)}function Jf(r,e,t,n){const a=r.mode;if(a==="disabled"&&(r.mode="hidden"),r.cues&&r.cues.length>0){const l=tA(r.cues,e,t);for(let u=0;u<l.length;u++)(!n||n(l[u]))&&r.removeCue(l[u])}a==="disabled"&&(r.mode=a)}function eA(r,e){if(e<r[0].startTime)return 0;const t=r.length-1;if(e>r[t].endTime)return-1;let n=0,a=t;for(;n<=a;){const l=Math.floor((a+n)/2);if(e<r[l].startTime)a=l-1;else if(e>r[l].startTime&&n<t)n=l+1;else return l}return r[n].startTime-e<e-r[a].startTime?n:a}function tA(r,e,t){const n=[],a=eA(r,e);if(a>-1)for(let l=a,u=r.length;l<u;l++){const c=r[l];if(c.startTime>=e&&c.endTime<=t)n.push(c);else if(c.startTime>t)return n}return n}function eo(r){const e=[];for(let t=0;t<r.length;t++){const n=r[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(r[t])}return e}var vi={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const iA=.25;function ed(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function _p(r,e,t,n,a){let l=new r(e,t,"");try{l.value=n,a&&(l.type=a)}catch{l=new r(e,t,JSON.stringify(a?vt({type:a},n):n))}return l}const Hl=(()=>{const r=ed();try{r&&new r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Of(r,e){return r.getTime()/1e3-e}function nA(r){return Uint8Array.from(r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class sA{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(ir(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return iv(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:a}}}=this;if(!n&&!a)return;const{samples:l}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=ed();if(u)for(let c=0;c<l.length;c++){const d=l[c].type;if(d===vi.emsg&&!n||!a)continue;const h=Ky(l[c].data);if(h){const g=l[c].pts;let p=g+l[c].duration;p>Hl&&(p=Hl),p-g<=0&&(p=g+iA);for(let x=0;x<h.length;x++){const S=h[x];if(!zy(S)){this.updateId3CueEnds(g,d);const E=_p(u,g,p,S,d);E&&this.id3Track.addCue(E)}}}}}updateId3CueEnds(e,t){var n;const a=(n=this.id3Track)==null?void 0:n.cues;if(a)for(let l=a.length;l--;){const u=a[l];u.type===t&&u.startTime<e&&u.endTime===Hl&&(u.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:a}){const{id3Track:l,hls:u}=this;if(!u)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:d}}=u;if(l&&(c||d)){let h;a==="audio"?h=g=>g.type===vi.audioId3&&d:a==="video"?h=g=>g.type===vi.emsg&&c:h=g=>g.type===vi.audioId3&&d||g.type===vi.emsg&&c,Jf(l,t,n,h)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:a}=this,{dateRanges:l}=t,u=Object.keys(l);if(a){const g=Object.keys(n).filter(p=>!u.includes(p));for(let p=g.length;p--;){const v=g[p];Object.keys(n[v].cues).forEach(x=>{a.removeCue(n[v].cues[x])}),delete n[v]}}const c=t.fragments[t.fragments.length-1];if(u.length===0||!ge(c==null?void 0:c.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const d=c.programDateTime/1e3-c.start,h=ed();for(let g=0;g<u.length;g++){const p=u[g],v=l[p],x=Of(v.startDate,d),S=n[p],E=(S==null?void 0:S.cues)||{};let b=(S==null?void 0:S.durationKnown)||!1,A=Hl;const O=v.endDate;if(O)A=Of(O,d),b=!0;else if(v.endOnNext&&!b){const k=u.reduce((D,F)=>{if(F!==v.id){const B=l[F];if(B.class===v.class&&B.startDate>v.startDate&&(!D||v.startDate<D.startDate))return B}return D},null);k&&(A=Of(k.startDate,d),b=!0)}const _=Object.keys(v.attr);for(let k=0;k<_.length;k++){const D=_[k];if(!l1(D))continue;const F=E[D];if(F)b&&!S.durationKnown&&(F.endTime=A);else if(h){let B=v.attr[D];o1(D)&&(B=nA(B));const M=_p(h,x,A,{key:D,data:B},vi.dateRange);M&&(M.id=p,this.id3Track.addCue(M),E[D]=M)}}n[p]={cues:E,dateRange:v,durationKnown:b}}}}class rA{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:a}=e,{liveSyncDuration:l,liveSyncDurationCount:u,lowLatencyMode:c}=this.config,d=this.hls.userConfig;let h=c&&n||t;(d.liveSyncDuration||d.liveSyncDurationCount||h===0)&&(h=l!==void 0?l:u*a);const g=a;return h+Math.min(this.stallCount*1,g)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const a=n.edge,l=e-t-this.edgeStalled,u=a-n.totalduration,c=a-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(u,l),c)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(R.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(R.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===te.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&Y.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:a,maxLiveSyncPlaybackRate:l}=this.config;if(!a||l===1||!t.live)return;const u=this.targetLatency;if(u===null)return;const c=n-u,d=Math.min(this.maxLatency,u+t.targetduration);if(c<d&&c>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,l)),p=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;e.playbackRate=Math.min(g,Math.max(1,p))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const td=["NONE","TYPE-0","TYPE-1",null];function aA(r){return td.indexOf(r)>-1}const bo=["SDR","PQ","HLG"];function lA(r){return!!r&&bo.indexOf(r)>-1}var to={No:"",Yes:"YES",v2:"v2"};function Dp(r){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=r,a=n<e/2;return e&&a?t?to.v2:to.Yes:to.No}class Cp{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class cr{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return wp(this._audioGroups,e)}hasSubtitleGroup(e){return wp(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function wp(r,e){return!e||!r?!1:r.indexOf(e)!==-1}function If(r,e){const t=e.startPTS;if(ge(t)){let n=0,a;e.sn>r.sn?(n=t-r.start,a=r):(n=r.start-t,a=e),a.duration!==n&&(a.duration=n)}else e.sn>r.sn?r.cc===e.cc&&r.minEndPTS?e.start=r.start+(r.minEndPTS-r.start):e.start=r.start+r.duration:e.start=Math.max(r.start-e.duration,0)}function sv(r,e,t,n,a,l){n-t<=0&&(Y.warn("Fragment should have a positive duration",e),n=t+e.duration,l=a+e.duration);let c=t,d=n;const h=e.startPTS,g=e.endPTS;if(ge(h)){const b=Math.abs(h-t);ge(e.deltaPTS)?e.deltaPTS=Math.max(b,e.deltaPTS):e.deltaPTS=b,c=Math.max(t,h),t=Math.min(t,h),a=Math.min(a,e.startDTS),d=Math.min(n,g),n=Math.max(n,g),l=Math.max(l,e.endDTS)}const p=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=c,e.startDTS=a,e.endPTS=n,e.minEndPTS=d,e.endDTS=l;const v=e.sn;if(!r||v<r.startSN||v>r.endSN)return 0;let x;const S=v-r.startSN,E=r.fragments;for(E[S]=e,x=S;x>0;x--)If(E[x],E[x-1]);for(x=S;x<E.length-1;x++)If(E[x],E[x+1]);return r.fragmentHint&&If(E[E.length-1],r.fragmentHint),r.PTSKnown=r.alignedSliding=!0,p}function oA(r,e){let t=null;const n=r.fragments;for(let c=n.length-1;c>=0;c--){const d=n[c].initSegment;if(d){t=d;break}}r.fragmentHint&&delete r.fragmentHint.endPTS;let a;fA(r,e,(c,d,h,g)=>{if(e.skippedSegments&&d.cc!==c.cc){const p=c.cc-d.cc;for(let v=h;v<g.length;v++)g[v].cc+=p}ge(c.startPTS)&&ge(c.endPTS)&&(d.start=d.startPTS=c.startPTS,d.startDTS=c.startDTS,d.maxStartPTS=c.maxStartPTS,d.endPTS=c.endPTS,d.endDTS=c.endDTS,d.minEndPTS=c.minEndPTS,d.duration=c.endPTS-c.startPTS,d.duration&&(a=d),e.PTSKnown=e.alignedSliding=!0),d.elementaryStreams=c.elementaryStreams,d.loader=c.loader,d.stats=c.stats,c.initSegment&&(d.initSegment=c.initSegment,t=c.initSegment)});const l=e.fragments;if(t&&(e.fragmentHint?l.concat(e.fragmentHint):l).forEach(d=>{var h;d&&(!d.initSegment||d.initSegment.relurl===((h=t)==null?void 0:h.relurl))&&(d.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=l.some(c=>!c),e.deltaUpdateFailed){Y.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let c=e.skippedSegments;c--;)l.shift();e.startSN=l[0].sn}else e.canSkipDateRanges&&(e.dateRanges=uA(r.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));e.startCC=e.fragments[0].cc,e.endCC=l[l.length-1].cc}cA(r.partList,e.partList,(c,d)=>{d.elementaryStreams=c.elementaryStreams,d.stats=c.stats}),a?sv(e,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):rv(r,e),l.length&&(e.totalduration=e.edge-l[0].start),e.driftStartTime=r.driftStartTime,e.driftStart=r.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const c=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=c),e.driftEndTime=u,e.driftEnd=c}else e.driftEndTime=r.driftEndTime,e.driftEnd=r.driftEnd,e.advancedDateTime=r.advancedDateTime}function uA(r,e,t){const n=lt({},r);return t&&t.forEach(a=>{delete n[a]}),Object.keys(e).forEach(a=>{const l=new jy(e[a].attr,n[a]);l.isValid?n[a]=l:Y.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[a].attr)}"`)}),n}function cA(r,e,t){if(r&&e){let n=0;for(let a=0,l=r.length;a<=l;a++){const u=r[a],c=e[a+n];u&&c&&u.index===c.index&&u.fragment.sn===c.fragment.sn?t(u,c):n--}}}function fA(r,e,t){const n=e.skippedSegments,a=Math.max(r.startSN,e.startSN)-e.startSN,l=(r.fragmentHint?1:0)+(n?e.endSN:Math.min(r.endSN,e.endSN))-e.startSN,u=e.startSN-r.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments;for(let h=a;h<=l;h++){const g=d[u+h];let p=c[h];n&&!p&&h<n&&(p=e.fragments[h]=g),g&&p&&t(g,p,h,c)}}function rv(r,e){const t=e.startSN+e.skippedSegments-r.startSN,n=r.fragments;t<0||t>=n.length||id(e,n[t].start)}function id(r,e){if(e){const t=r.fragments;for(let n=r.skippedSegments;n<t.length;n++)t[n].start+=e;r.fragmentHint&&(r.fragmentHint.start+=e)}}function dA(r,e=1/0){let t=1e3*r.targetduration;if(r.updated){const n=r.fragments;if(n.length&&t*4>e){const l=n[n.length-1].duration*1e3;l<t&&(t=l)}}else t/=2;return Math.round(t)}function hA(r,e,t){if(!(r!=null&&r.details))return null;const n=r.details;let a=n.fragments[e-n.startSN];return a||(a=n.fragmentHint,a&&a.sn===e)?a:e<n.startSN&&t&&t.sn===e?t:null}function Op(r,e,t){var n;return r!=null&&r.details?av((n=r.details)==null?void 0:n.partList,e,t):null}function av(r,e,t){if(r)for(let n=r.length;n--;){const a=r[n];if(a.index===t&&a.fragment.sn===e)return a}return null}function lv(r){r.forEach((e,t)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(a=>{a.level=t})})}function Ao(r){switch(r.details){case te.FRAG_LOAD_TIMEOUT:case te.KEY_LOAD_TIMEOUT:case te.LEVEL_LOAD_TIMEOUT:case te.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Ip(r,e){const t=Ao(e);return r.default[`${t?"timeout":"error"}Retry`]}function bd(r,e){const t=r.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*r.retryDelayMs,r.maxRetryDelayMs)}function kp(r){return vt(vt({},r),{errorRetry:null,timeoutRetry:null})}function Ro(r,e,t,n){if(!r)return!1;const a=n==null?void 0:n.code,l=e<r.maxNumRetry&&(mA(a)||!!t);return r.shouldRetry?r.shouldRetry(r,e,t,n,l):l}function mA(r){return r===0&&navigator.onLine===!1||!!r&&(r<400||r>499)}const ov={search:function(r,e){let t=0,n=r.length-1,a=null,l=null;for(;t<=n;){a=(t+n)/2|0,l=r[a];const u=e(l);if(u>0)t=a+1;else if(u<0)n=a-1;else return l}return null}};function gA(r,e,t){if(e===null||!Array.isArray(r)||!r.length||!ge(e))return null;const n=r[0].programDateTime;if(e<(n||0))return null;const a=r[r.length-1].endProgramDateTime;if(e>=(a||0))return null;t=t||0;for(let l=0;l<r.length;++l){const u=r[l];if(yA(e,t,u))return u}return null}function Lo(r,e,t=0,n=0,a=.005){let l=null;if(r){l=e[r.sn-e[0].sn+1]||null;const c=r.endDTS-t;c>0&&c<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(l=e[0]);if(l&&((!r||r.level===l.level)&&nd(t,n,l)===0||pA(l,r,Math.min(a,n))))return l;const u=ov.search(e,nd.bind(null,t,n));return u&&(u!==r||!l)?u:l}function pA(r,e,t){if(e&&e.start===0&&e.level<r.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((a,l)=>(l[0]==="INF"&&(a+=parseFloat(l[1])),a),t);return r.start<=n}return!1}function nd(r=0,e=0,t){if(t.start<=r&&t.start+t.duration>r)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=r?1:t.start-n>r&&t.start?-1:0}function yA(r,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>r}function vA(r,e){return ov.search(r,t=>t.cc<e?1:t.cc>e?-1:0)}var At={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},pi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class xA{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=Y.log.bind(Y,"[info]:"),this.warn=Y.warn.bind(Y,"[warning]:"),this.error=Y.error.bind(Y,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(R.ERROR,this.onError,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(R.ERROR,this.onError,this),e.off(R.ERROR,this.onErrorOut,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Se.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,a;if(t.fatal)return;const l=this.hls,u=t.context;switch(t.details){case te.FRAG_LOAD_ERROR:case te.FRAG_LOAD_TIMEOUT:case te.KEY_LOAD_ERROR:case te.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case te.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:At.DoNothing,flags:pi.None};return}case te.FRAG_GAP:case te.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=At.SendAlternateToPenaltyBox;return}case te.LEVEL_EMPTY_ERROR:case te.LEVEL_PARSING_ERROR:{var c,d;const h=t.parent===Se.MAIN?t.level:l.loadLevel;t.details===te.LEVEL_EMPTY_ERROR&&((c=t.context)!=null&&(d=c.levelDetails)!=null&&d.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,h):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,h))}return;case te.LEVEL_LOAD_ERROR:case te.LEVEL_LOAD_TIMEOUT:typeof(u==null?void 0:u.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u.level));return;case te.AUDIO_TRACK_LOAD_ERROR:case te.AUDIO_TRACK_LOAD_TIMEOUT:case te.SUBTITLE_LOAD_ERROR:case te.SUBTITLE_TRACK_LOAD_TIMEOUT:if(u){const h=l.levels[l.loadLevel];if(h&&(u.type===Me.AUDIO_TRACK&&h.hasAudioGroup(u.groupId)||u.type===Me.SUBTITLE_TRACK&&h.hasSubtitleGroup(u.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l.loadLevel),t.errorAction.action=At.SendAlternateToPenaltyBox,t.errorAction.flags=pi.MoveAllAlternatesMatchingHost;return}}return;case te.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const h=l.levels[l.loadLevel],g=h==null?void 0:h.attrs["HDCP-LEVEL"];g?t.errorAction={action:At.SendAlternateToPenaltyBox,flags:pi.MoveAllAlternatesMatchingHDCP,hdcpLevel:g}:this.keySystemError(t)}return;case te.BUFFER_ADD_CODEC_ERROR:case te.REMUX_ALLOC_ERROR:case te.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(a=t.level)!=null?a:l.loadLevel);return;case te.INTERNAL_EXCEPTION:case te.BUFFER_APPENDING_ERROR:case te.BUFFER_FULL_ERROR:case te.LEVEL_SWITCH_ERROR:case te.BUFFER_STALLED_ERROR:case te.BUFFER_SEEK_OVER_HOLE:case te.BUFFER_NUDGE_ON_STALL:t.errorAction={action:At.DoNothing,flags:pi.None};return}t.type===Te.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,a=Ip(n.config.playlistLoadPolicy,e),l=this.playlistError++;if(Ro(a,l,Ao(e),e.response))return{action:At.RetryRequest,flags:pi.None,retryConfig:a,retryCount:l};const c=this.getLevelSwitchAction(e,t);return a&&(c.retryConfig=a,c.retryCount=l),c}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),a=t.levels[n],{fragLoadPolicy:l,keyLoadPolicy:u}=t.config,c=Ip(e.details.startsWith("key")?u:l,e),d=t.levels.reduce((g,p)=>g+p.fragmentError,0);if(a&&(e.details!==te.FRAG_GAP&&a.fragmentError++,Ro(c,d,Ao(e),e.response)))return{action:At.RetryRequest,flags:pi.None,retryConfig:c,retryCount:d};const h=this.getLevelSwitchAction(e,n);return c&&(h.retryConfig=c,h.retryCount=d),h}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const a=this.hls.levels[t];if(a){var l,u;const h=e.details;a.loadError++,h===te.BUFFER_APPEND_ERROR&&a.fragmentError++;let g=-1;const{levels:p,loadLevel:v,minAutoLevel:x,maxAutoLevel:S}=n;n.autoLevelEnabled||(n.loadLevel=-1);const E=(l=e.frag)==null?void 0:l.type,A=(E===Se.AUDIO&&h===te.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(h===te.BUFFER_ADD_CODEC_ERROR||h===te.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:F})=>a.audioCodec!==F),_=e.sourceBufferName==="video"&&(h===te.BUFFER_ADD_CODEC_ERROR||h===te.BUFFER_APPEND_ERROR)&&p.some(({codecSet:F,audioCodec:B})=>a.codecSet!==F&&a.audioCodec===B),{type:k,groupId:D}=(u=e.context)!=null?u:{};for(let F=p.length;F--;){const B=(F+v)%p.length;if(B!==v&&B>=x&&B<=S&&p[B].loadError===0){var c,d;const M=p[B];if(h===te.FRAG_GAP&&E===Se.MAIN&&e.frag){const I=p[B].details;if(I){const N=Lo(e.frag,I.fragments,e.frag.start);if(N!=null&&N.gap)continue}}else{if(k===Me.AUDIO_TRACK&&M.hasAudioGroup(D)||k===Me.SUBTITLE_TRACK&&M.hasSubtitleGroup(D))continue;if(E===Se.AUDIO&&(c=a.audioGroups)!=null&&c.some(I=>M.hasAudioGroup(I))||E===Se.SUBTITLE&&(d=a.subtitleGroups)!=null&&d.some(I=>M.hasSubtitleGroup(I))||A&&a.audioCodec===M.audioCodec||!A&&a.audioCodec!==M.audioCodec||_&&a.codecSet===M.codecSet)continue}g=B;break}}if(g>-1&&n.loadLevel!==g)return e.levelRetry=!0,this.playlistError=0,{action:At.SendAlternateToPenaltyBox,flags:pi.None,nextAutoLevel:g}}return{action:At.SendAlternateToPenaltyBox,flags:pi.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case At.DoNothing:break;case At.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==te.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:a,hdcpLevel:l,nextAutoLevel:u}=n;switch(a){case pi.None:this.switchLevel(e,u);break;case pi.MoveAllAlternatesMatchingHDCP:l&&(t.maxHdcpLevel=td[td.indexOf(l)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,u)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class Ad{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=Y.log.bind(Y,`${t}:`),this.warn=Y.warn.bind(Y,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const a=t==null?void 0:t.renditionReports;if(a){let l=-1;for(let u=0;u<a.length;u++){const c=a[u];let d;try{d=new self.URL(c.URI,t.url).href}catch(h){Y.warn(`Could not construct new URL for Rendition Report: ${h}`),d=c.URI||""}if(d===e){l=u;break}else d===e.substring(0,d.length)&&(l=u)}if(l!==-1){const u=a[l],c=parseInt(u["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let d=parseInt(u["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const g=Math.min(t.age-t.partTarget,t.targetduration);d>=0&&g>t.partTarget&&(d+=1)}const h=n&&Dp(n);return new Cp(c,d>=0?d:void 0,h)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:a,stats:l}=t,u=self.performance.now(),c=l.loading.first?Math.max(0,u-l.loading.first):0;if(a.advancedDateTime=Date.now()-c,a.live||n!=null&&n.live){if(a.reloaded(n),n&&this.log(`live playlist ${e} ${a.advanced?"REFRESHED "+a.lastPartSn+"-"+a.lastPartIndex:a.updated?"UPDATED":"MISSED"}`),n&&a.fragments.length>0&&oA(n,a),!this.canLoad||!a.live)return;let d,h,g;if(a.canBlockReload&&a.endSN&&a.advanced){const b=this.hls.config.lowLatencyMode,A=a.lastPartSn,O=a.endSN,_=a.lastPartIndex,k=_!==-1,D=A===O,F=b?0:_;k?(h=D?O+1:A,g=D?F:_+1):h=O+1;const B=a.age,M=B+a.ageHeader;let I=Math.min(M-a.partTarget,a.targetduration*1.5);if(I>0){if(n&&I>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${I} with playlist age: ${a.age}`),I=0;else{const N=Math.floor(I/a.targetduration);if(h+=N,g!==void 0){const U=Math.round(I%a.targetduration/a.partTarget);g+=U}this.log(`CDN Tune-in age: ${a.ageHeader}s last advanced ${B.toFixed(2)}s goal: ${I} skip sn ${N} to part ${g}`)}a.tuneInGoal=I}if(d=this.getDeliveryDirectives(a,t.deliveryDirectives,h,g),b||!D){this.loadPlaylist(d);return}}else(a.canBlockReload||a.canSkipUntil)&&(d=this.getDeliveryDirectives(a,t.deliveryDirectives,h,g));const p=this.hls.mainForwardBufferInfo,v=p?p.end-p.len:0,x=(a.edge-v)*1e3,S=dA(a,x);a.updated&&u>this.requestScheduled+S&&(this.requestScheduled=l.loading.start),h!==void 0&&a.canBlockReload?this.requestScheduled=l.loading.first+S-(a.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+S<u?this.requestScheduled=u:this.requestScheduled-u<=0&&(this.requestScheduled+=S);let E=this.requestScheduled-u;E=Math.max(0,E),this.log(`reload live playlist ${e} in ${Math.round(E)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(d),E)}else this.clearTimer()}getDeliveryDirectives(e,t,n,a){let l=Dp(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,a=t.part,l=to.No),new Cp(n,a,l)}checkRetry(e){const t=e.details,n=Ao(e),a=e.errorAction,{action:l,retryCount:u=0,retryConfig:c}=a||{},d=!!a&&!!c&&(l===At.RetryRequest||!a.resolved&&l===At.SendAlternateToPenaltyBox);if(d){var h;if(this.requestScheduled=-1,u>=c.maxNumRetry)return!1;if(n&&(h=e.context)!=null&&h.deliveryDirectives)this.warn(`Retrying playlist loading ${u+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const g=bd(c,u);this.timer=self.setTimeout(()=>this.loadPlaylist(),g),this.warn(`Retrying playlist loading ${u+1}/${c.maxNumRetry} after "${t}" in ${g}ms`)}e.levelRetry=!0,a.resolved=!0}return d}}class Xs{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class SA{constructor(e,t,n,a=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Xs(e),this.fast_=new Xs(t),this.defaultTTFB_=a,this.ttfb_=new Xs(e)}update(e,t){const{slow_:n,fast_:a,ttfb_:l}=this;n.halfLife!==e&&(this.slow_=new Xs(e,n.getEstimate(),n.getTotalWeight())),a.halfLife!==t&&(this.fast_=new Xs(t,a.getEstimate(),a.getTotalWeight())),l.halfLife!==e&&(this.ttfb_=new Xs(e,l.getEstimate(),l.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,a=e/1e3,l=n/a;this.fast_.sample(a,l),this.slow_.sample(a,l)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const uv={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Mp={};function EA(r,e,t,n,a,l){const u=r.audioCodec?r.audioGroups:null,c=l==null?void 0:l.audioCodec,d=l==null?void 0:l.channels,h=d?parseInt(d):c?1/0:2;let g=null;if(u!=null&&u.length)try{u.length===1&&u[0]?g=e.groups[u[0]].channels:g=u.reduce((p,v)=>{if(v){const x=e.groups[v];if(!x)throw new Error(`Audio track group ${v} not found`);Object.keys(x.channels).forEach(S=>{p[S]=(p[S]||0)+x.channels[S]})}return p},{2:0})}catch{return!0}return r.videoCodec!==void 0&&(r.width>1920&&r.height>1088||r.height>1920&&r.width>1088||r.frameRate>Math.max(n,30)||r.videoRange!=="SDR"&&r.videoRange!==t||r.bitrate>Math.max(a,8e6))||!!g&&ge(h)&&Object.keys(g).some(p=>parseInt(p)>h)}function TA(r,e,t){const n=r.videoCodec,a=r.audioCodec;if(!n||!a||!t)return Promise.resolve(uv);const l={width:r.width,height:r.height,bitrate:Math.ceil(Math.max(r.bitrate*.9,r.averageBitrate)),framerate:r.frameRate||30},u=r.videoRange;u!=="SDR"&&(l.transferFunction=u.toLowerCase());const c=n.split(",").map(d=>({type:"media-source",video:vt(vt({},l),{},{contentType:Sa(d,"video")})}));return a&&r.audioGroups&&r.audioGroups.forEach(d=>{var h;d&&((h=e.groups[d])==null||h.tracks.forEach(g=>{if(g.groupId===d){const p=g.channels||"",v=parseFloat(p);ge(v)&&v>2&&c.push.apply(c,a.split(",").map(x=>({type:"media-source",audio:{contentType:Sa(x,"audio"),channels:""+v}})))}}))}),Promise.all(c.map(d=>{const h=bA(d);return Mp[h]||(Mp[h]=t.decodingInfo(d))})).then(d=>({supported:!d.some(h=>!h.supported),configurations:c,decodingInfoResults:d})).catch(d=>({supported:!1,configurations:c,decodingInfoResults:[],error:d}))}function bA(r){const{audio:e,video:t}=r,n=t||e;if(n){const a=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${a}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${a}`}return""}function AA(){if(typeof matchMedia=="function"){const r=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(r.media!==e.media)return r.matches===!0}return!1}function RA(r,e){let t=!1,n=[];return r&&(t=r!=="SDR",n=[r]),e&&(n=e.allowedVideoRanges||bo.slice(0),t=e.preferHDR!==void 0?e.preferHDR:AA(),t?n=n.filter(a=>a!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function LA(r,e,t,n,a){const l=Object.keys(r),u=n==null?void 0:n.channels,c=n==null?void 0:n.audioCodec,d=u&&parseInt(u)===2;let h=!0,g=!1,p=1/0,v=1/0,x=1/0,S=0,E=[];const{preferHDR:b,allowedVideoRanges:A}=RA(e,a);for(let D=l.length;D--;){const F=r[l[D]];h=F.channels[2]>0,p=Math.min(p,F.minHeight),v=Math.min(v,F.minFramerate),x=Math.min(x,F.minBitrate);const B=A.filter(M=>F.videoRanges[M]>0);B.length>0&&(g=!0,E=B)}p=ge(p)?p:0,v=ge(v)?v:0;const O=Math.max(1080,p),_=Math.max(30,v);return x=ge(x)?x:t,t=Math.max(x,t),g||(e=void 0,E=[]),{codecSet:l.reduce((D,F)=>{const B=r[F];if(F===D)return D;if(B.minBitrate>t)return en(F,`min bitrate of ${B.minBitrate} > current estimate of ${t}`),D;if(!B.hasDefaultAudio)return en(F,"no renditions with default or auto-select sound found"),D;if(c&&F.indexOf(c.substring(0,4))%5!==0)return en(F,`audio codec preference "${c}" not found`),D;if(u&&!d){if(!B.channels[u])return en(F,`no renditions with ${u} channel sound found (channels options: ${Object.keys(B.channels)})`),D}else if((!c||d)&&h&&B.channels[2]===0)return en(F,"no renditions with stereo sound found"),D;return B.minHeight>O?(en(F,`min resolution of ${B.minHeight} > maximum of ${O}`),D):B.minFramerate>_?(en(F,`min framerate of ${B.minFramerate} > maximum of ${_}`),D):E.some(M=>B.videoRanges[M]>0)?B.maxScore<S?(en(F,`max score of ${B.maxScore} < selected max of ${S}`),D):D&&(Eo(F)>=Eo(D)||B.fragmentError>r[D].fragmentError)?D:(S=B.maxScore,F):(en(F,`no variants with VIDEO-RANGE of ${JSON.stringify(E)} found`),D)},void 0),videoRanges:E,preferHDR:b,minFramerate:v,minBitrate:x}}function en(r,e){Y.log(`[abr] start candidates with "${r}" ignored because ${e}`)}function _A(r){return r.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const a=t.channels||"2";return n.channels[a]=(n.channels[a]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function DA(r,e,t,n){return r.slice(t,n+1).reduce((a,l)=>{if(!l.codecSet)return a;const u=l.audioGroups;let c=a[l.codecSet];c||(a[l.codecSet]=c={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),c.minBitrate=Math.min(c.minBitrate,l.bitrate);const d=Math.min(l.height,l.width);return c.minHeight=Math.min(c.minHeight,d),c.minFramerate=Math.min(c.minFramerate,l.frameRate),c.maxScore=Math.max(c.maxScore,l.score),c.fragmentError+=l.fragmentError,c.videoRanges[l.videoRange]=(c.videoRanges[l.videoRange]||0)+1,u&&u.forEach(h=>{if(!h)return;const g=e.groups[h];g&&(c.hasDefaultAudio=c.hasDefaultAudio||e.hasDefaultAudio?g.hasDefault:g.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(g.channels).forEach(p=>{c.channels[p]=(c.channels[p]||0)+g.channels[p]}))}),a},{})}function Oi(r,e,t){if("attrs"in r){const n=e.indexOf(r);if(n!==-1)return n}for(let n=0;n<e.length;n++){const a=e[n];if(ds(r,a,t))return n}return-1}function ds(r,e,t){const{groupId:n,name:a,lang:l,assocLang:u,default:c}=r,d=r.forced;return(n===void 0||e.groupId===n)&&(a===void 0||e.name===a)&&(l===void 0||e.lang===l)&&(l===void 0||e.assocLang===u)&&(c===void 0||e.default===c)&&(d===void 0||e.forced===d)&&(!("characteristics"in r)||CA(r.characteristics||"",e.characteristics))&&(t===void 0||t(r,e))}function CA(r,e=""){const t=r.split(","),n=e.split(",");return t.length===n.length&&!t.some(a=>n.indexOf(a)===-1)}function as(r,e){const{audioCodec:t,channels:n}=r;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function wA(r,e,t,n,a){const l=e[n],c=e.reduce((v,x,S)=>{const E=x.uri;return(v[E]||(v[E]=[])).push(S),v},{})[l.uri];c.length>1&&(n=Math.max.apply(Math,c));const d=l.videoRange,h=l.frameRate,g=l.codecSet.substring(0,4),p=Np(e,n,v=>{if(v.videoRange!==d||v.frameRate!==h||v.codecSet.substring(0,4)!==g)return!1;const x=v.audioGroups,S=t.filter(E=>!x||x.indexOf(E.groupId)!==-1);return Oi(r,S,a)>-1});return p>-1?p:Np(e,n,v=>{const x=v.audioGroups,S=t.filter(E=>!x||x.indexOf(E.groupId)!==-1);return Oi(r,S,a)>-1})}function Np(r,e,t){for(let n=e;n>-1;n--)if(t(r[n]))return n;for(let n=e+1;n<r.length;n++)if(t(r[n]))return n;return-1}class OA{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:n,hls:a}=this,{autoLevelEnabled:l,media:u}=a;if(!t||!u)return;const c=performance.now(),d=n?n.stats:t.stats,h=n?n.duration:t.duration,g=c-d.loading.start,p=a.minAutoLevel;if(d.aborted||d.loaded&&d.loaded===d.total||t.level<=p){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l||u.paused||!u.playbackRate||!u.readyState)return;const v=a.mainForwardBufferInfo;if(v===null)return;const x=this.bwEstimator.getEstimateTTFB(),S=Math.abs(u.playbackRate);if(g<=Math.max(x,1e3*(h/(S*2))))return;const E=v.len/S,b=d.loading.first?d.loading.first-d.loading.start:-1,A=d.loaded&&b>-1,O=this.getBwEstimate(),_=a.levels,k=_[t.level],D=d.total||Math.max(d.loaded,Math.round(h*k.averageBitrate/8));let F=A?g-b:g;F<1&&A&&(F=Math.min(g,d.loaded*8/O));const B=A?d.loaded*1e3/F:0,M=B?(D-d.loaded)/B:D*8/O+x/1e3;if(M<=E)return;const I=B?B*8:O;let N=Number.POSITIVE_INFINITY,U;for(U=t.level-1;U>p;U--){const Z=_[U].maxBitrate;if(N=this.getTimeToLoadFrag(x/1e3,I,h*Z,!_[U].details),N<E)break}if(N>=M||N>h*10)return;a.nextLoadLevel=a.nextAutoLevel=U,A?this.bwEstimator.sample(g-Math.min(x,b),d.loaded):this.bwEstimator.sampleTTFB(g);const Q=_[U].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>Q&&this.resetEstimator(Q),this.clearTimer(),Y.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${E.toFixed(3)} s
      Estimated load time for current fragment: ${M.toFixed(3)} s
      Estimated load time for down switch fragment: ${N.toFixed(3)} s
      TTFB estimate: ${b|0} ms
      Current BW estimate: ${ge(O)?O|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${U} @ ${Q|0} bps`),a.trigger(R.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:d})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(Y.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new SA(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(R.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var a;this.fragCurrent=n,this.partCurrent=(a=t.part)!=null?a:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case te.BUFFER_ADD_CODEC_ERROR:case te.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case te.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:a,partCurrent:l}=this;if(n&&a&&n.sn===a.sn&&n.level===a.level){const u=performance.now(),c=l?l.stats:n.stats,d=u-c.loading.start,h=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&h>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(p,h),c.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(e,t,n,a){const l=e+n/t,u=a?this.lastLevelLoadSec:0;return l+u}onLevelLoaded(e,t){const n=this.hls.config,{loading:a}=t.stats,l=a.end-a.start;ge(l)&&(this.lastLevelLoadSec=l/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const a=n?n.stats:t.stats;if(t.type===Se.MAIN&&this.bwEstimator.sampleTTFB(a.loading.first-a.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const l=n?n.duration:t.duration,u=this.hls.levels[t.level],c=(u.loaded?u.loaded.bytes:0)+a.loaded,d=(u.loaded?u.loaded.duration:0)+l;u.loaded={bytes:c,duration:d},u.realBitrate=Math.round(8*c/d)}if(t.bitrateTest){const l={stats:a,frag:t,part:n,id:t.type};this.onFragBuffered(R.FRAG_BUFFERED,l),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:a}=t,l=a!=null&&a.stats.loaded?a.stats:n.stats;if(l.aborted||this.ignoreFragment(n))return;const u=l.parsing.end-l.loading.start-Math.min(l.loading.first-l.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(u,l.loaded),l.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=u/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Se.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),a=this.hls.config.maxStarvationDelay,l=this.findBestLevel(n,t,e,0,a,1,1);if(l>-1)return l;const u=this.hls.firstLevel,c=Math.min(Math.max(u,t),e);return Y.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${u} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),a=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!a||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const l=n&&a?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const u=this.hls.levels;if(u.length>Math.max(e,l)&&u[e].loadError<=u[l].loadError)return e}return this._nextAutoLevel=l,this.nextAutoLevelKey=this.getAutoLevelKey(),l}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:a,config:l,minAutoLevel:u}=n,c=t?t.duration:e?e.duration:0,d=this.getBwEstimate(),h=this.getStarvationDelay();let g=l.abrBandWidthFactor,p=l.abrBandWidthUpFactor;if(h){const b=this.findBestLevel(d,u,a,h,0,g,p);if(b>=0)return b}let v=c?Math.min(c,l.maxStarvationDelay):l.maxStarvationDelay;if(!h){const b=this.bitrateTestDelay;b&&(v=(c?Math.min(c,l.maxLoadingDelay):l.maxLoadingDelay)-b,Y.info(`[abr] bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*v)} ms`),g=p=1)}const x=this.findBestLevel(d,u,a,h,v,g,p);if(Y.info(`[abr] ${h?"rebuffering expected":"buffer is empty"}, optimal quality level ${x}`),x>-1)return x;const S=n.levels[u],E=n.levels[n.loadLevel];return(S==null?void 0:S.bitrate)<(E==null?void 0:E.bitrate)?u:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,a=e.mainForwardBufferInfo;return(a?a.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,a,l,u,c){var d;const h=a+l,g=this.lastLoadedFragLevel,p=g===-1?this.hls.firstLevel:g,{fragCurrent:v,partCurrent:x}=this,{levels:S,allAudioTracks:E,loadLevel:b,config:A}=this.hls;if(S.length===1)return 0;const O=S[p],_=!!(O!=null&&(d=O.details)!=null&&d.live),k=b===-1||g===-1;let D,F="SDR",B=(O==null?void 0:O.frameRate)||0;const{audioPreference:M,videoPreference:I}=A,N=this.audioTracksByGroup||(this.audioTracksByGroup=_A(E));if(k){if(this.firstSelection!==-1)return this.firstSelection;const X=this.codecTiers||(this.codecTiers=DA(S,N,t,n)),$=LA(X,F,e,M,I),{codecSet:oe,videoRanges:le,minFramerate:z,minBitrate:C,preferHDR:H}=$;D=oe,F=H?le[le.length-1]:le[0],B=z,e=Math.max(e,C),Y.log(`[abr] picked start tier ${JSON.stringify($)}`)}else D=O==null?void 0:O.codecSet,F=O==null?void 0:O.videoRange;const U=x?x.duration:v?v.duration:0,Q=this.bwEstimator.getEstimateTTFB()/1e3,Z=[];for(let X=n;X>=t;X--){var V;const $=S[X],oe=X>p;if(!$)continue;if(A.useMediaCapabilities&&!$.supportedResult&&!$.supportedPromise){const se=navigator.mediaCapabilities;typeof(se==null?void 0:se.decodingInfo)=="function"&&EA($,N,F,B,e,M)?($.supportedPromise=TA($,N,se),$.supportedPromise.then(de=>{if(!this.hls)return;$.supportedResult=de;const fe=this.hls.levels,Ae=fe.indexOf($);de.error?Y.warn(`[abr] MediaCapabilities decodingInfo error: "${de.error}" for level ${Ae} ${JSON.stringify(de)}`):de.supported||(Y.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${Ae} ${JSON.stringify(de)}`),Ae>-1&&fe.length>1&&(Y.log(`[abr] Removing unsupported level ${Ae}`),this.hls.removeLevel(Ae)))})):$.supportedResult=uv}if(D&&$.codecSet!==D||F&&$.videoRange!==F||oe&&B>$.frameRate||!oe&&B>0&&B<$.frameRate||$.supportedResult&&!((V=$.supportedResult.decodingInfoResults)!=null&&V[0].smooth)){Z.push(X);continue}const le=$.details,z=(x?le==null?void 0:le.partTarget:le==null?void 0:le.averagetargetduration)||U;let C;oe?C=c*e:C=u*e;const H=U&&a>=U*2&&l===0?S[X].averageBitrate:S[X].maxBitrate,ee=this.getTimeToLoadFrag(Q,C,H*z,le===void 0);if(C>=H&&(X===g||$.loadError===0&&$.fragmentError===0)&&(ee<=Q||!ge(ee)||_&&!this.bitrateTestDelay||ee<h)){const se=this.forcedAutoLevel;return X!==b&&(se===-1||se!==b)&&(Z.length&&Y.trace(`[abr] Skipped level(s) ${Z.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${S[Z[0]].codecs}" ${S[Z[0]].videoRange}; not compatible with "${O.codecs}" ${F}`),Y.info(`[abr] switch candidate:${p}->${X} adjustedbw(${Math.round(C)})-bitrate=${Math.round(C-H)} ttfb:${Q.toFixed(1)} avgDuration:${z.toFixed(1)} maxFetchDuration:${h.toFixed(1)} fetchDuration:${ee.toFixed(1)} firstSelection:${k} codecSet:${D} videoRange:${F} hls.loadLevel:${b}`)),k&&(this.firstSelection=X),X}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,a=Math.min(Math.max(e,n),t);this._nextAutoLevel!==a&&(this.nextAutoLevelKey="",this._nextAutoLevel=a)}}class IA{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var yt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class kA{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(R.BUFFER_APPENDED,this.onBufferAppended,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.BUFFER_APPENDED,this.onBufferAppended,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let a=n.length;a--;){const l=n[a];if(!l)break;const u=l.end;if(l.start<=e&&u!==null&&e<=u)return l}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,a=Object.keys(n);for(let l=a.length;l--;){const u=n[a[l]];if((u==null?void 0:u.body.type)===t&&u.buffered){const c=u.body;if(c.start<=e&&e<=c.end)return c}}return null}detectEvictedFragments(e,t,n,a){this.timeRanges&&(this.timeRanges[e]=t);const l=(a==null?void 0:a.fragment.sn)||-1;Object.keys(this.fragments).forEach(u=>{const c=this.fragments[u];if(!c||l>=c.body.sn)return;if(!c.buffered&&!c.loaded){c.body.type===n&&this.removeFragment(c.body);return}const d=c.range[e];d&&d.time.some(h=>{const g=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return g&&this.removeFragment(c.body),g})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:a}=e;if(!t||n.sn==="initSegment")return;const l=Ws(n),u=this.fragments[l];if(!u||u.buffered&&n.gap)return;const c=!n.relurl;Object.keys(t).forEach(d=>{const h=n.elementaryStreams[d];if(!h)return;const g=t[d],p=c||h.partial===!0;u.range[d]=this.getBufferedTimes(n,a,p,g)}),u.loaded=null,Object.keys(u.range).length?(u.buffered=!0,(u.body.endList=n.endList||u.body.endList)&&(this.endListFragments[u.body.type]=u),$l(u)||this.removeParts(n.sn-1,n.type)):this.removeFragment(u.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(a=>a.fragment.sn>=e))}fragBuffered(e,t){const n=Ws(e);let a=this.fragments[n];!a&&t&&(a=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),a&&(a.loaded=null,a.buffered=!0)}getBufferedTimes(e,t,n,a){const l={time:[],partial:n},u=e.start,c=e.end,d=e.minEndPTS||c,h=e.maxStartPTS||u;for(let g=0;g<a.length;g++){const p=a.start(g)-this.bufferPadding,v=a.end(g)+this.bufferPadding;if(h>=p&&d<=v){l.time.push({startPTS:Math.max(u,a.start(g)),endPTS:Math.min(c,a.end(g))});break}else if(u<v&&c>p){const x=Math.max(u,a.start(g)),S=Math.min(c,a.end(g));S>x&&(l.partial=!0,l.time.push({startPTS:x,endPTS:S}))}else if(c<=p)break}return l}getPartialFragment(e){let t=null,n,a,l,u=0;const{bufferPadding:c,fragments:d}=this;return Object.keys(d).forEach(h=>{const g=d[h];g&&$l(g)&&(a=g.body.start-c,l=g.body.end+c,e>=a&&e<=l&&(n=Math.min(e-a,l-e),u<=n&&(t=g.body,u=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||$l(t))}getState(e){const t=Ws(e),n=this.fragments[t];return n?n.buffered?$l(n)?yt.PARTIAL:yt.OK:yt.APPENDING:yt.NOT_LOADED}isTimeBuffered(e,t,n){let a,l;for(let u=0;u<n.length;u++){if(a=n.start(u)-this.bufferPadding,l=n.end(u)+this.bufferPadding,e>=a&&t<=l)return!0;if(t<=a)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:a}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const l=a?null:t,u=Ws(n);this.fragments[u]={body:n,appendedPTS:null,loaded:l,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:a,timeRanges:l}=t;if(n.sn==="initSegment")return;const u=n.type;if(a){let c=this.activePartLists[u];c||(this.activePartLists[u]=c=[]),c.push(a)}this.timeRanges=l,Object.keys(l).forEach(c=>{const d=l[c];this.detectEvictedFragments(c,d,u,a)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Ws(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,a,l){a&&!this.hasGaps||Object.keys(this.fragments).forEach(u=>{const c=this.fragments[u];if(!c)return;const d=c.body;d.type!==n||a&&!d.gap||d.start<t&&d.end>e&&(c.buffered||l)&&this.removeFragment(d)})}removeFragment(e){const t=Ws(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const a=e.sn;this.activePartLists[e.type]=n.filter(l=>l.fragment.sn!==a)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function $l(r){var e,t,n;return r.buffered&&(r.body.gap||((e=r.range.video)==null?void 0:e.partial)||((t=r.range.audio)==null?void 0:t.partial)||((n=r.range.audiovideo)==null?void 0:n.partial))}function Ws(r){return`${r.type}_${r.level}_${r.sn}`}const MA={length:0,start:()=>0,end:()=>0};class Ke{static isBuffered(e,t){try{if(e){const n=Ke.getBuffered(e);for(let a=0;a<n.length;a++)if(t>=n.start(a)&&t<=n.end(a))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const a=Ke.getBuffered(e),l=[];let u;for(u=0;u<a.length;u++)l.push({start:a.start(u),end:a.end(u)});return this.bufferedInfo(l,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(h,g){const p=h.start-g.start;return p||g.end-h.end});let a=[];if(n)for(let h=0;h<e.length;h++){const g=a.length;if(g){const p=a[g-1].end;e[h].start-p<n?e[h].end>p&&(a[g-1].end=e[h].end):a.push(e[h])}else a.push(e[h])}else a=e;let l=0,u,c=t,d=t;for(let h=0;h<a.length;h++){const g=a[h].start,p=a[h].end;if(t+n>=g&&t<p)c=g,d=p,l=d-t;else if(t+n<g){u=g;break}}return{len:l,start:c||0,end:d||0,nextStart:u}}static getBuffered(e){try{return e.buffered}catch(t){return Y.log("failed to get media.buffered",t),MA}}}class Rd{constructor(e,t,n,a=0,l=-1,u=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Vl(),this.buffering={audio:Vl(),video:Vl(),audiovideo:Vl()},this.level=e,this.sn=t,this.id=n,this.size=a,this.part=l,this.partial=u}}function Vl(){return{start:0,executeStart:0,executeEnd:0,end:0}}function io(r,e){for(let n=0,a=r.length;n<a;n++){var t;if(((t=r[n])==null?void 0:t.cc)===e)return r[n]}return null}function NA(r,e,t){return!!(e&&(t.endCC>t.startCC||r&&r.cc<t.startCC))}function PA(r,e){const t=r.fragments,n=e.fragments;if(!n.length||!t.length){Y.log("No fragments to align");return}const a=io(t,n[0].cc);if(!a||a&&!a.startPTS){Y.log("No frag in previous level to align on");return}return a}function Pp(r,e){if(r){const t=r.start+e;r.start=r.startPTS=t,r.endPTS=t+r.duration}}function cv(r,e){const t=e.fragments;for(let n=0,a=t.length;n<a;n++)Pp(t[n],r);e.fragmentHint&&Pp(e.fragmentHint,r),e.alignedSliding=!0}function UA(r,e,t){e&&(FA(r,t,e),!t.alignedSliding&&e&&_o(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&rv(e,t))}function FA(r,e,t){if(NA(r,t,e)){const n=PA(t,e);n&&ge(n.start)&&(Y.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),cv(n.start,e))}}function _o(r,e){if(!r.hasProgramDateTime||!e.hasProgramDateTime)return;const t=r.fragments,n=e.fragments;if(!t.length||!n.length)return;let a,l;const u=Math.min(e.endCC,r.endCC);e.startCC<u&&r.startCC<u&&(a=io(n,u),l=io(t,u)),(!a||!l)&&(a=n[Math.floor(n.length/2)],l=io(t,a.cc)||t[Math.floor(t.length/2)]);const c=a.programDateTime,d=l.programDateTime;if(!c||!d)return;const h=(d-c)/1e3-(l.start-a.start);cv(h,r)}const Up=Math.pow(2,17);class BA{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new nn({type:Te.NETWORK_ERROR,details:te.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const a=this.config,l=a.fLoader,u=a.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(x=>x[0]==="GAP")){d(Bp(e));return}else e.gap=!1;const h=this.loader=e.loader=l?new l(a):new u(a),g=Fp(e),p=kp(a.fragLoadPolicy.default),v={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Up};e.stats=h.stats,h.load(g,v,{onSuccess:(x,S,E,b)=>{this.resetLoader(e,h);let A=x.data;E.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(A.slice(0,16)),A=A.slice(16)),c({frag:e,part:null,payload:A,networkDetails:b})},onError:(x,S,E,b)=>{this.resetLoader(e,h),d(new nn({type:Te.NETWORK_ERROR,details:te.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:vt({url:n,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:E,stats:b}))},onAbort:(x,S,E)=>{this.resetLoader(e,h),d(new nn({type:Te.NETWORK_ERROR,details:te.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:E,stats:x}))},onTimeout:(x,S,E)=>{this.resetLoader(e,h),d(new nn({type:Te.NETWORK_ERROR,details:te.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:E,stats:x}))},onProgress:(x,S,E,b)=>{t&&t({frag:e,part:null,payload:E,networkDetails:b})}})})}loadPart(e,t,n){this.abort();const a=this.config,l=a.fLoader,u=a.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){d(Bp(e,t));return}const h=this.loader=e.loader=l?new l(a):new u(a),g=Fp(e,t),p=kp(a.fragLoadPolicy.default),v={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Up};t.stats=h.stats,h.load(g,v,{onSuccess:(x,S,E,b)=>{this.resetLoader(e,h),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:x.data,networkDetails:b};n(A),c(A)},onError:(x,S,E,b)=>{this.resetLoader(e,h),d(new nn({type:Te.NETWORK_ERROR,details:te.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:vt({url:g.url,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:E,stats:b}))},onAbort:(x,S,E)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,h),d(new nn({type:Te.NETWORK_ERROR,details:te.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:E,stats:x}))},onTimeout:(x,S,E)=>{this.resetLoader(e,h),d(new nn({type:Te.NETWORK_ERROR,details:te.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:E,stats:x}))}})})}updateStatsFromPart(e,t){const n=e.stats,a=t.stats,l=a.total;if(n.loaded+=a.loaded,l){const d=Math.round(e.duration/t.duration),h=Math.min(Math.round(n.loaded/l),d),p=(d-h)*Math.round(n.loaded/h);n.total=n.loaded+p}else n.total=Math.max(n.loaded,n.total);const u=n.loading,c=a.loading;u.start?u.first+=c.first-c.start:(u.start=c.start,u.first=c.first),u.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Fp(r,e=null){const t=e||r,n={frag:r,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},a=t.byteRangeStartOffset,l=t.byteRangeEndOffset;if(ge(a)&&ge(l)){var u;let c=a,d=l;if(r.sn==="initSegment"&&((u=r.decryptdata)==null?void 0:u.method)==="AES-128"){const h=l-a;h%16&&(d=l+(16-h%16)),a!==0&&(n.resetIV=!0,c=a-16)}n.rangeStart=c,n.rangeEnd=d}return n}function Bp(r,e){const t=new Error(`GAP ${r.gap?"tag":"attribute"} found`),n={type:Te.MEDIA_ERROR,details:te.FRAG_GAP,fatal:!1,frag:r,error:t,networkDetails:null};return e&&(n.part=e),(e||r).stats.aborted=!0,new nn(n)}class nn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class jA{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class GA{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function HA(r){const e=r.byteLength,t=e&&new DataView(r.buffer).getUint8(e-1);return t?fs(r,0,e-t):r}class $A{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let a=0;a<4;a++)n[a]=t.getUint32(a*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,a=n[0],l=n[1],u=n[2],c=n[3],d=this.invSubMix,h=d[0],g=d[1],p=d[2],v=d[3],x=new Uint32Array(256);let S=0,E=0,b=0;for(b=0;b<256;b++)b<128?x[b]=b<<1:x[b]=b<<1^283;for(b=0;b<256;b++){let A=E^E<<1^E<<2^E<<3^E<<4;A=A>>>8^A&255^99,e[S]=A,t[A]=S;const O=x[S],_=x[O],k=x[_];let D=x[A]*257^A*16843008;a[S]=D<<24|D>>>8,l[S]=D<<16|D>>>16,u[S]=D<<8|D>>>24,c[S]=D,D=k*16843009^_*65537^O*257^S*16843008,h[A]=D<<24|D>>>8,g[A]=D<<16|D>>>16,p[A]=D<<8|D>>>24,v[A]=D,S?(S=O^x[x[x[k^O]]],E^=x[x[E]]):S=E=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,a=0;for(;a<t.length&&n;)n=t[a]===this.key[a],a++;if(n)return;this.key=t;const l=this.keySize=t.length;if(l!==4&&l!==6&&l!==8)throw new Error("Invalid aes key size="+l);const u=this.ksRows=(l+6+1)*4;let c,d;const h=this.keySchedule=new Uint32Array(u),g=this.invKeySchedule=new Uint32Array(u),p=this.sBox,v=this.rcon,x=this.invSubMix,S=x[0],E=x[1],b=x[2],A=x[3];let O,_;for(c=0;c<u;c++){if(c<l){O=h[c]=t[c];continue}_=O,c%l===0?(_=_<<8|_>>>24,_=p[_>>>24]<<24|p[_>>>16&255]<<16|p[_>>>8&255]<<8|p[_&255],_^=v[c/l|0]<<24):l>6&&c%l===4&&(_=p[_>>>24]<<24|p[_>>>16&255]<<16|p[_>>>8&255]<<8|p[_&255]),h[c]=O=(h[c-l]^_)>>>0}for(d=0;d<u;d++)c=u-d,d&3?_=h[c]:_=h[c-4],d<4||c<=4?g[d]=_:g[d]=S[p[_>>>24]]^E[p[_>>>16&255]]^b[p[_>>>8&255]]^A[p[_&255]],g[d]=g[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const a=this.keySize+6,l=this.invKeySchedule,u=this.invSBox,c=this.invSubMix,d=c[0],h=c[1],g=c[2],p=c[3],v=this.uint8ArrayToUint32Array_(n);let x=v[0],S=v[1],E=v[2],b=v[3];const A=new Int32Array(e),O=new Int32Array(A.length);let _,k,D,F,B,M,I,N,U,Q,Z,V,X,$;const oe=this.networkToHostOrderSwap;for(;t<A.length;){for(U=oe(A[t]),Q=oe(A[t+1]),Z=oe(A[t+2]),V=oe(A[t+3]),B=U^l[0],M=V^l[1],I=Z^l[2],N=Q^l[3],X=4,$=1;$<a;$++)_=d[B>>>24]^h[M>>16&255]^g[I>>8&255]^p[N&255]^l[X],k=d[M>>>24]^h[I>>16&255]^g[N>>8&255]^p[B&255]^l[X+1],D=d[I>>>24]^h[N>>16&255]^g[B>>8&255]^p[M&255]^l[X+2],F=d[N>>>24]^h[B>>16&255]^g[M>>8&255]^p[I&255]^l[X+3],B=_,M=k,I=D,N=F,X=X+4;_=u[B>>>24]<<24^u[M>>16&255]<<16^u[I>>8&255]<<8^u[N&255]^l[X],k=u[M>>>24]<<24^u[I>>16&255]<<16^u[N>>8&255]<<8^u[B&255]^l[X+1],D=u[I>>>24]<<24^u[N>>16&255]<<16^u[B>>8&255]<<8^u[M&255]^l[X+2],F=u[N>>>24]<<24^u[B>>16&255]<<16^u[M>>8&255]<<8^u[I&255]^l[X+3],O[t]=oe(_^x),O[t+1]=oe(F^S),O[t+2]=oe(D^E),O[t+3]=oe(k^b),x=U,S=Q,E=Z,b=V,t=t+4}return O.buffer}}const VA=16;class Ld{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?HA(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((a,l)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const u=this.flush();u?a(u.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:a,currentResult:l,remainderData:u}=this;this.logOnce("JS AES decrypt"),u&&(e=ci(u,e),this.remainderData=null);const c=this.getValidChunk(e);if(!c.length)return null;a&&(n=a);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new $A),d.expandKey(t);const h=l;return this.currentResult=d.decrypt(c.buffer,0,n),this.currentIV=fs(c,-16).buffer,h||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new GA(this.subtle,t)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new jA(this.subtle,new Uint8Array(n)).decrypt(e.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(Y.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const a=this.flush();if(a)return a.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%VA;return n!==e.length&&(t=fs(e,0,n),this.remainderData=fs(e,n)),t}logOnce(e){this.logEnabled&&(Y.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const zA={toString:function(r){let e="";const t=r.length;for(let n=0;n<t;n++)e+=`[${r.start(n).toFixed(3)}-${r.end(n).toFixed(3)}]`;return e}},ue={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class _d extends IA{constructor(e,t,n,a,l){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ue.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=l,this.logPrefix=a,this.log=Y.log.bind(Y,`${a}:`),this.warn=Y.warn.bind(Y,`${a}:`),this.hls=e,this.fragmentLoader=new BA(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Ld(e.config),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ue.STOPPED}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const l=n[n.length-1];return Ke.isBuffered(this.media,l.start+l.duration/2)}const a=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(a)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const a=this.config;this.levels&&a.autoStartLoad&&this.state===ue.STOPPED&&this.startLoad(a.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:a,state:l}=this,u=n?n.currentTime:0,c=Ke.bufferInfo(a||n,u,e.maxBufferHole);if(this.log(`media seeking to ${ge(u)?u.toFixed(3):u}, state: ${l}`),this.state===ue.ENDED)this.resetLoadingState();else if(t){const d=e.maxFragLookUpTolerance,h=t.start-d,g=t.start+t.duration+d;if(!c.len||g<c.start||h>c.end){const p=u>g;(u<h||p)&&(p&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(u,1/0,this.playlistType,!0),this.lastCurrentTime=u),!this.loadedmetadata&&!c.len&&(this.nextLoadPosition=this.startPosition=u),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=ue.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const a=l=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${l.part?" p: "+l.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(l)};this._doFragLoad(e,t,n,a).then(l=>{if(!l)return;const u=this.state;if(this.fragContextChanged(e)){(u===ue.FRAG_LOADING||!this.fragCurrent&&u===ue.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=ue.IDLE);return}"payload"in l&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(R.FRAG_LOADED,l)),this._handleFragmentLoadComplete(l)}).catch(l=>{this.state===ue.STOPPED||this.state===ue.ERROR||(this.warn(`Frag error: ${(l==null?void 0:l.message)||l}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===yt.APPENDING){const l=e.type,u=this.getFwdBufferInfo(this.mediaBuffer,l),c=Math.max(e.duration,u?u.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?e.sn-d.sn:0)===1||this.reduceMaxBufferLength(c,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===yt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const a={startOffset:e,endOffset:t,type:n};this.hls.trigger(R.BUFFER_FLUSHING,a)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:a}=this,{payload:l}=n,u=e.decryptdata;if(l&&l.byteLength>0&&u!=null&&u.key&&u.iv&&u.method==="AES-128"){const c=self.performance.now();return this.decrypter.decrypt(new Uint8Array(l),u.key.buffer,u.iv.buffer).catch(d=>{throw a.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:e}),d}).then(d=>{const h=self.performance.now();return a.trigger(R.FRAG_DECRYPTED,{frag:e,payload:d,stats:{tstart:c,tdecrypt:h}}),n.payload=d,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===ue.STOPPED||this.state===ue.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=ue.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,a,l,u;const c=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Se.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((a=e.endPTS)!=null?a:NaN).toFixed(3)}] > buffer:${c?zA.toString(Ke.getBuffered(c)):"(detached)"})`),e.sn!=="initSegment"){var d;if(e.type!==Se.SUBTITLE){const g=e.elementaryStreams;if(!Object.keys(g).some(p=>!!g[p])){this.state=ue.IDLE;return}}const h=(d=this.levels)==null?void 0:d[e.level];h!=null&&h.fragmentError&&(this.log(`Resetting level fragment error count of ${h.fragmentError} on frag buffered`),h.fragmentError=0)}this.state=ue.IDLE,c&&(!this.loadedmetadata&&e.type==Se.MAIN&&c.buffered.length&&((l=this.fragCurrent)==null?void 0:l.sn)===((u=this.fragPrevious)==null?void 0:u.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:a,partsLoaded:l}=e,u=!l||l.length===0||l.some(d=>!d),c=new Rd(n.level,n.sn,n.stats.chunkCount+1,0,a?a.index:-1,!u);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,a){var l;const u=t==null?void 0:t.details;if(!this.levels||!u)throw new Error(`frag load aborted, missing level${u?"":" detail"}s`);let c=null;if(e.encrypted&&!((l=e.decryptdata)!=null&&l.key)?(this.log(`Loading key for ${e.sn} of [${u.startSN}-${u.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=ue.KEY_LOADING,this.fragCurrent=e,c=this.keyLoader.load(e).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(R.KEY_LOADED,g),this.state===ue.KEY_LOADING&&(this.state=ue.IDLE),g}),this.hls.trigger(R.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(c=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&u.encryptedFragments.length&&this.keyLoader.loadClear(e,u.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const g=u.partList;if(g&&a){n>e.end&&u.fragmentHint&&(e=u.fragmentHint);const p=this.getNextPart(g,e,n);if(p>-1){const v=g[p];this.log(`Loading part sn: ${e.sn} p: ${v.index} cc: ${e.cc} of playlist [${u.startSN}-${u.endSN}] parts [0-${p}-${g.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=ue.FRAG_LOADING;let x;return c?x=c.then(S=>!S||this.fragContextChanged(S.frag)?null:this.doFragPartsLoad(e,v,t,a)).catch(S=>this.handleFragLoadError(S)):x=this.doFragPartsLoad(e,v,t,a).catch(S=>this.handleFragLoadError(S)),this.hls.trigger(R.FRAG_LOADING,{frag:e,part:v,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}else if(!e.url||this.loadedEndOfParts(g,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${u?"of ["+u.startSN+"-"+u.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),ge(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ue.FRAG_LOADING;const d=this.config.progressive;let h;return d&&c?h=c.then(g=>!g||this.fragContextChanged(g==null?void 0:g.frag)?null:this.fragmentLoader.load(e,a)).catch(g=>this.handleFragLoadError(g)):h=Promise.all([this.fragmentLoader.load(e,d?a:void 0),c]).then(([g])=>(!d&&g&&a&&a(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(R.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):h}doFragPartsLoad(e,t,n,a){return new Promise((l,u)=>{var c;const d=[],h=(c=n.details)==null?void 0:c.partList,g=p=>{this.fragmentLoader.loadPart(e,p,a).then(v=>{d[p.index]=v;const x=v.part;this.hls.trigger(R.FRAG_LOADED,v);const S=Op(n,e.sn,p.index+1)||av(h,e.sn,p.index+1);if(S)g(S);else return l({frag:e,part:x,partsLoaded:d})}).catch(u)};g(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===te.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(R.ERROR,t)}else this.hls.trigger(R.ERROR,{type:Te.OTHER_ERROR,details:te.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ue.PARSING){!this.fragCurrent&&this.state!==ue.STOPPED&&this.state!==ue.ERROR&&(this.state=ue.IDLE);return}const{frag:n,part:a,level:l}=t,u=self.performance.now();n.stats.parsing.end=u,a&&(a.stats.parsing.end=u),this.updateLevelTiming(n,a,l,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:a,sn:l,part:u}=e;if(!(t!=null&&t[a]))return this.warn(`Levels object was unset while buffering fragment ${l} of level ${a}. The current chunk will not be buffered.`),null;const c=t[a],d=u>-1?Op(c,l,u):null,h=d?d.fragment:hA(c,l,n);return h?(n&&n!==h&&(h.stats=n.stats),{frag:h,part:d,level:c}):null}bufferFragmentData(e,t,n,a,l){var u;if(!e||this.state!==ue.PARSING)return;const{data1:c,data2:d}=e;let h=c;if(c&&d&&(h=ci(c,d)),!((u=h)!=null&&u.length))return;const g={type:e.type,frag:t,part:n,chunkMeta:a,parent:t.type,data:h};if(this.hls.trigger(R.BUFFER_APPENDING,g),e.dropped&&e.independent&&!n){if(l)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ke.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,a=Ke.bufferInfo(t,n,0),l=e.duration,u=Math.min(this.config.maxFragLookUpTolerance*2,l*.25),c=Math.max(Math.min(e.start-u,a.end-u),n+u);e.start-c>u&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return ge(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:a}}=this,l=Ke.bufferInfo(e,t,a);if(l.len===0&&l.nextStart!==void 0){const u=this.fragmentTracker.getBufferedFrag(t,n);if(u&&l.nextStart<u.end)return Ke.bufferInfo(e,t,Math.max(l.nextStart,a))}return l}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,a=Math.max(Math.min(e-t,n.maxBufferLength),t),l=Math.max(e-t*3,n.maxMaxBufferLength/2,a);return l>=a?(n.maxMaxBufferLength=l,this.warn(`Reduce max buffer length to ${l}s`),!0):!1}getAppendedFrag(e,t=Se.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,Se.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,a=n.length;if(!a)return null;const{config:l}=this,u=n[0].start;let c;if(t.live){const d=l.initialLiveManifestSize;if(a<d)return this.warn(`Not enough fragments to start playback (have: ${a}, need: ${d})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<u)&&(c=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=c?this.hls.liveSyncPosition||c.start:e)}else e<=u&&(c=n[0]);if(!c){const d=l.lowLatencyMode?t.partEnd:t.fragmentEnd;c=this.getFragmentAtPosition(e,d,t)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===yt.OK||n===yt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,a,l){const u=e.gap,c=this.getNextFragment(this.nextLoadPosition,t);if(c===null)return c;if(e=c,u&&e&&!e.gap&&n.nextStart){const d=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,a);if(d!==null&&n.len+d.len>=l)return this.log(`buffer full after gaps in "${a}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let a=-1,l=!1,u=!0;for(let c=0,d=e.length;c<d;c++){const h=e[c];if(u=u&&!h.independent,a>-1&&n<h.start)break;const g=h.loaded;g?a=-1:(l||h.independent||u)&&h.fragment===t&&(a=c),l=g}return a}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let a=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),a=gA(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!a){const l=n.sn+1;if(l>=e.startSN&&l<=e.endSN){const u=t[l-e.startSN];n.cc===u.cc&&(a=u,this.log(`Live playlist, switching playlist, load frag with next SN: ${a.sn}`))}a||(a=vA(t,n.cc),a&&this.log(`Live playlist, switching playlist, load frag with same CC: ${a.sn}`))}}else{const l=this.hls.liveSyncPosition;l!==null&&(a=this.getFragmentAtPosition(l,this.bitrateTest?e.fragmentEnd:e.edge,e))}return a}getFragmentAtPosition(e,t,n){const{config:a}=this;let{fragPrevious:l}=this,{fragments:u,endSN:c}=n;const{fragmentHint:d}=n,{maxFragLookUpTolerance:h}=a,g=n.partList,p=!!(a.lowLatencyMode&&g!=null&&g.length&&d);p&&d&&!this.bitrateTest&&(u=u.concat(d),c=d.sn);let v;if(e<t){const x=e>t-h?0:h;v=Lo(l,u,e,x)}else v=u[u.length-1];if(v){const x=v.sn-n.startSN,S=this.fragmentTracker.getState(v);if((S===yt.OK||S===yt.PARTIAL&&v.gap)&&(l=v),l&&v.sn===l.sn&&(!p||g[0].fragment.sn>v.sn)&&l&&v.level===l.level){const b=u[x+1];v.sn<c&&this.fragmentTracker.getState(b)!==yt.OK?v=b:v=null}}return v}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const a=this.hls.liveSyncPosition,l=n.currentTime,u=e.fragments[0].start,c=e.edge,d=l>=u-t.maxFragLookUpTolerance&&l<=c;if(a!==null&&n.duration>a&&(l<a||!d)){const h=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!d&&n.readyState<4||l<c-h)&&(this.loadedmetadata||(this.nextLoadPosition=a),n.readyState&&(this.warn(`Playback: ${l.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${a.toFixed(3)}`),n.currentTime=a))}}alignPlaylists(e,t,n){const a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;const l=e.fragments[0].start,u=!t,c=e.alignedSliding&&ge(l);if(u||!c&&!l){const{fragPrevious:d}=this;UA(d,n,e);const h=e.fragments[0].start;return this.log(`Live playlist sliding: ${h.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${d?d.sn:"na"} fragments: ${a}`),h}return l}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const a=this.startTimeOffset!==null,l=a?this.startTimeOffset:e.startTimeOffset;l!==null&&ge(l)?(n=t+l,l<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${l} found in ${a?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ue.FRAG_LOADING_WAITING_RETRY)&&(this.state=ue.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const g=this.getCurrentContext(t.chunkMeta);g&&(t.frag=g.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var a;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(a=this.fragCurrent)==null?void 0:a.url}`);return}const l=t.details===te.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(n,!0);const u=t.errorAction,{action:c,retryCount:d=0,retryConfig:h}=u||{};if(u&&c===At.RetryRequest&&h){this.resetStartWhenNotLoaded(this.levelLastLoaded);const g=bd(h,d);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${d+1}/${h.maxNumRetry} in ${g}ms`),u.resolved=!0,this.retryDate=self.performance.now()+g,this.state=ue.FRAG_LOADING_WAITING_RETRY}else if(h&&u)if(this.resetFragmentErrors(e),d<h.maxNumRetry)!l&&c!==At.RemoveAlternatePermanently&&(u.resolved=!0);else{Y.warn(`${t.details} reached or exceeded max retry (${d})`);return}else(u==null?void 0:u.action)===At.SendAlternateToPenaltyBox?this.state=ue.WAITING_LEVEL:this.state=ue.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===ue.PARSING||this.state===ue.PARSED){const t=e.frag,n=e.parent,a=this.getFwdBufferInfo(this.mediaBuffer,n),l=a&&a.len>.5;l&&this.reduceMaxBufferLength(a.len,(t==null?void 0:t.duration)||10);const u=!l;return u&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),u}return!1}resetFragmentErrors(e){e===Se.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==ue.STOPPED&&(this.state=ue.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const a=Ke.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,a,n),this.state===ue.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=ue.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,a){var l;const u=n.details;if(!u){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((d,h)=>{const g=e.elementaryStreams[h];if(g){const p=g.endPTS-g.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${e.sn} ${h} duration reliably (${p})`),d||!1;const v=a?0:sv(u,e,g.startPTS,g.endPTS,g.startDTS,g.endDTS);return this.hls.trigger(R.LEVEL_PTS_UPDATED,{details:u,level:n,drift:v,type:h,frag:e,start:g.startPTS,end:g.endPTS}),!0}return d},!1)&&((l=this.transmuxer)==null?void 0:l.error)===null){const d=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(d.message),this.hls.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=ue.PARSED,this.hls.trigger(R.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class fv{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=KA(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function KA(r,e){const t=new Uint8Array(e);let n=0;for(let a=0;a<r.length;a++){const l=r[a];t.set(l,n),n+=l.length}return t}function YA(){return typeof __HLS_WORKER_BUNDLE__=="function"}function qA(){const r=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(r);return{worker:new self.Worker(e),objectURL:e}}function XA(r){const e=new self.URL(r,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function Ci(r="",e=9e4){return{type:r,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Dd{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,a){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=ci(this.cachedData,e),this.cachedData=null);let n=va(e,0),a=n?n.length:0,l;const u=this._audioTrack,c=this._id3Track,d=n?Td(n):void 0,h=e.length;for((this.basePTS===null||this.frameIndex===0&&ge(d))&&(this.basePTS=WA(d,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:vi.audioId3,duration:Number.POSITIVE_INFINITY});a<h;){if(this.canParse(e,a)){const g=this.appendFrame(u,e,a);g?(this.frameIndex++,this.lastPTS=g.sample.pts,a+=g.length,l=a):a=h}else y1(e,a)?(n=va(e,a),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:vi.audioId3,duration:Number.POSITIVE_INFINITY}),a+=n.length,l=a):a++;if(a===h&&l!==h){const g=fs(e,l);this.cachedData?this.cachedData=ci(this.cachedData,g):this.cachedData=g}}return{audioTrack:u,videoTrack:Ci(),id3Track:c,textTrack:Ci()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Ci(),id3Track:this._id3Track,textTrack:Ci()}}destroy(){}}const WA=(r,e,t)=>{if(ge(r))return r*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function QA(r,e,t,n){let a,l,u,c;const d=navigator.userAgent.toLowerCase(),h=n,g=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((e[t+2]&192)>>>6)+1;const p=(e[t+2]&60)>>>2;if(p>g.length-1){const v=new Error(`invalid ADTS sampling index:${p}`);r.emit(R.ERROR,R.ERROR,{type:Te.MEDIA_ERROR,details:te.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}return u=(e[t+2]&1)<<2,u|=(e[t+3]&192)>>>6,Y.log(`manifest codec:${n}, ADTS type:${a}, samplingIndex:${p}`),/firefox/i.test(d)?p>=6?(a=5,c=new Array(4),l=p-3):(a=2,c=new Array(2),l=p):d.indexOf("android")!==-1?(a=2,c=new Array(2),l=p):(a=5,c=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&p>=6?l=p-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(p>=6&&u===1||/vivaldi/i.test(d))||!n&&u===1)&&(a=2,c=new Array(2)),l=p)),c[0]=a<<3,c[0]|=(p&14)>>1,c[1]|=(p&1)<<7,c[1]|=u<<3,a===5&&(c[1]|=(l&14)>>1,c[2]=(l&1)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:g[p],channelCount:u,codec:"mp4a.40."+a,manifestCodec:h}}function dv(r,e){return r[e]===255&&(r[e+1]&246)===240}function hv(r,e){return r[e+1]&1?7:9}function Cd(r,e){return(r[e+3]&3)<<11|r[e+4]<<3|(r[e+5]&224)>>>5}function ZA(r,e){return e+5<r.length}function Do(r,e){return e+1<r.length&&dv(r,e)}function JA(r,e){return ZA(r,e)&&dv(r,e)&&Cd(r,e)<=r.length-e}function eR(r,e){if(Do(r,e)){const t=hv(r,e);if(e+t>=r.length)return!1;const n=Cd(r,e);if(n<=t)return!1;const a=e+n;return a===r.length||Do(r,a)}return!1}function mv(r,e,t,n,a){if(!r.samplerate){const l=QA(e,t,n,a);if(!l)return;r.config=l.config,r.samplerate=l.samplerate,r.channelCount=l.channelCount,r.codec=l.codec,r.manifestCodec=l.manifestCodec,Y.log(`parsed codec:${r.codec}, rate:${l.samplerate}, channels:${l.channelCount}`)}}function gv(r){return 1024*9e4/r}function tR(r,e){const t=hv(r,e);if(e+t<=r.length){const n=Cd(r,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function pv(r,e,t,n,a){const l=gv(r.samplerate),u=n+a*l,c=tR(e,t);let d;if(c){const{frameLength:p,headerLength:v}=c,x=v+p,S=Math.max(0,t+x-e.length);S?(d=new Uint8Array(x-v),d.set(e.subarray(t+v,e.length),0)):d=e.subarray(t+v,t+x);const E={unit:d,pts:u};return S||r.samples.push(E),{sample:E,length:x,missing:S}}const h=e.length-t;return d=new Uint8Array(h),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:u},length:h,missing:-1}}let zl=null;const iR=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],nR=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],sR=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],rR=[0,1,1,4];function yv(r,e,t,n,a){if(t+24>e.length)return;const l=vv(e,t);if(l&&t+l.frameLength<=e.length){const u=l.samplesPerFrame*9e4/l.sampleRate,c=n+a*u,d={unit:e.subarray(t,t+l.frameLength),pts:c,dts:c};return r.config=[],r.channelCount=l.channelCount,r.samplerate=l.sampleRate,r.samples.push(d),{sample:d,length:l.frameLength,missing:0}}}function vv(r,e){const t=r[e+1]>>3&3,n=r[e+1]>>1&3,a=r[e+2]>>4&15,l=r[e+2]>>2&3;if(t!==1&&a!==0&&a!==15&&l!==3){const u=r[e+2]>>1&1,c=r[e+3]>>6,d=t===3?3-n:n===3?3:4,h=iR[d*14+a-1]*1e3,p=nR[(t===3?0:t===2?1:2)*3+l],v=c===3?1:2,x=sR[t][n],S=rR[n],E=x*8*S,b=Math.floor(x*h/p+u)*S;if(zl===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);zl=_?parseInt(_[1]):0}return!!zl&&zl<=87&&n===2&&h>=224e3&&c===0&&(r[e+3]=r[e+3]|128),{sampleRate:p,channelCount:v,frameLength:b,samplesPerFrame:E}}}function wd(r,e){return r[e]===255&&(r[e+1]&224)===224&&(r[e+1]&6)!==0}function xv(r,e){return e+1<r.length&&wd(r,e)}function aR(r,e){return wd(r,e)&&4<=r.length-e}function Sv(r,e){if(e+1<r.length&&wd(r,e)){const n=vv(r,e);let a=4;n!=null&&n.frameLength&&(a=n.frameLength);const l=e+a;return l===r.length||xv(r,l)}return!1}class lR extends Dd{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,a){super.resetInitSegment(e,t,n,a),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=va(e,0);let n=(t==null?void 0:t.length)||0;if(Sv(e,n))return!1;for(let a=e.length;n<a;n++)if(eR(e,n))return Y.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return JA(e,t)}appendFrame(e,t,n){mv(e,this.observer,t,n,e.manifestCodec);const a=pv(e,t,n,this.basePTS,this.frameIndex);if(a&&a.missing===0)return a}}const oR=/\/emsg[-/]ID3/i;class uR{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,a){const l=this.videoTrack=Ci("video",1),u=this.audioTrack=Ci("audio",1),c=this.txtTrack=Ci("text",1);if(this.id3Track=Ci("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=Wy(e);if(d.video){const{id:h,timescale:g,codec:p}=d.video;l.id=h,l.timescale=c.timescale=g,l.codec=p}if(d.audio){const{id:h,timescale:g,codec:p}=d.audio;u.id=h,u.timescale=g,u.codec=p}c.id=Yy.text,l.sampleDuration=0,l.duration=u.duration=a}resetContiguity(){this.remainderData=null}static probe(e){return L1(e)}demux(e,t){this.timeOffset=t;let n=e;const a=this.videoTrack,l=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=ci(this.remainderData,e));const c=M1(n);this.remainderData=c.remainder,a.samples=c.valid||new Uint8Array}else a.samples=n;const u=this.extractID3Track(a,t);return l.samples=dp(t,a),{videoTrack:a,audioTrack:this.audioTrack,id3Track:u,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const a=this.extractID3Track(t,this.timeOffset);return n.samples=dp(e,t),{videoTrack:t,audioTrack:Ci(),id3Track:a,textTrack:Ci()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const a=Le(e.samples,["emsg"]);a&&a.forEach(l=>{const u=U1(l);if(oR.test(u.schemeIdUri)){const c=ge(u.presentationTime)?u.presentationTime/u.timeScale:t+u.presentationTimeDelta/u.timeScale;let d=u.eventDuration===4294967295?Number.POSITIVE_INFINITY:u.eventDuration/u.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const h=u.payload;n.samples.push({data:h,len:h.byteLength,dts:c,pts:c,type:vi.emsg,duration:d})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const Ev=(r,e)=>{let t=0,n=5;e+=n;const a=new Uint32Array(1),l=new Uint32Array(1),u=new Uint8Array(1);for(;n>0;){u[0]=r[e];const c=Math.min(n,8),d=8-c;l[0]=4278190080>>>24+d<<d,a[0]=(u[0]&l[0])>>d,t=t?t<<c|a[0]:a[0],e+=1,n-=c}return t};class cR extends Dd{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,a){super.resetInitSegment(e,t,n,a),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const a=Tv(e,t,n,this.basePTS,this.frameIndex);if(a!==-1)return{sample:e.samples[e.samples.length-1],length:a,missing:0}}static probe(e){if(!e)return!1;const t=va(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&Td(t)!==void 0&&Ev(e,n)<16}}function Tv(r,e,t,n,a){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const l=e[t+4]>>6;if(l>=3)return-1;const c=[48e3,44100,32e3][l],d=e[t+4]&63,g=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+l]*2;if(t+g>e.length)return-1;const p=e[t+6]>>5;let v=0;p===2?v+=2:(p&1&&p!==1&&(v+=2),p&4&&(v+=2));const x=(e[t+6]<<8|e[t+7])>>12-v&1,E=[2,1,2,3,3,4,4,5][p]+x,b=e[t+5]>>3,A=e[t+5]&7,O=new Uint8Array([l<<6|b<<1|A>>2,(A&3)<<6|p<<3|x<<2|d>>4,d<<4&224]),_=1536/c*9e4,k=n+a*_,D=e.subarray(t,t+g);return r.config=O,r.channelCount=E,r.samplerate=c,r.samples.push({unit:D,pts:k}),g}class fR{constructor(){this.VideoSample=null}createVideoSample(e,t,n,a){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:a,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,a;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const l=n.units;a=l[l.length-1]}return a}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,a=n.length;if(a){const l=n[a-1];e.pts=l.pts,e.dts=l.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&Y.log(e.pts+"/"+e.dts+":"+e.debug)}}class jp{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,a=new Uint8Array(4),l=Math.min(4,t);if(l===0)throw new Error("no bytes available");a.set(e.subarray(n,n+l)),this.word=new DataView(a.buffer).getUint32(0),this.bitsAvailable=l*8,this.bytesAvailable-=l}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&Y.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,a;for(let l=0;l<e;l++)n!==0&&(a=this.readEG(),n=(t+a+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,a=0,l,u,c;const d=this.readUByte.bind(this),h=this.readBits.bind(this),g=this.readUEG.bind(this),p=this.readBoolean.bind(this),v=this.skipBits.bind(this),x=this.skipEG.bind(this),S=this.skipUEG.bind(this),E=this.skipScalingList.bind(this);d();const b=d();if(h(5),v(3),d(),S(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){const F=g();if(F===3&&v(1),S(),S(),v(1),p())for(u=F!==3?8:12,c=0;c<u;c++)p()&&(c<6?E(16):E(64))}S();const A=g();if(A===0)g();else if(A===1)for(v(1),x(),x(),l=g(),c=0;c<l;c++)x();S(),v(1);const O=g(),_=g(),k=h(1);k===0&&v(1),v(1),p()&&(e=g(),t=g(),n=g(),a=g());let D=[1,1];if(p()&&p())switch(d()){case 1:D=[1,1];break;case 2:D=[12,11];break;case 3:D=[10,11];break;case 4:D=[16,11];break;case 5:D=[40,33];break;case 6:D=[24,11];break;case 7:D=[20,11];break;case 8:D=[32,11];break;case 9:D=[80,33];break;case 10:D=[18,11];break;case 11:D=[15,11];break;case 12:D=[64,33];break;case 13:D=[160,99];break;case 14:D=[4,3];break;case 15:D=[3,2];break;case 16:D=[2,1];break;case 255:{D=[d()<<8|d(),d()<<8|d()];break}}return{width:Math.ceil((O+1)*16-e*2-t*2),height:(2-k)*(_+1)*16-(k?2:4)*(n+a),pixelRatio:D}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class dR extends fR{parseAVCPES(e,t,n,a,l){const u=this.parseAVCNALu(e,n.data);let c=this.VideoSample,d,h=!1;n.data=null,c&&u.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),u.forEach(g=>{var p;switch(g.type){case 1:{let E=!1;d=!0;const b=g.data;if(h&&b.length>4){const A=new jp(b).readSliceType();(A===2||A===4||A===7||A===9)&&(E=!0)}if(E){var v;(v=c)!=null&&v.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),c.frame=!0,c.key=E;break}case 5:d=!0,(p=c)!=null&&p.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),c.key=!0,c.frame=!0;break;case 6:{d=!0,Zy(g.data,1,n.pts,t.samples);break}case 7:{var x,S;d=!0,h=!0;const E=g.data,A=new jp(E).readSPS();if(!e.sps||e.width!==A.width||e.height!==A.height||((x=e.pixelRatio)==null?void 0:x[0])!==A.pixelRatio[0]||((S=e.pixelRatio)==null?void 0:S[1])!==A.pixelRatio[1]){e.width=A.width,e.height=A.height,e.pixelRatio=A.pixelRatio,e.sps=[E],e.duration=l;const O=E.subarray(1,4);let _="avc1.";for(let k=0;k<3;k++){let D=O[k].toString(16);D.length<2&&(D="0"+D),_+=D}e.codec=_}break}case 8:d=!0,e.pps=[g.data];break;case 9:d=!0,e.audFound=!0,c&&this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:d=!0;break;default:d=!1,c&&(c.debug+="unknown NAL "+g.type+" ");break}c&&d&&c.units.push(g)}),a&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let a=e.naluState||0;const l=a,u=[];let c=0,d,h,g,p=-1,v=0;for(a===-1&&(p=0,v=t[0]&31,a=0,c=1);c<n;){if(d=t[c++],!a){a=d?0:1;continue}if(a===1){a=d?0:2;continue}if(!d)a=3;else if(d===1){if(h=c-a-1,p>=0){const x={data:t.subarray(p,h),type:v};u.push(x)}else{const x=this.getLastNalUnit(e.samples);x&&(l&&c<=4-l&&x.state&&(x.data=x.data.subarray(0,x.data.byteLength-l)),h>0&&(x.data=ci(x.data,t.subarray(0,h)),x.state=0))}c<n?(g=t[c]&31,p=c,v=g,a=0):a=-1}else a=0}if(p>=0&&a>=0){const x={data:t.subarray(p,n),type:v,state:a};u.push(x)}if(u.length===0){const x=this.getLastNalUnit(e.samples);x&&(x.data=ci(x.data,t))}return e.naluState=a,u}}class hR{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Ld(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const a=e[t].unit;if(a.length<=16)return;const l=a.subarray(16,a.length-a.length%16),u=l.buffer.slice(l.byteOffset,l.byteOffset+l.length);this.decryptBuffer(u).then(c=>{const d=new Uint8Array(c);a.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let a=0;for(let l=32;l<e.length-16;l+=160,a+=16)n.set(e.subarray(l,l+16),a);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let a=0;for(let l=32;l<e.length-16;l+=160,a+=16)e.set(n.subarray(a,a+16),l);return e}decryptAvcSample(e,t,n,a,l){const u=Jy(l.data),c=this.getAvcEncryptedData(u);this.decryptBuffer(c.buffer).then(d=>{l.data=this.getAvcDecryptedUnit(u,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,a)})}decryptAvcSamples(e,t,n,a){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){a();return}const l=e[t].units;for(;!(n>=l.length);n++){const u=l[n];if(!(u.data.length<=48||u.type!==1&&u.type!==5)&&(this.decryptAvcSample(e,t,n,a,u),!this.decrypter.isSync()))return}}}}const pt=188;class kn{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new dR}static probe(e){const t=kn.syncOffset(e);return t>0&&Y.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(pt*5,t-pt)+1,a=0;for(;a<n;){let l=!1,u=-1,c=0;for(let d=a;d<t;d+=pt)if(e[d]===71&&(t-d===pt||e[d+pt]===71)){if(c++,u===-1&&(u=d,u!==0&&(n=Math.min(u+pt*99,e.length-pt)+1)),l||(l=sd(e,d)===0),l&&c>1&&(u===0&&c>2||d+pt>n))return u}else{if(c)return-1;break}a++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Yy[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,a){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=kn.createTrack("video"),this._audioTrack=kn.createTrack("audio",a),this._id3Track=kn.createTrack("id3"),this._txtTrack=kn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=a}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,a=!1){n||(this.sampleAes=null);let l;const u=this._videoTrack,c=this._audioTrack,d=this._id3Track,h=this._txtTrack;let g=u.pid,p=u.pesData,v=c.pid,x=d.pid,S=c.pesData,E=d.pesData,b=null,A=this.pmtParsed,O=this._pmtId,_=e.length;if(this.remainderData&&(e=ci(this.remainderData,e),_=e.length,this.remainderData=null),_<pt&&!a)return this.remainderData=e,{audioTrack:c,videoTrack:u,id3Track:d,textTrack:h};const k=Math.max(0,kn.syncOffset(e));_-=(_-k)%pt,_<e.byteLength&&!a&&(this.remainderData=new Uint8Array(e.buffer,_,e.buffer.byteLength-_));let D=0;for(let B=k;B<_;B+=pt)if(e[B]===71){const M=!!(e[B+1]&64),I=sd(e,B),N=(e[B+3]&48)>>4;let U;if(N>1){if(U=B+5+e[B+4],U===B+pt)continue}else U=B+4;switch(I){case g:M&&(p&&(l=Qs(p))&&this.videoParser.parseAVCPES(u,h,l,!1,this._duration),p={data:[],size:0}),p&&(p.data.push(e.subarray(U,B+pt)),p.size+=B+pt-U);break;case v:if(M){if(S&&(l=Qs(S)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,l);break;case"mp3":this.parseMPEGPES(c,l);break;case"ac3":this.parseAC3PES(c,l);break}S={data:[],size:0}}S&&(S.data.push(e.subarray(U,B+pt)),S.size+=B+pt-U);break;case x:M&&(E&&(l=Qs(E))&&this.parseID3PES(d,l),E={data:[],size:0}),E&&(E.data.push(e.subarray(U,B+pt)),E.size+=B+pt-U);break;case 0:M&&(U+=e[U]+1),O=this._pmtId=mR(e,U);break;case O:{M&&(U+=e[U]+1);const Q=gR(e,U,this.typeSupported,n,this.observer);g=Q.videoPid,g>0&&(u.pid=g,u.segmentCodec=Q.segmentVideoCodec),v=Q.audioPid,v>0&&(c.pid=v,c.segmentCodec=Q.segmentAudioCodec),x=Q.id3Pid,x>0&&(d.pid=x),b!==null&&!A&&(Y.warn(`MPEG-TS PMT found at ${B} after unknown PID '${b}'. Backtracking to sync byte @${k} to parse all TS packets.`),b=null,B=k-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=I;break}}else D++;D>0&&Co(this.observer,new Error(`Found ${D} TS packet/s that do not start with 0x47`)),u.pesData=p,c.pesData=S,d.pesData=E;const F={audioTrack:c,videoTrack:u,id3Track:d,textTrack:h};return a&&this.extractRemainingSamples(F),F}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:a,textTrack:l}=e,u=n.pesData,c=t.pesData,d=a.pesData;let h;if(u&&(h=Qs(u))?(this.videoParser.parseAVCPES(n,l,h,!0,this._duration),n.pesData=null):n.pesData=u,c&&(h=Qs(c))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,h);break;case"mp3":this.parseMPEGPES(t,h);break;case"ac3":this.parseAC3PES(t,h);break}t.pesData=null}else c!=null&&c.size&&Y.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;d&&(h=Qs(d))?(this.parseID3PES(a,h),a.pesData=null):a.pesData=d}demuxSampleAes(e,t,n){const a=this.demux(e,n,!0,!this.config.progressive),l=this.sampleAes=new hR(this.observer,this.config,t);return this.decrypt(a,l)}decrypt(e,t){return new Promise(n=>{const{audioTrack:a,videoTrack:l}=e;a.samples&&a.segmentCodec==="aac"?t.decryptAacSamples(a.samples,0,()=>{l.samples?t.decryptAvcSamples(l.samples,0,0,()=>{n(e)}):n(e)}):l.samples&&t.decryptAvcSamples(l.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const a=this.aacOverFlow;let l=t.data;if(a){this.aacOverFlow=null;const p=a.missing,v=a.sample.unit.byteLength;if(p===-1)l=ci(a.sample.unit,l);else{const x=v-p;a.sample.unit.set(l.subarray(0,p),x),e.samples.push(a.sample),n=a.missing}}let u,c;for(u=n,c=l.length;u<c-1&&!Do(l,u);u++);if(u!==n){let p;const v=u<c-1;if(v?p=`AAC PES did not start with ADTS header,offset:${u}`:p="No ADTS header found in AAC PES",Co(this.observer,new Error(p),v),!v)return}mv(e,this.observer,l,u,this.audioCodec);let d;if(t.pts!==void 0)d=t.pts;else if(a){const p=gv(e.samplerate);d=a.sample.pts+p}else{Y.warn("[tsdemuxer]: AAC PES unknown PTS");return}let h=0,g;for(;u<c;)if(g=pv(e,l,u,d,h),u+=g.length,g.missing){this.aacOverFlow=g;break}else for(h++;u<c-1&&!Do(l,u);u++);}parseMPEGPES(e,t){const n=t.data,a=n.length;let l=0,u=0;const c=t.pts;if(c===void 0){Y.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;u<a;)if(xv(n,u)){const d=yv(e,n,u,c,l);if(d)u+=d.length,l++;else break}else u++}parseAC3PES(e,t){{const n=t.data,a=t.pts;if(a===void 0){Y.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const l=n.length;let u=0,c=0,d;for(;c<l&&(d=Tv(e,n,c,a,u++))>0;)c+=d}}parseID3PES(e,t){if(t.pts===void 0){Y.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=lt({},t,{type:this._videoTrack?vi.emsg:vi.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function sd(r,e){return((r[e+1]&31)<<8)+r[e+2]}function mR(r,e){return(r[e+10]&31)<<8|r[e+11]}function gR(r,e,t,n,a){const l={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(r[e+1]&15)<<8|r[e+2],c=e+3+u-4,d=(r[e+10]&15)<<8|r[e+11];for(e+=12+d;e<c;){const h=sd(r,e),g=(r[e+3]&15)<<8|r[e+4];switch(r[e]){case 207:if(!n){kf("ADTS AAC");break}case 15:l.audioPid===-1&&(l.audioPid=h);break;case 21:l.id3Pid===-1&&(l.id3Pid=h);break;case 219:if(!n){kf("H.264");break}case 27:l.videoPid===-1&&(l.videoPid=h,l.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?Y.log("MPEG audio found, not supported in this browser"):l.audioPid===-1&&(l.audioPid=h,l.segmentAudioCodec="mp3");break;case 193:if(!n){kf("AC-3");break}case 129:t.ac3?l.audioPid===-1&&(l.audioPid=h,l.segmentAudioCodec="ac3"):Y.log("AC-3 audio found, not supported in this browser");break;case 6:if(l.audioPid===-1&&g>0){let p=e+5,v=g;for(;v>2;){switch(r[p]){case 106:t.ac3!==!0?Y.log("AC-3 audio found, not supported in this browser for now"):(l.audioPid=h,l.segmentAudioCodec="ac3");break}const S=r[p+1]+2;p+=S,v-=S}}break;case 194:case 135:return Co(a,new Error("Unsupported EC-3 in M2TS found")),l;case 36:return Co(a,new Error("Unsupported HEVC in M2TS found")),l}e+=g+5}return l}function Co(r,e,t){Y.warn(`parsing error: ${e.message}`),r.emit(R.ERROR,R.ERROR,{type:Te.MEDIA_ERROR,details:te.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function kf(r){Y.log(`${r} with AES-128-CBC encryption found in unencrypted stream`)}function Qs(r){let e=0,t,n,a,l,u;const c=r.data;if(!r||r.size===0)return null;for(;c[0].length<19&&c.length>1;)c[0]=ci(c[0],c[1]),c.splice(1,1);if(t=c[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>r.size-6)return null;const h=t[7];h&192&&(l=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,h&64?(u=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,l-u>60*9e4&&(Y.warn(`${Math.round((l-u)/9e4)}s delta between PTS and DTS, align them`),l=u)):u=l),a=t[8];let g=a+9;if(r.size<=g)return null;r.size-=g;const p=new Uint8Array(r.size);for(let v=0,x=c.length;v<x;v++){t=c[v];let S=t.byteLength;if(g)if(g>S){g-=S;continue}else t=t.subarray(g),S-=g,g=0;p.set(t,e),e+=S}return n&&(n-=a+3),{data:p,pts:l,dts:u,len:n}}return null}class pR extends Dd{resetInitSegment(e,t,n,a){super.resetInitSegment(e,t,n,a),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:a,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=va(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&Td(t)!==void 0&&Ev(e,n)<=16)return!1;for(let a=e.length;n<a;n++)if(Sv(e,n))return Y.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return aR(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return yv(e,t,n,this.basePTS,this.frameIndex)}}class Gp{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const In=Math.pow(2,32)-1;class W{static init(){W.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in W.types)W.types.hasOwnProperty(e)&&(W.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);W.HDLR_TYPES={video:t,audio:n};const a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),l=new Uint8Array([0,0,0,0,0,0,0,0]);W.STTS=W.STSC=W.STCO=l,W.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),W.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),W.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),W.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const u=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);W.FTYP=W.box(W.types.ftyp,u,d,u,c),W.DINF=W.box(W.types.dinf,W.box(W.types.dref,a))}static box(e,...t){let n=8,a=t.length;const l=a;for(;a--;)n+=t[a].byteLength;const u=new Uint8Array(n);for(u[0]=n>>24&255,u[1]=n>>16&255,u[2]=n>>8&255,u[3]=n&255,u.set(e,4),a=0,n=8;a<l;a++)u.set(t[a],n),n+=t[a].byteLength;return u}static hdlr(e){return W.box(W.types.hdlr,W.HDLR_TYPES[e])}static mdat(e){return W.box(W.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(In+1)),a=Math.floor(t%(In+1));return W.box(W.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,a>>24,a>>16&255,a>>8&255,a&255,85,196,0,0]))}static mdia(e){return W.box(W.types.mdia,W.mdhd(e.timescale,e.duration),W.hdlr(e.type),W.minf(e))}static mfhd(e){return W.box(W.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?W.box(W.types.minf,W.box(W.types.smhd,W.SMHD),W.DINF,W.stbl(e)):W.box(W.types.minf,W.box(W.types.vmhd,W.VMHD),W.DINF,W.stbl(e))}static moof(e,t,n){return W.box(W.types.moof,W.mfhd(e),W.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=W.trak(e[t]);return W.box.apply(null,[W.types.moov,W.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(W.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=W.trex(e[t]);return W.box.apply(null,[W.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(In+1)),a=Math.floor(t%(In+1)),l=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,a>>24,a>>16&255,a>>8&255,a&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return W.box(W.types.mvhd,l)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let a,l;for(a=0;a<t.length;a++)l=t[a].flags,n[a+4]=l.dependsOn<<4|l.isDependedOn<<2|l.hasRedundancy;return W.box(W.types.sdtp,n)}static stbl(e){return W.box(W.types.stbl,W.stsd(e),W.box(W.types.stts,W.STTS),W.box(W.types.stsc,W.STSC),W.box(W.types.stsz,W.STSZ),W.box(W.types.stco,W.STCO))}static avc1(e){let t=[],n=[],a,l,u;for(a=0;a<e.sps.length;a++)l=e.sps[a],u=l.byteLength,t.push(u>>>8&255),t.push(u&255),t=t.concat(Array.prototype.slice.call(l));for(a=0;a<e.pps.length;a++)l=e.pps[a],u=l.byteLength,n.push(u>>>8&255),n.push(u&255),n=n.concat(Array.prototype.slice.call(l));const c=W.box(W.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),d=e.width,h=e.height,g=e.pixelRatio[0],p=e.pixelRatio[1];return W.box(W.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,W.box(W.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),W.box(W.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return W.box(W.types.mp4a,W.audioStsd(e),W.box(W.types.esds,W.esds(e)))}static mp3(e){return W.box(W.types[".mp3"],W.audioStsd(e))}static ac3(e){return W.box(W.types["ac-3"],W.audioStsd(e),W.box(W.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?W.box(W.types.stsd,W.STSD,W.mp3(e)):e.segmentCodec==="ac3"?W.box(W.types.stsd,W.STSD,W.ac3(e)):W.box(W.types.stsd,W.STSD,W.mp4a(e)):W.box(W.types.stsd,W.STSD,W.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,a=e.width,l=e.height,u=Math.floor(n/(In+1)),c=Math.floor(n%(In+1));return W.box(W.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,a&255,0,0,l>>8&255,l&255,0,0]))}static traf(e,t){const n=W.sdtp(e),a=e.id,l=Math.floor(t/(In+1)),u=Math.floor(t%(In+1));return W.box(W.types.traf,W.box(W.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255])),W.box(W.types.tfdt,new Uint8Array([1,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255])),W.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,W.box(W.types.trak,W.tkhd(e),W.mdia(e))}static trex(e){const t=e.id;return W.box(W.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],a=n.length,l=12+16*a,u=new Uint8Array(l);let c,d,h,g,p,v;for(t+=8+l,u.set([e.type==="video"?1:0,0,15,1,a>>>24&255,a>>>16&255,a>>>8&255,a&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),c=0;c<a;c++)d=n[c],h=d.duration,g=d.size,p=d.flags,v=d.cts,u.set([h>>>24&255,h>>>16&255,h>>>8&255,h&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,v>>>24&255,v>>>16&255,v>>>8&255,v&255],12+16*c);return W.box(W.types.trun,u)}static initSegment(e){W.types||W.init();const t=W.moov(e);return ci(W.FTYP,t)}}W.types=void 0;W.HDLR_TYPES=void 0;W.STTS=void 0;W.STSC=void 0;W.STCO=void 0;W.STSZ=void 0;W.VMHD=void 0;W.SMHD=void 0;W.STSD=void 0;W.FTYP=void 0;W.DINF=void 0;const bv=9e4;function Od(r,e,t=1,n=!1){const a=r*e*t;return n?Math.round(a):a}function yR(r,e,t=1,n=!1){return Od(r,e,1/t,n)}function ca(r,e=!1){return Od(r,1e3,1/bv,e)}function vR(r,e=1){return Od(r,bv,1/e)}const xR=10*1e3,Hp=1024,SR=1152,ER=1536;let Zs=null,Mf=null;class no{constructor(e,t,n,a=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,Zs===null){const u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Zs=u?parseInt(u[1]):0}if(Mf===null){const l=navigator.userAgent.match(/Safari\/(\d+)/i);Mf=l?parseInt(l[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){Y.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){Y.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){Y.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,a=e.reduce((l,u)=>{let c=u.pts,d=c-l;return d<-4294967296&&(t=!0,c=ui(c,n),d=c-l),d>0?l:c},n);return t&&Y.debug("PTS rollover detected"),a}remux(e,t,n,a,l,u,c,d){let h,g,p,v,x,S,E=l,b=l;const A=e.pid>-1,O=t.pid>-1,_=t.samples.length,k=e.samples.length>0,D=c&&_>0||_>1;if((!A||k)&&(!O||D)||this.ISGenerated||c){if(this.ISGenerated){var B,M,I,N;const V=this.videoTrackConfig;V&&(t.width!==V.width||t.height!==V.height||((B=t.pixelRatio)==null?void 0:B[0])!==((M=V.pixelRatio)==null?void 0:M[0])||((I=t.pixelRatio)==null?void 0:I[1])!==((N=V.pixelRatio)==null?void 0:N[1]))&&this.resetInitSegment()}else p=this.generateIS(e,t,l,u);const U=this.isVideoContiguous;let Q=-1,Z;if(D&&(Q=TR(t.samples),!U&&this.config.forceKeyFrameOnDiscontinuity))if(S=!0,Q>0){Y.warn(`[mp4-remuxer]: Dropped ${Q} out of ${_} video samples due to a missing keyframe`);const V=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(Q),t.dropped+=Q,b+=(t.samples[0].pts-V)/t.inputTimeScale,Z=b}else Q===-1&&(Y.warn(`[mp4-remuxer]: No keyframe found out of ${_} video samples`),S=!1);if(this.ISGenerated){if(k&&D){const V=this.getVideoStartPts(t.samples),$=(ui(e.samples[0].pts,V)-V)/t.inputTimeScale;E+=Math.max(0,$),b+=Math.max(0,-$)}if(k){if(e.samplerate||(Y.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),p=this.generateIS(e,t,l,u)),g=this.remuxAudio(e,E,this.isAudioContiguous,u,O||D||d===Se.AUDIO?b:void 0),D){const V=g?g.endPTS-g.startPTS:0;t.inputTimeScale||(Y.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),p=this.generateIS(e,t,l,u)),h=this.remuxVideo(t,b,U,V)}}else D&&(h=this.remuxVideo(t,b,U,0));h&&(h.firstKeyFrame=Q,h.independent=Q!==-1,h.firstKeyFramePTS=Z)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(x=Av(n,l,this._initPTS,this._initDTS)),a.samples.length&&(v=Rv(a,l,this._initPTS))),{audio:g,video:h,initSegment:p,independent:S,text:v,id3:x}}generateIS(e,t,n,a){const l=e.samples,u=t.samples,c=this.typeSupported,d={},h=this._initPTS;let g=!h||a,p="audio/mp4",v,x,S;if(g&&(v=x=1/0),e.config&&l.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":c.mpeg?(p="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}d.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):W.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(S=e.inputTimeScale,!h||S!==h.timescale?v=x=l[0].pts-Math.round(S*n):g=!1)}if(t.sps&&t.pps&&u.length){if(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:W.initSegment([t]),metadata:{width:t.width,height:t.height}},g)if(S=t.inputTimeScale,!h||S!==h.timescale){const E=this.getVideoStartPts(u),b=Math.round(S*n);x=Math.min(x,ui(u[0].dts,E)-b),v=Math.min(v,E-b)}else g=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,g?(this._initPTS={baseTime:v,timescale:S},this._initDTS={baseTime:x,timescale:S}):v=S=void 0,{tracks:d,initPTS:v,timescale:S}}remuxVideo(e,t,n,a){const l=e.inputTimeScale,u=e.samples,c=[],d=u.length,h=this._initPTS;let g=this.nextAvcDts,p=8,v=this.videoSampleDuration,x,S,E=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,A=!1;if(!n||g===null){const z=t*l,C=u[0].pts-ui(u[0].dts,u[0].pts);Zs&&g!==null&&Math.abs(z-C-g)<15e3?n=!0:g=z-C}const O=h.baseTime*l/h.timescale;for(let z=0;z<d;z++){const C=u[z];C.pts=ui(C.pts-O,g),C.dts=ui(C.dts-O,g),C.dts<u[z>0?z-1:z].dts&&(A=!0)}A&&u.sort(function(z,C){const H=z.dts-C.dts,ee=z.pts-C.pts;return H||ee}),x=u[0].dts,S=u[u.length-1].dts;const _=S-x,k=_?Math.round(_/(d-1)):v||e.inputTimeScale/30;if(n){const z=x-g,C=z>k,H=z<-1;if((C||H)&&(C?Y.warn(`AVC: ${ca(z,!0)} ms (${z}dts) hole between fragments detected at ${t.toFixed(3)}`):Y.warn(`AVC: ${ca(-z,!0)} ms (${z}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!H||g>=u[0].pts||Zs)){x=g;const ee=u[0].pts-z;if(C)u[0].dts=x,u[0].pts=ee;else for(let re=0;re<u.length&&!(u[re].dts>ee);re++)u[re].dts-=z,u[re].pts-=z;Y.log(`Video: Initial PTS/DTS adjusted: ${ca(ee,!0)}/${ca(x,!0)}, delta: ${ca(z,!0)} ms`)}}x=Math.max(0,x);let D=0,F=0,B=x;for(let z=0;z<d;z++){const C=u[z],H=C.units,ee=H.length;let re=0;for(let se=0;se<ee;se++)re+=H[se].data.length;F+=re,D+=ee,C.length=re,C.dts<B?(C.dts=B,B+=k/4|0||1):B=C.dts,E=Math.min(C.pts,E),b=Math.max(C.pts,b)}S=u[d-1].dts;const M=F+4*D+8;let I;try{I=new Uint8Array(M)}catch(z){this.observer.emit(R.ERROR,R.ERROR,{type:Te.MUX_ERROR,details:te.REMUX_ALLOC_ERROR,fatal:!1,error:z,bytes:M,reason:`fail allocating video mdat ${M}`});return}const N=new DataView(I.buffer);N.setUint32(0,M),I.set(W.types.mdat,4);let U=!1,Q=Number.POSITIVE_INFINITY,Z=Number.POSITIVE_INFINITY,V=Number.NEGATIVE_INFINITY,X=Number.NEGATIVE_INFINITY;for(let z=0;z<d;z++){const C=u[z],H=C.units;let ee=0;for(let de=0,fe=H.length;de<fe;de++){const Ae=H[de],me=Ae.data,be=Ae.data.byteLength;N.setUint32(p,be),p+=4,I.set(me,p),p+=be,ee+=4+be}let re;if(z<d-1)v=u[z+1].dts-C.dts,re=u[z+1].pts-C.pts;else{const de=this.config,fe=z>0?C.dts-u[z-1].dts:k;if(re=z>0?C.pts-u[z-1].pts:k,de.stretchShortVideoTrack&&this.nextAudioPts!==null){const Ae=Math.floor(de.maxBufferHole*l),me=(a?E+a*l:this.nextAudioPts)-C.pts;me>Ae?(v=me-fe,v<0?v=fe:U=!0,Y.log(`[mp4-remuxer]: It is approximately ${me/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=fe}else v=fe}const se=Math.round(C.pts-C.dts);Q=Math.min(Q,v),V=Math.max(V,v),Z=Math.min(Z,re),X=Math.max(X,re),c.push(new $p(C.key,v,ee,se))}if(c.length){if(Zs){if(Zs<70){const z=c[0].flags;z.dependsOn=2,z.isNonSync=0}}else if(Mf&&X-Z<V-Q&&k/V<.025&&c[0].cts===0){Y.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let z=x;for(let C=0,H=c.length;C<H;C++){const ee=z+c[C].duration,re=z+c[C].cts;if(C<H-1){const se=ee+c[C+1].cts;c[C].duration=se-re}else c[C].duration=C?c[C-1].duration:k;c[C].cts=0,z=ee}}}v=U||!v?k:v,this.nextAvcDts=g=S+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;const le={data1:W.moof(e.sequenceNumber++,x,lt({},e,{samples:c})),data2:I,startPTS:E/l,endPTS:(b+v)/l,startDTS:x/l,endDTS:g/l,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,le}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return SR;case"ac3":return ER;default:return Hp}}remuxAudio(e,t,n,a,l){const u=e.inputTimeScale,c=e.samplerate?e.samplerate:u,d=u/c,h=this.getSamplesPerFrame(e),g=h*d,p=this._initPTS,v=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,x=[],S=l!==void 0;let E=e.samples,b=v?0:8,A=this.nextAudioPts||-1;const O=t*u,_=p.baseTime*u/p.timescale;if(this.isAudioContiguous=n=n||E.length&&A>0&&(a&&Math.abs(O-A)<9e3||Math.abs(ui(E[0].pts-_,O)-A)<20*g),E.forEach(function($){$.pts=ui($.pts-_,O)}),!n||A<0){if(E=E.filter($=>$.pts>=0),!E.length)return;l===0?A=0:a&&!S?A=Math.max(0,O):A=E[0].pts}if(e.segmentCodec==="aac"){const $=this.config.maxAudioFramesDrift;for(let oe=0,le=A;oe<E.length;oe++){const z=E[oe],C=z.pts,H=C-le,ee=Math.abs(1e3*H/u);if(H<=-$*g&&S)oe===0&&(Y.warn(`Audio frame @ ${(C/u).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*H/u)} ms.`),this.nextAudioPts=A=le=C);else if(H>=$*g&&ee<xR&&S){let re=Math.round(H/g);le=C-re*g,le<0&&(re--,le+=g),oe===0&&(this.nextAudioPts=A=le),Y.warn(`[mp4-remuxer]: Injecting ${re} audio frame @ ${(le/u).toFixed(3)}s due to ${Math.round(1e3*H/u)} ms gap.`);for(let se=0;se<re;se++){const de=Math.max(le,0);let fe=Gp.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);fe||(Y.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),fe=z.unit.subarray()),E.splice(oe,0,{unit:fe,pts:de}),le+=g,oe++}}z.pts=le,le+=g}}let k=null,D=null,F,B=0,M=E.length;for(;M--;)B+=E[M].unit.byteLength;for(let $=0,oe=E.length;$<oe;$++){const le=E[$],z=le.unit;let C=le.pts;if(D!==null){const ee=x[$-1];ee.duration=Math.round((C-D)/d)}else if(n&&e.segmentCodec==="aac"&&(C=A),k=C,B>0){B+=b;try{F=new Uint8Array(B)}catch(ee){this.observer.emit(R.ERROR,R.ERROR,{type:Te.MUX_ERROR,details:te.REMUX_ALLOC_ERROR,fatal:!1,error:ee,bytes:B,reason:`fail allocating audio mdat ${B}`});return}v||(new DataView(F.buffer).setUint32(0,B),F.set(W.types.mdat,4))}else return;F.set(z,b);const H=z.byteLength;b+=H,x.push(new $p(!0,h,H,0)),D=C}const I=x.length;if(!I)return;const N=x[x.length-1];this.nextAudioPts=A=D+d*N.duration;const U=v?new Uint8Array(0):W.moof(e.sequenceNumber++,k/d,lt({},e,{samples:x}));e.samples=[];const Q=k/u,Z=A/u,X={data1:U,data2:F,startPTS:Q,endPTS:Z,startDTS:Q,endDTS:Z,type:"audio",hasAudio:!0,hasVideo:!1,nb:I};return this.isAudioContiguous=!0,X}remuxEmptyAudio(e,t,n,a){const l=e.inputTimeScale,u=e.samplerate?e.samplerate:l,c=l/u,d=this.nextAudioPts,h=this._initDTS,g=h.baseTime*9e4/h.timescale,p=(d!==null?d:a.startDTS*l)+g,v=a.endDTS*l+g,x=c*Hp,S=Math.ceil((v-p)/x),E=Gp.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(Y.warn("[mp4-remuxer]: remux empty Audio"),!E){Y.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const b=[];for(let A=0;A<S;A++){const O=p+A*x;b.push({unit:E,pts:O,dts:O})}return e.samples=b,this.remuxAudio(e,t,n,!1)}}function ui(r,e){let t;if(e===null)return r;for(e<r?t=-8589934592:t=8589934592;Math.abs(r-e)>4294967296;)r+=t;return r}function TR(r){for(let e=0;e<r.length;e++)if(r[e].key)return e;return-1}function Av(r,e,t,n){const a=r.samples.length;if(!a)return;const l=r.inputTimeScale;for(let c=0;c<a;c++){const d=r.samples[c];d.pts=ui(d.pts-t.baseTime*l/t.timescale,e*l)/l,d.dts=ui(d.dts-n.baseTime*l/n.timescale,e*l)/l}const u=r.samples;return r.samples=[],{samples:u}}function Rv(r,e,t){const n=r.samples.length;if(!n)return;const a=r.inputTimeScale;for(let u=0;u<n;u++){const c=r.samples[u];c.pts=ui(c.pts-t.baseTime*a/t.timescale,e*a)/a}r.samples.sort((u,c)=>u.pts-c.pts);const l=r.samples;return r.samples=[],{samples:l}}class $p{constructor(e,t,n,a){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=a,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class bR{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,a){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(C1(e,a)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const a=this.initData=Wy(e);a.audio&&(t=Vp(a.audio,je.AUDIO)),a.video&&(n=Vp(a.video,je.VIDEO));const l={};a.audio&&a.video?l.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:a.audio?l.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:a.video?l.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:Y.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=l}remux(e,t,n,a,l,u){var c,d;let{initPTS:h,lastEndTime:g}=this;const p={audio:void 0,video:void 0,text:a,id3:n,initSegment:void 0};ge(g)||(g=this.lastEndTime=l||0);const v=t.samples;if(!(v!=null&&v.length))return p;const x={initPTS:void 0,timescale:1};let S=this.initData;if((c=S)!=null&&c.length||(this.generateInitSegment(v),S=this.initData),!((d=S)!=null&&d.length))return Y.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),p;this.emitInitSegment&&(x.tracks=this.initTracks,this.emitInitSegment=!1);const E=O1(v,S),b=w1(S,v),A=b===null?l:b;(AR(h,A,l,E)||x.timescale!==h.timescale&&u)&&(x.initPTS=A-l,h&&h.timescale===1&&Y.warn(`Adjusting initPTS by ${x.initPTS-h.baseTime}`),this.initPTS=h={baseTime:x.initPTS,timescale:1});const O=e?A-h.baseTime/h.timescale:g,_=O+E;k1(S,v,h.baseTime/h.timescale),E>0?this.lastEndTime=_:(Y.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const k=!!S.audio,D=!!S.video;let F="";k&&(F+="audio"),D&&(F+="video");const B={data1:v,startPTS:O,startDTS:O,endPTS:_,endDTS:_,type:F,hasAudio:k,hasVideo:D,nb:1,dropped:0};return p.audio=B.type==="audio"?B:void 0,p.video=B.type!=="audio"?B:void 0,p.initSegment=x,p.id3=Av(n,l,h,h),a.samples.length&&(p.text=Rv(a,l,h)),p}}function AR(r,e,t,n){if(r===null)return!0;const a=Math.max(n,1),l=e-r.baseTime/r.timescale;return Math.abs(l-t)>a}function Vp(r,e){const t=r==null?void 0:r.codec;if(t&&t.length>4)return t;if(e===je.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return To(t,!1);const n="mp4a.40.5";return Y.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return Y.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let sn;try{sn=self.performance.now.bind(self.performance)}catch{Y.debug("Unable to use Performance API on this environment"),sn=ur==null?void 0:ur.Date.now}const so=[{demux:uR,remux:bR},{demux:kn,remux:no},{demux:lR,remux:no},{demux:pR,remux:no}];so.splice(2,0,{demux:cR,remux:no});class zp{constructor(e,t,n,a,l){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=a,this.id=l}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,a){const l=n.transmuxing;l.executeStart=sn();let u=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:d}=this;a&&(this.currentTransmuxState=a);const{contiguous:h,discontinuity:g,trackSwitch:p,accurateTimeOffset:v,timeOffset:x,initSegmentChange:S}=a||c,{audioCodec:E,videoCodec:b,defaultInitPts:A,duration:O,initSegmentData:_}=d,k=RR(u,t);if(k&&k.method==="AES-128"){const M=this.getDecrypter();if(M.isSync()){let I=M.softwareDecrypt(u,k.key.buffer,k.iv.buffer);if(n.part>-1&&(I=M.flush()),!I)return l.executeEnd=sn(),Nf(n);u=new Uint8Array(I)}else return this.decryptionPromise=M.webCryptoDecrypt(u,k.key.buffer,k.iv.buffer).then(I=>{const N=this.push(I,null,n);return this.decryptionPromise=null,N}),this.decryptionPromise}const D=this.needsProbing(g,p);if(D){const M=this.configureTransmuxer(u);if(M)return Y.warn(`[transmuxer] ${M.message}`),this.observer.emit(R.ERROR,R.ERROR,{type:Te.MEDIA_ERROR,details:te.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),l.executeEnd=sn(),Nf(n)}(g||p||S||D)&&this.resetInitSegment(_,E,b,O,t),(g||S||D)&&this.resetInitialTimestamp(A),h||this.resetContiguity();const F=this.transmux(u,k,x,v,n),B=this.currentTransmuxState;return B.contiguous=!0,B.discontinuity=!1,B.trackSwitch=!1,l.executeEnd=sn(),F}flush(e){const t=e.transmuxing;t.executeStart=sn();const{decrypter:n,currentTransmuxState:a,decryptionPromise:l}=this;if(l)return l.then(()=>this.flush(e));const u=[],{timeOffset:c}=a;if(n){const p=n.flush();p&&u.push(this.push(p,null,e))}const{demuxer:d,remuxer:h}=this;if(!d||!h)return t.executeEnd=sn(),[Nf(e)];const g=d.flush(c);return ro(g)?g.then(p=>(this.flushRemux(u,p,e),u)):(this.flushRemux(u,g,e),u)}flushRemux(e,t,n){const{audioTrack:a,videoTrack:l,id3Track:u,textTrack:c}=t,{accurateTimeOffset:d,timeOffset:h}=this.currentTransmuxState;Y.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const g=this.remuxer.remux(a,l,u,c,h,d,!0,this.id);e.push({remuxResult:g,chunkMeta:n}),n.transmuxing.executeEnd=sn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,a,l){const{demuxer:u,remuxer:c}=this;!u||!c||(u.resetInitSegment(e,t,n,a),c.resetInitSegment(e,t,n,l))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,a,l){let u;return t&&t.method==="SAMPLE-AES"?u=this.transmuxSampleAes(e,t,n,a,l):u=this.transmuxUnencrypted(e,n,a,l),u}transmuxUnencrypted(e,t,n,a){const{audioTrack:l,videoTrack:u,id3Track:c,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(l,u,c,d,t,n,!1,this.id),chunkMeta:a}}transmuxSampleAes(e,t,n,a,l){return this.demuxer.demuxSampleAes(e,t,n).then(u=>({remuxResult:this.remuxer.remux(u.audioTrack,u.videoTrack,u.id3Track,u.textTrack,n,a,!1,this.id),chunkMeta:l}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:a,vendor:l}=this;let u;for(let v=0,x=so.length;v<x;v++){var c;if((c=so[v].demux)!=null&&c.probe(e)){u=so[v];break}}if(!u)return new Error("Failed to find demuxer by probing fragment data");const d=this.demuxer,h=this.remuxer,g=u.remux,p=u.demux;(!h||!(h instanceof g))&&(this.remuxer=new g(n,t,a,l)),(!d||!(d instanceof p))&&(this.demuxer=new p(n,t,a),this.probe=p.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Ld(this.config)),e}}function RR(r,e){let t=null;return r.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Nf=r=>({remuxResult:{},chunkMeta:r});function ro(r){return"then"in r&&r.then instanceof Function}class LR{constructor(e,t,n,a,l){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=a,this.defaultInitPts=l||null}}class _R{constructor(e,t,n,a,l,u){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=a,this.timeOffset=l,this.initSegmentChange=u}}var Lv={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function a(d,h,g){this.fn=d,this.context=h,this.once=g||!1}function l(d,h,g,p,v){if(typeof g!="function")throw new TypeError("The listener must be a function");var x=new a(g,p||d,v),S=t?t+h:h;return d._events[S]?d._events[S].fn?d._events[S]=[d._events[S],x]:d._events[S].push(x):(d._events[S]=x,d._eventsCount++),d}function u(d,h){--d._eventsCount===0?d._events=new n:delete d._events[h]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var h=[],g,p;if(this._eventsCount===0)return h;for(p in g=this._events)e.call(g,p)&&h.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(g)):h},c.prototype.listeners=function(h){var g=t?t+h:h,p=this._events[g];if(!p)return[];if(p.fn)return[p.fn];for(var v=0,x=p.length,S=new Array(x);v<x;v++)S[v]=p[v].fn;return S},c.prototype.listenerCount=function(h){var g=t?t+h:h,p=this._events[g];return p?p.fn?1:p.length:0},c.prototype.emit=function(h,g,p,v,x,S){var E=t?t+h:h;if(!this._events[E])return!1;var b=this._events[E],A=arguments.length,O,_;if(b.fn){switch(b.once&&this.removeListener(h,b.fn,void 0,!0),A){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,g),!0;case 3:return b.fn.call(b.context,g,p),!0;case 4:return b.fn.call(b.context,g,p,v),!0;case 5:return b.fn.call(b.context,g,p,v,x),!0;case 6:return b.fn.call(b.context,g,p,v,x,S),!0}for(_=1,O=new Array(A-1);_<A;_++)O[_-1]=arguments[_];b.fn.apply(b.context,O)}else{var k=b.length,D;for(_=0;_<k;_++)switch(b[_].once&&this.removeListener(h,b[_].fn,void 0,!0),A){case 1:b[_].fn.call(b[_].context);break;case 2:b[_].fn.call(b[_].context,g);break;case 3:b[_].fn.call(b[_].context,g,p);break;case 4:b[_].fn.call(b[_].context,g,p,v);break;default:if(!O)for(D=1,O=new Array(A-1);D<A;D++)O[D-1]=arguments[D];b[_].fn.apply(b[_].context,O)}}return!0},c.prototype.on=function(h,g,p){return l(this,h,g,p,!1)},c.prototype.once=function(h,g,p){return l(this,h,g,p,!0)},c.prototype.removeListener=function(h,g,p,v){var x=t?t+h:h;if(!this._events[x])return this;if(!g)return u(this,x),this;var S=this._events[x];if(S.fn)S.fn===g&&(!v||S.once)&&(!p||S.context===p)&&u(this,x);else{for(var E=0,b=[],A=S.length;E<A;E++)(S[E].fn!==g||v&&!S[E].once||p&&S[E].context!==p)&&b.push(S[E]);b.length?this._events[x]=b.length===1?b[0]:b:u(this,x)}return this},c.prototype.removeAllListeners=function(h){var g;return h?(g=t?t+h:h,this._events[g]&&u(this,g)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c})(Lv);var DR=Lv.exports,Id=Qb(DR);class _v{constructor(e,t,n,a){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const l=e.config;this.hls=e,this.id=t,this.useWorker=!!l.enableWorker,this.onTransmuxComplete=n,this.onFlush=a;const u=(h,g)=>{g=g||{},g.frag=this.frag,g.id=this.id,h===R.ERROR&&(this.error=g.error),this.hls.trigger(h,g)};this.observer=new Id,this.observer.on(R.FRAG_DECRYPTED,u),this.observer.on(R.ERROR,u);const c=hs(l.preferManagedMediaSource)||{isTypeSupported:()=>!1},d={mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:c.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(l.workerPath||YA())){try{l.workerPath?(Y.log(`loading Web Worker ${l.workerPath} for "${t}"`),this.workerContext=XA(l.workerPath)):(Y.log(`injecting Web Worker for "${t}"`),this.workerContext=qA()),this.onwmsg=p=>this.onWorkerMessage(p);const{worker:g}=this.workerContext;g.addEventListener("message",this.onwmsg),g.onerror=p=>{const v=new Error(`${p.message}  (${p.filename}:${p.lineno})`);l.enableWorker=!1,Y.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(R.ERROR,{type:Te.OTHER_ERROR,details:te.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:v})},g.postMessage({cmd:"init",typeSupported:d,vendor:"",id:t,config:JSON.stringify(l)})}catch(g){Y.warn(`Error setting up "${t}" Web Worker, fallback to inline`,g),this.resetWorker(),this.error=null,this.transmuxer=new zp(this.observer,d,l,"",t)}return}this.transmuxer=new zp(this.observer,d,l,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,a,l,u,c,d,h,g){var p,v;h.transmuxing.start=self.performance.now();const{transmuxer:x}=this,S=u?u.start:l.start,E=l.decryptdata,b=this.frag,A=!(b&&l.cc===b.cc),O=!(b&&h.level===b.level),_=b?h.sn-b.sn:-1,k=this.part?h.part-this.part.index:-1,D=_===0&&h.id>1&&h.id===(b==null?void 0:b.stats.chunkCount),F=!O&&(_===1||_===0&&(k===1||D&&k<=0)),B=self.performance.now();(O||_||l.stats.parsing.start===0)&&(l.stats.parsing.start=B),u&&(k||!F)&&(u.stats.parsing.start=B);const M=!(b&&((p=l.initSegment)==null?void 0:p.url)===((v=b.initSegment)==null?void 0:v.url)),I=new _R(A,F,d,O,S,M);if(!F||A||M){Y.log(`[transmuxer-interface, ${l.type}]: Starting new transmux session for sn: ${h.sn} p: ${h.part} level: ${h.level} id: ${h.id}
        discontinuity: ${A}
        trackSwitch: ${O}
        contiguous: ${F}
        accurateTimeOffset: ${d}
        timeOffset: ${S}
        initSegmentChange: ${M}`);const N=new LR(n,a,t,c,g);this.configureTransmuxer(N)}if(this.frag=l,this.part=u,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:E,chunkMeta:h,state:I},e instanceof ArrayBuffer?[e]:[]);else if(x){const N=x.push(e,E,h,I);ro(N)?(x.async=!0,N.then(U=>{this.handleTransmuxComplete(U)}).catch(U=>{this.transmuxerError(U,h,"transmuxer-interface push error")})):(x.async=!1,this.handleTransmuxComplete(N))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);ro(n)||t.async?(ro(n)||(n=Promise.resolve(n)),n.then(l=>{this.handleFlushResult(l,e)}).catch(l=>{this.transmuxerError(l,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){Y.warn(`worker message received with no ${t?"event name":"data"}`);return}const n=this.hls;if(this.hls)switch(t.event){case"init":{var a;const l=(a=this.workerContext)==null?void 0:a.objectURL;l&&self.URL.revokeObjectURL(l);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":Y[t.data.logType]&&Y[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Kp=100;class CR extends _d{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Se.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.ERROR,this.onError,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.ERROR,this.onError,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:a,timescale:l}){if(n==="main"){const u=t.cc;this.initPTS[t.cc]={baseTime:a,timescale:l},this.log(`InitPTS for cc: ${u} found from main: ${a}`),this.videoTrackCC=u,this.state===ue.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=ue.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(Kp),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=ue.IDLE):(this.loadedmetadata=!1,this.state=ue.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case ue.IDLE:this.doTickIdle();break;case ue.WAITING_TRACK:{var e;const{levels:n,trackId:a}=this,l=n==null||(e=n[a])==null?void 0:e.details;if(l){if(this.waitForCdnTuneIn(l))break;this.state=ue.WAITING_INIT_PTS}break}case ue.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),a=this.retryDate;if(!a||n>=a||(t=this.media)!=null&&t.seeking){const{levels:l,trackId:u}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((l==null?void 0:l[u])||null),this.state=ue.IDLE}break}case ue.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:a,part:l,cache:u,complete:c}=n;if(this.initPTS[a.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=ue.FRAG_LOADING;const d=u.flush(),h={frag:a,part:l,payload:d,networkDetails:null};this._handleFragmentLoadProgress(h),c&&super._handleFragmentLoadComplete(h)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${a.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const d=this.getLoadPosition(),h=Ke.bufferInfo(this.mediaBuffer,d,this.config.maxBufferHole);nd(h.end,this.config.maxFragLookUpTolerance,a)<0&&(this.log(`Waiting fragment cc (${a.cc}) @ ${a.start} cancelled because another fragment at ${h.end} is needed`),this.clearWaitingFragment())}}else this.state=ue.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=ue.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:a}=this,l=e.config;if(!this.buffering||!n&&(this.startFragRequested||!l.startFragPrefetch)||!(t!=null&&t[a]))return;const u=t[a],c=u.details;if(!c||c.live&&this.levelLastLoaded!==u||this.waitForCdnTuneIn(c)){this.state=ue.WAITING_TRACK;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,je.AUDIO,Se.AUDIO));const h=this.getFwdBufferInfo(d,Se.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,c)){e.trigger(R.BUFFER_EOS,{type:"audio"}),this.state=ue.ENDED;return}const g=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Se.MAIN),p=h.len,v=this.getMaxBufferLength(g==null?void 0:g.len),x=c.fragments,S=x[0].start,E=this.getLoadPosition(),b=this.flushing?E:h.end;if(this.switchingTrack&&n){const k=E;c.PTSKnown&&k<S&&(h.end>S||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=S+.05)}if(p>=v&&!this.switchingTrack&&b<x[x.length-1].start)return;let A=this.getNextFragment(b,c),O=!1;if(A&&this.isLoopLoading(A,b)&&(O=!!A.gap,A=this.getNextFragmentLoopLoading(A,c,h,Se.MAIN,v)),!A){this.bufferFlushed=!0;return}const _=g&&A.start>g.end+c.targetduration;if(_||!(g!=null&&g.len)&&h.len){const k=this.getAppendedFrag(A.start,Se.MAIN);if(k===null||(O||(O=!!k.gap||!!_&&g.len===0),_&&!O||O&&h.nextStart&&h.nextStart<k.end))return}this.loadFragment(A,u,b)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new cr(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:a}=this;a&&(a.abortRequests(),this.removeUnbufferedFrags(a.start)),this.resetLoadingState(),n?this.setInterval(Kp):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=ue.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=ue.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(R.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:a}=this,{details:l,id:u}=t;if(!a){this.warn(`Audio tracks were reset while loading level ${u}`);return}this.log(`Audio track ${u} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`);const c=a[u];let d=0;if(l.live||(n=c.details)!=null&&n.live){this.checkLiveUpdate(l);const g=this.mainDetails;if(l.deltaUpdateFailed||!g)return;if(!c.details&&l.hasProgramDateTime&&g.hasProgramDateTime)_o(l,g),d=l.fragments[0].start;else{var h;d=this.alignPlaylists(l,c.details,(h=this.levelLastLoaded)==null?void 0:h.details)}}c.details=l,this.levelLastLoaded=c,!this.startFragRequested&&(this.mainDetails||!l.live)&&this.setStartPosition(this.mainDetails||l,d),this.state===ue.WAITING_TRACK&&!this.waitForCdnTuneIn(l)&&(this.state=ue.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:a,payload:l}=e,{config:u,trackId:c,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const h=d[c];if(!h){this.warn("Audio track is undefined on fragment load progress");return}const g=h.details;if(!g){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const p=u.defaultAudioCodec||h.audioCodec||"mp4a.40.2";let v=this.transmuxer;v||(v=this.transmuxer=new _v(this.hls,Se.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const x=this.initPTS[n.cc],S=(t=n.initSegment)==null?void 0:t.data;if(x!==void 0){const b=a?a.index:-1,A=b!==-1,O=new Rd(n.level,n.sn,n.stats.chunkCount,l.byteLength,b,A);v.push(l,S,p,"",n,a,g.totalduration,!1,O,x)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${g.startSN} ,${g.endSN}],track ${c}`);const{cache:E}=this.waitingData=this.waitingData||{frag:n,part:a,cache:new fv,complete:!1};E.push(new Uint8Array(l)),this.waitingVideoCC=this.videoTrackCC,this.state=ue.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:a}=t;if(n.type!==Se.AUDIO){if(!this.loadedmetadata&&n.type===Se.MAIN){const l=this.videoBuffer||this.media;l&&Ke.getBuffered(l).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${a?" p: "+a.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const l=this.switchingTrack;l&&(this.bufferedTrack=l,this.switchingTrack=null,this.hls.trigger(R.AUDIO_TRACK_SWITCHED,vt({},l)))}this.fragBufferedComplete(n,a)}onError(e,t){var n;if(t.fatal){this.state=ue.ERROR;return}switch(t.details){case te.FRAG_GAP:case te.FRAG_PARSING_ERROR:case te.FRAG_DECRYPT_ERROR:case te.FRAG_LOAD_ERROR:case te.FRAG_LOAD_TIMEOUT:case te.KEY_LOAD_ERROR:case te.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Se.AUDIO,t);break;case te.AUDIO_TRACK_LOAD_ERROR:case te.AUDIO_TRACK_LOAD_TIMEOUT:case te.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ue.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===Me.AUDIO_TRACK&&(this.state=ue.IDLE);break;case te.BUFFER_APPEND_ERROR:case te.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===te.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case te.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==je.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==je.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ue.ENDED&&(this.state=ue.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,Se.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:a}=this,{remuxResult:l,chunkMeta:u}=e,c=this.getCurrentContext(u);if(!c){this.resetWhenMissingContext(u);return}const{frag:d,part:h,level:g}=c,{details:p}=g,{audio:v,text:x,id3:S,initSegment:E}=l;if(this.fragContextChanged(d)||!p){this.fragmentTracker.removeFragment(d);return}if(this.state=ue.PARSING,this.switchingTrack&&v&&this.completeAudioSwitch(this.switchingTrack),E!=null&&E.tracks){const b=d.initSegment||d;this._bufferInitSegment(g,E.tracks,b,u),a.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:n,tracks:E.tracks})}if(v){const{startPTS:b,endPTS:A,startDTS:O,endDTS:_}=v;h&&(h.elementaryStreams[je.AUDIO]={startPTS:b,endPTS:A,startDTS:O,endDTS:_}),d.setElementaryStreamInfo(je.AUDIO,b,A,O,_),this.bufferFragmentData(v,d,h,u)}if(S!=null&&(t=S.samples)!=null&&t.length){const b=lt({id:n,frag:d,details:p},S);a.trigger(R.FRAG_PARSING_METADATA,b)}if(x){const b=lt({id:n,frag:d,details:p},x);a.trigger(R.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,n,a){if(this.state!==ue.PARSING)return;t.video&&delete t.video;const l=t.audio;if(!l)return;l.id="audio";const u=e.audioCodec;this.log(`Init audio buffer, container:${l.container}, codecs[level/parsed]=[${u}/${l.codec}]`),u&&u.split(",").length===1&&(l.levelCodec=u),this.hls.trigger(R.BUFFER_CODECS,t);const c=l.initSegment;if(c!=null&&c.byteLength){const d={type:"audio",frag:n,part:null,chunkMeta:a,parent:n.type,data:c};this.hls.trigger(R.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(e,t,n){const a=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||a===yt.NOT_LOADED||a===yt.PARTIAL){var l;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((l=t.details)!=null&&l.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ue.WAITING_INIT_PTS;const u=this.mainDetails;u&&u.fragments[0].start!==t.details.fragments[0].start&&_o(t.details,u)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:a,characteristics:l,audioCodec:u,channels:c}=this.bufferedTrack;ds({name:t,lang:n,assocLang:a,characteristics:l,audioCodec:u,channels:c},e,as)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(R.AUDIO_TRACK_SWITCHED,vt({},e))}}function Dv(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!Ea(r[t].attrs,e[t].attrs))return!1;return!0}function Ea(r,e,t){const n=r["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(a=>r[a]!==e[a])}function rd(r,e){return e.label.toLowerCase()===r.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(r.lang||"").toLowerCase())}class wR extends Ad{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:a,details:l}=t,u=this.tracksInGroup[n];if(!u||u.groupId!==a){this.warn(`Audio track with id:${n} and group:${a} not found in active group ${u==null?void 0:u.groupId}`);return}const c=u.details;u.details=t.details,this.log(`Audio track ${n} "${u.name}" lang:${u.lang} group:${a} loaded [${l.startSN}-${l.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,a=this.groupIds;let l=this.currentTrack;if(!n||(a==null?void 0:a.length)!==(n==null?void 0:n.length)||n!=null&&n.some(c=>(a==null?void 0:a.indexOf(c))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(v=>!n||n.indexOf(v.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(v=>v.default)&&(this.selectDefaultTrack=!1),c.forEach((v,x)=>{v.id=x});else if(!l&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const d=this.hls.config.audioPreference;if(!l&&d){const v=Oi(d,c,as);if(v>-1)l=c[v];else{const x=Oi(d,this.tracks);l=this.tracks[x]}}let h=this.findTrackId(l);h===-1&&l&&(h=this.findTrackId(null));const g={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(R.AUDIO_TRACKS_UPDATED,g);const p=this.trackId;if(h!==-1&&p===-1)this.setAudioTrack(h);else if(c.length&&p===-1){var u;const v=new Error(`No audio track selected for current audio group-ID(s): ${(u=this.groupIds)==null?void 0:u.join(",")} track count: ${c.length}`);this.warn(v.message),this.hls.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:v})}}else this.shouldReloadPlaylist(l)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Me.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const a=this.currentTrack;if(a&&ds(e,a,as))return a;const l=Oi(e,this.tracksInGroup,as);if(l>-1){const u=this.tracksInGroup[l];return this.setAudioTrack(l),u}else if(a){let u=t.loadLevel;u===-1&&(u=t.firstAutoLevel);const c=wA(e,t.levels,n,u,as);if(c===-1)return null;t.nextLoadLevel=c}if(e.channels||e.audioCodec){const u=Oi(e,n);if(u>-1)return n[u]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,a=t[e],l=a.details&&!a.details.live;if(e===this.trackId&&a===n&&l||(this.log(`Switching to audio-track ${e} "${a.name}" lang:${a.lang} group:${a.groupId} channels:${a.channels}`),this.trackId=e,this.currentTrack=a,this.hls.trigger(R.AUDIO_TRACK_SWITCHING,vt({},a)),l))return;const u=this.switchParams(a.url,n==null?void 0:n.details,a.details);this.loadPlaylist(u)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const a=t[n];if(!(this.selectDefaultTrack&&!a.default)&&(!e||ds(e,a,as)))return n}if(e){const{name:n,lang:a,assocLang:l,characteristics:u,audioCodec:c,channels:d}=e;for(let h=0;h<t.length;h++){const g=t[h];if(ds({name:n,lang:a,assocLang:l,characteristics:u,audioCodec:c,channels:d},g,as))return h}for(let h=0;h<t.length;h++){const g=t[h];if(Ea(e.attrs,g.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return h}for(let h=0;h<t.length;h++){const g=t[h];if(Ea(e.attrs,g.attrs,["LANGUAGE"]))return h}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,a=t.groupId;let l=t.url;if(e)try{l=e.addDirectives(l)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${a}`),this.clearTimer(),this.hls.trigger(R.AUDIO_TRACK_LOADING,{url:l,id:n,groupId:a,deliveryDirectives:e||null})}}}const Yp=500;class OR extends _d{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Se.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.ERROR,this.onError,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.ERROR,this.onError,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=ue.IDLE,this.setInterval(Yp),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:a}=t;if(this.fragPrevious=n,this.state=ue.IDLE,!a)return;const l=this.tracksBuffered[this.currentTrackId];if(!l)return;let u;const c=n.start;for(let h=0;h<l.length;h++)if(c>=l[h].start&&c<=l[h].end){u=l[h];break}const d=n.start+n.duration;u?u.end=d:(u={start:c,end:d},l.push(u)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:a}=t;if(n===0&&a!==Number.POSITIVE_INFINITY){const l=a-1;if(l<=0)return;t.endOffsetSubtitles=Math.max(0,l),this.tracksBuffered.forEach(u=>{for(let c=0;c<u.length;){if(u[c].end<=l){u.shift();continue}else if(u[c].start<l)u[c].start=l;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(n,l,Se.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Se.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===Se.SUBTITLE&&(t.details===te.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ue.STOPPED&&(this.state=ue.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&Dv(this.levels,t)){this.levels=t.map(n=>new cr(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const a=new cr(n);return this.tracksBuffered[a.id]=[],a}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Se.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const a=this.levels[this.currentTrackId];a!=null&&a.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,a&&this.setInterval(Yp)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:a,levels:l}=this,{details:u,id:c}=t;if(!l){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const d=l[c];if(c>=l.length||!d)return;this.log(`Subtitle track ${c} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""},duration:${u.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let h=0;if(u.live||(n=d.details)!=null&&n.live){const p=this.mainDetails;if(u.deltaUpdateFailed||!p)return;const v=p.fragments[0];if(!d.details)u.hasProgramDateTime&&p.hasProgramDateTime?(_o(u,p),h=u.fragments[0].start):v&&(h=v.start,id(u,h));else{var g;h=this.alignPlaylists(u,d.details,(g=this.levelLastLoaded)==null?void 0:g.details),h===0&&v&&(h=v.start,id(u,h))}}d.details=u,this.levelLastLoaded=d,c===a&&(!this.startFragRequested&&(this.mainDetails||!u.live)&&this.setStartPosition(this.mainDetails||u,h),this.tick(),u.live&&!this.fragCurrent&&this.media&&this.state===ue.IDLE&&(Lo(null,u.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,a=t.decryptdata,l=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&a!=null&&a.key&&a.iv&&a.method==="AES-128"){const u=performance.now();this.decrypter.decrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer).catch(c=>{throw l.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const d=performance.now();l.trigger(R.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:u,tdecrypt:d}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=ue.IDLE})}}doTick(){if(!this.media){this.state=ue.IDLE;return}if(this.state===ue.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:a}=this,l=this.getLoadPosition(),u=Ke.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],l,a.maxBufferHole),{end:c,len:d}=u,h=this.getFwdBufferInfo(this.media,Se.MAIN),g=n.details,p=this.getMaxBufferLength(h==null?void 0:h.len)+g.levelTargetDuration;if(d>p)return;const v=g.fragments,x=v.length,S=g.edge;let E=null;const b=this.fragPrevious;if(c<S){const A=a.maxFragLookUpTolerance,O=c>S-A?0:A;E=Lo(b,v,Math.max(v[0].start,c),O),!E&&b&&b.start<v[0].start&&(E=v[0])}else E=v[x-1];if(!E)return;if(E=this.mapToInitFragWhenRequired(E),E.sn!=="initSegment"){const A=E.sn-g.startSN,O=v[A-1];O&&O.cc===E.cc&&this.fragmentTracker.getState(O)===yt.NOT_LOADED&&(E=O)}this.fragmentTracker.getState(E)===yt.NOT_LOADED&&this.loadFragment(E,n,c)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new IR(this.tracksBuffered[this.currentTrackId]||[])}}class IR{constructor(e){this.buffered=void 0;const t=(n,a,l)=>{if(a=a>>>0,a>l-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${a}) is greater than the maximum bound (${l})`);return e[a][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class kR extends Ad{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=eo(this.media.textTracks);for(let l=0;l<n.length;l++)if(n[l].mode==="hidden")t=n[l];else if(n[l].mode==="showing"){t=n[l];break}const a=this.findTrackForTextTrack(t);this.subtitleTrack!==a&&this.setSubtitleTrack(a)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),eo(this.media.textTracks).forEach(t=>{ir(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:a,details:l}=t,u=this.tracksInGroup[n];if(!u||u.groupId!==a){this.warn(`Subtitle track with id:${n} and group:${a} not found in active group ${u==null?void 0:u.groupId}`);return}const c=u.details;u.details=t.details,this.log(`Subtitle track ${n} "${u.name}" lang:${u.lang} group:${a} loaded [${l.startSN}-${l.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,a=this.groupIds;let l=this.currentTrack;if(!n||(a==null?void 0:a.length)!==(n==null?void 0:n.length)||n!=null&&n.some(u=>(a==null?void 0:a.indexOf(u))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(g=>!n||n.indexOf(g.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(g=>g.default)&&(this.selectDefaultTrack=!1),u.forEach((g,p)=>{g.id=p});else if(!l&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const c=this.hls.config.subtitlePreference;if(!l&&c){this.selectDefaultTrack=!1;const g=Oi(c,u);if(g>-1)l=u[g];else{const p=Oi(c,this.tracks);l=this.tracks[p]}}let d=this.findTrackId(l);d===-1&&l&&(d=this.findTrackId(null));const h={subtitleTracks:u};this.log(`Updating subtitle tracks, ${u.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(R.SUBTITLE_TRACKS_UPDATED,h),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}else this.shouldReloadPlaylist(l)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let a=0;a<t.length;a++){const l=t[a];if(!(n&&!l.default||!n&&!e)&&(!e||ds(l,e)))return a}if(e){for(let a=0;a<t.length;a++){const l=t[a];if(Ea(e.attrs,l.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return a}for(let a=0;a<t.length;a++){const l=t[a];if(Ea(e.attrs,l.attrs,["LANGUAGE"]))return a}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const a=t[n];if(rd(a,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Me.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&ds(e,n))return n;const a=Oi(e,this.tracksInGroup);if(a>-1){const l=this.tracksInGroup[a];return this.setSubtitleTrack(a),l}else{if(n)return null;{const l=Oi(e,t);if(l>-1)return t[l]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,a=t.groupId;let l=t.url;if(e)try{l=e.addDirectives(l)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(R.SUBTITLE_TRACK_LOADING,{url:l,id:n,groupId:a,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=eo(e.textTracks),n=this.currentTrack;let a;if(n&&(a=t.filter(l=>rd(n,l))[0],a||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(l=>{l.mode!=="disabled"&&l!==a&&(l.mode="disabled")}),a){const l=this.subtitleDisplay?"showing":"hidden";a.mode!==l&&(a.mode=l)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!ge(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,a=t[e]||null;if(this.trackId=e,this.currentTrack=a,this.toggleTrackModes(),!a){this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:e});return}const l=!!a.details&&!a.details.live;if(e===this.trackId&&a===n&&l)return;this.log(`Switching to subtitle-track ${e}`+(a?` "${a.name}" lang:${a.lang} group:${a.groupId}`:""));const{id:u,groupId:c="",name:d,type:h,url:g}=a;this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:u,groupId:c,name:d,type:h,url:g});const p=this.switchParams(a.url,n==null?void 0:n.details,a.details);this.loadPlaylist(p)}}class MR{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const a=this.queues[t];a.push(e),a.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(l=>{t=l}),a={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(a,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(a){Y.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${a}`),n.onError(a);const l=this.buffers[e];l!=null&&l.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const qp=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class NR{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:a}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(R.MEDIA_ATTACHED,{media:n,mediaSource:a})),a&&a.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:a}=this;n!==a&&Y.error(`Media element src was set while attaching MediaSource (${a} > ${n})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=V1(hs(e.config.preferManagedMediaSource)),this.log=Y.log.bind(Y,t),this.warn=Y.warn.bind(Y,t),this.error=Y.error.bind(Y,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_APPENDING,this.onBufferAppending,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.BUFFER_EOS,this.onBufferEos,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(R.FRAG_PARSED,this.onFragParsed,this),e.on(R.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_APPENDING,this.onBufferAppending,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.BUFFER_EOS,this.onBufferEos,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(R.FRAG_PARSED,this.onFragParsed,this),e.off(R.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new MR(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,a=hs(this.appendSource);if(n&&a){var l;const u=this.mediaSource=new a;this.log(`created media source: ${(l=u.constructor)==null?void 0:l.name}`),u.addEventListener("sourceopen",this._onMediaSourceOpen),u.addEventListener("sourceended",this._onMediaSourceEnded),u.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(u.addEventListener("startstreaming",this._onStartStreaming),u.addEventListener("endstreaming",this._onEndStreaming));const c=this._objectUrl=self.URL.createObjectURL(u);if(this.appendSource)try{n.removeAttribute("src");const d=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||d&&u instanceof d,Xp(n),PR(n,c),n.load()}catch{n.src=c}else n.src=c;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(a){this.warn(`onMediaDetaching: ${a.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&Xp(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(R.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(a){this.warn(`onBufferReset ${e}`,a)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,a=Object.keys(t);if(a.forEach(u=>{if(n){const d=this.tracks[u];if(d&&typeof d.buffer.changeType=="function"){var c;const{id:h,codec:g,levelCodec:p,container:v,metadata:x}=t[u],S=pp(d.codec,d.levelCodec),E=S==null?void 0:S.replace(qp,"$1");let b=pp(g,p);const A=(c=b)==null?void 0:c.replace(qp,"$1");if(b&&E!==A){u.slice(0,5)==="audio"&&(b=To(b,this.appendSource));const O=`${v};codecs=${b}`;this.appendChangeType(u,O),this.log(`switching codec ${S} to ${b}`),this.tracks[u]={buffer:d.buffer,codec:g,container:v,levelCodec:p,metadata:x,id:h}}}}else this.pendingTracks[u]=t[u]}),n)return;const l=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==l&&(this.log(`${l} bufferCodec event(s) expected ${a.join(",")}`),this.bufferCodecEventsExpected=l),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,a={execute:()=>{const l=this.sourceBuffer[e];l&&(this.log(`changing ${e} sourceBuffer type to ${t}`),l.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn(`Failed to change ${e} SourceBuffer type`,l)}};n.append(a,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:a,tracks:l}=this,{data:u,type:c,frag:d,part:h,chunkMeta:g}=t,p=g.buffering[c],v=self.performance.now();p.start=v;const x=d.stats.buffering,S=h?h.stats.buffering:null;x.start===0&&(x.start=v),S&&S.start===0&&(S.start=v);const E=l.audio;let b=!1;c==="audio"&&(E==null?void 0:E.container)==="audio/mpeg"&&(b=!this.lastMpegAudioChunk||g.id===1||this.lastMpegAudioChunk.sn!==g.sn,this.lastMpegAudioChunk=g);const A=d.start,O={execute:()=>{if(p.executeStart=self.performance.now(),b){const _=this.sourceBuffer[c];if(_){const k=A-_.timestampOffset;Math.abs(k)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${A} (delta: ${k}) sn: ${d.sn})`),_.timestampOffset=A)}}this.appendExecutor(u,c)},onStart:()=>{},onComplete:()=>{const _=self.performance.now();p.executeEnd=p.end=_,x.first===0&&(x.first=_),S&&S.first===0&&(S.first=_);const{sourceBuffer:k}=this,D={};for(const F in k)D[F]=Ke.getBuffered(k[F]);this.appendErrors[c]=0,c==="audio"||c==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(R.BUFFER_APPENDED,{type:c,frag:d,part:h,chunkMeta:g,parent:d.type,timeRanges:D})},onError:_=>{const k={type:Te.MEDIA_ERROR,parent:d.type,details:te.BUFFER_APPEND_ERROR,sourceBufferName:c,frag:d,part:h,chunkMeta:g,error:_,err:_,fatal:!1};if(_.code===DOMException.QUOTA_EXCEEDED_ERR)k.details=te.BUFFER_FULL_ERROR;else{const D=++this.appendErrors[c];k.details=te.BUFFER_APPEND_ERROR,this.warn(`Failed ${D}/${n.config.appendErrorMaxRetry} times to append segment in "${c}" sourceBuffer`),D>=n.config.appendErrorMaxRetry&&(k.fatal=!0)}n.trigger(R.ERROR,k)}};a.append(O,c,!!this.pendingTracks[c])}onBufferFlushing(e,t){const{operationQueue:n}=this,a=l=>({execute:this.removeExecutor.bind(this,l,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(R.BUFFER_FLUSHED,{type:l})},onError:u=>{this.warn(`Failed to remove from ${l} SourceBuffer`,u)}});t.type?n.append(a(t.type),t.type):this.getSourceBufferTypes().forEach(l=>{n.append(a(l),l)})}onFragParsed(e,t){const{frag:n,part:a}=t,l=[],u=a?a.elementaryStreams:n.elementaryStreams;u[je.AUDIOVIDEO]?l.push("audiovideo"):(u[je.AUDIO]&&l.push("audio"),u[je.VIDEO]&&l.push("video"));const c=()=>{const d=self.performance.now();n.stats.buffering.end=d,a&&(a.stats.buffering.end=d);const h=a?a.stats:n.stats;this.hls.trigger(R.FRAG_BUFFERED,{frag:n,part:a,stats:h,id:n.type})};l.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(c,l)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((a,l)=>{const u=this.sourceBuffer[l];return u&&(!t.type||t.type===l)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${l} sourceBuffer now EOS`))),a&&!!(!u||u.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(l=>{const u=this.sourceBuffer[l];u&&(u.ending=!1)});const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;const l=e.config,u=n.currentTime,c=t.levelTargetDuration,d=t.live&&l.liveBackBufferLength!==null?l.liveBackBufferLength:l.backBufferLength;if(ge(d)&&d>0){const h=Math.max(d,c),g=Math.floor(u/c)*c-h;this.flushBackBuffer(u,c,g)}if(ge(l.frontBufferFlushThreshold)&&l.frontBufferFlushThreshold>0){const h=Math.max(l.maxBufferLength,l.frontBufferFlushThreshold),g=Math.max(h,c),p=Math.floor(u/c)*c+g;this.flushFrontBuffer(u,c,p)}}flushBackBuffer(e,t,n){const{details:a,sourceBuffer:l}=this;this.getSourceBufferTypes().forEach(c=>{const d=l[c];if(d){const h=Ke.getBuffered(d);if(h.length>0&&n>h.start(0)){if(this.hls.trigger(R.BACK_BUFFER_REACHED,{bufferEnd:n}),a!=null&&a.live)this.hls.trigger(R.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(d.ended&&h.end(h.length-1)-e<t*2){this.log(`Cannot flush ${c} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:c})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:a}=this;this.getSourceBufferTypes().forEach(u=>{const c=a[u];if(c){const d=Ke.getBuffered(c),h=d.length;if(h<2)return;const g=d.start(h-1),p=d.end(h-1);if(n>g||e>=g&&e<=p)return;if(c.ended&&e-p<2*t){this.log(`Cannot flush ${u} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:g,endOffset:1/0,type:u})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:a}=this,l=e.fragments[0].start+e.totalduration,u=n.duration,c=ge(a.duration)?a.duration:0;e.live&&t.config.liveDurationInfinity?(a.duration=1/0,this.updateSeekableRange(e)):(l>c&&l>u||!ge(u))&&(this.log(`Updating Media Source duration to ${l.toFixed(3)}`),a.duration=l)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const l=Math.max(0,n[0].start),u=Math.max(l,l+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${l}-${u}.`),t.setLiveSeekableRange(l,u)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,a=Object.keys(n).length;if(a&&(!e||a===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const l=this.getSourceBufferTypes();if(l.length)this.hls.trigger(R.BUFFER_CREATED,{tracks:this.tracks}),l.forEach(u=>{t.executeNext(u)});else{const u=new Error("could not create source buffer for media codec(s)");this.hls.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:u,reason:u.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const l in e)if(!t[l]){var a;const u=e[l];if(!u)throw Error(`source buffer exists for track ${l}, however track does not`);let c=((a=u.levelCodec)==null?void 0:a.indexOf(","))===-1?u.levelCodec:u.codec;c&&l.slice(0,5)==="audio"&&(c=To(c,this.appendSource));const d=`${u.container};codecs=${c}`;this.log(`creating sourceBuffer(${d})`);try{const h=t[l]=n.addSourceBuffer(d),g=l;this.addBufferListener(g,"updatestart",this._onSBUpdateStart),this.addBufferListener(g,"updateend",this._onSBUpdateEnd),this.addBufferListener(g,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(g,"bufferedchange",(p,v)=>{const x=v.removedRanges;x!=null&&x.length&&this.hls.trigger(R.BUFFER_FLUSHED,{type:l})}),this.tracks[l]={buffer:h,codec:c,container:u.container,levelCodec:u.levelCodec,metadata:u.metadata,id:u.id}}catch(h){this.error(`error while trying to add sourceBuffer: ${h.message}`),this.hls.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:l,mimeType:d})}}}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const a=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${a}`,t),this.hls.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:a,fatal:!1});const l=this.operationQueue.current(e);l&&l.onError(a)}removeExecutor(e,t,n){const{media:a,mediaSource:l,operationQueue:u,sourceBuffer:c}=this,d=c[e];if(!a||!l||!d){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),u.shiftAndExecuteNext(e);return}const h=ge(a.duration)?a.duration:1/0,g=ge(l.duration)?l.duration:1/0,p=Math.max(0,t),v=Math.min(n,h,g);v>p&&(!d.ending||d.ended)?(d.ended=!1,this.log(`Removing [${p},${v}] from the ${e} SourceBuffer`),d.remove(p,v)):u.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,a=t.map(l=>n.appendBlocker(l));Promise.all(a).then(()=>{e(),t.forEach(l=>{const u=this.sourceBuffer[l];u!=null&&u.updating||n.shiftAndExecuteNext(l)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const a=this.sourceBuffer[e];if(!a)return;const l=n.bind(this,e);this.listeners[e].push({event:t,listener:l}),a.addEventListener(t,l)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}function Xp(r){const e=r.querySelectorAll("source");[].slice.call(e).forEach(t=>{r.removeChild(t)})}function PR(r,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,r.appendChild(t)}const UR={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Cv=r=>String.fromCharCode(UR[r]||r),yi=15,tn=100,FR={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},BR={17:2,18:4,21:6,22:8,23:10,19:13,20:15},jR={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},GR={25:2,26:4,29:6,30:8,31:10,27:13,28:15},HR=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class $R{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;Y.log(`${this.time} [${e}] ${n}`)}}}const ns=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class wv{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const a=t[n];e.hasOwnProperty(a)&&(this[a]=e[a])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class VR{constructor(){this.uchar=" ",this.penState=new wv}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class zR{constructor(e){this.chars=[],this.pos=0,this.currPenState=new wv,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<tn;t++)this.chars.push(new VR);this.logger=e}equals(e){for(let t=0;t<tn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<tn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<tn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>tn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=tn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Cv(e);if(this.pos>=tn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<tn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<tn;n++){const a=this.chars[n].uchar;a!==" "&&(t=!1),e.push(a)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Pf{constructor(e){this.rows=[],this.currRow=yi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<yi;t++)this.rows.push(new zR(e));this.logger=e}reset(){for(let e=0;e<yi;e++)this.rows[e].clear();this.currRow=yi-1}equals(e){let t=!0;for(let n=0;n<yi;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<yi;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<yi;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<yi;c++)this.rows[c].clear();const l=this.currRow+1-this.nrRollUpRows,u=this.lastOutputScreen;if(u){const c=u.rows[l].cueStartTime,d=this.logger.time;if(c!==null&&d!==null&&c<d)for(let h=0;h<this.nrRollUpRows;h++)this.rows[t-this.nrRollUpRows+h+1].copy(u.rows[l+h])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const l=e.indent,u=Math.max(l-1,0);n.setCursor(e.indent),e.color=n.chars[u].penState.foreground}const a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",a=-1;for(let l=0;l<yi;l++){const u=this.rows[l].getTextString();u&&(a=l+1,e?t.push("Row "+a+": '"+u+"'"):t.push(u.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class Wp{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Pf(n),this.nonDisplayedMemory=new Pf(n),this.lastOutputScreen=new Pf(n),this.currRollUpRow=this.displayedMemory.rows[yi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[yi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,a=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=a[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Qp{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=YR(),this.logger=void 0;const a=this.logger=new $R;this.channels=[null,new Wp(e,t,a),new Wp(e+1,n,a)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const a=t[n]&127,l=t[n+1]&127;let u=!1,c=null;if(a===0&&l===0)continue;this.logger.log(3,()=>"["+ns([t[n],t[n+1]])+"] -> ("+ns([a,l])+")");const d=this.cmdHistory;if(a>=16&&a<=31){if(KR(a,l,d)){Kl(null,null,d),this.logger.log(3,()=>"Repeated command ("+ns([a,l])+") is dropped");continue}Kl(a,l,this.cmdHistory),u=this.parseCmd(a,l),u||(u=this.parseMidrow(a,l)),u||(u=this.parsePAC(a,l)),u||(u=this.parseBackgroundAttributes(a,l))}else Kl(null,null,d);if(!u&&(c=this.parseChars(a,l),c)){const g=this.currentChannel;g&&g>0?this.channels[g].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!u&&!c&&this.logger.log(2,()=>"Couldn't parse cleaned data "+ns([a,l])+" orig: "+ns([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,a=(e===23||e===31)&&t>=33&&t<=35;if(!(n||a))return!1;const l=e===20||e===21||e===23?1:2,u=this.channels[l];return e===20||e===21||e===28||e===29?t===32?u.ccRCL():t===33?u.ccBS():t===34?u.ccAOF():t===35?u.ccAON():t===36?u.ccDER():t===37?u.ccRU(2):t===38?u.ccRU(3):t===39?u.ccRU(4):t===40?u.ccFON():t===41?u.ccRDC():t===42?u.ccTR():t===43?u.ccRTD():t===44?u.ccEDM():t===45?u.ccCR():t===46?u.ccENM():t===47&&u.ccEOC():u.ccTO(t-32),this.currentChannel=l,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const a=this.channels[n];return a?(a.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+ns([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const a=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,l=(e===16||e===24)&&t>=64&&t<=95;if(!(a||l))return!1;const u=e<=23?1:2;t>=64&&t<=95?n=u===1?FR[e]:jR[e]:n=u===1?BR[e]:GR[e];const c=this.channels[u];return c?(c.setPAC(this.interpretPAC(n,t)),this.currentChannel=u,!0):!1}interpretPAC(e,t){let n;const a={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,a.underline=(n&1)===1,n<=13?a.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(a.italics=!0,a.color="white"):a.indent=Math.floor((n-16)/2)*4,a}parseChars(e,t){let n,a=null,l=null;if(e>=25?(n=2,l=e-8):(n=1,l=e),l>=17&&l<=19){let u;l===17?u=t+80:l===18?u=t+112:u=t+144,this.logger.log(2,()=>"Special char '"+Cv(u)+"' in channel "+n),a=[u]}else e>=32&&e<=127&&(a=t===0?[e]:[e,t]);return a&&this.logger.log(3,()=>"Char codes =  "+ns(a).join(",")),a}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,a=(e===23||e===31)&&t>=45&&t<=47;if(!(n||a))return!1;let l;const u={};e===16||e===24?(l=Math.floor((t-32)/2),u.background=HR[l],t%2===1&&(u.background=u.background+"_semi")):t===45?u.background="transparent":(u.foreground="black",t===47&&(u.underline=!0));const c=e<=23?1:2;return this.channels[c].setBkgData(u),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Kl(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function Kl(r,e,t){t.a=r,t.b=e}function KR(r,e,t){return t.a===r&&t.b===e}function YR(){return{a:null,b:null}}class Yl{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var kd=function(){if(ur!=null&&ur.VTTCue)return self.VTTCue;const r=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,d){if(typeof d!="string"||!Array.isArray(c))return!1;const h=d.toLowerCase();return~c.indexOf(h)?h:!1}function n(c){return t(r,c)}function a(c){return t(e,c)}function l(c,...d){let h=1;for(;h<arguments.length;h++){const g=arguments[h];for(const p in g)c[p]=g[p]}return c}function u(c,d,h){const g=this,p={enumerable:!0};g.hasBeenReset=!1;let v="",x=!1,S=c,E=d,b=h,A=null,O="",_=!0,k="auto",D="start",F=50,B="middle",M=50,I="middle";Object.defineProperty(g,"id",l({},p,{get:function(){return v},set:function(N){v=""+N}})),Object.defineProperty(g,"pauseOnExit",l({},p,{get:function(){return x},set:function(N){x=!!N}})),Object.defineProperty(g,"startTime",l({},p,{get:function(){return S},set:function(N){if(typeof N!="number")throw new TypeError("Start time must be set to a number.");S=N,this.hasBeenReset=!0}})),Object.defineProperty(g,"endTime",l({},p,{get:function(){return E},set:function(N){if(typeof N!="number")throw new TypeError("End time must be set to a number.");E=N,this.hasBeenReset=!0}})),Object.defineProperty(g,"text",l({},p,{get:function(){return b},set:function(N){b=""+N,this.hasBeenReset=!0}})),Object.defineProperty(g,"region",l({},p,{get:function(){return A},set:function(N){A=N,this.hasBeenReset=!0}})),Object.defineProperty(g,"vertical",l({},p,{get:function(){return O},set:function(N){const U=n(N);if(U===!1)throw new SyntaxError("An invalid or illegal string was specified.");O=U,this.hasBeenReset=!0}})),Object.defineProperty(g,"snapToLines",l({},p,{get:function(){return _},set:function(N){_=!!N,this.hasBeenReset=!0}})),Object.defineProperty(g,"line",l({},p,{get:function(){return k},set:function(N){if(typeof N!="number"&&N!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");k=N,this.hasBeenReset=!0}})),Object.defineProperty(g,"lineAlign",l({},p,{get:function(){return D},set:function(N){const U=a(N);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");D=U,this.hasBeenReset=!0}})),Object.defineProperty(g,"position",l({},p,{get:function(){return F},set:function(N){if(N<0||N>100)throw new Error("Position must be between 0 and 100.");F=N,this.hasBeenReset=!0}})),Object.defineProperty(g,"positionAlign",l({},p,{get:function(){return B},set:function(N){const U=a(N);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");B=U,this.hasBeenReset=!0}})),Object.defineProperty(g,"size",l({},p,{get:function(){return M},set:function(N){if(N<0||N>100)throw new Error("Size must be between 0 and 100.");M=N,this.hasBeenReset=!0}})),Object.defineProperty(g,"align",l({},p,{get:function(){return I},set:function(N){const U=a(N);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");I=U,this.hasBeenReset=!0}})),g.displayState=void 0}return u.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},u}();class qR{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Ov(r){function e(n,a,l,u){return(n|0)*3600+(a|0)*60+(l|0)+parseFloat(u||0)}const t=r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class XR{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let a=0;a<n.length;++a)if(t===n[a]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function Iv(r,e,t,n){const a=n?r.split(n):[r];for(const l in a){if(typeof a[l]!="string")continue;const u=a[l].split(t);if(u.length!==2)continue;const c=u[0],d=u[1];e(c,d)}}const ad=new kd(0,0,""),ql=ad.align==="middle"?"middle":"center";function WR(r,e,t){const n=r;function a(){const c=Ov(r);if(c===null)throw new Error("Malformed timestamp: "+n);return r=r.replace(/^[^\sa-zA-Z-]+/,""),c}function l(c,d){const h=new XR;Iv(c,function(v,x){let S;switch(v){case"region":for(let E=t.length-1;E>=0;E--)if(t[E].id===x){h.set(v,t[E].region);break}break;case"vertical":h.alt(v,x,["rl","lr"]);break;case"line":S=x.split(","),h.integer(v,S[0]),h.percent(v,S[0])&&h.set("snapToLines",!1),h.alt(v,S[0],["auto"]),S.length===2&&h.alt("lineAlign",S[1],["start",ql,"end"]);break;case"position":S=x.split(","),h.percent(v,S[0]),S.length===2&&h.alt("positionAlign",S[1],["start",ql,"end","line-left","line-right","auto"]);break;case"size":h.percent(v,x);break;case"align":h.alt(v,x,["start",ql,"end","left","right"]);break}},/:/,/\s/),d.region=h.get("region",null),d.vertical=h.get("vertical","");let g=h.get("line","auto");g==="auto"&&ad.line===-1&&(g=-1),d.line=g,d.lineAlign=h.get("lineAlign","start"),d.snapToLines=h.get("snapToLines",!0),d.size=h.get("size",100),d.align=h.get("align",ql);let p=h.get("position","auto");p==="auto"&&ad.position===50&&(p=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=p}function u(){r=r.replace(/^\s+/,"")}if(u(),e.startTime=a(),u(),r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);r=r.slice(3),u(),e.endTime=a(),u(),l(r,e)}function kv(r){return r.replace(/<br(?: \/)?>/gi,`
`)}class QR{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new qR,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let l=t.buffer,u=0;for(l=kv(l);u<l.length&&l[u]!=="\r"&&l[u]!==`
`;)++u;const c=l.slice(0,u);return l[u]==="\r"&&++u,l[u]===`
`&&++u,t.buffer=l.slice(u),c}function a(l){Iv(l,function(u,c){},/:/)}try{let l="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;l=n();const c=l.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let u=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(u?u=!1:l=n(),t.state){case"HEADER":/:/.test(l)?a(l):l||(t.state="ID");continue;case"NOTE":l||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(l)){t.state="NOTE";break}if(!l)continue;if(t.cue=new kd(0,0,""),t.state="CUE",l.indexOf("-->")===-1){t.cue.id=l;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{WR(l,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=l.indexOf("-->")!==-1;if(!l||c&&(u=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=l}continue;case"BADCUE":l||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const ZR=/\r\n|\n\r|\n|\r/g,Uf=function(e,t,n=0){return e.slice(n,n+t.length)===t},JR=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),a=parseInt(e.slice(-9,-7)),l=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!ge(t)||!ge(n)||!ge(a)||!ge(l))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*a,t+=60*60*1e3*l,t},Ff=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function Md(r,e,t){return Ff(r.toString())+Ff(e.toString())+Ff(t)}const eL=function(e,t,n){let a=e[t],l=e[a.prevCC];if(!l||!l.new&&a.new){e.ccOffset=e.presentationOffset=a.start,a.new=!1;return}for(;(u=l)!=null&&u.new;){var u;e.ccOffset+=a.start-l.start,a.new=!1,a=l,l=e[a.prevCC]}e.presentationOffset=n};function tL(r,e,t,n,a,l,u){const c=new QR,d=Ii(new Uint8Array(r)).trim().replace(ZR,`
`).split(`
`),h=[],g=e?vR(e.baseTime,e.timescale):0;let p="00:00.000",v=0,x=0,S,E=!0;c.oncue=function(b){const A=t[n];let O=t.ccOffset;const _=(v-g)/9e4;if(A!=null&&A.new&&(x!==void 0?O=t.ccOffset=A.start:eL(t,n,_)),_){if(!e){S=new Error("Missing initPTS for VTT MPEGTS");return}O=_-t.presentationOffset}const k=b.endTime-b.startTime,D=ui((b.startTime+O-x)*9e4,a*9e4)/9e4;b.startTime=Math.max(D,0),b.endTime=Math.max(D+k,0);const F=b.text.trim();b.text=decodeURIComponent(encodeURIComponent(F)),b.id||(b.id=Md(b.startTime,b.endTime,F)),b.endTime>0&&h.push(b)},c.onparsingerror=function(b){S=b},c.onflush=function(){if(S){u(S);return}l(h)},d.forEach(b=>{if(E)if(Uf(b,"X-TIMESTAMP-MAP=")){E=!1,b.slice(16).split(",").forEach(A=>{Uf(A,"LOCAL:")?p=A.slice(6):Uf(A,"MPEGTS:")&&(v=parseInt(A.slice(7)))});try{x=JR(p)/1e3}catch(A){S=A}return}else b===""&&(E=!1);c.parse(b+`
`)}),c.flush()}const Bf="stpp.ttml.im1t",Mv=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Nv=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,iL={left:"start",center:"center",right:"end",start:"start",end:"end"};function Zp(r,e,t,n){const a=Le(new Uint8Array(r),["mdat"]);if(a.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const l=a.map(c=>Ii(c)),u=yR(e.baseTime,1,e.timescale);try{l.forEach(c=>t(nL(c,u)))}catch(c){n(c)}}function nL(r,e){const a=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tt")[0];if(!a)throw new Error("Invalid ttml");const l={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},u=Object.keys(l).reduce((p,v)=>(p[v]=a.getAttribute(`ttp:${v}`)||l[v],p),{}),c=a.getAttribute("xml:space")!=="preserve",d=Jp(jf(a,"styling","style")),h=Jp(jf(a,"layout","region")),g=jf(a,"body","[begin]");return[].map.call(g,p=>{const v=Pv(p,c);if(!v||!p.hasAttribute("begin"))return null;const x=Hf(p.getAttribute("begin"),u),S=Hf(p.getAttribute("dur"),u);let E=Hf(p.getAttribute("end"),u);if(x===null)throw ey(p);if(E===null){if(S===null)throw ey(p);E=x+S}const b=new kd(x-e,E-e,v);b.id=Md(b.startTime,b.endTime,b.text);const A=h[p.getAttribute("region")],O=d[p.getAttribute("style")],_=sL(A,O,d),{textAlign:k}=_;if(k){const D=iL[k];D&&(b.lineAlign=D),b.align=k}return lt(b,_),b}).filter(p=>p!==null)}function jf(r,e,t){const n=r.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function Jp(r){return r.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function Pv(r,e){return[].slice.call(r.childNodes).reduce((t,n,a)=>{var l;return n.nodeName==="br"&&a?t+`
`:(l=n.childNodes)!=null&&l.length?Pv(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function sL(r,e,t){const n="http://www.w3.org/ns/ttml#styling";let a=null;const l=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],u=r!=null&&r.hasAttribute("style")?r.getAttribute("style"):null;return u&&t.hasOwnProperty(u)&&(a=t[u]),l.reduce((c,d)=>{const h=Gf(e,n,d)||Gf(r,n,d)||Gf(a,n,d);return h&&(c[d]=h),c},{})}function Gf(r,e,t){return r&&r.hasAttributeNS(e,t)?r.getAttributeNS(e,t):null}function ey(r){return new Error(`Could not parse ttml timestamp ${r}`)}function Hf(r,e){if(!r)return null;let t=Ov(r);return t===null&&(Mv.test(r)?t=rL(r,e):Nv.test(r)&&(t=aL(r,e))),t}function rL(r,e){const t=Mv.exec(r),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function aL(r,e){const t=Nv.exec(r),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class lL{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=iy(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new Yl(this,"textTrack1"),t=new Yl(this,"textTrack2"),n=new Yl(this,"textTrack3"),a=new Yl(this,"textTrack4");this.cea608Parser1=new Qp(1,e,t),this.cea608Parser2=new Qp(3,n,a)}}addCues(e,t,n,a,l){let u=!1;for(let c=l.length;c--;){const d=l[c],h=oL(d[0],d[1],t,n);if(h>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],n),u=!0,h/(n-t)>.5))return}if(u||l.push([t,n]),this.config.renderTextTracksNatively){const c=this.captionsTracks[e];this.Cues.newCue(c,t,n,a)}else{const c=this.Cues.newCue(null,t,n,a);this.hls.trigger(R.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:a,timescale:l}){const{unparsedVttFrags:u}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:a,timescale:l}),u.length&&(this.unparsedVttFrags=[],u.forEach(c=>{this.onFragLoaded(R.FRAG_LOADED,c)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let a=0;a<n.textTracks.length;a++){const l=n.textTracks[a];if(ty(l,{name:e,lang:t}))return l}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:a}=this,{label:l,languageCode:u}=t[e],c=this.getExistingTrack(l,u);if(c)n[e]=c,ir(n[e]),iv(n[e],a);else{const d=this.createTextTrack("captions",l,u);d&&(d[e]=!0,n[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,a={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=a,this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[a]})}createTextTrack(e,t,n){const a=this.media;if(a)return a.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{ir(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=iy(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)ir(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],a=n.some(l=>l.textCodec===Bf);if(this.config.enableWebVTT||a&&this.config.enableIMSC1){if(Dv(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const u=this.media,c=u?eo(u.textTracks):null;if(this.tracks.forEach((d,h)=>{let g;if(c){let p=null;for(let v=0;v<c.length;v++)if(c[v]&&ty(c[v],d)){p=c[v],c[v]=null;break}p&&(g=p)}if(g)ir(g);else{const p=Uv(d);g=this.createTextTrack(p,d.name,d.lang),g&&(g.mode="disabled")}g&&this.textTracks.push(g)}),c!=null&&c.length){const d=c.filter(h=>h!==null).map(h=>h.label);d.length&&Y.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const u=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:u})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const a=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!a)return;const l=`textTrack${a[1]}`,u=this.captionsProperties[l];u&&(u.label=n.name,n.lang&&(u.languageCode=n.lang),u.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Se.MAIN){var n,a;const{cea608Parser1:l,cea608Parser2:u,lastSn:c}=this,{cc:d,sn:h}=t.frag,g=(n=(a=t.part)==null?void 0:a.index)!=null?n:-1;l&&u&&(h!==c+1||h===c&&g!==this.lastPartIndex+1||d!==this.lastCc)&&(l.reset(),u.reset()),this.lastCc=d,this.lastSn=h,this.lastPartIndex=g}}onFragLoaded(e,t){const{frag:n,payload:a}=t;if(n.type===Se.SUBTITLE)if(a.byteLength){const l=n.decryptdata,u="stats"in t;if(l==null||!l.encrypted||u){const c=this.tracks[n.level],d=this.vttCCs;d[n.cc]||(d[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),c&&c.textCodec===Bf?this._parseIMSC1(n,a):this._parseVTTs(t)}}else this.hls.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Zp(t,this.initPTS[e.cc],a=>{this._appendCues(a,e.level),n.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},a=>{Y.log(`Failed to parse IMSC1: ${a}`),n.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:a})})}_parseVTTs(e){var t;const{frag:n,payload:a}=e,{initPTS:l,unparsedVttFrags:u}=this,c=l.length-1;if(!l[n.cc]&&c===-1){u.push(e);return}const d=this.hls,h=(t=n.initSegment)!=null&&t.data?ci(n.initSegment.data,new Uint8Array(a)):a;tL(h,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,g=>{this._appendCues(g,n.level),d.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},g=>{const p=g.message==="Missing initPTS for VTT MPEGTS";p?u.push(e):this._fallbackToIMSC1(n,a),Y.log(`Failed to parse VTT cue: ${g}`),!(p&&c>n.cc)&&d.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:g})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Zp(t,this.initPTS[e.cc],()=>{n.textCodec=Bf,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const a=this.textTracks[t];if(!a||a.mode==="disabled")return;e.forEach(l=>nv(a,l))}else{const a=this.tracks[t];if(!a)return;const l=a.default?"default":"subtitles"+t;n.trigger(R.CUES_PARSED,{type:"subtitles",cues:e,track:l})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Se.SUBTITLE&&this.onFragLoaded(R.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:a}=this;if(!this.enabled||!n||!a)return;const{frag:l,samples:u}=t;if(!(l.type===Se.MAIN&&this.closedCaptionsForLevel(l)==="NONE"))for(let c=0;c<u.length;c++){const d=u[c].bytes;if(d){const h=this.extractCea608Data(d);n.addData(u[c].pts,h[0]),a.addData(u[c].pts,h[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:a,type:l}){const{media:u}=this;if(!(!u||u.currentTime<n)){if(!l||l==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(d=>Jf(c[d],t,n))}if(this.config.renderTextTracksNatively&&t===0&&a!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(d=>Jf(c[d],t,a))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let a=2;for(let l=0;l<n;l++){const u=e[a++],c=127&e[a++],d=127&e[a++];if(c===0&&d===0)continue;if((4&u)!==0){const g=3&u;(g===0||g===1)&&(t[g].push(c),t[g].push(d))}}return t}}function Uv(r){return r.characteristics&&/transcribes-spoken-dialog/gi.test(r.characteristics)&&/describes-music-and-sound/gi.test(r.characteristics)?"captions":"subtitles"}function ty(r,e){return!!r&&r.kind===Uv(e)&&rd(e,r)}function oL(r,e,t,n){return Math.min(e,n)-Math.max(r,t)}function iy(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Nd{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&ge(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&Y.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((a,l)=>this.isLevelAllowed(a)&&l<=e);return this.clientRect=null,Nd.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const a=(c,d)=>d?c.width!==d.width||c.height!==d.height:!0;let l=e.length-1;const u=Math.max(t,n);for(let c=0;c<e.length;c+=1){const d=e[c];if((d.width>=u||d.height>=u)&&a(d,e[c+1])){l=c;break}}return l}}class uL{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const a=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=a,a&&typeof a.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const a=performance.now();if(t){if(this.lastTime){const l=a-this.lastTime,u=n-this.lastDroppedFrames,c=t-this.lastDecodedFrames,d=1e3*u/l,h=this.hls;if(h.trigger(R.FPS_DROP,{currentDropped:u,currentDecoded:c,totalDroppedFrames:n}),d>0&&u>h.config.fpsDroppedMonitoringThreshold*c){let g=h.currentLevel;Y.warn("drop FPS ratio greater than max allowed value for currentLevel: "+g),g>0&&(h.autoLevelCapping===-1||h.autoLevelCapping>=g)&&(g=g-1,h.trigger(R.FPS_DROP_LEVEL_CAPPING,{level:g,droppedLevel:h.currentLevel}),h.autoLevelCapping=g,this.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Xl="[eme]";class lr{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=lr.CDMCleanupPromise?[lr.CDMCleanupPromise]:[],this.debug=Y.debug.bind(Y,Xl),this.log=Y.log.bind(Y,Xl),this.warn=Y.warn.bind(Y,Xl),this.error=Y.error.bind(Y,Xl),this.onMediaEncrypted=t=>{const{initDataType:n,initData:a}=t,l=`"${t.type}" event: init data type: "${n}"`;if(this.debug(l),a!==null){if(!this.keyFormatPromise){let u=Object.keys(this.keySystemAccessPromises);u.length||(u=Bl(this.config));const c=u.map(Af).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(c)}this.keyFormatPromise.then(u=>{const c=Tf(u);let d,h;if(n==="sinf"){if(c!==Be.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${c}`);return}const S=ft(new Uint8Array(a));try{const E=Sd(JSON.parse(S).sinf),b=Qy(E);if(!b)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=b.subarray(8,24),h=Be.FAIRPLAY}catch(E){this.warn(`${l} Failed to parse sinf: ${E}`);return}}else{if(c!==Be.WIDEVINE&&c!==Be.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${c}`);return}const S=j1(a),E=S.filter(A=>!!A.systemId&&bf(A.systemId)===c);E.length>1&&this.warn(`${l} Using first of ${E.length} pssh found for selected key-system ${c}`);const b=E[0];if(!b){S.length===0||S.some(A=>!A.systemId)?this.warn(`${l} contains incomplete or invalid pssh data`):this.log(`ignoring ${l} for ${S.map(A=>bf(A.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(h=bf(b.systemId),b.version===0&&b.data)if(h===Be.WIDEVINE){const A=b.data.length-22;d=b.data.subarray(A,A+16)}else h===Be.PLAYREADY&&(d=$y(b.data))}if(!h||!d){this.log(`Unable to handle ${l} with key-system ${c}`);return}const g=Di.hexDump(d),{keyIdToKeySessionPromise:p,mediaKeySessions:v}=this;let x=p[g];for(let S=0;S<v.length;S++){const E=v[S],b=E.decryptdata;if(!b.keyId)continue;const A=Di.hexDump(b.keyId);if(g===A||b.uri.replace(/-/g,"").indexOf(g)!==-1){if(x=p[A],b.pssh)break;delete p[A],b.pssh=new Uint8Array(a),b.keyId=d,x=p[g]=x.then(()=>this.generateRequestWithPreferredKeySession(E,n,a,"encrypted-event-key-match")),x.catch(O=>this.handleError(O));break}}if(!x){if(h!==c){this.log(`Ignoring "${l}" with ${h} init data for selected key-system ${c}`);return}x=p[g]=this.getKeySystemSelectionPromise([h]).then(({keySystem:S,mediaKeys:E})=>{var b;this.throwIfDestroyed();const A=new xa("ISO-23001-7",g,(b=Af(S))!=null?b:"");return A.pssh=new Uint8Array(a),A.keyId=d,this.attemptSetMediaKeys(S,E).then(()=>{this.throwIfDestroyed();const O=this.createMediaKeySessionContext({decryptdata:A,keySystem:S,mediaKeys:E});return this.generateRequestWithPreferredKeySession(O,n,a,"encrypted-event-no-match")})}),x.catch(S=>this.handleError(S))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,a=t[e];if(a)return a.licenseUrl;if(e===Be.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(u,c,d)=>!!u&&d.indexOf(u)===c,a=t.map(u=>u.audioCodec).filter(n),l=t.map(u=>u.videoCodec).filter(n);return a.length+l.length===0&&l.push("avc1.42e01e"),new Promise((u,c)=>{const d=h=>{const g=h.shift();this.getMediaKeysPromise(g,a,l).then(p=>u({keySystem:g,mediaKeys:p})).catch(p=>{h.length?d(h):p instanceof ai?c(p):c(new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};d(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let a=`Configured requestMediaKeySystemAccess is not a function ${n}`;return Hy===null&&self.location.protocol==="http:"&&(a=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(a))}return n(e,t)}getMediaKeysPromise(e,t,n){const a=g1(e,t,n,this.config.drmSystemOptions),l=this.keySystemAccessPromises[e];let u=l==null?void 0:l.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(a)}`),u=this.requestMediaKeySystemAccess(e,a);const c=this.keySystemAccessPromises[e]={keySystemAccess:u};return u.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),u.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const h=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),c.mediaKeys=d.createMediaKeys().then(g=>(this.log(`Media-keys created for "${e}"`),h.then(p=>p?this.setMediaKeysServerCertificate(g,e,p):g))),c.mediaKeys.catch(g=>{this.error(`Failed to create media-keys for "${e}"}: ${g}`)}),c.mediaKeys})}return u.then(()=>l.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Di.hexDump(e.keyId||[])}`);const a=n.createSession(),l={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:a,keyStatus:"status-pending"};return this.mediaKeySessions.push(l),l}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),a=this.getKeyIdString(t),l="cenc";this.keyIdToKeySessionPromise[a]=this.generateRequestWithPreferredKeySession(n,l,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Di.hexDump(e.keyId)}updateKeySession(e,t){var n;const a=e.mediaKeysSession;return this.log(`Updating key-session "${a.sessionId}" for keyID ${Di.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),a.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const a=Bl(this.config),l=e.map(Tf).filter(u=>!!u&&a.indexOf(u)!==-1);return this.getKeySystemSelectionPromise(l).then(({keySystem:u})=>{const c=Af(u);c?t(c):n(new Error(`Unable to find format for key-system "${u}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),a=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${a}`);let l=this.keyIdToKeySessionPromise[n];return l||(l=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:u,mediaKeys:c})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${a}`),this.attemptSetMediaKeys(u,c).then(()=>{this.throwIfDestroyed();const d=this.createMediaKeySessionContext({keySystem:u,mediaKeys:c,decryptdata:t});return this.generateRequestWithPreferredKeySession(d,"cenc",t.pssh,"playlist-key")}))),l.catch(u=>this.handleError(u))),l}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof ai?this.hls.trigger(R.ERROR,e.data):this.hls.trigger(R.ERROR,{type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const a=Tf(e.keyFormat),l=a?[a]:Bl(this.config);return this.attemptKeySystemAccess(l)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Bl(this.config)),e.length===0)throw new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const a=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(a),a.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(a),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(l=>n.indexOf(l)===-1)})}generateRequestWithPreferredKeySession(e,t,n,a){var l,u;const c=(l=this.config.drmSystems)==null||(u=l[e.keySystem])==null?void 0:u.generateRequest;if(c)try{const S=c.call(this.hls,t,n,e);if(!S)throw new Error("Invalid response from configured generateRequest filter");t=S.initDataType,n=e.decryptdata.pssh=S.initData?new Uint8Array(S.initData):null}catch(S){var d;if(this.warn(S.message),(d=this.hls)!=null&&d.config.debug)throw S}if(n===null)return this.log(`Skipping key-session request for "${a}" (no initData)`),Promise.resolve(e);const h=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${a}": ${h} (init data type: ${t} length: ${n?n.byteLength:null})`);const g=new Id,p=e._onmessage=S=>{const E=e.mediaKeysSession;if(!E){g.emit("error",new Error("invalid state"));return}const{messageType:b,message:A}=S;this.log(`"${b}" message event for session "${E.sessionId}" message size: ${A.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,A).catch(O=>{this.handleError(O),g.emit("error",O)}):b==="license-release"?e.keySystem===Be.FAIRPLAY&&(this.updateKeySession(e,Qf("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${b}"`)},v=e._onkeystatuseschange=S=>{if(!e.mediaKeysSession){g.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const b=e.keyStatus;g.emit("keyStatus",b),b==="expired"&&(this.warn(`${e.keySystem} expired for key ${h}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",p),e.mediaKeysSession.addEventListener("keystatuseschange",v);const x=new Promise((S,E)=>{g.on("error",E),g.on("keyStatus",b=>{b.startsWith("usable")?S():b==="output-restricted"?E(new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):b==="internal-error"?E(new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${b}"`)):b==="expired"?E(new Error("key expired while generating request")):this.warn(`unhandled key status change "${b}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var S;this.log(`Request generated for key-session "${(S=e.mediaKeysSession)==null?void 0:S.sessionId}" keyId: ${h}`)}).catch(S=>{throw new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_NO_SESSION,error:S,fatal:!1},`Error generating key-session request: ${S}`)}).then(()=>x).catch(S=>{throw g.removeAllListeners(),this.removeSession(e),S}).then(()=>(g.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Di.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Di.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,a=new n(t),l=this.getServerCertificateUrl(e);return l?(this.log(`Fetching server certificate for "${e}"`),new Promise((u,c)=>{const d={responseType:"arraybuffer",url:l},h=t.certLoadPolicy.default,g={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(v,x,S,E)=>{u(v.data)},onError:(v,x,S,E)=>{c(new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:vt({url:d.url,data:void 0},v)},`"${e}" certificate request failed (${l}). Status: ${v.code} (${v.text})`))},onTimeout:(v,x,S)=>{c(new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${l})`))},onAbort:(v,x,S)=>{c(new Error("aborted"))}};a.load(d,g,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((a,l)=>{e.setServerCertificate(n).then(u=>{this.log(`setServerCertificate ${u?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),a(e)}).catch(u=>{l(new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:u,fatal:!0},u.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(a=>{throw new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:a,fatal:!0},a.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const a=new DOMParser().parseFromString(n,"application/xml"),l=a.querySelectorAll("HttpHeader");if(l.length>0){let g;for(let p=0,v=l.length;p<v;p++){var u,c;g=l[p];const x=(u=g.querySelector("name"))==null?void 0:u.textContent,S=(c=g.querySelector("value"))==null?void 0:c.textContent;x&&S&&e.setRequestHeader(x,S)}}const d=a.querySelector("Challenge"),h=d==null?void 0:d.textContent;if(!h)throw new Error("Cannot find <Challenge> in key message");return Qf(atob(h))}setupLicenseXHR(e,t,n,a){const l=this.config.licenseXhrSetup;return l?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return l.call(this.hls,e,t,n,a)}).catch(u=>{if(!n.decryptdata)throw u;return e.open("POST",t,!0),l.call(this.hls,e,t,n,a)}).then(u=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:u||a})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:a}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((a,l)=>{const u=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${u}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return l(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let d=c.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const h=this.config.licenseResponseCallback;if(h)try{d=h.call(this.hls,c,u,e)}catch(g){this.error(g)}a(d)}else{const d=n.errorRetry,h=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>h||c.status>=400&&c.status<500)l(new ai({type:Te.KEY_SYSTEM_ERROR,details:te.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:c,response:{url:u,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${u}). Status: ${c.status} (${c.statusText})`));else{const g=h-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${g} attempts left`),this.requestLicense(e,t).then(a,l)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=c,this.setupLicenseXHR(c,u,e,t).then(({xhr:d,licenseChallenge:h})=>{e.keySystem==Be.PLAYREADY&&(h=this.unpackPlayReadyKeyMessage(d,h)),d.send(h)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},xa.clearKeyUriToKeyIdMap();const n=t.length;lr.CDMCleanupPromise=Promise.all(t.map(a=>this.removeSession(a)).concat(e==null?void 0:e.setMediaKeys(null).catch(a=>{this.log(`Could not clear media keys: ${a}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((a,l)=>(a.indexOf(l.keyFormat)===-1&&a.push(l.keyFormat),a),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const a=this.mediaKeySessions.indexOf(e);return a>-1&&this.mediaKeySessions.splice(a,1),t.remove().catch(l=>{this.log(`Could not remove session: ${l}`)}).then(()=>t.close()).catch(l=>{this.log(`Could not close session: ${l}`)})}}}lr.CDMCleanupPromise=void 0;class ai extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var Dt;(function(r){r.MANIFEST="m",r.AUDIO="a",r.VIDEO="v",r.MUXED="av",r.INIT="i",r.CAPTION="c",r.TIMED_TEXT="tt",r.KEY="k",r.OTHER="o"})(Dt||(Dt={}));var ld;(function(r){r.DASH="d",r.HLS="h",r.SMOOTH="s",r.OTHER="o"})(ld||(ld={}));var us;(function(r){r.OBJECT="CMCD-Object",r.REQUEST="CMCD-Request",r.SESSION="CMCD-Session",r.STATUS="CMCD-Status"})(us||(us={}));const cL={[us.OBJECT]:["br","d","ot","tb"],[us.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[us.SESSION]:["cid","pr","sf","sid","st","v"],[us.STATUS]:["bs","rtp"]};class fr{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof fr?n:new fr(n))),this.value=e,this.params=t}}class Fv{constructor(e){this.description=void 0,this.description=e}}const fL="Dict";function dL(r){return Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":typeof r=="object"?JSON.stringify(r):String(r)}function hL(r,e,t,n){return new Error(`failed to ${r} "${dL(e)}" as ${t}`,{cause:n})}const ny="Bare Item",mL="Boolean",gL="Byte Sequence",pL="Decimal",yL="Integer";function vL(r){return r<-999999999999999||999999999999999<r}const xL=/[\x00-\x1f\x7f]+/,SL="Token",EL="Key";function ki(r,e,t){return hL("serialize",r,e,t)}function TL(r){if(typeof r!="boolean")throw ki(r,mL);return r?"?1":"?0"}function bL(r){return btoa(String.fromCharCode(...r))}function AL(r){if(ArrayBuffer.isView(r)===!1)throw ki(r,gL);return`:${bL(r)}:`}function Bv(r){if(vL(r))throw ki(r,yL);return r.toString()}function RL(r){return`@${Bv(r.getTime()/1e3)}`}function jv(r,e){if(r<0)return-jv(-r,e);const t=Math.pow(10,e);if(Math.abs(r*t%1-.5)<Number.EPSILON){const a=Math.floor(r*t);return(a%2===0?a:a+1)/t}else return Math.round(r*t)/t}function LL(r){const e=jv(r,3);if(Math.floor(Math.abs(e)).toString().length>12)throw ki(r,pL);const t=e.toString();return t.includes(".")?t:`${t}.0`}const _L="String";function DL(r){if(xL.test(r))throw ki(r,_L);return`"${r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function CL(r){return r.description||r.toString().slice(7,-1)}function sy(r){const e=CL(r);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw ki(e,SL);return e}function od(r){switch(typeof r){case"number":if(!ge(r))throw ki(r,ny);return Number.isInteger(r)?Bv(r):LL(r);case"string":return DL(r);case"symbol":return sy(r);case"boolean":return TL(r);case"object":if(r instanceof Date)return RL(r);if(r instanceof Uint8Array)return AL(r);if(r instanceof Fv)return sy(r);default:throw ki(r,ny)}}function ud(r){if(/^[a-z*][a-z0-9\-_.*]*$/.test(r)===!1)throw ki(r,EL);return r}function Pd(r){return r==null?"":Object.entries(r).map(([e,t])=>t===!0?`;${ud(e)}`:`;${ud(e)}=${od(t)}`).join("")}function Gv(r){return r instanceof fr?`${od(r.value)}${Pd(r.params)}`:od(r)}function wL(r){return`(${r.value.map(Gv).join(" ")})${Pd(r.params)}`}function OL(r,e={whitespace:!0}){if(typeof r!="object")throw ki(r,fL);const t=r instanceof Map?r.entries():Object.entries(r),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([a,l])=>{l instanceof fr||(l=new fr(l));let u=ud(a);return l.value===!0?u+=Pd(l.params):(u+="=",Array.isArray(l.value)?u+=wL(l):u+=Gv(l)),u}).join(`,${n}`)}function IL(r,e){return OL(r,e)}const kL=r=>r==="ot"||r==="sf"||r==="st",ML=r=>typeof r=="number"?ge(r):r!=null&&r!==""&&r!==!1;function NL(r,e){const t=new URL(r),n=new URL(e);if(t.origin!==n.origin)return r;const a=t.pathname.split("/").slice(1),l=n.pathname.split("/").slice(1,-1);for(;a[0]===l[0];)a.shift(),l.shift();for(;l.length;)l.shift(),a.unshift("..");return a.join("/")}function PL(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const l=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(a=="x"?l:l&3|8).toString(16)})}}}const ao=r=>Math.round(r),UL=(r,e)=>(e!=null&&e.baseUrl&&(r=NL(r,e.baseUrl)),encodeURIComponent(r)),Wl=r=>ao(r/100)*100,FL={br:ao,d:ao,bl:Wl,dl:Wl,mtp:Wl,nor:UL,rtp:Wl,tb:ao};function BL(r,e){const t={};if(r==null||typeof r!="object")return t;const n=Object.keys(r).sort(),a=lt({},FL,e==null?void 0:e.formatters),l=e==null?void 0:e.filter;return n.forEach(u=>{if(l!=null&&l(u))return;let c=r[u];const d=a[u];d&&(c=d(c,e)),!(u==="v"&&c===1)&&(u=="pr"&&c===1||ML(c)&&(kL(u)&&typeof c=="string"&&(c=new Fv(c)),t[u]=c))}),t}function Hv(r,e={}){return r?IL(BL(r,e),lt({whitespace:!1},e)):""}function jL(r,e={}){if(!r)return{};const t=Object.entries(r),n=Object.entries(cL).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),a=t.reduce((l,u)=>{var c,d;const[h,g]=u,p=((c=n.find(v=>v[1].includes(h)))==null?void 0:c[0])||us.REQUEST;return(d=l[p])!=null||(l[p]={}),l[p][h]=g,l},{});return Object.entries(a).reduce((l,[u,c])=>(l[u]=Hv(c,e),l),{})}function GL(r,e,t){return lt(r,jL(e,t))}const HL="CMCD";function $L(r,e={}){if(!r)return"";const t=Hv(r,e);return`${HL}=${encodeURIComponent(t)}`}const ry=/CMCD=[^&#]+/;function VL(r,e,t){const n=$L(e,t);if(!n)return r;if(ry.test(r))return r.replace(ry,n);const a=r.includes("?")?"&":"?";return`${r}${a}${n}`}class zL{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=a=>{try{this.apply(a,{ot:Dt.MANIFEST,su:!this.initialized})}catch(l){Y.warn("Could not generate manifest CMCD data.",l)}},this.applyFragmentData=a=>{try{const l=a.frag,u=this.hls.levels[l.level],c=this.getObjectType(l),d={d:l.duration*1e3,ot:c};(c===Dt.VIDEO||c===Dt.AUDIO||c==Dt.MUXED)&&(d.br=u.bitrate/1e3,d.tb=this.getTopBandwidth(c)/1e3,d.bl=this.getBufferLength(c)),this.apply(a,d)}catch(l){Y.warn("Could not generate segment CMCD data.",l)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||PL(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHED,this.onMediaDetached,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHED,this.onMediaDetached,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,a;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(a=t.tracks.video)==null?void 0:a.buffer}createData(){var e;return{v:1,sf:ld.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){lt(t,this.createData());const n=t.ot===Dt.INIT||t.ot===Dt.VIDEO||t.ot===Dt.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:a}=this;a&&(t=Object.keys(t).reduce((l,u)=>(a.includes(u)&&(l[u]=t[u]),l),{})),this.useHeaders?(e.headers||(e.headers={}),GL(e.headers,t)):e.url=VL(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Dt.TIMED_TEXT;if(e.sn==="initSegment")return Dt.INIT;if(t==="audio")return Dt.AUDIO;if(t==="main")return this.hls.audioTracks.length?Dt.VIDEO:Dt.MUXED}getTopBandwidth(e){let t=0,n;const a=this.hls;if(e===Dt.AUDIO)n=a.audioTracks;else{const l=a.maxAutoLevel,u=l>-1?l+1:a.levels.length;n=a.levels.slice(0,u)}for(const l of n)l.bitrate>t&&(t=l.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===Dt.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Ke.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(l){this.loader=void 0,this.loader=new n(l)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(l,u,c){t(l),this.loader.load(l,u,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(l){this.loader=void 0,this.loader=new n(l)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(l,u,c){t(l),this.loader.load(l,u,c)}}}}const KL=3e5;class YL{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=Y.log.bind(Y,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===At.SendAlternateToPenaltyBox&&n.flags===pi.MoveAllAlternatesMatchingHost){const a=this.levels;let l=this.pathwayPriority,u=this.pathwayId;if(t.context){const{groupId:c,pathwayId:d,type:h}=t.context;c&&a?u=this.getPathwayForGroupId(c,h,u):d&&(u=d)}u in this.penalizedPathways||(this.penalizedPathways[u]=performance.now()),!l&&a&&(l=a.reduce((c,d)=>(c.indexOf(d.pathwayId)===-1&&c.push(d.pathwayId),c),[])),l&&l.length>1&&(this.updatePathwayPriority(l),n.resolved=this.pathwayId!==u),n.resolved||Y.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${u} levels: ${a&&a.length} priorities: ${JSON.stringify(l)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,a=performance.now();Object.keys(n).forEach(l=>{a-n[l]>KL&&delete n[l]});for(let l=0;l<e.length;l++){const u=e[l];if(u in n)continue;if(u===this.pathwayId)return;const c=this.hls.nextLoadLevel,d=this.hls.levels[c];if(t=this.getLevelsForPathway(u),t.length>0){this.log(`Setting Pathway to "${u}"`),this.pathwayId=u,lv(t),this.hls.trigger(R.LEVELS_UPDATED,{levels:t});const h=this.hls.levels[c];d&&h&&this.levels&&(h.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&h.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${h.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(e,t,n){const a=this.getLevelsForPathway(n).concat(this.levels||[]);for(let l=0;l<a.length;l++)if(t===Me.AUDIO_TRACK&&a[l].hasAudioGroup(e)||t===Me.SUBTITLE_TRACK&&a[l].hasSubtitleGroup(e))return a[l].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},a={};e.forEach(l=>{const{ID:u,"BASE-ID":c,"URI-REPLACEMENT":d}=l;if(t.some(g=>g.pathwayId===u))return;const h=this.getLevelsForPathway(c).map(g=>{const p=new Ze(g.attrs);p["PATHWAY-ID"]=u;const v=p.AUDIO&&`${p.AUDIO}_clone_${u}`,x=p.SUBTITLES&&`${p.SUBTITLES}_clone_${u}`;v&&(n[p.AUDIO]=v,p.AUDIO=v),x&&(a[p.SUBTITLES]=x,p.SUBTITLES=x);const S=$v(g.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),E=new cr({attrs:p,audioCodec:g.audioCodec,bitrate:g.bitrate,height:g.height,name:g.name,url:S,videoCodec:g.videoCodec,width:g.width});if(g.audioGroups)for(let b=1;b<g.audioGroups.length;b++)E.addGroupId("audio",`${g.audioGroups[b]}_clone_${u}`);if(g.subtitleGroups)for(let b=1;b<g.subtitleGroups.length;b++)E.addGroupId("text",`${g.subtitleGroups[b]}_clone_${u}`);return E});t.push(...h),ay(this.audioTracks,n,d,u),ay(this.subtitleTracks,a,d,u)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let a;try{a=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(a.protocol!=="data:"){const g=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;a.searchParams.set("_HLS_pathway",this.pathwayId),a.searchParams.set("_HLS_throughput",""+g)}const l={responseType:"json",url:a.href},u=t.steeringManifestLoadPolicy.default,c=u.errorRetry||u.timeoutRetry||{},d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},h={onSuccess:(g,p,v,x)=>{this.log(`Loaded steering manifest: "${a}"`);const S=g.data;if(S.VERSION!==1){this.log(`Steering VERSION ${S.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=S.TTL;const{"RELOAD-URI":E,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":A}=S;if(E)try{this.uri=new self.URL(E,a).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${E}`);return}this.scheduleRefresh(this.uri||v.url),b&&this.clonePathways(b);const O={steeringManifest:S,url:a.toString()};this.hls.trigger(R.STEERING_MANIFEST_LOADED,O),A&&this.updatePathwayPriority(A)},onError:(g,p,v,x)=>{if(this.log(`Error loading steering manifest: ${g.code} ${g.text} (${p.url})`),this.stopLoad(),g.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let S=this.timeToLoad*1e3;if(g.code===429){const E=this.loader;if(typeof(E==null?void 0:E.getResponseHeader)=="function"){const b=E.getResponseHeader("Retry-After");b&&(S=parseFloat(b)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,S)},onTimeout:(g,p,v)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${a}`),this.loader.load(l,d,h)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const a=(n=this.hls)==null?void 0:n.media;if(a&&!a.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function ay(r,e,t,n){r&&Object.keys(e).forEach(a=>{const l=r.filter(u=>u.groupId===a).map(u=>{const c=lt({},u);return c.details=void 0,c.attrs=new Ze(c.attrs),c.url=c.attrs.URI=$v(u.url,u.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[a],c.attrs["PATHWAY-ID"]=n,c});r.push(...l)})}function $v(r,e,t,n){const{HOST:a,PARAMS:l,[t]:u}=n;let c;e&&(c=u==null?void 0:u[e],c&&(r=c));const d=new self.URL(r);return a&&!c&&(d.host=a),l&&Object.keys(l).sort().forEach(h=>{h&&d.searchParams.set(h,l[h])}),d.href}const qL=/^age:\s*[\d.]+\s*$/im;class Vv{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new ko,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0,a.aborted=!1;const l=this.xhrSetup;l?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return l(n,t.url)}).catch(u=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),l(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(u=>{this.callbacks.onError({code:n.status,text:u.message},t,n,a)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const a=t.headers,{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=n.loadPolicy;if(a)for(const c in a)e.setRequestHeader(c,a[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=l&&ge(l)?l:u,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const a=t.readyState,l=this.config;if(!n.aborted&&a>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),l.timeout!==l.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),l.timeout=l.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),l.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),a===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,c=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const p=c??t.response;if(p!=null){n.loading.end=Math.max(self.performance.now(),n.loading.first);const v=t.responseType==="arraybuffer"?p.byteLength:p.length;if(n.loaded=n.total=v,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const x=this.callbacks.onProgress;if(x&&x(n,e,p,t),!this.callbacks)return;const S={url:t.responseURL,data:p,code:u};this.callbacks.onSuccess(S,n,e,t);return}}const d=l.loadPolicy.errorRetry,h=n.retry,g={url:e.url,data:void 0,code:u};Ro(d,h,!1,g)?this.retry(d):(Y.error(`${u} while loading ${e.url}`),this.callbacks.onError({code:u,text:t.statusText},e,t,n))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Ro(e,t,!0))this.retry(e);else{var n;Y.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const a=this.callbacks;a&&(this.abortInternal(),a.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=bd(e,n.retry),n.retry++,Y.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&qL.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function XL(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const WL=/(\d+)-(\d+)\/(\d+)/;class ly{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||e_,this.controller=new self.AbortController,this.stats=new ko}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();const l=QL(e,this.controller.signal),u=n.onProgress,c=e.responseType==="arraybuffer",d=c?"byteLength":"length",{maxTimeToFirstByteMs:h,maxLoadTimeMs:g}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,l),self.clearTimeout(this.requestTimeout),t.timeout=h&&ge(h)?h:g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(a,e,this.response)},t.timeout),self.fetch(this.request).then(p=>{this.response=this.loader=p;const v=Math.max(self.performance.now(),a.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=g,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(a,e,this.response)},g-(v-a.loading.start)),!p.ok){const{status:x,statusText:S}=p;throw new t_(S||"fetch, bad network response",x,p)}return a.loading.first=v,a.total=JL(p.headers)||a.total,u&&ge(t.highWaterMark)?this.loadProgressively(p,a,e,t.highWaterMark,u):c?p.arrayBuffer():e.responseType==="json"?p.json():p.text()}).then(p=>{const v=this.response;if(!v)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first);const x=p[d];x&&(a.loaded=a.total=x);const S={url:v.url,data:p,code:v.status};u&&!ge(t.highWaterMark)&&u(a,e,p,v),n.onSuccess(S,a,e,v)}).catch(p=>{if(self.clearTimeout(this.requestTimeout),a.aborted)return;const v=p&&p.code||0,x=p?p.message:null;n.onError({code:v,text:x},e,p?p.details:null,a)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,a=0,l){const u=new fv,c=e.body.getReader(),d=()=>c.read().then(h=>{if(h.done)return u.dataLength&&l(t,n,u.flush(),e),Promise.resolve(new ArrayBuffer(0));const g=h.value,p=g.length;return t.loaded+=p,p<a||u.dataLength?(u.push(g),u.dataLength>=a&&l(t,n,u.flush(),e)):l(t,n,g,e),d()}).catch(()=>Promise.reject());return d()}}function QL(r,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(lt({},r.headers))};return r.rangeEnd&&t.headers.set("Range","bytes="+r.rangeStart+"-"+String(r.rangeEnd-1)),t}function ZL(r){const e=WL.exec(r);if(e)return parseInt(e[2])-parseInt(e[1])+1}function JL(r){const e=r.get("Content-Range");if(e){const n=ZL(e);if(ge(n))return n}const t=r.get("Content-Length");if(t)return parseInt(t)}function e_(r,e){return new self.Request(r.url,e)}class t_ extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const i_=/\s/,n_={newCue(r,e,t,n){const a=[];let l,u,c,d,h;const g=self.VTTCue||self.TextTrackCue;for(let v=0;v<n.rows.length;v++)if(l=n.rows[v],c=!0,d=0,h="",!l.isEmpty()){var p;for(let E=0;E<l.chars.length;E++)i_.test(l.chars[E].uchar)&&c?d++:(h+=l.chars[E].uchar,c=!1);l.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const x=kv(h.trim()),S=Md(e,t,x);r!=null&&(p=r.cues)!=null&&p.getCueById(S)||(u=new g(e,t,x),u.id=S,u.line=v+1,u.align="left",u.position=10+Math.min(80,Math.floor(d*8/32)*10),a.push(u))}return r&&a.length&&(a.sort((v,x)=>v.line==="auto"||x.line==="auto"?0:v.line>8&&x.line>8?x.line-v.line:v.line-x.line),a.forEach(v=>nv(r,v))),a}},s_={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},zv=vt(vt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Vv,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:OA,bufferController:NR,capLevelController:Nd,errorController:xA,fpsController:uL,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Hy,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:s_},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},r_()),{},{subtitleStreamController:OR,subtitleTrackController:kR,timelineController:lL,audioStreamController:CR,audioTrackController:wR,emeController:lr,cmcdController:zL,contentSteeringController:YL});function r_(){return{cueHandler:n_,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function a_(r,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=cd(r),n=["manifest","level","frag"],a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(l=>{const u=`${l==="level"?"playlist":l}LoadPolicy`,c=e[u]===void 0,d=[];a.forEach(h=>{const g=`${l}Loading${h}`,p=e[g];if(p!==void 0&&c){d.push(g);const v=t[u].default;switch(e[u]={default:v},h){case"TimeOut":v.maxLoadTimeMs=p,v.maxTimeToFirstByteMs=p;break;case"MaxRetry":v.errorRetry.maxNumRetry=p,v.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":v.errorRetry.retryDelayMs=p,v.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=p,v.timeoutRetry.maxRetryDelayMs=p;break}}}),d.length&&Y.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${u}": ${JSON.stringify(e[u])}`)}),vt(vt({},t),e)}function cd(r){return r&&typeof r=="object"?Array.isArray(r)?r.map(cd):Object.keys(r).reduce((e,t)=>(e[t]=cd(r[t]),e),{}):r}function l_(r){const e=r.loader;e!==ly&&e!==Vv?(Y.log("[config]: Custom loader detected, cannot enable progressive streaming"),r.progressive=!1):XL()&&(r.loader=ly,r.progressive=!0,r.enableSoftwareAES=!0,Y.log("[config]: Progressive streaming enabled, using FetchLoader"))}let $f;class o_ extends Ad{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,a=[],l={},u={};let c=!1,d=!1,h=!1;t.levels.forEach(g=>{var p,v;const x=g.attrs;let{audioCodec:S,videoCodec:E}=g;((p=S)==null?void 0:p.indexOf("mp4a.40.34"))!==-1&&($f||($f=/chrome|firefox/i.test(navigator.userAgent)),$f&&(g.audioCodec=S=void 0)),S&&(g.audioCodec=S=To(S,n)),((v=E)==null?void 0:v.indexOf("avc1"))===0&&(E=g.videoCodec=q1(E));const{width:b,height:A,unknownCodecs:O}=g;if(c||(c=!!(b&&A)),d||(d=!!E),h||(h=!!S),O!=null&&O.length||S&&!Df(S,"audio",n)||E&&!Df(E,"video",n))return;const{CODECS:_,"FRAME-RATE":k,"HDCP-LEVEL":D,"PATHWAY-ID":F,RESOLUTION:B,"VIDEO-RANGE":M}=x,N=`${`${F||"."}-`}${g.bitrate}-${B}-${k}-${_}-${M}-${D}`;if(l[N])if(l[N].uri!==g.url&&!g.attrs["PATHWAY-ID"]){const U=u[N]+=1;g.attrs["PATHWAY-ID"]=new Array(U+1).join(".");const Q=new cr(g);l[N]=Q,a.push(Q)}else l[N].addGroupId("audio",x.AUDIO),l[N].addGroupId("text",x.SUBTITLES);else{const U=new cr(g);l[N]=U,u[N]=1,a.push(U)}}),this.filterAndSortMediaOptions(a,t,c,d,h)}filterAndSortMediaOptions(e,t,n,a,l){let u=[],c=[],d=e;if((n||a)&&l&&(d=d.filter(({videoCodec:S,videoRange:E,width:b,height:A})=>(!!S||!!(b&&A))&&lA(E))),d.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const S=new Error("no level with compatible codecs found in manifest");this.hls.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:S,reason:S.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:S}=this.hls.config;u=t.audioTracks.filter(E=>!E.audioCodec||Df(E.audioCodec,"audio",S)),oy(u)}t.subtitles&&(c=t.subtitles,oy(c));const h=d.slice(0);d.sort((S,E)=>{if(S.attrs["HDCP-LEVEL"]!==E.attrs["HDCP-LEVEL"])return(S.attrs["HDCP-LEVEL"]||"")>(E.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&S.height!==E.height)return S.height-E.height;if(S.frameRate!==E.frameRate)return S.frameRate-E.frameRate;if(S.videoRange!==E.videoRange)return bo.indexOf(S.videoRange)-bo.indexOf(E.videoRange);if(S.videoCodec!==E.videoCodec){const b=gp(S.videoCodec),A=gp(E.videoCodec);if(b!==A)return A-b}if(S.uri===E.uri&&S.codecSet!==E.codecSet){const b=Eo(S.codecSet),A=Eo(E.codecSet);if(b!==A)return A-b}return S.averageBitrate!==E.averageBitrate?S.averageBitrate-E.averageBitrate:0});let g=h[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==h.length)){for(let S=0;S<h.length;S++)if(h[S].pathwayId===d[0].pathwayId){g=h[S];break}}this._levels=d;for(let S=0;S<d.length;S++)if(d[S]===g){var p;this._firstLevel=S;const E=g.bitrate,b=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${E}`),((p=this.hls.userConfig)==null?void 0:p.abrEwmaDefaultEstimate)===void 0){const A=Math.min(E,this.hls.config.abrEwmaDefaultEstimateMax);A>b&&b===zv.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=A)}break}const v=l&&!a,x={levels:d,audioTracks:u,subtitleTracks:c,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:l,video:a,altAudio:!v&&u.some(S=>!!S.url)};this.hls.trigger(R.MANIFEST_PARSED,x),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const g=new Error("invalid level idx"),p=e<0;if(this.hls.trigger(R.ERROR,{type:Te.OTHER_ERROR,details:te.LEVEL_SWITCH_ERROR,level:e,fatal:p,error:g,reason:g.message}),p)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,a=this.currentLevel,l=a?a.attrs["PATHWAY-ID"]:void 0,u=t[e],c=u.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=u,n===e&&u.details&&a&&l===c)return;this.log(`Switching to level ${e} (${u.height?u.height+"p ":""}${u.videoRange?u.videoRange+" ":""}${u.codecSet?u.codecSet+" ":""}@${u.bitrate})${c?" with Pathway "+c:""} from level ${n}${l?" with Pathway "+l:""}`);const d={level:e,attrs:u.attrs,details:u.details,bitrate:u.bitrate,averageBitrate:u.averageBitrate,maxBitrate:u.maxBitrate,realBitrate:u.realBitrate,width:u.width,height:u.height,codecSet:u.codecSet,audioCodec:u.audioCodec,videoCodec:u.videoCodec,audioGroups:u.audioGroups,subtitleGroups:u.subtitleGroups,loaded:u.loaded,loadError:u.loadError,fragmentError:u.fragmentError,name:u.name,id:u.id,uri:u.uri,url:u.url,urlId:0,audioGroupIds:u.audioGroupIds,textGroupIds:u.textGroupIds};this.hls.trigger(R.LEVEL_SWITCHING,d);const h=u.details;if(!h||h.live){const g=this.switchParams(u.uri,a==null?void 0:a.details,h);this.loadPlaylist(g)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Me.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Se.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(l=>!!n[l]))return;const a=this._levels[t.level];a!=null&&a.loadError&&(this.log(`Resetting level error count of ${a.loadError} on frag buffered`),a.loadError=0)}}onLevelLoaded(e,t){var n;const{level:a,details:l}=t,u=this._levels[a];if(!u){var c;this.warn(`Invalid level index ${a}`),(c=t.deliveryDirectives)!=null&&c.skip&&(l.deltaUpdateFailed=!0);return}a===this.currentLevelIndex?(u.fragmentError===0&&(u.loadError=0),this.playlistLoaded(a,t,u.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(l.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let a=n.uri;if(e)try{a=e.addDirectives(a)}catch(u){this.warn(`Could not construct new URL with HLS Delivery Directives: ${u}`)}const l=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${l?" Pathway "+l:""} ${a}`),this.clearTimer(),this.hls.trigger(R.LEVEL_LOADING,{url:a,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((a,l)=>l!==e?!0:(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(u=>u.level=-1)),!1));lv(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(R.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(R.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function oy(r){const e={};r.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class u_{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const a=this.keyUriToKeyInfo[n].loader;if(a){var t;if(e&&e!==((t=a.context)==null?void 0:t.frag.type))return;a.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=te.KEY_LOAD_ERROR,n,a,l){return new nn({type:Te.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:l,error:n,networkDetails:a})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:a}=e;for(let l=0;l<t.length;l++){const u=t[l];if(a<=u.cc&&(n==="initSegment"||u.sn==="initSegment"||n<u.sn)){this.emeController.selectKeySystemFormat(u).then(c=>{u.setKeyFormat(c)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,a;t&&e.setKeyFormat(t);const l=e.decryptdata;if(!l){const h=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,te.KEY_LOAD_ERROR,h))}const u=l.uri;if(!u)return Promise.reject(this.createKeyLoadError(e,te.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${u}"`)));let c=this.keyUriToKeyInfo[u];if((n=c)!=null&&n.decryptdata.key)return l.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});if((a=c)!=null&&a.keyLoadPromise){var d;switch((d=c.mediaKeySessionContext)==null?void 0:d.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return c.keyLoadPromise.then(h=>(l.key=h.keyInfo.decryptdata.key,{frag:e,keyInfo:c}))}}switch(c=this.keyUriToKeyInfo[u]={decryptdata:l,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},l.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return l.keyFormat==="identity"?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,te.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${l.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const a=this.emeController.loadKey(n);if(a)return(e.keyLoadPromise=a.then(l=>(e.mediaKeySessionContext=l,n))).catch(l=>{throw e.keyLoadPromise=null,l})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,a=n.loader,l=new a(n);return t.keyLoader=e.loader=l,e.keyLoadPromise=new Promise((u,c)=>{const d={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},h=n.keyLoadPolicy.default,g={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(v,x,S,E)=>{const{frag:b,keyInfo:A,url:O}=S;if(!b.decryptdata||A!==this.keyUriToKeyInfo[O])return c(this.createKeyLoadError(b,te.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),E));A.decryptdata.key=b.decryptdata.key=new Uint8Array(v.data),b.keyLoader=null,A.loader=null,u({frag:b,keyInfo:A})},onError:(v,x,S,E)=>{this.resetLoader(x),c(this.createKeyLoadError(t,te.KEY_LOAD_ERROR,new Error(`HTTP Error ${v.code} loading key ${v.text}`),S,vt({url:d.url,data:void 0},v)))},onTimeout:(v,x,S)=>{this.resetLoader(x),c(this.createKeyLoadError(t,te.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),S))},onAbort:(v,x,S)=>{this.resetLoader(x),c(this.createKeyLoadError(t,te.INTERNAL_ABORTED,new Error("key loading aborted"),S))}};l.load(d,g,p)})}resetLoader(e){const{frag:t,keyInfo:n,url:a}=e,l=n.loader;t.keyLoader===l&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[a],l&&l.destroy()}}function Kv(){return self.SourceBuffer||self.WebKitSourceBuffer}function Yv(){if(!hs())return!1;const e=Kv();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function c_(){if(!Yv())return!1;const r=hs();return typeof(r==null?void 0:r.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>r.isTypeSupported(Sa(e,"video")))||["mp4a.40.2","fLaC"].some(e=>r.isTypeSupported(Sa(e,"audio"))))}function f_(){var r;const e=Kv();return typeof(e==null||(r=e.prototype)==null?void 0:r.changeType)=="function"}const d_=250,lo=2,h_=.1,m_=.05;class g_{constructor(e,t,n,a){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=a}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:a,stalled:l}=this;if(a===null)return;const{currentTime:u,seeking:c}=a,d=this.seeking&&!c,h=!this.seeking&&c;if(this.seeking=c,u!==e){if(this.moved=!0,c||(this.nudgeRetry=0),l!==null){if(this.stallReported){const b=self.performance.now()-l;Y.warn(`playback not stuck anymore @${u}, after ${Math.round(b)}ms`),this.stallReported=!1}this.stalled=null}return}if(h||d){this.stalled=null;return}if(a.paused&&!c||a.ended||a.playbackRate===0||!Ke.getBuffered(a).length){this.nudgeRetry=0;return}const g=Ke.bufferInfo(a,u,0),p=g.nextStart||0;if(c){const b=g.len>lo,A=!p||t&&t.start<=u||p-u>lo&&!this.fragmentTracker.getPartialFragment(u);if(b||A)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var v;if(!(g.len>0)&&!p)return;const A=Math.max(p,g.start||0)-u,O=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,k=(O==null||(v=O.details)==null?void 0:v.live)?O.details.targetduration*2:lo,D=this.fragmentTracker.getPartialFragment(u);if(A>0&&(A<=k||D)){a.paused||this._trySkipBufferHole(D);return}}const x=self.performance.now();if(l===null){this.stalled=x;return}const S=x-l;if(!c&&S>=d_&&(this._reportStall(g),!this.media))return;const E=Ke.bufferInfo(a,u,n.maxBufferHole);this._tryFixBufferStall(E,S)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:a,media:l}=this;if(l===null)return;const u=l.currentTime,c=a.getPartialFragment(u);c&&(this._trySkipBufferHole(c)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-u<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(Y.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:a}=this;if(!a&&n){this.stallReported=!0;const l=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);Y.warn(l.message),t.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:a}=this;if(a===null)return 0;const l=a.currentTime,u=Ke.bufferInfo(a,l,0),c=l<u.start?u.start:u.nextStart;if(c){const d=u.len<=t.maxBufferHole,h=u.len>0&&u.len<1&&a.readyState<3,g=c-l;if(g>0&&(d||h)){if(g>t.maxBufferHole){const{fragmentTracker:v}=this;let x=!1;if(l===0){const S=v.getAppendedFrag(0,Se.MAIN);S&&c<S.end&&(x=!0)}if(!x){const S=e||v.getAppendedFrag(l,Se.MAIN);if(S){let E=!1,b=S.end;for(;b<c;){const A=v.getPartialFragment(b);if(A)b+=A.duration;else{E=!0;break}}if(E)return 0}}}const p=Math.max(c+m_,l+h_);if(Y.warn(`skipping hole, adjusting currentTime from ${l} to ${p}`),this.moved=!0,this.stalled=null,a.currentTime=p,e&&!e.gap){const v=new Error(`fragment loaded with buffer holes, seeking from ${l} to ${p}`);n.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,frag:e})}return p}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:a}=this;if(n===null)return;const l=n.currentTime;if(this.nudgeRetry++,a<e.nudgeMaxRetry){const u=l+(a+1)*e.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${l} to ${u}`);Y.warn(c.message),n.currentTime=u,t.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1})}else{const u=new Error(`Playhead still not moving while enough data buffered @${l} after ${e.nudgeMaxRetry} nudges`);Y.error(u.message),t.trigger(R.ERROR,{type:Te.MEDIA_ERROR,details:te.BUFFER_STALLED_ERROR,error:u,fatal:!0})}}}const p_=100;class y_ extends _d{constructor(e,t,n){super(e,t,n,"[stream-controller]",Se.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(R.ERROR,this.onError,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(R.ERROR,this.onError,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(p_),this.level=-1,!this.startFragRequested){let a=n.startLevel;a===-1&&(n.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=n.firstAutoLevel),n.nextLoadLevel=a,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=ue.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=ue.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ue.WAITING_LEVEL:{const{levels:t,level:n}=this,a=t==null?void 0:t[n],l=a==null?void 0:a.details;if(l&&(!l.live||this.levelLastLoaded===a)){if(this.waitForCdnTuneIn(l))break;this.state=ue.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ue.IDLE;break}break}case ue.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:a,level:l}=this,u=a==null?void 0:a[l];this.resetStartWhenNotLoaded(u||null),this.state=ue.IDLE}}break}this.state===ue.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:a}=this;if(t===null||!a&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const l=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[l]))return;const u=n[l],c=this.getMainFwdBufferInfo();if(c===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(c,d)){const E={};this.altAudio&&(E.type="video"),this.hls.trigger(R.BUFFER_EOS,E),this.state=ue.ENDED;return}if(!this.buffering)return;e.loadLevel!==l&&e.manualLevel===-1&&this.log(`Adapting to level ${l} from level ${this.level}`),this.level=e.nextLoadLevel=l;const h=u.details;if(!h||this.state===ue.WAITING_LEVEL||h.live&&this.levelLastLoaded!==u){this.level=l,this.state=ue.WAITING_LEVEL;return}const g=c.len,p=this.getMaxBufferLength(u.maxBitrate);if(g>=p)return;this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);const v=this.backtrackFragment?this.backtrackFragment.start:c.end;let x=this.getNextFragment(v,h);if(this.couldBacktrack&&!this.fragPrevious&&x&&x.sn!=="initSegment"&&this.fragmentTracker.getState(x)!==yt.OK){var S;const b=((S=this.backtrackFragment)!=null?S:x).sn-h.startSN,A=h.fragments[b-1];A&&x.cc===A.cc&&(x=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(x&&this.isLoopLoading(x,v)){if(!x.gap){const b=this.audioOnly&&!this.altAudio?je.AUDIO:je.VIDEO,A=(b===je.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,b,Se.MAIN)}x=this.getNextFragmentLoopLoading(x,h,c,Se.MAIN,p)}x&&(x.initSegment&&!x.initSegment.data&&!this.bitrateTest&&(x=x.initSegment),this.loadFragment(x,u,v))}loadFragment(e,t,n){const a=this.fragmentTracker.getState(e);this.fragCurrent=e,a===yt.NOT_LOADED||a===yt.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Se.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const a=this.getAppendedFrag(t.currentTime);a&&a.start>1&&this.flushMainBuffer(0,a.start-1);const l=this.getLevelDetails();if(l!=null&&l.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<l.targetduration*2)return}if(!t.paused&&e){const c=this.hls.nextLoadLevel,d=e[c],h=this.fragLastKbps;h&&this.fragCurrent?n=this.fragCurrent.duration*d.maxBitrate/(1e3*h)+1:n=0}else n=0;const u=this.getBufferedFrag(t.currentTime+n);if(u){const c=this.followingBufferedFrag(u);if(c){this.abortCurrentFrag();const d=c.maxStartPTS?c.maxStartPTS:c.start,h=c.duration,g=Math.max(u.end,d+Math.min(Math.max(h-this.config.maxFragLookUpTolerance,h*(this.couldBacktrack?.5:.125)),h*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(g,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ue.KEY_LOADING:case ue.FRAG_LOADING:case ue.FRAG_LOADING_WAITING_RETRY:case ue.PARSING:case ue.PARSED:this.state=ue.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new g_(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;ge(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(R.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,a=!1;t.levels.forEach(l=>{const u=l.audioCodec;u&&(n=n||u.indexOf("mp4a.40.2")!==-1,a=a||u.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&a&&!f_(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==ue.IDLE)return;const a=n[t.level];(!a.details||a.details.live&&this.levelLastLoaded!==a||this.waitForCdnTuneIn(a.details))&&(this.state=ue.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:a}=this,l=t.level,u=t.details,c=u.totalduration;if(!a){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${c}`);const d=a[l],h=this.fragCurrent;h&&(this.state===ue.FRAG_LOADING||this.state===ue.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let g=0;if(u.live||(n=d.details)!=null&&n.live){var p;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;g=this.alignPlaylists(u,d.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(d.details=u,this.levelLastLoaded=d,this.hls.trigger(R.LEVEL_UPDATED,{details:u,level:l}),this.state===ue.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=ue.IDLE}this.startFragRequested?u.live&&this.synchronizeToLiveEdge(u):this.setStartPosition(u,g),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:a,payload:l}=e,{levels:u}=this;if(!u){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const c=u[n.level],d=c.details;if(!d){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const h=c.videoCodec,g=d.PTSKnown||!d.live,p=(t=n.initSegment)==null?void 0:t.data,v=this._getAudioCodec(c),x=this.transmuxer=this.transmuxer||new _v(this.hls,Se.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),S=a?a.index:-1,E=S!==-1,b=new Rd(n.level,n.sn,n.stats.chunkCount,l.byteLength,S,E),A=this.initPTS[n.cc];x.push(l,p,v,h,n,a,d.totalduration,g,b,A)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const u=this.fragCurrent;u&&(this.log("Switching to main audio track, cancel main fragment load"),u.abortRequests(),this.fragmentTracker.removeFragment(u)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const l=this.hls;n&&(l.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),l.trigger(R.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,a=!!this.hls.audioTracks[n].url;if(a){const l=this.videoBuffer;l&&this.mediaBuffer!==l&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=l)}this.altAudio=a,this.tick()}onBufferCreated(e,t){const n=t.tracks;let a,l,u=!1;for(const c in n){const d=n[c];if(d.id==="main"){if(l=c,a=d,c==="video"){const h=n[c];h&&(this.videoBuffer=h.buffer)}}else u=!0}u&&a?(this.log(`Alternate track found, use ${l}.buffered to schedule main fragment loading`),this.mediaBuffer=a.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:a}=t;if(n&&n.type!==Se.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${a?" p: "+a.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ue.PARSED&&(this.state=ue.IDLE);return}const l=a?a.stats:n.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,a)}onError(e,t){var n;if(t.fatal){this.state=ue.ERROR;return}switch(t.details){case te.FRAG_GAP:case te.FRAG_PARSING_ERROR:case te.FRAG_DECRYPT_ERROR:case te.FRAG_LOAD_ERROR:case te.FRAG_LOAD_TIMEOUT:case te.KEY_LOAD_ERROR:case te.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Se.MAIN,t);break;case te.LEVEL_LOAD_ERROR:case te.LEVEL_LOAD_TIMEOUT:case te.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ue.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===Me.LEVEL&&(this.state=ue.IDLE);break;case te.BUFFER_APPEND_ERROR:case te.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===te.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case te.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Ke.getBuffered(e).length){const n=this.state!==ue.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=ue.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==je.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===je.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,Se.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const a=Ke.getBuffered(e),u=(a.length?a.start(0):0)-n;u>0&&(u<this.config.maxBufferHole||u<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${u} to match buffer start`),n+=u,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:a}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=ue.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const l=e.stats;l.parsing.start=l.parsing.end=l.buffering.start=l.buffering.end=self.performance.now(),a.trigger(R.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:a}=this,{remuxResult:l,chunkMeta:u}=e,c=this.getCurrentContext(u);if(!c){this.resetWhenMissingContext(u);return}const{frag:d,part:h,level:g}=c,{video:p,text:v,id3:x,initSegment:S}=l,{details:E}=g,b=this.altAudio?void 0:l.audio;if(this.fragContextChanged(d)){this.fragmentTracker.removeFragment(d);return}if(this.state=ue.PARSING,S){if(S!=null&&S.tracks){const _=d.initSegment||d;this._bufferInitSegment(g,S.tracks,_,u),a.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:_,id:n,tracks:S.tracks})}const A=S.initPTS,O=S.timescale;ge(A)&&(this.initPTS[d.cc]={baseTime:A,timescale:O},a.trigger(R.INIT_PTS_FOUND,{frag:d,id:n,initPTS:A,timescale:O}))}if(p&&E&&d.sn!=="initSegment"){const A=E.fragments[d.sn-1-E.startSN],O=d.sn===E.startSN,_=!A||d.cc>A.cc;if(l.independent!==!1){const{startPTS:k,endPTS:D,startDTS:F,endDTS:B}=p;if(h)h.elementaryStreams[p.type]={startPTS:k,endPTS:D,startDTS:F,endDTS:B};else if(p.firstKeyFrame&&p.independent&&u.id===1&&!_&&(this.couldBacktrack=!0),p.dropped&&p.independent){const M=this.getMainFwdBufferInfo(),I=(M?M.end:this.getLoadPosition())+this.config.maxBufferHole,N=p.firstKeyFramePTS?p.firstKeyFramePTS:k;if(!O&&I<N-this.config.maxBufferHole&&!_){this.backtrack(d);return}else _&&(d.gap=!0);d.setElementaryStreamInfo(p.type,d.start,D,d.start,B,!0)}else O&&k>lo&&(d.gap=!0);d.setElementaryStreamInfo(p.type,k,D,F,B),this.backtrackFragment&&(this.backtrackFragment=d),this.bufferFragmentData(p,d,h,u,O||_)}else if(O||_)d.gap=!0;else{this.backtrack(d);return}}if(b){const{startPTS:A,endPTS:O,startDTS:_,endDTS:k}=b;h&&(h.elementaryStreams[je.AUDIO]={startPTS:A,endPTS:O,startDTS:_,endDTS:k}),d.setElementaryStreamInfo(je.AUDIO,A,O,_,k),this.bufferFragmentData(b,d,h,u)}if(E&&x!=null&&(t=x.samples)!=null&&t.length){const A={id:n,frag:d,details:E,samples:x.samples};a.trigger(R.FRAG_PARSING_METADATA,A)}if(E&&v){const A={id:n,frag:d,details:E,samples:v.samples};a.trigger(R.FRAG_PARSING_USERDATA,A)}}_bufferInitSegment(e,t,n,a){if(this.state!==ue.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:l,video:u,audiovideo:c}=t;if(l){let d=e.audioCodec;const h=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){d&&(d.indexOf("mp4a.40.5")!==-1?d="mp4a.40.2":d="mp4a.40.5");const g=l.metadata;g&&"channelCount"in g&&(g.channelCount||1)!==1&&h.indexOf("firefox")===-1&&(d="mp4a.40.5")}d&&d.indexOf("mp4a.40.5")!==-1&&h.indexOf("android")!==-1&&l.container!=="audio/mpeg"&&(d="mp4a.40.2",this.log(`Android: force audio codec to ${d}`)),e.audioCodec&&e.audioCodec!==d&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${d}"`),l.levelCodec=d,l.id="main",this.log(`Init audio buffer, container:${l.container}, codecs[selected/level/parsed]=[${d||""}/${e.audioCodec||""}/${l.codec}]`)}u&&(u.levelCodec=e.videoCodec,u.id="main",this.log(`Init video buffer, container:${u.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u.codec}]`)),c&&this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.codecs}/${c.codec}]`),this.hls.trigger(R.BUFFER_CODECS,t),Object.keys(t).forEach(d=>{const g=t[d].initSegment;g!=null&&g.byteLength&&this.hls.trigger(R.BUFFER_APPENDING,{type:d,data:g,frag:n,part:null,chunkMeta:a,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Se.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ue.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Ke.isBuffered(e,n)?t=this.getAppendedFrag(n):Ke.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const a=this.fragPlaying,l=t.level;(!a||t.sn!==a.sn||a.level!==l)&&(this.fragPlaying=t,this.hls.trigger(R.FRAG_CHANGED,{frag:t}),(!a||a.level!==l)&&this.hls.trigger(R.LEVEL_SWITCHED,{level:l}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&ge(t)&&ge(n.programDateTime)){const a=n.programDateTime+(t-n.start)*1e3;return new Date(a)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class zt{static get version(){return"1.5.20"}static isMSESupported(){return Yv()}static isSupported(){return c_()}static getMediaSource(){return hs()}static get Events(){return R}static get ErrorTypes(){return Te}static get ErrorDetails(){return te}static get DefaultConfig(){return zt.defaultConfig?zt.defaultConfig:zv}static set DefaultConfig(e){zt.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Id,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,r1(e.debug||!1,"Hls instance");const t=this.config=a_(zt.DefaultConfig,e);this.userConfig=e,t.progressive&&l_(t);const{abrController:n,bufferController:a,capLevelController:l,errorController:u,fpsController:c}=t,d=new u(this),h=this.abrController=new n(this),g=this.bufferController=new a(this),p=this.capLevelController=new l(this),v=new c(this),x=new J1(this),S=new sA(this),E=t.contentSteeringController,b=E?new E(this):null,A=this.levelController=new o_(this,b),O=new kA(this),_=new u_(this.config),k=this.streamController=new y_(this,O,_);p.setStreamController(k),v.setStreamController(k);const D=[x,A,k];b&&D.splice(1,0,b),this.networkControllers=D;const F=[h,g,p,v,S,O];this.audioTrackController=this.createController(t.audioTrackController,D);const B=t.audioStreamController;B&&D.push(new B(this,O,_)),this.subtitleTrackController=this.createController(t.subtitleTrackController,D);const M=t.subtitleStreamController;M&&D.push(new M(this,O,_)),this.createController(t.timelineController,F),_.emeController=this.emeController=this.createController(t.emeController,F),this.cmcdController=this.createController(t.cmcdController,F),this.latencyController=this.createController(rA,F),this.coreComponents=F,D.push(d);const I=d.onErrorOut;typeof I=="function"&&this.on(R.ERROR,I,d)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,a){this._emitter.off(e,t,n,a)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(Y.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const a=e===R.ERROR;this.trigger(R.ERROR,{type:Te.OTHER_ERROR,details:te.INTERNAL_EXCEPTION,fatal:a,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){Y.log("destroy"),this.trigger(R.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){Y.log("attachMedia"),this._media=e,this.trigger(R.MEDIA_ATTACHING,{media:e})}detachMedia(){Y.log("detachMedia"),this.trigger(R.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,a=this.url=xd.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,Y.log(`loadSource:${a}`),t&&n&&(n!==a||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(R.MANIFEST_LOADING,{url:e})}startLoad(e=-1){Y.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),!(!this.started||!this.networkControllers));t++);}stopLoad(){Y.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}resumeBuffering(){Y.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()})}pauseBuffering(){Y.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()})}swapAudioCodec(){Y.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){Y.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){Y.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){Y.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){Y.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){Y.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){Y.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(Y.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){aA(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let a=0;a<n;a++)if(e[a].maxBitrate>=t)return a;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let a;if(t===-1&&e!=null&&e.length?a=e.length-1:a=t,n)for(let l=a;l--;){const u=e[l].attrs["HDCP-LEVEL"];if(u&&u<=n)return l}return a}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}zt.defaultConfig=void 0;function v_({url:r,useHlsJs:e,title:t,playing:n=!1,startTime:a=0,onPlay:l,onPause:u,onEnded:c,onError:d,onProgress:h,onQualitiesLoaded:g}){const p=he.useRef(null),v=he.useRef(null),[x,S]=he.useState(!0),[E,b]=he.useState(!1);he.useEffect(()=>{if(!e||!p.current)return;v.current&&v.current.destroy();const _=new zt({debug:!0,enableWorker:!0,autoStartLoad:!0,startLevel:-1,manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:1e4,timeoutRetry:{maxNumRetry:3,retryDelayMs:1e3,maxRetryDelayMs:0},errorRetry:{maxNumRetry:3,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:1e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:2e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},maxBufferSize:0,maxBufferLength:30,maxMaxBufferLength:600,progressive:!1,lowLatencyMode:!1,enableSoftwareAES:!0,abrEwmaDefaultEstimate:5e5,backBufferLength:90});return _.attachMedia(p.current),_.on(zt.Events.MEDIA_ATTACHED,()=>{_.loadSource(r)}),_.on(zt.Events.MANIFEST_PARSED,()=>{var k;S(!1),n&&((k=p.current)==null||k.play())}),_.on(zt.Events.LEVEL_LOADED,()=>{const k=_.levels.map(D=>({width:D.width,height:D.height,bitrate:D.bitrate}));g==null||g(k)}),_.on(zt.Events.ERROR,(k,D)=>{if(D.fatal){switch(D.type){case zt.ErrorTypes.NETWORK_ERROR:console.error("Network error:",D),_.startLoad();break;case zt.ErrorTypes.MEDIA_ERROR:console.error("Media error:",D),_.recoverMediaError();break;default:console.error("Fatal error:",D),_.destroy();break}d==null||d(new Error(`HLS.js Error: ${D.type}`))}}),v.current=_,()=>{v.current&&v.current.destroy()}},[r,e,d,n,g]);const A=_=>{const k=p.current;if(k)switch(_.key.toLowerCase()){case" ":_.preventDefault(),k.paused?k.play():k.pause();break;case"arrowleft":_.preventDefault(),k.currentTime=Math.max(0,k.currentTime-10);break;case"arrowright":_.preventDefault(),k.currentTime=Math.min(k.duration,k.currentTime+10);break;case"arrowup":_.preventDefault(),k.volume=Math.min(1,k.volume+.1);break;case"arrowdown":_.preventDefault(),k.volume=Math.max(0,k.volume-.1);break;case"m":_.preventDefault(),k.muted=!k.muted;break;case"f":_.preventDefault(),document.fullscreenElement?document.exitFullscreen():k.requestFullscreen();break}};he.useEffect(()=>{if(e)return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[e]);const O=()=>{p.current&&!E&&(p.current.currentTime=a,b(!0)),l==null||l()};return he.useEffect(()=>{b(!1)},[r]),e?L.jsxs("div",{className:"relative w-full h-full bg-black rounded-lg overflow-hidden shadow-2xl",children:[t&&L.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 p-4 bg-gradient-to-b from-black/80 to-transparent",children:L.jsx("h1",{className:"text-white text-xl font-medium",children:t})}),x&&L.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80",children:L.jsx("div",{className:"text-sky-200",children:"Loading..."})}),L.jsx("video",{ref:p,controls:!0,playsInline:!0,autoPlay:n,style:{width:"100%",height:"100%"},onPlay:O,onPause:u,onEnded:c,onTimeUpdate:_=>{h==null||h({played:_.currentTarget.currentTime/_.currentTarget.duration,playedSeconds:_.currentTarget.currentTime,loaded:_.currentTarget.buffered.length?_.currentTarget.buffered.end(0)/_.currentTarget.duration:0,loadedSeconds:_.currentTarget.buffered.length?_.currentTarget.buffered.end(0):0})},onSeeking:()=>S(!0),onSeeked:()=>S(!1),onWaiting:()=>S(!0),onPlaying:()=>S(!1),onLoadedData:()=>S(!1)})]}):L.jsxs("div",{className:"relative w-full h-full bg-black rounded-lg overflow-hidden shadow-2xl",children:[t&&L.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 p-4 bg-gradient-to-b from-black/80 to-transparent",children:L.jsx("h1",{className:"text-white text-xl font-medium",children:t})}),L.jsx(Wb,{url:r,playing:n,controls:!0,width:"100%",height:"100%",className:"absolute top-0 left-0",onPlay:O,onPause:u,onEnded:c,onError:d,onProgress:h,progressInterval:1e3})]})}const fd=Ni("/movies/$movieID/play")({validateSearch:r=>({title:String(r.title??"unknown"),pid:String(r.pid??"unknown")}),loaderDeps:({search:r})=>r,component:x_});function x_(){const{movieID:r}=fd.useParams(),{pid:e,title:t}=fd.useLoaderDeps();return he.useEffect(()=>()=>{window.confirm("are you sure you wish to stop playback?")&&fetch(`/api/v1/ffmpeg/jobs/cancel/${e}`,{method:"delete",credentials:"include"}).then(n=>alert(`${n.status} - ${n.statusText}`))},[e]),L.jsx("div",{className:"min-h-screen bg-slate-900 flex flex-col",children:L.jsx("div",{className:"flex-1 flex items-center justify-center p-4 md:p-8",children:L.jsx("div",{className:"w-full max-w-7xl aspect-video",children:L.jsx(v_,{url:`/api/v1/hls/movies/${r}/playlist.m3u8`,useHlsJs:Kb(),title:t,startTime:300,onError:n=>{console.error("Playback Error:",n)}})})})})}const S_=Ni("/login")(),E_=Ni("/settings/")(),T_=Ni("/settings/users/create")(),b_=S_.update({id:"/login",path:"/login",getParentRoute:()=>Si}).lazy(()=>bt(()=>import("./login.lazy-CorNqf7r.js"),[]).then(r=>r.Route)),A_=db.update({id:"/",path:"/",getParentRoute:()=>Si}),R_=E_.update({id:"/settings/",path:"/settings/",getParentRoute:()=>Si}).lazy(()=>bt(()=>import("./index.lazy-S2BvkpVV.js"),[]).then(r=>r.Route)),L_=mb.update({id:"/tvshows/",path:"/tvshows/",getParentRoute:()=>Si}),__=pb.update({id:"/music/",path:"/music/",getParentRoute:()=>Si}),D_=qf.update({id:"/movies/",path:"/movies/",getParentRoute:()=>Si}),C_=Jl.update({id:"/settings/users/",path:"/settings/users/",getParentRoute:()=>Si}),w_=Xf.update({id:"/movies/$movieID/",path:"/movies/$movieID/",getParentRoute:()=>Si}),O_=T_.update({id:"/settings/users/create",path:"/settings/users/create",getParentRoute:()=>Si}).lazy(()=>bt(()=>import("./create.lazy-Dx2tVMc8.js"),[]).then(r=>r.Route)),I_=fd.update({id:"/movies/$movieID/play",path:"/movies/$movieID/play",getParentRoute:()=>Si}),k_={IndexRoute:A_,LoginLazyRoute:b_,MoviesIndexRoute:D_,MusicIndexRoute:__,TvshowsIndexRoute:L_,SettingsIndexLazyRoute:R_,MoviesMovieIDPlayRoute:I_,SettingsUsersCreateLazyRoute:O_,MoviesMovieIDIndexRoute:w_,SettingsUsersIndexRoute:C_},M_=Si._addFileChildren(k_)._addFileTypes(),N_=TT({routeTree:M_});TE.createRoot(document.getElementById("root")).render(L.jsx(he.StrictMode,{children:L.jsx(_T,{router:N_})}));export{ub as E,j_ as F,tr as L,cb as S,bt as _,pd as a,qT as b,U_ as c,B_ as d,G_ as e,vd as f,F_ as g,JT as h,Pb as i,L as j,dd as k,ln as l,Ta as m,Uy as n,he as r,lb as u};

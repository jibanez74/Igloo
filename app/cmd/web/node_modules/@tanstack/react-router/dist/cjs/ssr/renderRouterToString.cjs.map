{"version":3,"file":"renderRouterToString.cjs","sources":["../../../src/ssr/renderRouterToString.tsx"],"sourcesContent":["import ReactDOMServer from 'react-dom/server'\nimport type { ReactNode } from 'react'\nimport type { AnyRouter } from '@tanstack/router-core'\n\nexport const renderRouterToString = async ({\n  router,\n  responseHeaders,\n  children,\n}: {\n  router: AnyRouter\n  responseHeaders: Headers\n  children: ReactNode\n}) => {\n  try {\n    let html = ReactDOMServer.renderToString(children)\n    router.serverSsr!.setRenderFinished()\n\n    const injectedHtml = router.serverSsr!.takeBufferedHtml()\n    if (injectedHtml) {\n      html = html.replace(`</body>`, () => `${injectedHtml}</body>`)\n    }\n\n    return new Response(`<!DOCTYPE html>${html}`, {\n      status: router.state.statusCode,\n      headers: responseHeaders,\n    })\n  } catch (error) {\n    console.error('Render to string error:', error)\n    return new Response('Internal Server Error', {\n      status: 500,\n      headers: responseHeaders,\n    })\n  } finally {\n    router.serverSsr?.cleanup()\n  }\n}\n"],"names":[],"mappings":";;;AAIO,MAAM,uBAAuB,OAAO;AAAA,EACzC;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,MAAI;AACF,QAAI,OAAO,eAAe,eAAe,QAAQ;AACjD,WAAO,UAAW,kBAAA;AAElB,UAAM,eAAe,OAAO,UAAW,iBAAA;AACvC,QAAI,cAAc;AAChB,aAAO,KAAK,QAAQ,WAAW,MAAM,GAAG,YAAY,SAAS;AAAA,IAC/D;AAEA,WAAO,IAAI,SAAS,kBAAkB,IAAI,IAAI;AAAA,MAC5C,QAAQ,OAAO,MAAM;AAAA,MACrB,SAAS;AAAA,IAAA,CACV;AAAA,EACH,SAAS,OAAO;AACd,YAAQ,MAAM,2BAA2B,KAAK;AAC9C,WAAO,IAAI,SAAS,yBAAyB;AAAA,MAC3C,QAAQ;AAAA,MACR,SAAS;AAAA,IAAA,CACV;AAAA,EACH,UAAA;AACE,WAAO,WAAW,QAAA;AAAA,EACpB;AACF;;"}